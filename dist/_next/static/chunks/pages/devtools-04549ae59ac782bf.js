(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[893],{2230:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Br}});var a=n(7294),r=n(2640),i=n(29),o=n(7794),s=n.n(o),c=n(7690),u=n(6897),l=n(2923),d=n(7563),f=n(7169);function p(e){var t=new Date(e),n=t.getFullYear(),a=t.getMonth()+1,r=t.getDate(),i=t.getHours().toString().padStart(2,"0"),o=t.getMinutes().toString().padStart(2,"0"),s=t.getSeconds().toString().padStart(2,"0"),c=t.getMilliseconds().toString().padStart(3,"0");return"".concat(n,"-").concat(a,"-").concat(r," ").concat(i,":").concat(o,":").concat(s,".").concat(c)}function m(e){return navigator.clipboard?navigator.clipboard.writeText(e):Promise.resolve()}function h(e,t){return"string"===typeof e&&t.indexOf(e)>=0}function g(){var e,t=function(e){if("string"===typeof e)return e},n=function(e){if("string"===typeof e)return I(e)},a=function(e,t){if(h(e,t))return e},r=d.parse(location.search);if("string"===typeof r.signalingUrlCandidates)try{e=JSON.parse(r.signalingUrlCandidates)}catch(o){}var i={apiUrl:t(r.apiUrl),audio:n(r.audio),audioBitRate:a(r.audioBitRate,f.xR),audioCodecType:a(r.audioCodecType,f.o1),autoGainControl:a(r.autoGainControl,f.iN),bundleId:t(r.bundleId),channelId:t(r.channelId),clientId:t(r.clientId),googCpuOveruseDetection:n(r.googCpuOveruseDetection),debug:n(r.debug),debugType:a(r.debugType,f.aF),displayResolution:a(r.displayResolution,f.hJ),e2ee:n(r.e2ee),echoCancellation:a(r.echoCancellation,f.PS),echoCancellationType:a(r.echoCancellationType,f.cJ),noiseSuppression:a(r.noiseSuppression,f.ad),fakeVolume:t(r.fakeVolume),frameRate:a(r.frameRate,f.YX),mediaType:a(r.mediaType,f.w_),metadata:t(r.metadata),showStats:n(r.showStats),signalingNotifyMetadata:t(r.signalingNotifyMetadata),signalingUrlCandidates:Array.isArray(e)?e:void 0,simulcast:a(r.simulcast,f.VE),simulcastRid:a(r.simulcastRid,f.WJ),spotlight:a(r.spotlight,f.VJ),spotlightNumber:a(r.spotlightNumber,f.Xr),spotlightFocusRid:a(r.spotlightFocusRid,f.I7),spotlightUnfocusRid:a(r.spotlightUnfocusRid,f.I7),resolution:a(r.resolution,f.Vf),video:n(r.video),videoBitRate:a(r.videoBitRate,f.Q5),videoCodecType:a(r.videoCodecType,f.Sh),audioInput:t(r.audioInput),videoInput:t(r.videoInput),audioOutput:t(r.audioOutput),mute:n(r.mute),dataChannelSignaling:a(r.dataChannelSignaling,f.l9),ignoreDisconnectWebSocket:a(r.ignoreDisconnectWebSocket,f.kt),micDevice:n(r.micDevice),cameraDevice:n(r.cameraDevice),audioTrack:n(r.audioTrack),videoTrack:n(r.videoTrack),dataChannels:t(r.dataChannels),reconnect:n(r.reconnect),audioContentHint:a(r.audioContentHint,f.nT),videoContentHint:a(r.videoContentHint,f.QO),aspectRatio:a(r.aspectRatio,f.Ii),resizeMode:a(r.resizeMode,f.L4),blurRadius:a(r.blurRadius,f.G_),mediaProcessorsNoiseSuppression:n(r.mediaProcessorsNoiseSuppression),multistream:a(r.multistream,f.u9),role:a(r.role,f.K$)};return Object.keys(i).map((function(e){void 0===i[e]&&delete i[e]})),i}function v(e,t){if(e)return t.filter((function(e){return""!==e}));var n="https:"===window.location.protocol?"wss://":"ws://",a=window.location.port?":".concat(window.location.port):"";return n+window.location.hostname+a+"/signaling"}function x(e){switch(e){case"120p (160x120)":return{width:160,height:120};case"180p (320x180)":return{width:320,height:180};case"240p (320x240)":return{width:320,height:240};case"360p (640x360)":return{width:640,height:360};case"480p (640x480)":return{width:640,height:480};case"720p (1280x720)":return{width:1280,height:720};case"1080p (1920x1080)":return{width:1920,height:1080};case"2160p (3840x2160)":return{width:3840,height:2160};default:return{width:0,height:0}}}function b(e){switch(e){case"4:3":return 4/3;case"16:9":return 16/9;case"21:9":return 20/9;default:return NaN}}function j(e){switch(e){case"weak":return 5;case"midium":return 10;case"strong":return 15;default:return 0}}function y(e){var t=e.audio,n=e.autoGainControl,a=e.noiseSuppression,r=e.echoCancellation,i=e.echoCancellationType,o=e.audioInput;if(!t)return!1;if(!n&&!a&&!r&&!i&&!o)return t;var s={};o&&(s.deviceId={exact:o});var c=I(n);void 0!==c&&(s.autoGainControl=c);var u=I(a);void 0!==u&&(s.noiseSuppression=u);var l=I(r);return void 0!==l&&(s.echoCancellation=l),i&&(s.echoCancellationType=i),s}function C(e){var t=e.video,n=e.frameRate,a=e.resolution,r=e.videoInput,i=e.aspectRatio,o=e.resizeMode;if(!t)return!1;if(!n&&!a&&!r&&!i&&!o)return t;var s={};if(n&&(s.frameRate={min:parseInt(n,10),max:parseInt(n,10)}),a){var c=x(a),u=c.width,l=c.height;0<u&&0<l&&(s.width={exact:u},s.height={exact:l})}return r&&(s.deviceId={exact:r}),i&&(s.aspectRatio=b(i)),o&&(s.resizeMode=o),s}function S(e){var t=e.audio,n=e.video,a=e.frameRate,r=e.resolution,i=e.volume,o=e.aspectRatio,s=e.resizeMode,c=parseInt(a,10)||30,u=x(r),l=u.width||240,d={audio:t,video:n,frameRate:c,width:l,height:u.height||160,fontSize:Math.floor(l/5),volume:parseFloat(i)};return n&&(o||s)&&(d.videoTrackConstraints={},o&&(d.videoTrackConstraints.aspectRatio=b(o)),s&&(d.videoTrackConstraints.resizeMode=s)),d}function k(e){var t=e.aspectRatio,n=e.frameRate,a=e.resizeMode,r=e.resolution;if(!n&&!r&&!t&&!a)return{video:!0};var i={};if(n&&(i.frameRate=parseInt(n,10)),r){var o=x(r),s=o.width,c=o.height;0<s&&0<c&&(i.width=s,i.height=c)}return t&&(i.aspectRatio=b(t)),a&&(i.resizeMode=a),{video:i}}function N(e){var t=new MediaStream,n=null;if(e.video){(n=document.createElement("canvas")).getContext("2d"),n.width=e.width,n.height=e.height;var a=n.captureStream(e.frameRate).getTracks()[0];e.videoTrackConstraints&&a.applyConstraints(e.videoTrackConstraints),t.addTrack(a)}var r=null;if(e.audio){var i=new(window.AudioContext||window.webkitAudioContext),o=i.createOscillator();o.type="sine",r=i.createGain(),o.connect(r),o.start(0);var s=i.createMediaStreamDestination();r.connect(s);var c=s.stream.getTracks();t.addTrack(c[0]),r.gain.setValueAtTime(e.volume,0)}return{canvas:n,mediaStream:t,gainNode:r}}function w(e,t,n,a){if(null!==e){var r=e.getContext("2d");if(r){r.globalCompositeOperation="source-over",r.clearRect(0,0,e.width,e.height),r.fillStyle="#"+("0".repeat(6)+t.toString(16)).slice(-6),r.fillRect(0,0,e.width,e.height),r.fillStyle="#"+("0".repeat(6)+(16777215-t).toString(16)).slice(-6),r.font="".concat(n,"px Arial");var i=e.width/2-n/2,o=n/4*(a.length-1),s=e.height/2+n/2.5;r.fillText(a,i-o,s)}}}function I(e){return"true"===e||"false"!==e&&void 0}function Z(e,t){if(e){try{return JSON.parse(t)}catch(n){}return t}}function T(){if(!window.RTCRtpSender||!RTCRtpSender.getCapabilities)return"VP9";var e=RTCRtpSender.getCapabilities("video");if(!e||!e.codecs)return"VP9";var t=e.codecs.map((function(e){return e.mimeType.replace("video/","")}));return t.includes("VP9")?"VP9":t.includes("VP8")?"VP8":t.includes("H264")?"H264":t.includes("AV1")?"AV1":t.includes("H265")?"H265":"VP9"}function O(){return R.apply(this,arguments)}function R(){return(R=(0,i.Z)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==navigator.mediaDevices){e.next=2;break}return e.abrupt("return",[]);case 2:return e.prev=2,e.next=5,navigator.mediaDevices.enumerateDevices();case 5:return e.abrupt("return",e.sent);case 8:e.prev=8,e.t0=e.catch(2);case 10:return e.abrupt("return",[]);case 11:case"end":return e.stop()}}),e,null,[[2,8]])})))).apply(this,arguments)}function M(e){return"connected"===e||"connecting"===e}function D(e){return{id:e.id,label:e.label,kind:e.kind,enabled:e.enabled,muted:e.muted,readyState:e.readyState,contentHint:e.contentHint,getConstraints:e.getConstraints(),getCapabilities:e.getCapabilities?e.getCapabilities():null,getSettings:e.getSettings()}}function P(e){var t={audio:e.audio,video:e.video};e.audioCodecType&&(t.audioCodecType=e.audioCodecType);var n=parseInt(e.audioBitRate,10);n&&(t.audioBitRate=n),e.videoCodecType&&(t.videoCodecType=e.videoCodecType);var a=parseInt(e.videoBitRate,10);a&&(t.videoBitRate=a);var r=I(e.multistream);void 0!==r&&(t.multistream=r),e.e2ee&&(t.e2ee=!0);var i=I(e.spotlight);void 0!==i&&(t.spotlight=i,!0===i&&(e.spotlightNumber&&(t.spotlightNumber=parseInt(e.spotlightNumber)),e.spotlightFocusRid&&(t.spotlightFocusRid=e.spotlightFocusRid),e.spotlightUnfocusRid&&(t.spotlightUnfocusRid=e.spotlightUnfocusRid)));var o=I(e.simulcast);if(void 0!==o&&(t.simulcast=o,!0===o&&e.simulcastRid&&(t.simulcastRid=e.simulcastRid)),e.enabledSignalingNotifyMetadata&&(t.signalingNotifyMetadata=Z(!0,e.signalingNotifyMetadata)),e.enabledBundleId&&(t.bundleId=e.bundleId),e.enabledClientId&&(t.clientId=e.clientId),e.enabledDataChannel){var s=I(e.dataChannelSignaling);void 0!==s&&(t.dataChannelSignaling=s);var c=I(e.ignoreDisconnectWebSocket);void 0!==c&&(t.ignoreDisconnectWebSocket=c)}if(""!==e.dataChannels){var u=[];try{u=JSON.parse(e.dataChannels)}catch(l){console.warn("Illegal format DataChannels")}Array.isArray(u)&&(t.dataChannels=u)}return t}var E=n(4839);function A(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return B(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return B(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function B(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function U(e,t){return V.apply(this,arguments)}function V(){return(V=(0,i.Z)(s().mark((function e(t,n){var a,r,i,o,l,d,f,p,m,h,g,v,x,b,I,Z,T,O,R,M,D,P,B,U,V,F,H,z,G,L,W;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a="MEDIA_CONSTRAINTS","getDisplayMedia"!==n.mediaType){e.next=16;break}if(n.video&&n.cameraDevice){e.next=4;break}return e.abrupt("return",[new MediaStream,null]);case 4:if(void 0!==navigator.mediaDevices){e.next=6;break}throw new Error("Failed to call getUserMedia. Make sure domain is secure");case 6:return r=k({frameRate:n.frameRate,resolution:n.resolution,aspectRatio:n.aspectRatio,resizeMode:n.resizeMode}),t(E.t.actions.setLogMessages({title:a,description:JSON.stringify(r)})),t(E.t.actions.setTimelineMessage(_("media-constraints",r))),e.next=11,navigator.mediaDevices.getDisplayMedia(r);case 11:i=e.sent,t(E.t.actions.setTimelineMessage(_("succeed-get-display-media"))),o=A(i.getVideoTracks());try{for(o.s();!(l=o.n()).done;)void 0!==(d=l.value).contentHint&&(d.contentHint=n.videoContentHint),d.enabled=n.videoTrack,t(E.t.actions.setTimelineMessage(J("start",d)))}catch(s){o.e(s)}finally{o.f()}return e.abrupt("return",[i,null]);case 16:if("fakeMedia"!==n.mediaType||!n.fakeContents.worker){e.next=28;break}f=S({audio:n.audio&&n.micDevice,video:n.video&&n.cameraDevice,frameRate:n.frameRate,resolution:n.resolution,volume:n.fakeVolume,aspectRatio:n.aspectRatio,resizeMode:n.resizeMode}),t(E.t.actions.setLogMessages({title:a,description:JSON.stringify(f)})),t(E.t.actions.setTimelineMessage(_("media-constraints",f))),p=N(f),m=p.canvas,h=p.mediaStream,g=p.gainNode,null!==m&&(n.fakeContents.worker.onmessage=function(e){var t=e.data;"update"===t.type&&w(m,n.fakeContents.colorCode,f.fontSize,t.counter.toString())},n.fakeContents.worker.postMessage({type:"stop"}),n.fakeContents.worker.postMessage({type:"start",interval:1e3/f.frameRate})),v=A(h.getVideoTracks());try{for(v.s();!(x=v.n()).done;)void 0!==(b=x.value).contentHint&&(b.contentHint=n.videoContentHint),b.enabled=n.videoTrack,t(E.t.actions.setTimelineMessage(J("start",b)))}catch(s){v.e(s)}finally{v.f()}I=A(h.getAudioTracks());try{for(I.s();!(Z=I.n()).done;)void 0!==(T=Z.value).contentHint&&(T.contentHint=n.audioContentHint),T.enabled=n.audioTrack,t(E.t.actions.setTimelineMessage(J("start",T)))}catch(s){I.e(s)}finally{I.f()}return t(E.t.actions.setTimelineMessage(_("succeed-create-fake-media"))),e.abrupt("return",[h,g]);case 28:if(void 0!==navigator.mediaDevices){e.next=30;break}throw new Error("Failed to call getUserMedia. Make sure domain is secure");case 30:if(O=new MediaStream,!(R=y({audio:n.audio&&n.micDevice,autoGainControl:n.autoGainControl,noiseSuppression:n.noiseSuppression,echoCancellation:n.echoCancellation,echoCancellationType:n.echoCancellationType,audioInput:n.audioInput}))){e.next=49;break}return t(E.t.actions.setLogMessages({title:a,description:JSON.stringify({audio:R})})),t(E.t.actions.setTimelineMessage(_("audio-media-constraints",{audio:R}))),e.next=37,navigator.mediaDevices.getUserMedia({audio:R});case 37:if(M=e.sent,D=M.getAudioTracks()[0],t(E.t.actions.setTimelineMessage(J("start",D))),!n.mediaProcessorsNoiseSuppression||!c.b.isSupported()){e.next=47;break}if(null!==n.noiseSuppressionProcessor){e.next=43;break}throw new Error("Failed to start NoiseSuppressionProcessor. NoiseSuppressionProcessor is 'null'");case 43:return n.noiseSuppressionProcessor.stopProcessing(),e.next=46,n.noiseSuppressionProcessor.startProcessing(D);case 46:D=e.sent;case 47:t(E.t.actions.setTimelineMessage(_("succeed-audio-get-user-media"))),O.addTrack(D);case 49:if(!(P=C({aspectRatio:n.aspectRatio,frameRate:n.frameRate,resizeMode:n.resizeMode,resolution:n.resolution,video:n.video&&n.cameraDevice,videoInput:n.videoInput}))){e.next=68;break}return t(E.t.actions.setLogMessages({title:a,description:JSON.stringify({video:P})})),t(E.t.actions.setTimelineMessage(_("video-media-constraints",{video:P}))),e.next=55,navigator.mediaDevices.getUserMedia({video:P});case 55:if(B=e.sent,U=B.getVideoTracks()[0],t(E.t.actions.setTimelineMessage(J("start",U))),""===n.blurRadius||!u.s.isSupported()){e.next=66;break}if(null!==n.virtualBackgroundProcessor){e.next=61;break}throw new Error("Failed to start VirtualBackgroundProcessor. VirtualBackgroundProcessor is 'null'");case 61:return V={blurRadius:j(n.blurRadius)},n.virtualBackgroundProcessor.stopProcessing(),e.next=65,n.virtualBackgroundProcessor.startProcessing(U,V);case 65:U=e.sent;case 66:t(E.t.actions.setTimelineMessage(_("succeed-video-get-user-media"))),O.addTrack(U);case 68:F=A(O.getVideoTracks());try{for(F.s();!(H=F.n()).done;)void 0!==(z=H.value).contentHint&&(z.contentHint=n.videoContentHint),z.enabled=n.videoTrack}catch(s){F.e(s)}finally{F.f()}G=A(O.getAudioTracks());try{for(G.s();!(L=G.n()).done;)void 0!==(W=L.value).contentHint&&(W.contentHint=n.audioContentHint),W.enabled=n.audioTrack}catch(s){G.e(s)}finally{G.f()}return e.abrupt("return",[O,null]);case 73:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(e,t,n){n.on("log",(function(t,n){e(E.t.actions.setLogMessages({title:t,description:JSON.stringify(n)}))})),n.on("notify",(function(t,n){"spotlight.focused"===t.event_type&&"string"===typeof t.connection_id&&e(E.t.actions.setFocusedSpotlightConnectionId(t.connection_id)),"spotlight.unfocused"===t.event_type&&"string"===typeof t.connection_id&&e(E.t.actions.setUnFocusedSpotlightConnectionId(t.connection_id)),"connection.destroyed"===t.event_type&&"string"===typeof t.connection_id&&e(E.t.actions.deleteFocusedSpotlightConnectionId(t.connection_id)),e(E.t.actions.setNotifyMessages({timestamp:(new Date).getTime(),message:t,transportType:n}))})),n.on("push",(function(t,n){e(E.t.actions.setPushMessages({timestamp:(new Date).getTime(),message:t,transportType:n}))})),n.on("track",(function(n){if(e(E.t.actions.setTimelineMessage(_("event-on-track"))),!t().soraContents.remoteMediaStreams.find((function(e){return e.id===n.streams[0].id}))){var a,r=A(n.streams[0].getTracks());try{for(r.s();!(a=r.n()).done;){var i=a.value;e(E.t.actions.setTimelineMessage(_("remote-".concat(i.kind,"-mediastream-track"),D(i))))}}catch(o){r.e(o)}finally{r.f()}e(E.t.actions.setRemoteMediaStream(n.streams[0]))}})),n.on("removetrack",(function(n){e(E.t.actions.setTimelineMessage(_("event-on-removetrack"))),t().soraContents.remoteMediaStreams.find((function(e){if(null!==n&&void 0!==n&&n.target)return e.id===n.target.id}))&&e(E.t.actions.removeRemoteMediaStream(n.target.id))})),n.on("disconnect",(function(n){var a={type:n.type,title:n.title};void 0!==n.code&&(a.code=n.code),void 0!==n.reason&&(a.reason=n.reason),void 0!==n.params&&(a.params=n.params),e(E.t.actions.setTimelineMessage(_("event-on-disconnect",a)));var r=t(),i=r.fakeContents,o=r.soraContents,s=r.reconnect,c=r.noiseSuppressionProcessor,u=r.virtualBackgroundProcessor,l=o.localMediaStream,d=o.remoteMediaStreams;if(u&&u.isProcessing()){var f=u.getOriginalTrack();f&&(f.stop(),e(E.t.actions.setTimelineMessage(J("stop",f)))),u.stopProcessing()}else l&&l.getVideoTracks().forEach((function(t){t.stop(),e(E.t.actions.setTimelineMessage(J("stop",t)))}));if(c&&c.isProcessing()){var p=c.getOriginalTrack();p&&(p.stop(),e(E.t.actions.setTimelineMessage(J("stop",p)))),c.stopProcessing()}else l&&l.getAudioTracks().forEach((function(t){t.stop(),e(E.t.actions.setTimelineMessage(J("stop",t)))}));d.forEach((function(e){e.getTracks().forEach((function(e){e.stop()}))})),i.worker&&i.worker.postMessage({type:"stop"}),e(E.t.actions.setSora(null)),e(E.t.actions.setSoraConnectionStatus("disconnected")),e(E.t.actions.setLocalMediaStream(null)),e(E.t.actions.removeAllRemoteMediaStreams()),e(E.t.actions.setSoraInfoAlertMessage("Disconnect Sora.")),e(E.t.actions.setTimelineMessage(_("disconnected"))),"abend"===n.type&&s&&e(E.t.actions.setSoraReconnecting(!0))})),n.on("timeline",(function(t){var n={timestamp:(new Date).getTime(),type:t.type,data:t.data,dataChannelId:t.dataChannelId,dataChannelLabel:t.dataChannelLabel,logType:t.logType};e(E.t.actions.setTimelineMessage(n)),t.data&&"object"===typeof t.data&&"sdp"in t.data&&e(E.t.actions.setTimelineMessage(_("".concat(t.type,"-sdp"),t.data.sdp)))})),n.on("signaling",(function(t){var n={timestamp:(new Date).getTime(),transportType:t.transportType,type:t.type,data:t.data};e(E.t.actions.setSignalingMessage(n))})),n.on("message",(function(t){e(E.t.actions.setDataChannelMessage({timestamp:(new Date).getTime(),label:t.label,data:t.data}))})),n.on("datachannel",(function(t){e(E.t.actions.setSoraDataChannels(t.datachannel))}))}function H(e){return{audio:e.audio,audioBitRate:e.audioBitRate,audioCodecType:e.audioCodecType,bundleId:e.bundleId,clientId:e.clientId,dataChannels:e.enabledDataChannels?e.dataChannels:"",dataChannelSignaling:e.dataChannelSignaling,e2ee:e.e2ee,enabledBundleId:e.enabledBundleId,enabledClientId:e.enabledClientId,enabledDataChannel:e.enabledDataChannel,enabledSignalingNotifyMetadata:e.enabledSignalingNotifyMetadata,ignoreDisconnectWebSocket:e.ignoreDisconnectWebSocket,multistream:e.multistream,signalingNotifyMetadata:e.signalingNotifyMetadata,simulcast:e.simulcast,simulcastRid:e.simulcastRid,spotlight:e.spotlight,spotlightFocusRid:e.spotlightFocusRid,spotlightNumber:e.spotlightNumber,spotlightUnfocusRid:e.spotlightUnfocusRid,video:e.video,videoBitRate:e.videoBitRate,videoCodecType:e.videoCodecType}}function _(e,t){return{type:e,logType:"sora-devtools",timestamp:(new Date).getTime(),data:t}}function J(e,t){var n=D(t);return _("".concat(e,"-").concat(t.kind,"-mediastream-track"),n)}function z(e,t){return G.apply(this,arguments)}function G(){return(G=(0,i.Z)(s().mark((function e(t,n){var a,r,i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.pc||"closed"===(null===(a=n.pc)||void 0===a?void 0:a.iceConnectionState)){e.next=7;break}return e.next=3,n.pc.getStats();case 3:r=e.sent,i=[],r.forEach((function(e){i.push(e)})),t(E.t.actions.setStatsReport(i));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var L=function(){return function(){var e=(0,i.Z)(s().mark((function e(t,n){var a,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n(),!(r=a.soraContents).sora){e.next=6;break}return t(E.t.actions.setSoraConnectionStatus("disconnecting")),e.next=5,r.sora.disconnect();case 5:t(E.t.actions.setSoraConnectionStatus("disconnected"));case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},W=function(){return function(){var e=(0,i.Z)(s().mark((function e(t,n){var a,r,i,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O();case 2:a=e.sent,r=[],i=[],o=[],a.forEach((function(e){""!==e.deviceId&&("audioinput"===e.kind?r.push(e.toJSON()):"audiooutput"===e.kind?o.push(e.toJSON()):"videoinput"===e.kind&&i.push(e.toJSON()))})),t(E.t.actions.setAudioInputDevices(r)),t(E.t.actions.setVideoInputDevices(i)),t(E.t.actions.setAudioOutputDevices(o));case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},K=function(){return function(){var e=(0,i.Z)(s().mark((function e(t,n){var a,i,o,c,u,l,d;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((a=n()).soraContents.sora){e.next=3;break}return e.abrupt("return");case 3:return a.virtualBackgroundProcessor&&a.virtualBackgroundProcessor.isProcessing()?((i=a.virtualBackgroundProcessor.getOriginalTrack())&&(i.stop(),t(E.t.actions.setTimelineMessage(J("stop",i)))),a.virtualBackgroundProcessor.stopProcessing()):a.soraContents.localMediaStream&&a.soraContents.localMediaStream.getVideoTracks().forEach((function(e){e.stop(),t(E.t.actions.setTimelineMessage(J("stop",e)))})),a.noiseSuppressionProcessor&&a.noiseSuppressionProcessor.isProcessing()?((o=a.noiseSuppressionProcessor.getOriginalTrack())&&(o.stop(),t(E.t.actions.setTimelineMessage(J("stop",o)))),a.noiseSuppressionProcessor.stopProcessing()):a.soraContents.localMediaStream&&a.soraContents.localMediaStream.getAudioTracks().forEach((function(e){e.stop(),t(E.t.actions.setTimelineMessage(J("stop",e)))})),e.next=7,U(t,a).catch((function(e){throw t(E.t.actions.setSoraErrorAlertMessage(e.toString())),t(E.t.actions.setSoraConnectionStatus("disconnected")),e}));case 7:c=e.sent,u=(0,r.Z)(c,2),l=u[0],d=u[1],l.getTracks().forEach((function(e){if(a.soraContents.sora&&a.soraContents.sora.pc){var t=a.soraContents.sora.pc.getSenders().find((function(t){return!!t.track&&t.track.kind===e.kind}));t&&t.replaceTrack(e)}})),t(E.t.actions.setLocalMediaStream(l)),t(E.t.actions.setFakeContentsGainNode(d));case 14:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},q=E.t.actions,X=q.clearDataChannelMessages,Q=q.deleteAlertMessage,Y=q.setAPIErrorAlertMessage,$=q.setAPIInfoAlertMessage,ee=q.setAspectRatio,te=q.setAudio,ne=q.setAudioBitRate,ae=q.setAudioCodecType,re=q.setAudioContentHint,ie=q.setAudioInput,oe=q.setAudioOutput,se=q.setAudioTrack,ce=q.setAutoGainControl,ue=q.setBlurRadius,le=q.setBundleId,de=q.setChannelId,fe=q.setClientId,pe=q.setDataChannels,me=q.setDataChannelSignaling,he=q.setDebug,ge=q.setDebugFilterText,ve=q.setDebugType,xe=q.setDisplayResolution,be=q.setEchoCancellation,je=q.setEchoCancellationType,ye=q.setEnabledBundleId,Ce=q.setEnabledClientId,Se=q.setEnabledDataChannels,ke=q.setEnabledDataChannel,Ne=q.setEnabledMetadata,we=q.setEnabledSignalingNotifyMetadata,Ie=q.setEnabledSignalingUrlCandidates,Ze=q.setFakeVolume,Te=q.setFrameRate,Oe=q.setIgnoreDisconnectWebSocket,Re=(q.setLocalMediaStream,q.setLogMessages,q.setMediaProcessorsNoiseSuppression),Me=q.setMediaType,De=q.setMetadata,Pe=q.setMultistream,Ee=q.setNoiseSuppression,Ae=(q.setNotifyMessages,q.setReconnect),Be=q.setResizeMode,Ue=q.setRole,Ve=q.setResolution,Fe=q.setSignalingNotifyMetadata,He=q.setSignalingUrlCandidates,_e=q.setSimulcast,Je=q.setSimulcastRid,ze=(q.setSora,q.setSoraReconnecting),Ge=(q.setSoraErrorAlertMessage,q.setSoraInfoAlertMessage,q.setSpotlight),Le=q.setSpotlightFocusRid,We=q.setSpotlightNumber,Ke=q.setSpotlightUnfocusRid,qe=q.setVideo,Xe=q.setVideoBitRate,Qe=q.setVideoCodecType,Ye=q.setVideoContentHint,$e=q.setVideoInput,et=q.setVideoTrack,tt=n(9473),nt=function(){return(0,tt.I0)()},at=tt.v9,rt=n(5509),it=n(3192),ot=n(9499),st=n(6518),ct=n(5893),ut=function(){return(0,ct.jsxs)("svg",{width:"1em",height:"1em",viewBox:"0 0 16 16",className:"bi bi-clipboard",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:[(0,ct.jsx)("path",{fillRule:"evenodd",d:"M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"}),(0,ct.jsx)("path",{fillRule:"evenodd",d:"M9.5 1h-3a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"})]})},lt=function(e){return e.disabled?(0,ct.jsx)("div",{style:{height:"31px"}}):(0,ct.jsx)("button",{className:"btn btn-sm btn-dark",onClick:function(t){m(e.text),t.currentTarget.blur()},children:(0,ct.jsx)(ut,{})})},dt=function(e){var t=e.description;return void 0===t?null:"object"!==typeof t?(0,ct.jsx)("div",{className:"debug-message",children:(0,ct.jsx)("div",{className:"col-sm-12",children:(0,ct.jsx)("pre",{className:e.wordBreak?"word-break":"",children:t})})}):(0,ct.jsx)("div",{className:"debug-message",children:(0,ct.jsx)("div",{className:"col-sm-12",children:(0,ct.jsx)("pre",{className:e.wordBreak?"word-break":"",children:JSON.stringify(t,null,2)})})})},ft=function(e){var t=e.defaultShow,n=e.description,r=e.title,i=e.timestamp,o=e.label,s=(0,a.useState)(void 0!==t&&t),c=s[0],u=s[1],l=i?r+i:r,d=void 0===n;return(0,ct.jsxs)("div",{className:"border border-light rounded mb-1 bg-dark","data-title":r,children:[(0,ct.jsxs)("div",{className:"d-flex justify-content-between align-items-center text-break",children:[(0,ct.jsxs)("a",{className:"debug-title ".concat(d?"disabled":""),onClick:function(){return u(!c)},"aria-controls":l,"aria-expanded":c,children:[(0,ct.jsx)("i",{className:"".concat(c?"arrow-bottom":"arrow-right"," ").concat(d?"disabled":"")})," ",i?(0,ct.jsxs)("span",{className:"text-white-50 me-1",children:["[",p(i),"]"]}):null,o,(0,ct.jsx)("span",{children:r})]}),(0,ct.jsx)("div",{className:"border-left",children:(0,ct.jsx)(lt,{text:"string"===typeof n?n:JSON.stringify(n,null,2),disabled:d})})]}),(0,ct.jsx)(st.Z,{in:c,children:(0,ct.jsx)("div",{className:"border-top",children:(0,ct.jsx)(dt,{description:n,wordBreak:e.wordBreak})})})]})};function pt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function mt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pt(Object(n),!0).forEach((function(t){(0,ot.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ht=function(){var e=nt();return(0,ct.jsx)("input",{className:"btn btn-secondary",type:"button",name:"clear",defaultValue:"clear",onClick:function(){e(X())}})},gt=function(e){var t=e.data,n=e.label,a=e.timestamp;if("ZAKURO"===(new TextDecoder).decode(t.slice(0,6))){var r=(new TextDecoder).decode(t.slice(22,48)),i=new DataView(t),o=i.getBigInt64(6),s=i.getBigInt64(14),c=t.byteLength,u="connectionId: ".concat(r,"\nUnixTimeMicro: ").concat(o,"\nCounter: ").concat(s,"\nByteLength: ").concat(c);return(0,ct.jsx)(ft,{title:n+" ZAKURO",timestamp:a,description:u,defaultShow:!0,wordBreak:!0})}var l=new Uint8Array(t).toString()+"\n(".concat((new TextDecoder).decode(t),")");return(0,ct.jsx)(ft,{title:n,timestamp:a,description:l,defaultShow:!0,wordBreak:!0})},vt=a.memo((function(e){return(0,ct.jsx)(gt,mt({},e))})),xt=function(){var e=at((function(e){return e.dataChannelMessages}));return(0,ct.jsxs)(ct.Fragment,{children:[(0,ct.jsx)("div",{className:"py-1",children:(0,ct.jsx)(ht,{})}),(0,ct.jsx)("div",{className:"debug-messages",children:e.map((function(e){var t=e.label+e.timestamp;return(0,ct.jsx)(vt,mt({},e),t)}))})]})},bt=n(6986),jt=n(1341),yt=n(4716),Ct=function(){var e=at((function(e){return e.debugFilterText})),t=nt();return(0,ct.jsxs)(bt.Z,{className:"form-inline debug-filter",controlId:"channelId",children:[(0,ct.jsx)(jt.Z,{className:"text-white",children:"Filter:"}),(0,ct.jsx)(yt.Z,{type:"text",placeholder:"Filter",value:e,onChange:function(e){t(ge(e.target.value))},autoComplete:"off"})]})};function St(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function kt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?St(Object(n),!0).forEach((function(t){(0,ot.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):St(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Nt=function(e){var t=e.message,n=e.timestamp;return(0,ct.jsx)(ft,{title:t.title,timestamp:n,description:JSON.parse(t.description)})},wt=a.memo((function(e){return(0,ct.jsx)(Nt,kt({},e))})),It=function(){var e=at((function(e){return e.logMessages})),t=at((function(e){return e.debugFilterText})),n=e.filter((function(e){return t.split(" ").every((function(t){return""===t||0<=JSON.stringify(e).indexOf(t)}))}));return(0,ct.jsx)("div",{className:"debug-messages",children:n.map((function(e,t){return(0,ct.jsx)(wt,kt({},e),e.message.title+String(t)+e.timestamp)}))})};function Zt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}var Tt={websocket:"#00ff00",datachannel:"#ff00ff"},Ot=function(e){var t=e.text,n=Object.keys(Tt).includes(t)?Tt[t]:void 0;return(0,ct.jsxs)("span",{className:"me-1",style:n?{color:n}:{},children:["[",t,"]"]})},Rt=function(e){var t=e.notify,n=t.transportType?(0,ct.jsx)(Ot,{text:t.transportType}):null;return(0,ct.jsx)(ft,{title:t.message.event_type,timestamp:t.timestamp,description:t.message,label:n})},Mt=a.memo((function(e){return(0,ct.jsx)(Rt,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Zt(Object(n),!0).forEach((function(t){(0,ot.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e))})),Dt=function(){var e=at((function(e){return e.notifyMessages})),t=at((function(e){return e.debugFilterText})),n=e.filter((function(e){return t.split(" ").every((function(t){return""===t||0<=JSON.stringify(e).indexOf(t)}))}));return(0,ct.jsx)("div",{className:"debug-messages",children:n.map((function(e){return(0,ct.jsx)(Mt,{notify:e},e.message.type+e.timestamp)}))})};function Pt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}var Et={websocket:"#00ff00",datachannel:"#ff00ff"},At=function(e){var t=e.text,n=Object.keys(Et).includes(t)?Et[t]:void 0;return(0,ct.jsxs)("span",{style:n?{color:n}:{},children:["[",t,"]"]})},Bt=function(e){var t=e.push,n=t.transportType?(0,ct.jsx)(At,{text:t.transportType}):null;return(0,ct.jsx)(ft,{title:t.message.type,timestamp:t.timestamp,description:t.message,label:n})},Ut=a.memo((function(e){return(0,ct.jsx)(Bt,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pt(Object(n),!0).forEach((function(t){(0,ot.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e))})),Vt=function(){var e=at((function(e){return e.pushMessages})),t=at((function(e){return e.debugFilterText})),n=e.filter((function(e){return t.split(" ").every((function(t){return""===t||0<=JSON.stringify(e).indexOf(t)}))}));return(0,ct.jsx)("div",{className:"debug-messages",children:n.map((function(e,t){var n="".concat(e.timestamp,"-").concat(t);return(0,ct.jsx)(Ut,{ariaControls:n,push:e},n)}))})},Ft=n(469),Ht=n(5005),_t=function(){var e=(0,a.useRef)(null),t=(0,a.useRef)(null),n=at((function(e){return e.soraContents.sora})),r=at((function(e){return e.soraContents.datachannels}));return(0,ct.jsxs)(ct.Fragment,{children:[(0,ct.jsxs)("div",{className:"d-flex mt-2",children:[(0,ct.jsx)(bt.Z,{className:"me-1",controlId:"sendDataChannelMessageLabel",children:(0,ct.jsx)(Ft.Z,{name:"sendDataChannelMessageLabel",ref:e,children:r.map((function(e){return(0,ct.jsx)("option",{value:e.label,children:e.label},e.label)}))})}),(0,ct.jsx)(bt.Z,{className:"flex-grow-1 me-1",controlId:"sendDataChannelMessage",children:(0,ct.jsx)(yt.Z,{className:"flex-fill",placeholder:"sendDataChannelMessage\u3092\u6307\u5b9a",type:"text",ref:t})}),(0,ct.jsx)(Ht.Z,{variant:"secondary",onClick:function(){if(null!==e.current&&null!==t.current){var a=e.current.value;n&&n.sendMessage(a,(new TextEncoder).encode(t.current.value))}},disabled:0===r.length,children:"send"})]}),0<r.length?(0,ct.jsx)("pre",{className:"form-control mt-2",style:{color:"#fff",backgroundColor:"#222222",maxHeight:"250px",minHeight:"250px"},children:JSON.stringify(r,null,2)}):null]})};function Jt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function zt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Jt(Object(n),!0).forEach((function(t){(0,ot.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Jt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Gt={websocket:"#00ff00",datachannel:"#ff00ff"},Lt=function(e){var t=e.text,n=Object.keys(Gt).includes(t)?Gt[t]:void 0;return(0,ct.jsxs)("span",{className:"me-1",style:n?{color:n}:{},children:["[",t,"]"]})},Wt=function(e){var t=e.data,n=e.type,a=e.timestamp,r=e.transportType,i=r?(0,ct.jsx)(Lt,{text:r}):null;return(0,ct.jsx)(ft,{title:n,timestamp:a,description:t,label:i})},Kt=a.memo((function(e){return(0,ct.jsx)(Wt,zt({},e))})),qt=function(){var e=at((function(e){return e.signalingMessages})),t=at((function(e){return e.debugFilterText})),n=e.filter((function(e){return t.split(" ").every((function(t){return""===t||0<=JSON.stringify(e).indexOf(t)}))}));return(0,ct.jsx)("div",{className:"debug-messages",children:n.map((function(e){var t=e.type+e.timestamp;return(0,ct.jsx)(Kt,zt({},e),t)}))})};function Xt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Qt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xt(Object(n),!0).forEach((function(t){(0,ot.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Yt=function(e){return(0,ct.jsx)(ft,{title:"".concat(e.id,"(").concat(e.type,")"),timestamp:null,description:e})},$t=a.memo((function(e){return(0,ct.jsx)(Yt,Qt({},e))})),en=function(){var e=at((function(e){return e.soraContents.statsReport})),t=at((function(e){return e.debugFilterText})),n=e.filter((function(e){return t.split(" ").every((function(t){return""===t||0<=JSON.stringify(e).indexOf(t)}))}));return(0,ct.jsx)("div",{className:"debug-messages",children:n.map((function(e){return(0,ct.jsx)($t,Qt({},e),e.id)}))})};function tn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function nn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tn(Object(n),!0).forEach((function(t){(0,ot.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var an={signaling:"#ff00ff",notify:"#ffff00",push:"#98fb98",e2ee:"#00ffff",stats:"#ffc0cb"},rn=function(){return(0,ct.jsx)("span",{className:"me-1",style:{color:"#00ff00"},children:"[websocket]"})},on=function(){return(0,ct.jsx)("span",{className:"me-1",style:{color:"#ff8c00"},children:"[peerconnection]"})},sn=function(){return(0,ct.jsx)("span",{className:"me-1",style:{color:"#bce2e8"},children:"[sora]"})},cn=function(){return(0,ct.jsx)("span",{className:"me-1",style:{color:"#73b8e2"},children:"[sora-devtools]"})},un=function(e){var t=e.label,n=e.id,a=t&&Object.keys(an).includes(t)?an[t]:void 0;return(0,ct.jsxs)("span",{className:"me-1",style:a?{color:a}:{},children:["[datachannel]",t?"[".concat(t,"]"):"","number"===typeof n?"[".concat(n,"]"):""]})},ln=function(e){var t,n=e.timestamp,a=e.logType,r=e.dataChannelId,i=e.dataChannelLabel,o=e.type,s=e.data,c="".concat(o);return"websocket"===a?t=(0,ct.jsx)(rn,{}):"datachannel"===a?t=(0,ct.jsx)(un,{id:r,label:i}):"peerconnection"===a?t=(0,ct.jsx)(on,{}):"sora"===a?t=(0,ct.jsx)(sn,{}):"sora-devtools"===a&&(t=(0,ct.jsx)(cn,{})),(0,ct.jsx)(ft,{title:c,timestamp:n,description:s,label:t})},dn=a.memo((function(e){return(0,ct.jsx)(ln,nn({},e))})),fn=function(){var e=at((function(e){return e.timelineMessages})),t=at((function(e){return e.debugFilterText})),n=e.filter((function(e){return t.split(" ").every((function(t){return""===t||0<=JSON.stringify(e).indexOf(t)}))}));return(0,ct.jsx)("div",{className:"debug-messages",children:n.map((function(e){var t="".concat(e.timestamp,"-").concat(e.type);return e.dataChannelLabel&&(t+="-".concat(e.dataChannelLabel)),(0,ct.jsx)(dn,nn({},e),t)}))})},pn=function(){var e=at((function(e){return e.debug})),t=at((function(e){return e.debugType})),n=nt();if(!e)return null;return(0,ct.jsx)("div",{className:"col-debug col-6",children:(0,ct.jsxs)(rt.Z,{id:"debug-tab",activeKey:t,defaultActiveKey:"timeline",onSelect:function(e){"log"!==e&&"notify"!==e&&"push"!==e&&"stats"!==e&&"timeline"!==e&&"signaling"!==e&&"messaging"!==e||n(ve(e))},children:[(0,ct.jsxs)(it.Z,{eventKey:"timeline",title:"Timeline",children:[(0,ct.jsx)(Ct,{}),(0,ct.jsx)(fn,{})]}),(0,ct.jsxs)(it.Z,{eventKey:"signaling",title:"Signaling",children:[(0,ct.jsx)(Ct,{}),(0,ct.jsx)(qt,{})]}),(0,ct.jsxs)(it.Z,{eventKey:"notify",title:"Notfiy",children:[(0,ct.jsx)(Ct,{}),(0,ct.jsx)(Dt,{})]}),(0,ct.jsxs)(it.Z,{eventKey:"push",title:"Push",children:[(0,ct.jsx)(Ct,{}),(0,ct.jsx)(Vt,{})]}),(0,ct.jsxs)(it.Z,{eventKey:"stats",title:"Stats",children:[(0,ct.jsx)(Ct,{}),(0,ct.jsx)(en,{})]}),(0,ct.jsxs)(it.Z,{eventKey:"log",title:"Log",children:[(0,ct.jsx)(Ct,{}),(0,ct.jsx)(It,{})]}),(0,ct.jsxs)(it.Z,{eventKey:"messaging",title:"Messaging",children:[(0,ct.jsx)(_t,{}),(0,ct.jsx)(xt,{})]})]})})},mn=n(1608),hn=n(1555),gn=n(8331);function vn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}var xn=function(){var e=nt(),t=at((function(e){return e.soraContents.reconnectingTrials}));return(0,a.useEffect)((function(){e(function(){var e=(0,i.Z)(s().mark((function e(t,n){var a,o,c,u,d,f,p,m,h,g,x,b,j,y;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t(E.t.actions.setTimelineMessage(_("start-reconnect"))),t(E.t.actions.setSoraConnectionStatus("connecting")),!(a=n()).soraContents.sora){e.next=6;break}return e.next=6,a.soraContents.sora.disconnect();case 6:if(o=v(a.enabledSignalingUrlCandidates,a.signalingUrlCandidates),t(E.t.actions.setLogMessages({title:"SIGNALING_URL",description:JSON.stringify(o)})),c=l.Z.connection(o,a.debug),u=H(a),d=P(u),f=Z(a.enabledMetadata,a.metadata),"sendonly"!==a.role&&"sendrecv"!==a.role){e.next=19;break}return e.next=15,U(t,a).catch((function(e){throw t(E.t.actions.setSoraErrorAlertMessage(e.toString())),t(E.t.actions.setSoraConnectionStatus("disconnected")),e}));case 15:g=e.sent,x=(0,r.Z)(g,2),m=x[0],h=x[1];case 19:b=s().mark((function e(r){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!1!==n().soraContents.reconnecting){e.next=3;break}return e.abrupt("return","break");case 3:if(t(E.t.actions.setSoraReconnectingTrials(r)),e.prev=4,"sendonly"!==a.role){e.next=15;break}if((p=c.sendonly(a.channelId,null,d)).metadata=f,"boolean"===typeof a.googCpuOveruseDetection&&(p.constraints={optional:[{googCpuOveruseDetection:a.googCpuOveruseDetection}]}),F(t,n,p),!m){e.next=13;break}return e.next=13,p.connect(m);case 13:e.next=31;break;case 15:if("sendrecv"!==a.role){e.next=25;break}if((p=c.sendrecv(a.channelId,null,d)).metadata=f,"boolean"===typeof a.googCpuOveruseDetection&&(p.constraints={optional:[{googCpuOveruseDetection:a.googCpuOveruseDetection}]}),F(t,n,p),!m){e.next=23;break}return e.next=23,p.connect(m);case 23:e.next=31;break;case 25:if("recvonly"!==a.role){e.next=31;break}return(p=c.recvonly(a.channelId,null,d)).metadata=f,F(t,n,p),e.next=31,p.connect();case 31:e.next=37;break;case 33:e.prev=33,e.t0=e.catch(4),e.t0 instanceof Error&&t(E.t.actions.setSoraErrorAlertMessage("(trials ".concat(r,") Failed to connect Sora. ").concat(e.t0.message))),p=void 0;case 37:if(void 0===p){e.next=39;break}return e.abrupt("return","break");case 39:return e.next=41,new Promise((function(e){return setTimeout(e,500*r+500)}));case 41:case"end":return e.stop()}}),e,null,[[4,33]])})),j=1;case 21:if(!(j<=10)){e.next=29;break}return e.delegateYield(b(j),"t0",23);case 23:if("break"!==e.t0){e.next=26;break}return e.abrupt("break",29);case 26:j++,e.next=21;break;case 29:if(void 0!==p){e.next=34;break}return t(E.t.actions.setSoraErrorAlertMessage("Failed to reconnect Sora.")),t(E.t.actions.setSoraConnectionStatus("disconnected")),t(E.t.actions.setSoraReconnecting(!1)),e.abrupt("return");case 34:return t(E.t.actions.setSoraInfoAlertMessage("Succeeded to reconnect Sora.")),e.next=37,z(t,p);case 37:y=setInterval((0,i.Z)(s().mark((function e(){var a,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n(),!(r=a.soraContents).sora){e.next=6;break}return e.next=4,z(t,r.sora);case 4:e.next=7;break;case 6:clearInterval(y);case 7:case"end":return e.stop()}}),e)}))),1e3),t(E.t.actions.setSora(p)),m&&t(E.t.actions.setLocalMediaStream(m)),h&&t(E.t.actions.setFakeContentsGainNode(h)),t(E.t.actions.setSoraConnectionStatus("connected")),t(E.t.actions.setTimelineMessage(_("connected"))),t(E.t.actions.setSoraReconnecting(!1));case 44:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}),[]),(0,ct.jsxs)(gn.Z,{delay:2e4,onClose:function(){e(ze(!1))},children:[(0,ct.jsx)(gn.Z.Header,{className:"bg-warning text-white",children:(0,ct.jsx)("strong",{className:"me-auto",children:"Reconnect"})}),(0,ct.jsx)(gn.Z.Body,{className:"bg-light",children:(0,ct.jsxs)("p",{className:"text-break font-weight-bold mb-0",children:["Reconnecting... (trials ",t,")"]})})]})},bn=function(e){var t=nt(),n="error"===e.type?"bg-danger":"bg-info";return(0,ct.jsxs)(gn.Z,{autohide:!0,delay:2e4,onClose:function(){t(Q(e.timestamp))},children:[(0,ct.jsxs)(gn.Z.Header,{className:"".concat(n," text-white"),children:[(0,ct.jsx)("strong",{className:"me-auto",children:e.title}),(0,ct.jsx)("span",{children:p(e.timestamp)})]}),(0,ct.jsx)(gn.Z.Body,{className:"bg-light",children:(0,ct.jsx)("p",{className:"text-break font-weight-bold mb-0",children:e.message})})]})},jn=function(){var e=at((function(e){return e.alertMessages})),t=at((function(e){return e.soraContents.reconnecting}));return(0,ct.jsxs)("div",{className:"alert-messages",children:[t?(0,ct.jsx)(xn,{}):null,e.map((function(e){return(0,ct.jsx)(bn,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vn(Object(n),!0).forEach((function(t){(0,ot.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e),e.timestamp)}))]})},yn=function(e){return(0,ct.jsxs)("div",{className:"d-flex align-items-center border border-secondary rounded mx-1",children:[(0,ct.jsx)("p",{id:e.id,className:"mx-2 p-1",children:e.text}),(0,ct.jsx)("div",{className:"border-left border-secondary",children:(0,ct.jsx)("button",{className:"btn btn-sm btn-light",onClick:function(t){m(e.text),t.currentTarget.blur()},children:(0,ct.jsx)(ut,{})})})]})},Cn=function(e){var t=e.localVideo,n=e.connectionId,a=e.clientId;return(0,ct.jsxs)(ct.Fragment,{children:[n?(0,ct.jsx)(yn,{id:t?"local-video-connection-id":void 0,text:n}):null,null!==a&&void 0!==a&&n!==a?(0,ct.jsx)(yn,{id:t?"local-video-client-id":void 0,text:a}):null]})};function Sn(e,t,n,a){return kn.apply(this,arguments)}function kn(){return(kn=(0,i.Z)(s().mark((function e(t,n,a,r){var i,o,c,u,l,d,f,p;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=window.location.protocol,o="https:"==i?"443":"3000",c="https:"==i?"api":"",u="".concat(i,"//").concat(window.location.hostname,":").concat(o,"/").concat(c),null!==t&&(u=t),l="Sora_".concat(n,".").concat(a),e.next=8,fetch(u,{method:"POST",body:JSON.stringify(r),headers:{Accept:"application/json","Content-Type":"application/json","x-sora-target":l},mode:"cors"});case 8:return d=e.sent,e.next=11,d.json();case 11:if(f=e.sent,d.ok){e.next=17;break}throw p="POST ".concat(u," ").concat(d.status," (").concat(d.statusText,") target:").concat(l),f.error_type&&(p+=" error_type: ".concat(f.error_type)),new Error(p);case 17:return e.abrupt("return",f);case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Nn(e,t){return Sn(e,"20161101","StartRecording",{channel_id:t,expire_time:3600})}function wn(e,t){return Sn(e,"20161101","StopRecording",{channel_id:t})}function In(e,t,n,a,r){var i={channel_id:t,recv_connection_id:n,rid:a};return r&&(i.send_connection_id=r),Sn(e,"20201005","RequestRtpStream",i)}function Zn(e,t,n,a){var r={channel_id:t,recv_connection_id:n};return a&&(r.send_connection_id=a),Sn(e,"20201005","ResetRtpStream",r)}function Tn(e,t,n,a,r,i){var o={channel_id:t,recv_connection_id:n,spotlight_focus_rid:a,spotlight_unfocus_rid:r};return i&&(o.send_connection_id=i),Sn(e,"20211215","RequestSpotlightRid",o)}function On(e,t,n,a){var r={channel_id:t,recv_connection_id:n};return a&&(r.send_connection_id=a),Sn(e,"20211215","ResetSpotlightRid",r)}var Rn=function(e){var t=at((function(e){return e.soraContents.sora})),n=at((function(e){return e.apiUrl})),a=at((function(e){return e.channelId})),r=nt(),o=function(){var o=(0,i.Z)(s().mark((function i(){var o;return s().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(null!==t&&void 0!==t&&t.connectionId){i.next=2;break}return i.abrupt("return");case 2:return i.prev=2,i.next=5,In(n,a,t.connectionId,e.rid);case 5:o=i.sent,r($("POST successed. response: ".concat(JSON.stringify(o)))),i.next=12;break;case 9:i.prev=9,i.t0=i.catch(2),i.t0 instanceof Error&&r(Y(i.t0.message));case 12:case"end":return i.stop()}}),i,null,[[2,9]])})));return function(){return o.apply(this,arguments)}}();return(0,ct.jsx)("div",{className:"mx-1",children:(0,ct.jsx)("input",{className:"btn btn-secondary",type:"button",name:"requestSimulcastRidTo".concat(e.rid.charAt(0).toUpperCase()+e.rid.slice(1)),defaultValue:"".concat(e.rid," rid"),onClick:o})})},Mn=function(){var e=(0,a.useRef)(null),t=(0,a.useRef)(null),n=at((function(e){return e.soraContents.sora})),r=at((function(e){return e.channelId})),o=at((function(e){return e.apiUrl})),c=nt();if(null===n||void 0===n||!n.connectionId)return null;var u=function(){var a=(0,i.Z)(s().mark((function a(){var i,u,l;return s().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(null!==n&&void 0!==n&&n.connectionId){a.next=2;break}return a.abrupt("return");case 2:if(null!==e.current&&null!==t.current){a.next=4;break}return a.abrupt("return");case 4:return i=e.current.value,u=t.current.value,a.prev=6,a.next=9,Tn(o,r,n.connectionId,i,u);case 9:l=a.sent,c($("POST successed. response: ".concat(JSON.stringify(l)))),a.next=16;break;case 13:a.prev=13,a.t0=a.catch(6),a.t0 instanceof Error&&c(Y(a.t0.message));case 16:case"end":return a.stop()}}),a,null,[[6,13]])})));return function(){return a.apply(this,arguments)}}();return(0,ct.jsx)("div",{className:"mx-1",children:(0,ct.jsxs)(bt.Z,{className:"form-inline",children:[(0,ct.jsx)(Ft.Z,{ref:e,children:f.I7.map((function(e){return""===e?null:(0,ct.jsxs)("option",{value:e,children:["SpotlightFocusRid: ",e]},e)}))}),(0,ct.jsx)(Ft.Z,{ref:t,children:f.I7.map((function(e){return""===e?null:(0,ct.jsxs)("option",{value:e,children:["SpotlightUnfocusRid: ",e,"\xa0\xa0\xa0"]},e)}))}),(0,ct.jsx)("input",{className:"btn btn-secondary",type:"button",name:"requestSpotlightRid",defaultValue:"requestSpotlightRid",onClick:u})]})})},Dn=function(){var e=at((function(e){return e.soraContents.sora})),t=at((function(e){return e.channelId})),n=at((function(e){return e.apiUrl})),a=nt(),r=function(){var r=(0,i.Z)(s().mark((function r(){var i;return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(null!==e&&void 0!==e&&e.connectionId){r.next=2;break}return r.abrupt("return");case 2:return r.prev=2,r.next=5,Zn(n,t,e.connectionId);case 5:i=r.sent,a($("POST successed. response: ".concat(JSON.stringify(i)))),r.next=12;break;case 9:r.prev=9,r.t0=r.catch(2),r.t0 instanceof Error&&a(Y(r.t0.message));case 12:case"end":return r.stop()}}),r,null,[[2,9]])})));return function(){return r.apply(this,arguments)}}();return(0,ct.jsx)("div",{className:"mx-1",children:(0,ct.jsx)("input",{className:"btn btn-secondary",type:"button",name:"resetAllSimulcastRid",defaultValue:"reset rid",onClick:r})})},Pn=function(){var e=at((function(e){return e.soraContents.sora})),t=at((function(e){return e.channelId})),n=at((function(e){return e.apiUrl})),a=nt(),r=function(){var r=(0,i.Z)(s().mark((function r(){var i;return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(null!==e&&void 0!==e&&e.connectionId){r.next=2;break}return r.abrupt("return");case 2:return r.prev=2,r.next=5,On(n,t,e.connectionId);case 5:i=r.sent,a($("POST successed. response: ".concat(JSON.stringify(i)))),r.next=12;break;case 9:r.prev=9,r.t0=r.catch(2),r.t0 instanceof Error&&a(Y(r.t0.message));case 12:case"end":return r.stop()}}),r,null,[[2,9]])})));return function(){return r.apply(this,arguments)}}();return(0,ct.jsx)("div",{className:"mx-1",children:(0,ct.jsx)("input",{className:"btn btn-secondary",type:"button",name:"resetAllSpotlightRid",defaultValue:"resetSpotlightRid",onClick:r})})};function En(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}var An=function(e){var t,n=e.displayResolution,r=e.stream,i=e.mute,o=e.audioOutput,s=e.setHeight,c=(0,a.useRef)(null),u=x(n);return(0,a.useEffect)((function(){var e=new ResizeObserver((function(e){e.forEach((function(e){s(e.contentRect.height)}))}));return c.current&&(o&&r&&r.getAudioTracks().length>0&&c.current.setSinkId(o),e.observe(c.current)),function(){e.disconnect()}}),[]),(0,a.useEffect)((function(){c.current&&i&&(c.current.muted=!0)}),[i]),(0,a.useEffect)((function(){var e;c.current&&r?(r.getVideoTracks().forEach((function(t){e=t.enabled,t.enabled=!1})),c.current.onloadedmetadata=function(t){r.getVideoTracks().forEach((function(t){void 0!==e&&(t.enabled=e)}))},c.current.srcObject=r,o&&r.getAudioTracks().length>0&&c.current.setSinkId(o)):c.current&&null===r&&(c.current.srcObject=null)}),[r]),o&&null!==(t=c.current)&&void 0!==t&&t.setSinkId&&r&&r.getAudioTracks().length>0&&c.current.setSinkId(o),(0,ct.jsx)("video",{id:e.localVideo?"local-video":void 0,autoPlay:!0,playsInline:!0,controls:!0,muted:i,ref:c,width:0<u.width?u.width:void 0,height:0<u.height?u.height:void 0})},Bn=a.memo((function(e){return(0,ct.jsx)(An,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?En(Object(n),!0).forEach((function(t){(0,ot.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):En(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e))}));function Un(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Vn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Un(Object(n),!0).forEach((function(t){(0,ot.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Un(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Fn=2.5,Hn=10,_n="#CCCCCC";function Jn(e,t,n){e.beginPath(),e.fillStyle=t,e.fillRect(0,n,25,Hn),e.closePath()}function zn(e,t){var n=Math.ceil(t/12.5),a=t-Hn;Jn(e,_n,a);for(var r=0;r<n;r++)Jn(e,_n,a=a-Hn-Fn)}var Gn=function(e){var t=(0,a.useRef)(null);return(0,a.useEffect)((function(){if(0!==e.stream.getAudioTracks().length){var n=new(window.AudioContext||window.webkitAudioContext),a=n.createMediaStreamSource(e.stream),r=n.createAnalyser();r.fftSize=2048;var i=r.frequencyBinCount,o=new Uint8Array(i);a.connect(r);var s=null;return function e(){s=requestAnimationFrame(e),r.getByteTimeDomainData(o);var n=Array.from(o),a=Math.max.apply(null,n)-128,i=t.current;if(null!==i){var c=i.getContext("2d");null!==c&&(c.clearRect(0,0,25,i.height),c.save(),zn(c,i.height),function(e,t,n){for(var a=t*n,r=Math.ceil(a/12.5),i=0;i<r;i++)Jn(e,"#000000",t-Hn*(i+1)-Fn*i)}(c,i.height,a/128),c.restore())}}(),function(){n&&n.close(),s&&cancelAnimationFrame(s)}}}),[e.stream]),(0,ct.jsx)("canvas",{width:25,height:e.height,className:"volume-visualizer",ref:t})},Ln=function(e){var t=(0,a.useRef)(null);return(0,a.useEffect)((function(){var e=t.current;if(null!==e){var n=e.getContext("2d");null!==n&&(n.clearRect(0,0,25,e.height),n.save(),zn(n,e.height),n.restore())}}),[]),(0,ct.jsx)("canvas",{width:25,height:e.height,className:"volume-visualizer",ref:t})},Wn=a.memo((function(e){return e.micDevice&&0<e.stream.getAudioTracks().length?(0,ct.jsx)(Gn,Vn({},e)):(0,ct.jsx)(Ln,Vn({},e))})),Kn=function(){var e=(0,a.useState)(0),t=e[0],n=e[1],r=at((function(e){return e.audio})),i=at((function(e){return e.video})),o=at((function(e){return e.audioOutput})),s=at((function(e){return e.displayResolution})),c=at((function(e){return e.focusedSpotlightConnectionIds})),u=at((function(e){return e.soraContents.connectionId})),l=at((function(e){return e.soraContents.localMediaStream})),d=at((function(e){return e.micDevice})),f=u&&c[u];return!1===r&&!1===i?null:(0,ct.jsx)(ct.Fragment,{children:(0,ct.jsx)("div",{className:"d-flex",children:(0,ct.jsxs)("div",{className:"d-flex flex-nowrap align-items-start video-wrapper"+(f?" spotlight-focused":""),children:[(0,ct.jsx)(Bn,{stream:l,setHeight:n,audioOutput:o,displayResolution:s,localVideo:!0,mute:!0}),null!==l?(0,ct.jsx)(Wn,{micDevice:d,stream:l,height:t}):null]})})})},qn=function(){var e=at((function(e){return e.soraContents.connectionId})),t=at((function(e){return e.soraContents.clientId})),n=at((function(e){return e.simulcast})),a=at((function(e){return e.spotlight})),r=at((function(e){return e.role}));return(0,ct.jsx)("div",{className:"row my-1",children:(0,ct.jsxs)("div",{className:"col-auto",children:[(0,ct.jsxs)("div",{className:"video-status mb-1",children:[null!==e||null!==t?(0,ct.jsx)("div",{className:"d-flex align-items-center mb-1 video-status-inner",children:(0,ct.jsx)(Cn,{connectionId:e,clientId:t,localVideo:!0})}):null,null!==e&&!a&&n&&"sendonly"!==r?(0,ct.jsxs)("div",{className:"d-flex align-items-center mb-1 video-status-inner",children:[(0,ct.jsx)(Rn,{rid:"r0"}),(0,ct.jsx)(Rn,{rid:"r1"}),(0,ct.jsx)(Rn,{rid:"r2"}),(0,ct.jsx)(Dn,{})]}):null,null!==e&&a?(0,ct.jsxs)("div",{className:"d-flex align-items-center mb-1 video-status-inner",children:[(0,ct.jsx)(Mn,{}),(0,ct.jsx)(Pn,{})]}):null]}),"recvonly"!==r?(0,ct.jsx)(Kn,{}):null]})})};function Xn(e,t,n){if(null!==t){var a=[];return"video"===n?a=t.getVideoTracks().map((function(e){return e.id})):"audio"===n&&(a=t.getAudioTracks().map((function(e){return e.id}))),e.find((function(e){if(e.id&&!e.id.match(/^RTCMediaStreamTrack/))return!1;if("trackIdentifier"in e){var t=e;return t.trackIdentifier&&a.includes(t.trackIdentifier)}return!1}))}}var Qn=function(e){var t=at((function(e){return e.soraContents.statsReport})),n=at((function(e){return e.soraContents.prevStatsReport})),a=Xn(t,e.stream,e.type),r=Xn(n,e.stream,e.type);if(!a)return null;var i=a.jitterBufferDelay,o=a.jitterBufferEmittedCount;r&&(i=a.jitterBufferDelay-r.jitterBufferDelay,o=a.jitterBufferEmittedCount-r.jitterBufferEmittedCount);var s=Math.floor(i/o*1e3),c="normal-jitter-buffer";return 500<s?c="critical-jitter-buffer":300<s?c="danger-jitter-buffer":100<s&&(c="warning-jitter-buffer"),(0,ct.jsx)("div",{className:"btn btn-sm mx-1 ".concat(c),children:(0,ct.jsxs)("span",{children:[e.type,": ",s]})})},Yn=function(e){var t=at((function(e){return e.soraContents.sora})),n=at((function(e){return e.apiUrl})),a=at((function(e){return e.channelId})),r=nt(),o=function(){var o=(0,i.Z)(s().mark((function i(){var o;return s().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(null!==t&&void 0!==t&&t.connectionId){i.next=2;break}return i.abrupt("return");case 2:return i.prev=2,i.next=5,In(n,a,t.connectionId,e.rid,e.sendConnectionId);case 5:o=i.sent,r($("POST successed. response: ".concat(JSON.stringify(o)))),i.next=12;break;case 9:i.prev=9,i.t0=i.catch(2),i.t0 instanceof Error&&r(Y(i.t0.message));case 12:case"end":return i.stop()}}),i,null,[[2,9]])})));return function(){return o.apply(this,arguments)}}();return(0,ct.jsx)("input",{className:"btn btn-secondary btn-sm mx-1",type:"button",name:"requestSimulcastRidTo".concat(e.rid.charAt(0).toUpperCase()+e.rid.slice(1)),defaultValue:"".concat(e.rid," rid"),onClick:o})},$n=function(e){var t=(0,a.useRef)(null),n=(0,a.useRef)(null),r=at((function(e){return e.soraContents.sora})),o=at((function(e){return e.channelId})),c=at((function(e){return e.apiUrl})),u=nt();if(null===r||void 0===r||!r.connectionId)return null;var l=function(){var a=(0,i.Z)(s().mark((function a(){var i,l,d;return s().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(null!==r&&void 0!==r&&r.connectionId){a.next=2;break}return a.abrupt("return");case 2:if(null!==t.current&&null!==n.current){a.next=4;break}return a.abrupt("return");case 4:return i=t.current.value,l=n.current.value,a.prev=6,a.next=9,Tn(c,o,r.connectionId,i,l,e.sendConnectionId);case 9:d=a.sent,u($("POST successed. response: ".concat(JSON.stringify(d)))),a.next=16;break;case 13:a.prev=13,a.t0=a.catch(6),a.t0 instanceof Error&&u(Y(a.t0.message));case 16:case"end":return a.stop()}}),a,null,[[6,13]])})));return function(){return a.apply(this,arguments)}}();return(0,ct.jsx)("div",{className:"mx-1",children:(0,ct.jsxs)(bt.Z,{className:"form-inline",children:[(0,ct.jsx)(Ft.Z,{ref:t,children:f.I7.map((function(e){return""===e?null:(0,ct.jsxs)("option",{value:e,children:["SpotlightFocusRid: ",e]},e)}))}),(0,ct.jsx)(Ft.Z,{ref:n,children:f.I7.map((function(e){return""===e?null:(0,ct.jsxs)("option",{value:e,children:["SpotlightUnfocusRid: ",e,"\xa0\xa0\xa0"]},e)}))}),(0,ct.jsx)("input",{className:"btn btn-secondary",type:"button",name:"requestSpotlightRidBySendConnectionId",defaultValue:"requestSpotlightRid",onClick:l})]})})},ea=function(e){var t=at((function(e){return e.soraContents.sora})),n=at((function(e){return e.channelId})),a=at((function(e){return e.apiUrl})),r=nt(),o=function(){var o=(0,i.Z)(s().mark((function i(){var o;return s().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(null!==t&&void 0!==t&&t.connectionId){i.next=2;break}return i.abrupt("return");case 2:return i.prev=2,i.next=5,Zn(a,n,t.connectionId,e.sendConnectionId);case 5:o=i.sent,r($("POST successed. response: ".concat(JSON.stringify(o)))),i.next=12;break;case 9:i.prev=9,i.t0=i.catch(2),i.t0 instanceof Error&&r(Y(i.t0.message));case 12:case"end":return i.stop()}}),i,null,[[2,9]])})));return function(){return o.apply(this,arguments)}}();return(0,ct.jsx)("input",{className:"btn btn-secondary btn-sm mx-1",type:"button",name:"resetRtpStream",defaultValue:"reset rid",onClick:o})},ta=function(e){var t=at((function(e){return e.soraContents.sora})),n=at((function(e){return e.channelId})),a=at((function(e){return e.apiUrl})),r=nt(),o=function(){var o=(0,i.Z)(s().mark((function i(){var o;return s().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(null!==t&&void 0!==t&&t.connectionId){i.next=2;break}return i.abrupt("return");case 2:return i.prev=2,i.next=5,On(a,n,t.connectionId,e.sendConnectionId);case 5:o=i.sent,r($("POST successed. response: ".concat(JSON.stringify(o)))),i.next=12;break;case 9:i.prev=9,i.t0=i.catch(2),i.t0 instanceof Error&&r(Y(i.t0.message));case 12:case"end":return i.stop()}}),i,null,[[2,9]])})));return function(){return o.apply(this,arguments)}}();return(0,ct.jsx)("input",{className:"btn btn-secondary mx-1",type:"button",name:"resetSpotlightRid",defaultValue:"resetSpotlightRid",onClick:o})};function na(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return aa(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return aa(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function aa(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function ra(e,t){if(null===t)return[];var n,a=t.getTracks().map((function(e){return e.id})),r=[],i=na(e);try{for(i.s();!(n=i.n()).done;){var o=n.value;if((!o.id||o.id.match(/^RTCMediaStreamTrack/))&&"trackIdentifier"in o){var s=o;s.trackIdentifier&&a.includes(s.trackIdentifier)&&r.push(s)}}}catch(c){i.e(c)}finally{i.f()}return r}var ia=function(e){var t=at((function(e){return e.showStats})),n=at((function(e){return e.soraContents.statsReport})),a=at((function(e){return e.soraContents.prevStatsReport}));if(!t)return null;var i=ra(n,e.stream),o=ra(a,e.stream);return(0,ct.jsx)(ct.Fragment,{children:i.map((function(e){var t=0,n=0,a=o.find((function(t){return e.id===t.id}));return a&&(t=e.jitterBufferDelay-a.jitterBufferDelay,n=e.jitterBufferEmittedCount-a.jitterBufferEmittedCount),(0,ct.jsx)("div",{children:(0,ct.jsxs)("ul",{className:"mediastream-stats-report",children:[Object.entries(e).map((function(e){var t=(0,r.Z)(e,2),n=t[0],a=t[1];return(0,ct.jsxs)("li",{children:[(0,ct.jsxs)("strong",{children:[n,":"]})," ",a]},n)})),(0,ct.jsxs)("li",{children:[(0,ct.jsx)("strong",{children:"[jitterBufferDelay/jitterBufferEmittedCount_in_ms]"})," ",Math.floor(t/n*1e3)]})]})},e.id)}))})},oa=function(e){var t=(0,a.useState)(0),n=t[0],r=t[1],i=at((function(e){return e.audioOutput})),o=at((function(e){return e.displayResolution})),s=at((function(e){return e.focusedSpotlightConnectionIds})),c=at((function(e){return e.multistream})),u=at((function(e){return e.mute})),l=at((function(e){return e.simulcast})),d=at((function(e){return e.spotlight})),f=e.stream.id&&s[e.stream.id];return(0,ct.jsxs)("div",{className:"col-auto",children:[(0,ct.jsxs)("div",{className:"video-status",children:[(0,ct.jsxs)("div",{className:"d-flex align-items-center mb-1 video-status-inner",children:[(0,ct.jsx)(Cn,{connectionId:e.stream.id}),(0,ct.jsx)(Qn,{type:"audio",stream:e.stream}),(0,ct.jsx)(Qn,{type:"video",stream:e.stream})]}),(0,ct.jsxs)("div",{className:"d-flex align-items-center mb-1 video-status-inner",children:[!d&&c&&l?(0,ct.jsxs)(ct.Fragment,{children:[(0,ct.jsx)(Yn,{rid:"r0",sendConnectionId:e.stream.id}),(0,ct.jsx)(Yn,{rid:"r1",sendConnectionId:e.stream.id}),(0,ct.jsx)(Yn,{rid:"r2",sendConnectionId:e.stream.id}),(0,ct.jsx)(ea,{sendConnectionId:e.stream.id})]}):null,d&&c&&l?(0,ct.jsxs)(ct.Fragment,{children:[(0,ct.jsx)($n,{sendConnectionId:e.stream.id}),(0,ct.jsx)(ta,{sendConnectionId:e.stream.id})]}):null]})]}),(0,ct.jsxs)("div",{className:"d-flex flex-wrap align-items-start",children:[(0,ct.jsxs)("div",{className:"d-flex flex-nowrap align-items-start video-wrapper"+(f?" spotlight-focused":""),children:[(0,ct.jsx)(Bn,{stream:e.stream,setHeight:r,mute:u,audioOutput:i,displayResolution:o}),(0,ct.jsx)(Wn,{micDevice:!0,stream:e.stream,height:n})]}),(0,ct.jsx)(ia,{stream:e.stream})]})]})},sa=function(){var e=at((function(e){return e.soraContents.remoteMediaStreams}));return(0,ct.jsx)("div",{className:"row my-2",children:e.map((function(e){return(0,ct.jsx)(oa,{stream:e},e.id)}))})},ca=function(){var e=at((function(e){return e.aspectRatio})),t=nt();return(0,ct.jsxs)(bt.Z,{className:"form-inline",controlId:"aspectRatio",children:[(0,ct.jsx)(jt.Z,{children:"aspectRatio:"}),(0,ct.jsx)(Ft.Z,{name:"aspectRatio",value:e,onChange:function(e){h(e.target.value,f.Ii)&&t(ee(e.target.value))},children:f.Ii.map((function(e){return(0,ct.jsx)("option",{value:e,children:""===e?"\u672a\u6307\u5b9a":e},e)}))})]})},ua=function(){var e=at((function(e){return e.audioBitRate})),t=M(at((function(e){return e.soraContents.connectionStatus}))),n=nt();return(0,ct.jsxs)(bt.Z,{className:"form-inline",controlId:"audioBitRate",children:[(0,ct.jsx)(jt.Z,{children:"audioBitRate:"}),(0,ct.jsx)(Ft.Z,{name:"audioBitRate",value:e,onChange:function(e){h(e.target.value,f.xR)&&n(ne(e.target.value))},disabled:t,children:f.xR.map((function(e){return(0,ct.jsx)("option",{value:e,children:""===e?"\u672a\u6307\u5b9a":e},e)}))})]})},la=function(){var e=at((function(e){return e.audioCodecType})),t=M(at((function(e){return e.soraContents.connectionStatus}))),n=nt();return(0,ct.jsxs)(bt.Z,{className:"form-inline",controlId:"audioBitRate",children:[(0,ct.jsx)(jt.Z,{children:"audioCodecType:"}),(0,ct.jsx)(Ft.Z,{name:"audioCodecType",value:e,onChange:function(e){h(e.target.value,f.o1)&&n(ae(e.target.value))},disabled:t,children:f.o1.map((function(e){return(0,ct.jsx)("option",{value:e,children:""===e?"\u672a\u6307\u5b9a":e},e)}))})]})},da=function(){var e=at((function(e){return e.audioContentHint})),t=nt();return(0,ct.jsxs)(bt.Z,{className:"form-inline",controlId:"audioContentHint",children:[(0,ct.jsx)(jt.Z,{children:"audioContentHint:"}),(0,ct.jsx)(Ft.Z,{name:"audioContentHint",value:e,onChange:function(e){h(e.target.value,f.nT)&&t(re(e.target.value))},children:f.nT.map((function(e){return(0,ct.jsx)("option",{value:e,children:""===e?"\u672a\u6307\u5b9a":e},e)}))})]})},fa=n(6316),pa=function(){var e=at((function(e){return e.audio})),t=M(at((function(e){return e.soraContents.connectionStatus}))),n=nt();return(0,ct.jsx)(bt.Z,{className:"form-inline",controlId:"audio",children:(0,ct.jsx)(fa.Z,{type:"switch",name:"audio",label:"audio",checked:e,onChange:function(e){n(te(e.target.checked))},disabled:t})})},ma=function(){var e=at((function(e){return e.audioInput})),t=at((function(e){return e.audioInputDevices})),n=nt();return(0,ct.jsxs)(bt.Z,{className:"form-inline",controlId:"audioInput",children:[(0,ct.jsx)(jt.Z,{children:"audioInput:"}),(0,ct.jsxs)(Ft.Z,{name:"audioInput",value:e,onChange:function(e){n(ie(e.target.value)),n(K())},disabled:0===t.length,children:[(0,ct.jsx)("option",{value:"",children:"\u672a\u6307\u5b9a"}),t.map((function(e){return(0,ct.jsx)("option",{value:e.deviceId,children:e.label},e.deviceId)}))]})]})},ha=function(){var e=at((function(e){return e.audioOutput})),t=at((function(e){return e.audioOutputDevices})),n=nt();return(0,ct.jsxs)(bt.Z,{className:"form-inline",controlId:"audioOutput",children:[(0,ct.jsx)(jt.Z,{children:"audioOutput:"}),(0,ct.jsxs)(Ft.Z,{name:"audioOutput",value:e,onChange:function(e){n(oe(e.target.value))},disabled:0===t.length,children:[(0,ct.jsx)("option",{value:"",children:"\u672a\u6307\u5b9a"}),t.map((function(e){return(0,ct.jsx)("option",{value:e.deviceId,children:e.label},e.deviceId)}))]})]})},ga=function(){var e=at((function(e){return e.audioTrack})),t=nt();return(0,ct.jsx)(bt.Z,{className:"form-inline",controlId:"audioTrack",children:(0,ct.jsx)(fa.Z,{type:"switch",name:"audioTrack",label:"Enable audio track",checked:e,onChange:function(e){t(se(e.target.checked))}})})},va=function(){var e=at((function(e){return e.autoGainControl})),t=nt();return(0,ct.jsxs)(bt.Z,{className:"form-inline",controlId:"autoGainControl",children:[(0,ct.jsx)(jt.Z,{children:"autoGainControl:"}),(0,ct.jsx)(Ft.Z,{name:"autoGainControl",value:e,onChange:function(e){h(e.target.value,f.iN)&&t(ce(e.target.value))},children:f.iN.map((function(e){return(0,ct.jsx)("option",{value:e,children:""===e?"\u672a\u6307\u5b9a":e},e)}))})]})},xa=function(){var e=at((function(e){return e.blurRadius})),t=at((function(e){return e.mediaType})),n=nt(),a="getUserMedia"!==t;return(0,ct.jsxs)(bt.Z,{className:"form-inline",controlId:"spotlightNumber",children:[(0,ct.jsx)(jt.Z,{children:"blurRadius:"}),(0,ct.jsx)(Ft.Z,{value:e,onChange:function(e){h(e.target.value,f.G_)&&n(ue(e.target.value))},disabled:a,children:f.G_.map((function(e){return(0,ct.jsx)("option",{suppressHydrationWarning:!0,value:e,children:""===e||a?"\u672a\u6307\u5b9a":e},e)}))})]})},ba=function(){var e=at((function(e){return e.enabledBundleId})),t=at((function(e){return e.bundleId})),n=M(at((function(e){return e.soraContents.connectionStatus}))),a=nt();return(0,ct.jsxs)(ct.Fragment,{children:[(0,ct.jsx)(mn.Z,{className:"form-row",children:(0,ct.jsx)(hn.Z,{className:"col-auto",children:(0,ct.jsx)(bt.Z,{className:"form-inline",controlId:"enabledBundleId",children:(0,ct.jsx)(fa.Z,{type:"switch",name:"enabledBundleId",label:"bundleId",checked:e,onChange:function(e){a(ye(e.target.checked))},disabled:n})})})}),e?(0,ct.jsx)(mn.Z,{className:"form-row",children:(0,ct.jsx)(hn.Z,{className:"col-auto",children:(0,ct.jsx)(bt.Z,{className:"form-inline",controlId:"bundleId",children:(0,ct.jsx)(yt.Z,{className:"flex-fill w-500",type:"text",placeholder:"bundleId\u3092\u6307\u5b9a",value:t,onChange:function(e){a(le(e.target.value))},disabled:n})})})}):null]})},ja=function(){var e=at((function(e){return e.cameraDevice})),t=at((function(e){return e.soraContents.sora})),n=at((function(e){return e.video})),a=!(t?t.video:n),o=nt();return(0,ct.jsx)(bt.Z,{className:"form-inline",controlId:"cameraDevice",children:(0,ct.jsx)(fa.Z,{type:"switch",name:"cameraDevice",label:"Enable camera device",checked:e,onChange:function(e){o(function(e){return function(){var t=(0,i.Z)(s().mark((function t(n,a){var i,o,c,u,l,d;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((i=a()).soraContents.localMediaStream&&i.soraContents.sora){t.next=4;break}return n(E.t.actions.setCameraDevice(e)),t.abrupt("return");case 4:if(!e){t.next=15;break}return o={aspectRatio:i.aspectRatio,audio:!1,audioContentHint:i.audioContentHint,audioInput:i.audioInput,audioTrack:i.audioTrack,autoGainControl:i.autoGainControl,blurRadius:i.blurRadius,cameraDevice:e,echoCancellation:i.echoCancellation,echoCancellationType:i.echoCancellationType,fakeContents:i.fakeContents,fakeVolume:i.fakeVolume,frameRate:i.frameRate,mediaProcessorsNoiseSuppression:i.mediaProcessorsNoiseSuppression,mediaType:i.mediaType,micDevice:i.micDevice,noiseSuppression:i.noiseSuppression,noiseSuppressionProcessor:i.noiseSuppressionProcessor,resizeMode:i.resizeMode,resolution:i.resolution,video:i.video,videoContentHint:i.videoContentHint,videoInput:i.videoInput,videoTrack:i.videoTrack,virtualBackgroundProcessor:i.virtualBackgroundProcessor},t.next=8,U(n,o).catch((function(e){throw n(E.t.actions.setSoraErrorAlertMessage(e.toString())),e}));case 8:c=t.sent,u=(0,r.Z)(c,2),l=u[0],d=u[1],0<l.getVideoTracks().length&&(i.soraContents.sora.replaceVideoTrack(i.soraContents.localMediaStream,l.getVideoTracks()[0]),n(E.t.actions.setFakeContentsGainNode(d))),t.next=16;break;case 15:i.soraContents.sora.stopVideoTrack(i.soraContents.localMediaStream);case 16:n(E.t.actions.setCameraDevice(e));case 17:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}(e.target.checked))},disabled:a})})},ya=function(){var e=at((function(e){return e.channelId})),t=M(at((function(e){return e.soraContents.connectionStatus}))),n=nt();return(0,ct.jsxs)(bt.Z,{className:"form-inline",controlId:"channelId",children:[(0,ct.jsx)(jt.Z,{children:"channelId:"}),(0,ct.jsx)(yt.Z,{type:"text",placeholder:"ChannelId\u3092\u6307\u5b9a",value:e,onChange:function(e){n(de(e.target.value))},disabled:t})]})},Ca=function(){var e=at((function(e){return e.enabledClientId})),t=at((function(e){return e.clientId})),n=M(at((function(e){return e.soraContents.connectionStatus}))),a=nt();return(0,ct.jsxs)(ct.Fragment,{children:[(0,ct.jsx)(mn.Z,{className:"form-row",children:(0,ct.jsx)(hn.Z,{className:"col-auto",children:(0,ct.jsx)(bt.Z,{className:"form-inline",controlId:"enabledClientId",children:(0,ct.jsx)(fa.Z,{type:"switch",name:"enabledClientId",label:"clientId",checked:e,onChange:function(e){a(Ce(e.target.checked))},disabled:n})})})}),e?(0,ct.jsx)(mn.Z,{className:"form-row",children:(0,ct.jsx)(hn.Z,{className:"col-auto",children:(0,ct.jsx)(bt.Z,{className:"form-inline",controlId:"clientId",children:(0,ct.jsx)(yt.Z,{className:"flex-fill w-500",type:"text",placeholder:"ClientId\u3092\u6307\u5b9a",value:t,onChange:function(e){a(fe(e.target.value))},disabled:n})})})}):null]})},Sa=function(){var e=at((function(e){return e.soraContents.connectionStatus})),t=nt();return(0,ct.jsx)("div",{className:"col-auto mb-1",children:(0,ct.jsx)("input",{className:"btn btn-secondary",type:"button",name:"connect",defaultValue:"connect",onClick:function(){t(function(){var e=(0,i.Z)(s().mark((function e(t,n){var a,o,c,u,d,f,p,m,h,g,x,b,j,y,C,S;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t(E.t.actions.setTimelineMessage(_("start-connection"))),t(E.t.actions.setSoraConnectionStatus("connecting")),!(a=n()).soraContents.sora){e.next=6;break}return e.next=6,a.soraContents.sora.disconnect();case 6:if(o=v(a.enabledSignalingUrlCandidates,a.signalingUrlCandidates),t(E.t.actions.setLogMessages({title:"SIGNALING_URL",description:JSON.stringify(o)})),c=l.Z.connection(o,a.debug),u=H(a),d=P(u),f=Z(a.enabledMetadata,a.metadata),e.prev=12,"sendonly"!==a.role){e.next=28;break}return(p=c.sendonly(a.channelId,null,d)).metadata=f,"boolean"===typeof a.googCpuOveruseDetection&&(p.constraints={optional:[{googCpuOveruseDetection:a.googCpuOveruseDetection}]}),F(t,n,p),e.next=20,U(t,a).catch((function(e){throw t(E.t.actions.setSoraErrorAlertMessage(e.toString())),t(E.t.actions.setSoraConnectionStatus("disconnected")),e}));case 20:return g=e.sent,x=(0,r.Z)(g,2),m=x[0],h=x[1],e.next=26,p.connect(m);case 26:e.next=49;break;case 28:if("sendrecv"!==a.role){e.next=43;break}return(p=c.sendrecv(a.channelId,null,d)).metadata=f,"boolean"===typeof a.googCpuOveruseDetection&&(p.constraints={optional:[{googCpuOveruseDetection:a.googCpuOveruseDetection}]}),F(t,n,p),e.next=35,U(t,a).catch((function(e){throw t(E.t.actions.setSoraErrorAlertMessage(e.toString())),t(E.t.actions.setSoraConnectionStatus("disconnected")),e}));case 35:return b=e.sent,j=(0,r.Z)(b,2),m=j[0],h=j[1],e.next=41,p.connect(m);case 41:e.next=49;break;case 43:if("recvonly"!==a.role){e.next=49;break}return(p=c.recvonly(a.channelId,null,d)).metadata=f,F(t,n,p),e.next=49,p.connect();case 49:e.next=58;break;case 51:throw e.prev=51,e.t0=e.catch(12),e.t0 instanceof Error&&t(E.t.actions.setSoraErrorAlertMessage("Failed to connect Sora. ".concat(e.t0.message))),a.virtualBackgroundProcessor&&a.virtualBackgroundProcessor.isProcessing()?((y=a.virtualBackgroundProcessor.getOriginalTrack())&&(y.stop(),t(E.t.actions.setTimelineMessage(J("stop",y)))),a.virtualBackgroundProcessor.stopProcessing()):m&&m.getVideoTracks().forEach((function(e){e.stop(),t(E.t.actions.setTimelineMessage(J("stop",e)))})),a.noiseSuppressionProcessor&&a.noiseSuppressionProcessor.isProcessing()&&((C=a.noiseSuppressionProcessor.getOriginalTrack())?(C.stop(),t(E.t.actions.setTimelineMessage(J("stop",C)))):m&&m.getAudioTracks().forEach((function(e){e.stop(),t(E.t.actions.setTimelineMessage(J("stop",e)))})),a.noiseSuppressionProcessor.stopProcessing()),t(E.t.actions.setSoraConnectionStatus("disconnected")),e.t0;case 58:if(void 0!==p){e.next=60;break}throw new Error("Failed to connect Sora. Connection object is 'undefined'");case 60:return t(E.t.actions.setSoraInfoAlertMessage("Succeeded to connect Sora.")),e.next=63,z(t,p);case 63:S=setInterval((0,i.Z)(s().mark((function e(){var a,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n(),!(r=a.soraContents).sora){e.next=6;break}return e.next=4,z(t,r.sora);case 4:e.next=7;break;case 6:clearInterval(S);case 7:case"end":return e.stop()}}),e)}))),1e3),p.stream=null,t(E.t.actions.setSora(p)),m&&t(E.t.actions.setLocalMediaStream(m)),h&&t(E.t.actions.setFakeContentsGainNode(h)),t(E.t.actions.setSoraConnectionStatus("connected")),t(E.t.actions.setTimelineMessage(_("connected")));case 70:case"end":return e.stop()}}),e,null,[[12,51]])})));return function(t,n){return e.apply(this,arguments)}}())},disabled:"disconnecting"===e||"connecting"===e||"initializing"===e})})},ka=function(e){var t=at((function(e){return e.ignoreDisconnectWebSocket})),n=nt();return(0,ct.jsxs)(bt.Z,{className:"form-inline",controlId:"ignoreDisconnectWebSocket",children:[(0,ct.jsx)(jt.Z,{children:"ignoreDisconnectWebSocket:"}),(0,ct.jsx)(Ft.Z,{name:"ignoreDisconnectWebSocket",value:t,onChange:function(e){h(e.target.value,f.kt)&&n(Oe(e.target.value))},disabled:e.disabled,children:f.kt.map((function(e){return(0,ct.jsx)("option",{value:e,children:""===e?"\u672a\u6307\u5b9a":e},e)}))})]})},Na=function(e){var t=at((function(e){return e.dataChannelSignaling})),n=nt();return(0,ct.jsxs)(bt.Z,{className:"form-inline",controlId:"dataChannelSignaling",children:[(0,ct.jsx)(jt.Z,{children:"dataChannelSignaling:"}),(0,ct.jsx)(Ft.Z,{name:"dataChannelSignaling",value:t,onChange:function(e){h(e.target.value,f.l9)&&n(me(e.target.value))},disabled:e.disabled,children:f.l9.map((function(e){return(0,ct.jsx)("option",{value:e,children:""===e?"\u672a\u6307\u5b9a":e},e)}))})]})},wa=function(){var e=at((function(e){return e.enabledDataChannel})),t=M(at((function(e){return e.soraContents.connectionStatus}))),n=nt();return(0,ct.jsxs)(ct.Fragment,{children:[(0,ct.jsx)(mn.Z,{className:"form-row",children:(0,ct.jsx)(hn.Z,{className:"col-auto",children:(0,ct.jsx)(bt.Z,{className:"form-inline",controlId:"enabledDataChannel",children:(0,ct.jsx)(fa.Z,{type:"switch",name:"enabledDataChannel",label:"dataChannel",checked:e,onChange:function(e){n(ke(e.target.checked))},disabled:t})})})}),e?(0,ct.jsx)(mn.Z,{className:"form-row",children:(0,ct.jsx)(hn.Z,{className:"col-auto",children:(0,ct.jsxs)(mn.Z,{xs:"auto",children:[(0,ct.jsx)(hn.Z,{children:(0,ct.jsx)(Na,{disabled:t})}),(0,ct.jsx)(hn.Z,{children:(0,ct.jsx)(ka,{disabled:t})})]})})}):null]})},Ia=function(){var e=at((function(e){return e.enabledDataChannels})),t=at((function(e){return e.dataChannels})),n=M(at((function(e){return e.soraContents.connectionStatus}))),a=nt(),r="dataChannels\u3092\u6307\u5b9a\n(\u4f8b)\n"+JSON.stringify([{label:"#spam",maxPacketLifeTime:10,ordered:!0,protocol:"efg",compress:!1,direction:"sendrecv"}],null,2);return(0,ct.jsxs)(ct.Fragment,{children:[(0,ct.jsx)(mn.Z,{className:"form-row",children:(0,ct.jsx)(hn.Z,{className:"col-auto",children:(0,ct.jsx)(bt.Z,{className:"form-inline",controlId:"enabledDataChannels",children:(0,ct.jsx)(fa.Z,{type:"switch",name:"enabledDataChannels",label:"dataChannels",checked:e,onChange:function(e){a(Se(e.target.checked))},disabled:n})})})}),e?(0,ct.jsx)(mn.Z,{className:"form-row",children:(0,ct.jsx)(hn.Z,{className:"col-auto",children:(0,ct.jsx)(bt.Z,{className:"form-inline",controlId:"dataChannels",children:(0,ct.jsx)(yt.Z,{className:"flex-fill",as:"textarea",placeholder:r,value:t,onChange:function(e){a(pe(e.target.value))},rows:12,cols:100,disabled:n})})})}):null]})},Za=function(){var e=at((function(e){return e.soraContents.connectionStatus})),t=nt();return(0,ct.jsx)("div",{className:"col-auto mb-1",children:(0,ct.jsx)("input",{className:"btn btn-secondary",type:"button",name:"disconnect",defaultValue:"disconnect",onClick:function(){t(L())},disabled:"disconnecting"===e||"connecting"===e||"initializing"===e})})},Ta=function(){var e=at((function(e){return e.displayResolution})),t=nt();return(0,ct.jsxs)(bt.Z,{className:"form-inline",controlId:"displayResolution",children:[(0,ct.jsx)(jt.Z,{children:"displayResolution:"}),(0,ct.jsx)(Ft.Z,{name:"displayResolution",value:e,onChange:function(e){h(e.target.value,f.hJ)&&t(xe(e.target.value))},children:f.hJ.map((function(e){return(0,ct.jsx)("option",{value:e,children:""===e?"\u672a\u6307\u5b9a":e},e)}))})]})},Oa=n(6968),Ra=function(){var e=(0,a.useState)(!1),t=e[0],n=e[1],r=at((function(e){return e.e2ee})),o=M(at((function(e){return e.soraContents.connectionStatus}))),c=nt();return(0,a.useEffect)((function(){r&&n(!1)}),[r]),(0,ct.jsx)(mn.Z,{className:"form-row",children:(0,ct.jsx)(hn.Z,{className:"col-auto",children:(0,ct.jsxs)(bt.Z,{className:"form-inline",controlId:"e2ee",children:[(0,ct.jsx)(fa.Z,{type:"switch",name:"e2ee",label:"e2ee",checked:r,onChange:function(e){e.target.checked&&n(!0),c(function(e){return function(){var t=(0,i.Z)(s().mark((function t(n,a){var r;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=14;break}r="Faild to execute WebAssembly '".concat("https://sora-e2ee-wasm.shiguredo.jp/2020.2/wasm.wasm","'."),t.next=5;break;case 5:return t.prev=5,t.next=8,l.Z.initE2EE("https://sora-e2ee-wasm.shiguredo.jp/2020.2/wasm.wasm");case 8:t.next=14;break;case 10:return t.prev=10,t.t0=t.catch(5),n(E.t.actions.setSoraErrorAlertMessage(r)),t.abrupt("return");case 14:n(E.t.actions.setE2EE(e));case 15:case"end":return t.stop()}}),t,null,[[5,10]])})));return function(e,n){return t.apply(this,arguments)}}()}(e.target.checked))},disabled:o}),t?(0,ct.jsx)(Oa.Z,{className:"spinner-status",variant:"primary",animation:"border",role:"status"}):null]})})})},Ma=function(){var e=at((function(e){return e.echoCancellation})),t=nt();return(0,ct.jsxs)(bt.Z,{className:"form-inline",controlId:"echoCancellation",children:[(0,ct.jsx)(jt.Z,{children:"echoCancellation:"}),(0,ct.jsx)(Ft.Z,{name:"echoCancellation",value:e,onChange:function(e){h(e.target.value,f.PS)&&t(be(e.target.value))},children:f.PS.map((function(e){return(0,ct.jsx)("option",{value:e,children:""===e?"\u672a\u6307\u5b9a":e},e)}))})]})},Da=function(){var e=at((function(e){return e.echoCancellationType})),t=nt();return(0,ct.jsxs)(bt.Z,{className:"form-inline",controlId:"echoCancellationType",children:[(0,ct.jsx)(jt.Z,{children:"echoCancellationType:"}),(0,ct.jsx)(Ft.Z,{name:"echoCancellationType",value:e,onChange:function(e){h(e.target.value,f.cJ)&&t(je(e.target.value))},children:f.cJ.map((function(e){return(0,ct.jsx)("option",{value:e,children:""===e?"\u672a\u6307\u5b9a":e},e)}))})]})},Pa=n(1181),Ea=function(){var e=at((function(e){return e.mediaType})),t=at((function(e){return e.fakeVolume})),n=nt();return"fakeMedia"!==e?null:(0,ct.jsxs)(bt.Z,{className:"form-inline",controlId:"fakeVolume",children:[(0,ct.jsx)(jt.Z,{children:"fakeVolume:"}),(0,ct.jsx)(Pa.Z.Range,{min:"0",max:"1",step:"0.25",value:t,onChange:function(e){n(Ze(e.target.value))}})]})},Aa=function(){var e=at((function(e){return e.frameRate})),t=nt();return(0,ct.jsxs)(bt.Z,{className:"form-inline",controlId:"frameRate",children:[(0,ct.jsx)(jt.Z,{children:"frameRate:"}),(0,ct.jsx)(Ft.Z,{name:"frameRate",value:e,onChange:function(e){h(e.target.value,f.YX)&&t(Te(e.target.value))},children:f.YX.map((function(e){return(0,ct.jsx)("option",{value:e,children:""===e?"\u672a\u6307\u5b9a":e},e)}))})]})},Ba=function(){var e=at((function(e){return e.mediaProcessorsNoiseSuppression})),t=at((function(e){return e.mediaType})),n=nt(),a="getUserMedia"!==t;return(0,ct.jsx)(bt.Z,{className:"form-inline",controlId:"mediaProcessorsNoiseSuppression",children:(0,ct.jsx)(fa.Z,{type:"switch",name:"mediaProcessorsNoiseSuppression",label:"mediaProcessorsNoiseSuppression",checked:e,onChange:function(e){n(Re(e.target.checked))},disabled:a})})},Ua=function(e){var t=e.label,n=e.disabled,a=e.onChange,r=e.mediaType;return(0,ct.jsx)(fa.Z,{type:"radio",inline:!0,id:t,label:t,value:t,checked:r===t,onChange:a,disabled:n})},Va=function(){var e=at((function(e){return e.soraContents.connectionStatus})),t=at((function(e){return e.mediaType})),n=M(e),a=nt(),r=function(e){h(e.target.value,f.w_)&&a(Me(e.target.value))};return(0,ct.jsxs)(bt.Z,{className:"form-inline flex-wrap",children:[(0,ct.jsx)(jt.Z,{children:"mediaType:"}),(0,ct.jsx)(Ua,{label:"getUserMedia",mediaType:t,disabled:n,onChange:r}),(0,ct.jsx)(Ua,{label:"getDisplayMedia",mediaType:t,disabled:n,onChange:r}),(0,ct.jsx)(Ua,{label:"fakeMedia",mediaType:t,disabled:n,onChange:r})]})},Fa=function(){var e=at((function(e){return e.enabledMetadata})),t=at((function(e){return e.metadata})),n=M(at((function(e){return e.soraContents.connectionStatus}))),a=nt();return(0,ct.jsxs)(ct.Fragment,{children:[(0,ct.jsx)(mn.Z,{className:"form-row",children:(0,ct.jsx)(hn.Z,{className:"col-auto",children:(0,ct.jsx)(bt.Z,{className:"form-inline",controlId:"enabledMetadata",children:(0,ct.jsx)(fa.Z,{type:"switch",name:"enabledMetadata",label:"metadata",checked:e,onChange:function(e){a(Ne(e.target.checked))},disabled:n})})})}),e?(0,ct.jsx)(mn.Z,{className:"form-row",children:(0,ct.jsx)(hn.Z,{className:"col-auto",children:(0,ct.jsx)(bt.Z,{className:"form-inline",controlId:"metadata",children:(0,ct.jsx)(yt.Z,{className:"flex-fill",as:"textarea",placeholder:"Metadata\u3092\u6307\u5b9a",value:t,onChange:function(e){a(De(e.target.value))},rows:10,cols:100,disabled:n})})})}):null]})},Ha=function(){var e=at((function(e){return e.micDevice})),t=at((function(e){return e.soraContents.sora})),n=at((function(e){return e.audio})),a=!(t?t.audio:n),o=nt();return(0,ct.jsx)(bt.Z,{className:"form-inline",controlId:"micDevice",children:(0,ct.jsx)(fa.Z,{type:"switch",name:"micDevice",label:"Enable mic device",checked:e,onChange:function(e){o(function(e){return function(){var t=(0,i.Z)(s().mark((function t(n,a){var i,o,c,u,l,d;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((i=a()).soraContents.localMediaStream&&i.soraContents.sora){t.next=4;break}return n(E.t.actions.setMicDevice(e)),t.abrupt("return");case 4:if(!e){t.next=18;break}return o={aspectRatio:i.aspectRatio,audio:i.audio,audioContentHint:i.audioContentHint,audioInput:i.audioInput,audioTrack:i.audioTrack,autoGainControl:i.autoGainControl,blurRadius:i.blurRadius,cameraDevice:i.cameraDevice,echoCancellation:i.echoCancellation,echoCancellationType:i.echoCancellationType,fakeContents:i.fakeContents,fakeVolume:i.fakeVolume,frameRate:i.frameRate,mediaProcessorsNoiseSuppression:i.mediaProcessorsNoiseSuppression,mediaType:i.mediaType,micDevice:e,noiseSuppression:i.noiseSuppression,noiseSuppressionProcessor:i.noiseSuppressionProcessor,resizeMode:i.resizeMode,resolution:i.resolution,video:!1,videoContentHint:i.videoContentHint,videoInput:i.videoInput,videoTrack:i.videoTrack,virtualBackgroundProcessor:i.virtualBackgroundProcessor},t.next=8,U(n,o).catch((function(e){throw n(E.t.actions.setSoraErrorAlertMessage(e.toString())),e}));case 8:if(c=t.sent,u=(0,r.Z)(c,2),l=u[0],d=u[1],!(0<l.getAudioTracks().length)){t.next=16;break}return t.next=15,i.soraContents.sora.replaceAudioTrack(i.soraContents.localMediaStream,l.getAudioTracks()[0]);case 15:n(E.t.actions.setFakeContentsGainNode(d));case 16:t.next=19;break;case 18:i.soraContents.sora.stopAudioTrack(i.soraContents.localMediaStream);case 19:n(E.t.actions.setMicDevice(e));case 20:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}(e.target.checked))},disabled:a})})},_a=function(){var e=at((function(e){return e.multistream})),t=M(at((function(e){return e.soraContents.connectionStatus}))),n=nt();return(0,ct.jsxs)(bt.Z,{className:"form-inline",controlId:"multistream",children:[(0,ct.jsx)(jt.Z,{children:"multistream:"}),(0,ct.jsx)(Ft.Z,{name:"multistream",value:e,onChange:function(e){h(e.target.value,f.u9)&&n(Pe(e.target.value))},disabled:t,children:f.u9.map((function(e){return(0,ct.jsx)("option",{value:e,children:""===e?"\u672a\u6307\u5b9a":e},e)}))})]})},Ja=function(){var e=at((function(e){return e.noiseSuppression})),t=nt();return(0,ct.jsxs)(bt.Z,{className:"form-inline",controlId:"noiseSuppression",children:[(0,ct.jsx)(jt.Z,{children:"noiseSuppression:"}),(0,ct.jsx)(Ft.Z,{name:"noiseSuppression",value:e,onChange:function(e){h(e.target.value,f.ad)&&t(Ee(e.target.value))},children:f.ad.map((function(e){return(0,ct.jsx)("option",{value:e,children:""===e?"\u672a\u6307\u5b9a":e},e)}))})]})},za=function(){var e=at((function(e){return e.reconnect})),t=M(at((function(e){return e.soraContents.connectionStatus}))),n=nt();return(0,ct.jsx)(mn.Z,{className:"form-row",children:(0,ct.jsx)(hn.Z,{className:"col-auto",children:(0,ct.jsx)(bt.Z,{className:"form-inline",controlId:"reconnect",children:(0,ct.jsx)(fa.Z,{type:"switch",name:"reconnect",label:"reconnect",checked:e,onChange:function(e){n(Ae(e.target.checked))},disabled:t})})})})},Ga=function(){var e=nt();return(0,ct.jsx)("div",{className:"col-auto mb-1",children:(0,ct.jsx)("input",{className:"btn btn-outline-secondary",type:"button",name:"update-devices",defaultValue:"update-devices",onClick:function(){e(W())}})})},La=function(){var e=at((function(e){return e.resizeMode})),t=nt();return(0,ct.jsxs)(bt.Z,{className:"form-inline",controlId:"resizeMode",children:[(0,ct.jsx)(jt.Z,{children:"resizeMode:"}),(0,ct.jsx)(Ft.Z,{name:"resizeMode",value:e,onChange:function(e){h(e.target.value,f.L4)&&t(Be(e.target.value))},children:f.L4.map((function(e){return(0,ct.jsx)("option",{value:e,children:""===e?"\u672a\u6307\u5b9a":e},e)}))})]})},Wa=function(){var e=at((function(e){return e.resolution})),t=nt();return(0,ct.jsxs)(bt.Z,{className:"form-inline",controlId:"resolution",children:[(0,ct.jsx)(jt.Z,{children:"resolution:"}),(0,ct.jsx)(Ft.Z,{name:"resolution",value:e,onChange:function(e){h(e.target.value,f.Vf)&&t(Ve(e.target.value))},children:f.Vf.map((function(e){return(0,ct.jsx)("option",{value:e,children:""===e?"\u672a\u6307\u5b9a":e},e)}))})]})},Ka=function(){var e=at((function(e){return e.role})),t=M(at((function(e){return e.soraContents.connectionStatus}))),n=nt();return(0,ct.jsxs)(bt.Z,{className:"form-inline",controlId:"role",children:[(0,ct.jsx)(jt.Z,{children:"role:"}),(0,ct.jsx)(Ft.Z,{name:"role",value:e,onChange:function(e){h(e.target.value,f.K$)&&n(Ue(e.target.value))},disabled:t,children:f.K$.map((function(e){return(0,ct.jsx)("option",{value:e,children:e},e)}))})]})},qa=function(){var e=at((function(e){return e.enabledSignalingNotifyMetadata})),t=at((function(e){return e.signalingNotifyMetadata})),n=M(at((function(e){return e.soraContents.connectionStatus}))),a=nt();return(0,ct.jsxs)(ct.Fragment,{children:[(0,ct.jsx)(mn.Z,{className:"form-row",children:(0,ct.jsx)(hn.Z,{className:"col-auto",children:(0,ct.jsx)(bt.Z,{className:"form-inline",controlId:"enabledSignalingNotifyMetadata",children:(0,ct.jsx)(fa.Z,{type:"switch",name:"enabledSignalingNotifyMetadata",label:"signalingNotifyMetadata",checked:e,onChange:function(e){a(we(e.target.checked))},disabled:n})})})}),e?(0,ct.jsx)(mn.Z,{className:"form-row",children:(0,ct.jsx)(hn.Z,{className:"col-auto",children:(0,ct.jsx)(bt.Z,{className:"form-inline",controlId:"signalingNotifyMetadata",children:(0,ct.jsx)(yt.Z,{className:"flex-fill",as:"textarea",placeholder:"signalingNotifyMetadata\u3092\u6307\u5b9a",value:t,onChange:function(e){a(Fe(e.target.value))},rows:10,cols:100,disabled:n})})})}):null]})},Xa=function(){var e=at((function(e){return e.enabledSignalingUrlCandidates})),t=at((function(e){return e.signalingUrlCandidates})),n=M(at((function(e){return e.soraContents.connectionStatus}))),a=nt();return(0,ct.jsxs)(ct.Fragment,{children:[(0,ct.jsx)(mn.Z,{className:"form-row",xs:"auto",children:(0,ct.jsx)(hn.Z,{className:"col-auto",children:(0,ct.jsx)(bt.Z,{className:"form-inline",controlId:"enabledSignalingUrlCandidates",children:(0,ct.jsx)(fa.Z,{type:"switch",name:"enabledSignalingUrlCandidates",label:"signalingUrlCandidates",checked:e,onChange:function(e){a(Ie(e.target.checked))},disabled:n})})})}),e?(0,ct.jsx)(mn.Z,{className:"form-row",xs:"auto",children:(0,ct.jsx)(hn.Z,{className:"col-auto",children:(0,ct.jsx)(bt.Z,{className:"form-inline",controlId:"signalingNotifyMetadata",children:(0,ct.jsx)(yt.Z,{className:"flex-fill",as:"textarea",placeholder:"signalingUrlCandidates\u3092\u6307\u5b9a",value:t.join("\n"),onChange:function(e){a(He(e.target.value.split("\n")))},rows:5,cols:100,disabled:n})})})}):null]})},Qa=function(){var e=at((function(e){return e.simulcast})),t=M(at((function(e){return e.soraContents.connectionStatus}))),n=nt();return(0,ct.jsxs)(bt.Z,{className:"form-inline",controlId:"simulcast",children:[(0,ct.jsx)(jt.Z,{children:"simulcast:"}),(0,ct.jsx)(Ft.Z,{name:"simulcast",value:e,onChange:function(e){h(e.target.value,f.VE)&&n(_e(e.target.value))},disabled:t,children:f.VE.map((function(e){return(0,ct.jsx)("option",{value:e,children:""===e?"\u672a\u6307\u5b9a":e},e)}))})]})},Ya=function(){var e=at((function(e){return e.simulcastRid})),t=M(at((function(e){return e.soraContents.connectionStatus}))),n=nt();return(0,ct.jsxs)(bt.Z,{className:"form-inline",controlId:"simulcastRid",children:[(0,ct.jsx)(jt.Z,{children:"simulcastRid:"}),(0,ct.jsx)(Ft.Z,{name:"simulcastRid",value:e,onChange:function(e){h(e.target.value,f.WJ)&&n(Je(e.target.value))},disabled:t,children:f.WJ.map((function(e){return(0,ct.jsx)("option",{value:e,children:""===e?"\u672a\u6307\u5b9a":e},e)}))})]})},$a=function(){var e=at((function(e){return e.spotlightFocusRid})),t=M(at((function(e){return e.soraContents.connectionStatus}))),n=nt();return(0,ct.jsxs)(bt.Z,{className:"form-inline",controlId:"spotlightFocusRid",children:[(0,ct.jsx)(jt.Z,{children:"spotlightFocusRid:"}),(0,ct.jsx)(Ft.Z,{value:e,onChange:function(e){h(e.target.value,f.I7)&&n(Le(e.target.value))},disabled:t,children:f.I7.map((function(e){return(0,ct.jsx)("option",{value:e,children:""===e?"\u672a\u6307\u5b9a":e},e)}))})]})},er=function(){var e=at((function(e){return e.spotlight})),t=M(at((function(e){return e.soraContents.connectionStatus}))),n=nt();return(0,ct.jsxs)(bt.Z,{className:"form-inline",controlId:"spotlight",children:[(0,ct.jsx)(jt.Z,{children:"spotlight:"}),(0,ct.jsx)(Ft.Z,{name:"spotlight",value:e,onChange:function(e){h(e.target.value,f.VJ)&&n(Ge(e.target.value))},disabled:t,children:f.VJ.map((function(e){return(0,ct.jsx)("option",{value:e,children:""===e?"\u672a\u6307\u5b9a":e},e)}))})]})},tr=function(){var e=at((function(e){return e.spotlightNumber})),t=M(at((function(e){return e.soraContents.connectionStatus}))),n=nt();return(0,ct.jsxs)(bt.Z,{className:"form-inline",controlId:"spotlightNumber",children:[(0,ct.jsx)(jt.Z,{children:"spotlightNumber:"}),(0,ct.jsx)(Ft.Z,{value:e,onChange:function(e){h(e.target.value,f.Xr)&&n(We(e.target.value))},disabled:t,children:f.Xr.map((function(e){return(0,ct.jsx)("option",{value:e,children:""===e?"\u672a\u6307\u5b9a":e},e)}))})]})},nr=function(){var e=at((function(e){return e.spotlightUnfocusRid})),t=M(at((function(e){return e.soraContents.connectionStatus}))),n=nt();return(0,ct.jsxs)(bt.Z,{className:"form-inline",controlId:"spotlightUnfocusRid",children:[(0,ct.jsx)(jt.Z,{children:"spotlightUnfocusRid:"}),(0,ct.jsx)(Ft.Z,{value:e,onChange:function(e){h(e.target.value,f.I7)&&n(Ke(e.target.value))},disabled:t,children:f.I7.map((function(e){return(0,ct.jsx)("option",{value:e,children:""===e?"\u672a\u6307\u5b9a":e},e)}))})]})},ar=function(){var e=at((function(e){return e.channelId})),t=at((function(e){return e.soraContents.connectionStatus})),n=at((function(e){return e.apiUrl})),a=nt(),r=function(){var t=(0,i.Z)(s().mark((function t(){var r;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Nn(n,e);case 3:r=t.sent,a($("POST successed. response: ".concat(JSON.stringify(r)))),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),t.t0 instanceof Error&&a(Y(t.t0.message));case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}();return(0,ct.jsx)("div",{className:"col-auto mb-1",children:(0,ct.jsx)("input",{className:"btn btn-secondary",type:"button",name:"startRec",defaultValue:"start rec",onClick:r,disabled:"initializing"===t})})},rr=function(){var e=at((function(e){return e.channelId})),t=at((function(e){return e.soraContents.connectionStatus})),n=at((function(e){return e.apiUrl})),a=nt(),r=function(){var t=(0,i.Z)(s().mark((function t(){var r;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,wn(n,e);case 3:r=t.sent,a($("POST successed. response: ".concat(JSON.stringify(r)))),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),t.t0 instanceof Error&&a(Y(t.t0.message));case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}();return(0,ct.jsx)("div",{className:"col-auto mb-1",children:(0,ct.jsx)("input",{className:"btn btn-secondary",type:"button",name:"stopRec",defaultValue:"stop rec",onClick:r,disabled:"initializing"===t})})},ir=function(){var e=nt();return(0,ct.jsx)("div",{className:"col-auto mb-1",children:(0,ct.jsx)("input",{className:"btn btn-outline-secondary",type:"button",name:"update-mediastream",defaultValue:"update-mediastream",onClick:function(){e(K())}})})},or=f.Q5.slice();or.splice(f.Q5.indexOf("15000")+1,0,"support-message");var sr=function(){var e=at((function(e){return e.videoBitRate})),t=M(at((function(e){return e.soraContents.connectionStatus}))),n=nt();return(0,ct.jsxs)(bt.Z,{className:"form-inline",controlId:"videoBitRate",children:[(0,ct.jsx)(jt.Z,{children:"videoBitRate:"}),(0,ct.jsx)(Ft.Z,{name:"videoBitRate",value:e,onChange:function(e){h(e.target.value,f.Q5)&&n(Xe(e.target.value))},disabled:t,children:or.map((function(e){var t=e;return""===e?t="\u672a\u6307\u5b9a":"support-message"===e&&(t="\u4ee5\u4e0b\u306f\u30b5\u30dd\u30fc\u30c8\u5916\u3067\u3059"),(0,ct.jsx)("option",{value:e,disabled:"support-message"===e,children:t},e)}))})]})},cr=function(){var e=at((function(e){return e.videoCodecType})),t=M(at((function(e){return e.soraContents.connectionStatus}))),n=nt();return(0,ct.jsxs)(bt.Z,{className:"form-inline",controlId:"videoCodecType",children:[(0,ct.jsx)(jt.Z,{children:"videoCodecType:"}),(0,ct.jsx)(Ft.Z,{name:"videoCodecType",value:e,onChange:function(e){h(e.target.value,f.Sh)&&n(Qe(e.target.value))},disabled:t,children:f.Sh.map((function(e){return(0,ct.jsx)("option",{value:e,children:""===e?"\u672a\u6307\u5b9a":e},e)}))})]})},ur=function(){var e=at((function(e){return e.videoContentHint})),t=nt();return(0,ct.jsxs)(bt.Z,{className:"form-inline",controlId:"videoContentHint",children:[(0,ct.jsx)(jt.Z,{children:"videoContentHint:"}),(0,ct.jsx)(Ft.Z,{name:"videoContentHint",value:e,onChange:function(e){h(e.target.value,f.QO)&&t(Ye(e.target.value))},children:f.QO.map((function(e){return(0,ct.jsx)("option",{value:e,children:""===e?"\u672a\u6307\u5b9a":e},e)}))})]})},lr=function(){var e=at((function(e){return e.video})),t=M(at((function(e){return e.soraContents.connectionStatus}))),n=nt();return(0,ct.jsx)(bt.Z,{className:"form-inline",controlId:"video",children:(0,ct.jsx)(fa.Z,{type:"switch",name:"video",label:"video",checked:e,onChange:function(e){n(qe(e.target.checked))},disabled:t})})},dr=function(){var e=at((function(e){return e.videoInput})),t=at((function(e){return e.videoInputDevices})),n=nt();return(0,ct.jsxs)(bt.Z,{className:"form-inline",controlId:"videoInput",children:[(0,ct.jsx)(jt.Z,{children:"videoInput:"}),(0,ct.jsxs)(Ft.Z,{name:"videoInput",value:e,onChange:function(e){n($e(e.target.value)),n(K())},disabled:0===t.length,children:[(0,ct.jsx)("option",{value:"",children:"\u672a\u6307\u5b9a"}),t.map((function(e){return(0,ct.jsx)("option",{value:e.deviceId,children:e.label},e.deviceId)}))]})]})},fr=function(){var e=at((function(e){return e.videoTrack})),t=nt();return(0,ct.jsx)(bt.Z,{className:"form-inline",controlId:"videoTrack",children:(0,ct.jsx)(fa.Z,{type:"switch",name:"videoTrack",label:"Enable video track",checked:e,onChange:function(e){t(et(e.target.checked))}})})},pr=function(){return(0,ct.jsxs)(ct.Fragment,{children:[(0,ct.jsx)(mn.Z,{className:"form-row",xs:"auto",children:(0,ct.jsx)(hn.Z,{children:(0,ct.jsx)(ya,{})})}),(0,ct.jsxs)(mn.Z,{className:"form-row",xs:"auto",children:[(0,ct.jsx)(hn.Z,{children:(0,ct.jsx)(Ka,{})}),(0,ct.jsx)(hn.Z,{children:(0,ct.jsx)(_a,{})}),(0,ct.jsx)(hn.Z,{children:(0,ct.jsx)(Qa,{})}),(0,ct.jsx)(hn.Z,{children:(0,ct.jsx)(er,{})})]})]})},mr=function(){return(0,ct.jsxs)(ct.Fragment,{children:[(0,ct.jsxs)(mn.Z,{className:"form-row",xs:"auto",children:[(0,ct.jsx)(hn.Z,{children:(0,ct.jsx)(pa,{})}),(0,ct.jsx)(hn.Z,{children:(0,ct.jsx)(la,{})}),(0,ct.jsx)(hn.Z,{children:(0,ct.jsx)(ua,{})})]}),(0,ct.jsxs)(mn.Z,{className:"form-row",xs:"auto",children:[(0,ct.jsx)(hn.Z,{children:(0,ct.jsx)(lr,{})}),(0,ct.jsx)(hn.Z,{children:(0,ct.jsx)(cr,{})}),(0,ct.jsx)(hn.Z,{children:(0,ct.jsx)(sr,{})})]})]})},hr=function(){return"true"!==at((function(e){return e.simulcast}))?null:(0,ct.jsx)(mn.Z,{className:"form-row",xs:"auto",children:(0,ct.jsx)(hn.Z,{children:(0,ct.jsx)(Ya,{})})})},gr=function(){return"true"!==at((function(e){return e.spotlight}))?null:(0,ct.jsxs)(mn.Z,{className:"form-row",xs:"auto",children:[(0,ct.jsx)(hn.Z,{children:(0,ct.jsx)(tr,{})}),(0,ct.jsx)(hn.Z,{children:(0,ct.jsx)($a,{})}),(0,ct.jsx)(hn.Z,{children:(0,ct.jsx)(nr,{})})]})},vr=function(){var e=(0,a.useState)(!0),t=e[0],n=e[1],r=[at((function(e){return e.e2ee})),at((function(e){return e.enabledBundleId})),at((function(e){return e.enabledClientId})),at((function(e){return e.enabledDataChannel})),at((function(e){return e.enabledDataChannels})),at((function(e){return e.enabledMetadata})),at((function(e){return e.enabledSignalingNotifyMetadata})),at((function(e){return e.enabledSignalingUrlCandidates})),at((function(e){return e.reconnect}))].some((function(e){return e})),i=["btn-collapse-options"];t&&i.push("collapsed"),r&&i.push("fw-bold");return(0,ct.jsxs)(mn.Z,{className:"form-row",children:[(0,ct.jsx)(hn.Z,{children:(0,ct.jsx)("a",{href:"#",className:i.join(" "),onClick:function(e){e.preventDefault(),n(!t)},children:"Signaling options"})}),(0,ct.jsx)(st.Z,{in:!t,children:(0,ct.jsxs)("div",{children:[(0,ct.jsx)(Ra,{}),(0,ct.jsx)(za,{}),(0,ct.jsx)(Ca,{}),(0,ct.jsx)(Fa,{}),(0,ct.jsx)(ba,{}),(0,ct.jsx)(qa,{}),(0,ct.jsx)(Xa,{}),(0,ct.jsx)(Ia,{}),(0,ct.jsx)(wa,{})]})})]})},xr=function(){return(0,ct.jsxs)(mn.Z,{xs:"auto",className:"form-row",children:[(0,ct.jsx)(hn.Z,{children:(0,ct.jsx)(Va,{})}),(0,ct.jsx)(hn.Z,{children:(0,ct.jsx)(Ea,{})})]})},br=function(){var e=(0,a.useState)(!0),t=e[0],n=e[1],r=[""!==at((function(e){return e.audioContentHint})),""!==at((function(e){return e.autoGainControl})),""!==at((function(e){return e.noiseSuppression})),""!==at((function(e){return e.echoCancellation})),""!==at((function(e){return e.echoCancellationType})),""!==at((function(e){return e.videoContentHint})),""!==at((function(e){return e.resolution})),""!==at((function(e){return e.frameRate})),""!==at((function(e){return e.blurRadius})),at((function(e){return e.mediaProcessorsNoiseSuppression}))].some((function(e){return e})),i=["btn-collapse-options"];t&&i.push("collapsed"),r&&i.push("fw-bold");return(0,ct.jsxs)(mn.Z,{className:"form-row",children:[(0,ct.jsx)(hn.Z,{children:(0,ct.jsx)("a",{href:"#",className:i.join(" "),onClick:function(e){e.preventDefault(),n(!t)},children:"Media options"})}),(0,ct.jsx)(st.Z,{in:!t,children:(0,ct.jsxs)("div",{children:[(0,ct.jsxs)(mn.Z,{className:"form-row",children:[(0,ct.jsx)(hn.Z,{className:"col-auto",children:(0,ct.jsx)(da,{})}),(0,ct.jsx)(hn.Z,{className:"col-auto",children:(0,ct.jsx)(va,{})}),(0,ct.jsx)(hn.Z,{className:"col-auto",children:(0,ct.jsx)(Ja,{})}),(0,ct.jsx)(hn.Z,{className:"col-auto",children:(0,ct.jsx)(Ma,{})}),(0,ct.jsx)(hn.Z,{className:"col-auto",children:(0,ct.jsx)(Da,{})}),(0,ct.jsx)(hn.Z,{className:"col-auto",children:(0,ct.jsx)(Ba,{})})]}),(0,ct.jsxs)(mn.Z,{className:"form-row",children:[(0,ct.jsx)(hn.Z,{className:"col-auto",children:(0,ct.jsx)(ur,{})}),(0,ct.jsx)(hn.Z,{className:"col-auto",children:(0,ct.jsx)(Wa,{})}),(0,ct.jsx)(hn.Z,{className:"col-auto",children:(0,ct.jsx)(Aa,{})}),(0,ct.jsx)(hn.Z,{className:"col-auto",children:(0,ct.jsx)(ca,{})}),(0,ct.jsx)(hn.Z,{className:"col-auto",children:(0,ct.jsx)(La,{})}),(0,ct.jsx)(hn.Z,{className:"col-auto",children:(0,ct.jsx)(xa,{})})]}),(0,ct.jsx)(ir,{})]})})]})},jr=function(){var e=at((function(e){return e.role}));return(0,ct.jsxs)(mn.Z,{className:"form-row",xs:"auto",children:["recvonly"!==e?(0,ct.jsxs)(ct.Fragment,{children:[(0,ct.jsx)(hn.Z,{children:(0,ct.jsx)(ma,{})}),(0,ct.jsx)(hn.Z,{children:(0,ct.jsx)(dr,{})})]}):null,(0,ct.jsx)(hn.Z,{children:(0,ct.jsx)(ha,{})}),(0,ct.jsx)(Ga,{})]})},yr=function(){var e=at((function(e){return e.role}));return(0,ct.jsxs)(mn.Z,{className:"form-row",xs:"auto",children:[(0,ct.jsx)(hn.Z,{children:(0,ct.jsx)(Ta,{})}),"recvonly"!==e?(0,ct.jsxs)(ct.Fragment,{children:[(0,ct.jsx)(hn.Z,{children:(0,ct.jsx)(Ha,{})}),(0,ct.jsx)(hn.Z,{children:(0,ct.jsx)(ja,{})}),(0,ct.jsx)(hn.Z,{children:(0,ct.jsx)(ga,{})}),(0,ct.jsx)(hn.Z,{children:(0,ct.jsx)(fr,{})})]}):null]})},Cr=function(){var e=at((function(e){return e.debug})),t=at((function(e){return e.role}));return(0,ct.jsxs)("div",{className:e?"col-devtools col-6":"col-devtools col-12",children:[(0,ct.jsx)(jn,{}),(0,ct.jsx)(pr,{}),(0,ct.jsx)(hr,{}),(0,ct.jsx)(gr,{}),(0,ct.jsx)("hr",{className:"hr-form"}),(0,ct.jsx)(mr,{}),(0,ct.jsx)(vr,{}),(0,ct.jsx)("hr",{className:"hr-form"}),"recvonly"!==t?(0,ct.jsxs)(ct.Fragment,{children:[(0,ct.jsx)(xr,{}),(0,ct.jsx)(br,{}),(0,ct.jsx)("hr",{className:"hr-form"})]}):null,(0,ct.jsx)(jr,{}),(0,ct.jsx)(yr,{}),(0,ct.jsx)("hr",{className:"hr-form"}),(0,ct.jsxs)("div",{className:"row",children:[(0,ct.jsx)(Sa,{}),(0,ct.jsx)(Za,{}),(0,ct.jsx)(ar,{}),(0,ct.jsx)(rr,{})]}),(0,ct.jsx)("hr",{className:"hr-form"}),(0,ct.jsx)(qn,{}),"recvonly"===t||"sendrecv"===t?(0,ct.jsx)(sa,{}):null]})},Sr=n(6592),kr=n(4607),Nr=function(){var e=at((function(e){return e.debug})),t=nt(),n=e?"btn btn-footer-debug-mode active":"btn btn-footer-debug-mode";return(0,ct.jsx)("div",{children:(0,ct.jsx)("button",{className:n,onClick:function(){t(he(!e))},children:"debug"})})},wr=function(){var e=at((function(e){return e.version}));return(0,ct.jsxs)("footer",{children:[(0,ct.jsxs)(Sr.Z,{variant:"dark",bg:"sora",expand:"md",fixed:"bottom",children:[(0,ct.jsx)(kr.Z,{className:"me-auto"}),(0,ct.jsx)(kr.Z,{children:(0,ct.jsxs)(Sr.Z.Collapse,{id:"navbar-collapse",children:[(0,ct.jsxs)("a",{href:"https://github.com/shiguredo/sora-devtools",className:"btn btn-outline-light m-1",children:["GitHub: shiguredo/sora-devtools: ",e]}),(0,ct.jsxs)("a",{href:"https://github.com/shiguredo/sora-js-sdk",className:"btn btn-outline-light m-1",children:["GitHub: shiguredo/sora-js-sdk: ",l.Z.version()]})]})})]}),(0,ct.jsx)(Nr,{})]})},Ir=n(9008),Zr=n.n(Ir),Tr=function(){return(0,ct.jsx)(Zr(),{children:(0,ct.jsx)("title",{children:"Sora DevTools"})})},Or=n(682),Rr=function(){var e=nt();return(0,ct.jsx)("input",{className:"btn btn-light btn-sm ms-1",type:"button",name:"copyUrl",defaultValue:"copy URL",onClick:function(){e((function(e,t){var n=t(),a={channelId:n.channelId,role:n.role,audio:n.audio,video:n.video,debug:n.debug,mediaType:"getUserMedia"!==n.mediaType?n.mediaType:void 0,audioBitRate:""!==n.audioBitRate?n.audioBitRate:void 0,audioCodecType:""!==n.audioCodecType?n.audioCodecType:void 0,videoBitRate:""!==n.videoBitRate?n.videoBitRate:void 0,videoCodecType:""!==n.videoCodecType?n.videoCodecType:void 0,audioContentHint:""!==n.audioContentHint?n.audioContentHint:void 0,autoGainControl:""!==n.autoGainControl?n.autoGainControl:void 0,noiseSuppression:""!==n.noiseSuppression?n.noiseSuppression:void 0,echoCancellation:""!==n.echoCancellation?n.echoCancellation:void 0,echoCancellationType:""!==n.echoCancellationType?n.echoCancellationType:void 0,videoContentHint:""!==n.videoContentHint?n.videoContentHint:void 0,resolution:""!==n.resolution?n.resolution:void 0,frameRate:""!==n.frameRate?n.frameRate:void 0,aspectRatio:""!==n.aspectRatio?n.aspectRatio:void 0,resizeMode:""!==n.resizeMode?n.resizeMode:void 0,blurRadius:""!==n.blurRadius?n.blurRadius:void 0,multistream:""!==n.multistream?n.multistream:void 0,simulcast:""!==n.simulcast?n.simulcast:void 0,simulcastRid:""!==n.simulcastRid?n.simulcastRid:void 0,spotlight:""!==n.spotlight?n.spotlight:void 0,spotlightNumber:""!==n.spotlightNumber?n.spotlightNumber:void 0,spotlightFocusRid:""!==n.spotlightFocusRid?n.spotlightFocusRid:void 0,spotlightUnfocusRid:""!==n.spotlightUnfocusRid?n.spotlightUnfocusRid:void 0,audioInput:""!==n.audioInput?n.audioInput:void 0,audioOutput:""!==n.audioOutput?n.audioOutput:void 0,videoInput:""!==n.videoInput?n.videoInput:void 0,displayResolution:""!==n.displayResolution?n.displayResolution:void 0,bundleId:""!==n.bundleId&&n.enabledBundleId?n.bundleId:void 0,clientId:""!==n.clientId&&n.enabledClientId?n.clientId:void 0,metadata:""!==n.metadata&&n.enabledMetadata?n.metadata:void 0,signalingNotifyMetadata:""!==n.signalingNotifyMetadata&&n.enabledSignalingNotifyMetadata?n.signalingNotifyMetadata:void 0,dataChannelSignaling:""!==n.dataChannelSignaling&&n.enabledDataChannel?n.dataChannelSignaling:void 0,ignoreDisconnectWebSocket:""!==n.ignoreDisconnectWebSocket&&n.enabledDataChannel?n.ignoreDisconnectWebSocket:void 0,dataChannels:""!==n.dataChannels&&n.enabledDataChannels?n.dataChannels:void 0,reconnect:!0===n.reconnect||void 0,e2ee:!0===n.e2ee||void 0,mediaProcessorsNoiseSuppression:!0===n.mediaProcessorsNoiseSuppression||void 0,micDevice:!1!==n.micDevice&&void 0,cameraDevice:!1===n.cameraDevice||void 0,audioTrack:!1===n.audioTrack||void 0,videoTrack:!1!==n.videoTrack&&void 0,signalingUrlCandidates:0<n.signalingUrlCandidates.length&&n.enabledSignalingUrlCandidates?n.signalingUrlCandidates:void 0,apiUrl:null!==n.apiUrl?n.apiUrl:void 0,fakeVolume:"fakeMedia"===n.mediaType?n.fakeVolume:void 0},r=Object.keys(a).map((function(e){var t=a[e];if(void 0!==t)return"signalingUrlCandidates"===e?"".concat(e,"=").concat(encodeURIComponent(JSON.stringify(t))):"".concat(e,"=").concat(encodeURIComponent(t))})).filter((function(e){return void 0!==e}));m("".concat(location.origin).concat(location.pathname,"?").concat(r.join("&")))}))}})},Mr=function(){var e=at((function(e){return e.debug})),t=nt(),n=["btn","btn-header-debug-mode","btn-sm","ms-1"];return e&&n.push("active"),(0,ct.jsx)("input",{className:n.join(" "),type:"button",name:"debug",defaultValue:"debug",onClick:function(){t(he(!e))}})},Dr=n(8218);function Pr(){var e=Dr.h.getState(),t={aspectRatio:e.aspectRatio,audio:e.audio,audioBitRate:e.audioBitRate,audioCodecType:e.audioCodecType,audioContentHint:e.audioContentHint,audioInput:e.audioInput,audioInputDevices:e.audioInputDevices,audioOutput:e.audioOutput,audioOutputDevices:e.audioOutputDevices,autoGainControl:e.autoGainControl,bundleId:e.bundleId,clientId:e.clientId,channelId:e.channelId,googCpuOveruseDetection:e.googCpuOveruseDetection,debug:e.debug,dataChannelSignaling:e.dataChannelSignaling,dataChannels:e.dataChannels,displayResolution:e.displayResolution,e2ee:e.e2ee,echoCancellation:e.echoCancellation,echoCancellationType:e.echoCancellationType,enabledBundleId:e.enabledBundleId,enabledClientId:e.enabledClientId,enabledDataChannel:e.enabledDataChannel,enabledDataChannels:e.enabledDataChannels,enabledMetadata:e.enabledMetadata,enabledSignalingNotifyMetadata:e.enabledSignalingNotifyMetadata,enabledSignalingUrlCandidates:e.enabledSignalingUrlCandidates,fakeVolume:e.fakeVolume,frameRate:e.frameRate,ignoreDisconnectWebSocket:e.ignoreDisconnectWebSocket,mediaType:e.mediaType,metadata:e.metadata,multistream:e.multistream,noiseSuppression:e.noiseSuppression,reconnect:e.reconnect,resizeMode:e.resizeMode,resolution:e.resolution,simulcast:e.simulcast,spotlight:e.spotlight,signalingNotifyMetadata:e.signalingNotifyMetadata,signalingUrlCandidates:e.signalingUrlCandidates,simulcastRid:e.simulcastRid,spotlightNumber:e.spotlightNumber,spotlightFocusRid:e.spotlightFocusRid,spotlightUnfocusRid:e.spotlightUnfocusRid,video:e.video,videoBitRate:e.videoBitRate,videoCodecType:e.videoCodecType,videoContentHint:e.videoContentHint,videoInput:e.videoInput,videoInputDevices:e.videoInputDevices,cameraDevice:e.cameraDevice,videoTrack:e.videoTrack,micDevice:e.micDevice,audioTrack:e.audioTrack,role:e.role};return{userAgent:navigator.userAgent,"sora-devtools":e.version,"sora-js-sdk":l.Z.version(),parameters:t,timeline:e.timelineMessages.map((function(e){return{timestamp:e.timestamp,message:e}})),notify:e.notifyMessages,stats:e.soraContents.statsReport}}var Er=function(){var e=(0,a.useRef)(null),t=function(){var t=(0,i.Z)(s().mark((function t(){var n,a,r,i;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=Pr(),a=JSON.stringify(n),r=new Blob([a],{type:"text/plain"}),window.URL=window.URL||window.webkitURL,e.current&&(i=(new Date).toISOString().replaceAll(":","_").replaceAll(".","_"),e.current.download="sora-devtools-report-".concat(i,".json"),e.current.href=window.URL.createObjectURL(r),e.current.click());case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return(0,ct.jsxs)(ct.Fragment,{children:[(0,ct.jsx)("input",{className:"btn btn-light btn-sm ms-1",type:"button",name:"downloadReport",defaultValue:"Download report",onClick:t}),(0,ct.jsx)("a",{ref:e,style:{display:"none"}})]})},Ar=function(){var e=at((function(e){return e.soraContents.sora}));return(0,ct.jsx)("header",{children:(0,ct.jsx)(Sr.Z,{variant:"dark",bg:"sora",expand:"md",fixed:"top",children:(0,ct.jsxs)(Or.Z,{children:[(0,ct.jsx)(Sr.Z.Brand,{href:"/",children:"Sora DevTools"}),(0,ct.jsx)(Sr.Z.Toggle,{"aria-controls":"navbar-collapse"}),(0,ct.jsxs)(Sr.Z.Collapse,{id:"navbar-collapse",children:[(0,ct.jsx)(kr.Z,{className:"me-auto"}),(0,ct.jsxs)(kr.Z,{children:[(0,ct.jsx)(Sr.Z.Text,{className:"py-0 my-1 mx-1",children:(0,ct.jsx)("p",{className:"navbar-signaling-url border rounded",children:e?e.connectedSignalingUrl:"\u672a\u63a5\u7d9a"})}),(0,ct.jsx)(Sr.Z.Text,{className:"py-0 my-1 mx-1",children:(0,ct.jsx)(Mr,{})}),(0,ct.jsx)(Sr.Z.Text,{className:"py-0 my-1 mx-1",children:(0,ct.jsx)(Er,{})}),(0,ct.jsx)(Sr.Z.Text,{className:"py-0 my-1 ms-1",children:(0,ct.jsx)(Rr,{})})]})]})]})})})},Br=function(){var e=nt();return(0,a.useEffect)((function(){return e(function(){var e=(0,i.Z)(s().mark((function e(t,n){var a,r,i,o,c,u,d,f,p,m,h,v,x,b,j,y;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(E.t.actions.resetState()),void 0!==(a=g()).audio&&t(E.t.actions.setAudio(a.audio)),void 0!==a.audioBitRate&&t(E.t.actions.setAudioBitRate(a.audioBitRate)),void 0!==a.audioCodecType&&t(E.t.actions.setAudioCodecType(a.audioCodecType)),e.next=7,O();case 7:if(r=e.sent,void 0!==(i=r.find((function(e){return"audioinput"===e.kind&&e.deviceId===a.audioInput})))&&t(E.t.actions.setAudioInput(i.deviceId)),void 0!==(o=r.find((function(e){return"audiooutput"===e.kind&&e.deviceId===a.audioOutput})))&&t(E.t.actions.setAudioOutput(o.deviceId)),void 0!==(c=r.find((function(e){return"videoinput"===e.kind&&e.deviceId===a.videoInput})))&&t(E.t.actions.setVideoInput(c.deviceId)),void 0!==a.autoGainControl&&t(E.t.actions.setAutoGainControl(a.autoGainControl)),void 0!==a.channelId&&t(E.t.actions.setChannelId(a.channelId)),void 0!==a.displayResolution&&t(E.t.actions.setDisplayResolution(a.displayResolution)),void 0!==a.e2ee&&t(E.t.actions.setE2EE(a.e2ee)),void 0!==a.echoCancellation&&t(E.t.actions.setEchoCancellation(a.echoCancellation)),void 0!==a.echoCancellationType&&t(E.t.actions.setEchoCancellationType(a.echoCancellationType)),void 0!==a.mediaType&&t(E.t.actions.setMediaType(a.mediaType)),void 0!==a.fakeVolume&&t(E.t.actions.setFakeVolume(a.fakeVolume)),void 0!==a.frameRate&&t(E.t.actions.setFrameRate(a.frameRate)),void 0!==a.multistream&&t(E.t.actions.setMultistream(a.multistream)),void 0!==a.noiseSuppression&&t(E.t.actions.setNoiseSuppression(a.noiseSuppression)),void 0!==a.resolution&&t(E.t.actions.setResolution(a.resolution)),void 0!==a.showStats&&t(E.t.actions.setShowStats(a.showStats)),void 0!==a.simulcast&&t(E.t.actions.setSimulcast(a.simulcast)),void 0!==a.simulcastRid&&t(E.t.actions.setSimulcastRid(a.simulcastRid)),void 0!==a.spotlight&&t(E.t.actions.setSpotlight(a.spotlight)),void 0!==a.spotlightNumber&&t(E.t.actions.setSpotlightNumber(a.spotlightNumber)),void 0!==a.spotlightFocusRid&&t(E.t.actions.setSpotlightFocusRid(a.spotlightFocusRid)),void 0!==a.spotlightUnfocusRid&&t(E.t.actions.setSpotlightUnfocusRid(a.spotlightUnfocusRid)),void 0!==a.video&&t(E.t.actions.setVideo(a.video)),void 0!==a.videoBitRate&&t(E.t.actions.setVideoBitRate(a.videoBitRate)),void 0!==a.videoCodecType?t(E.t.actions.setVideoCodecType(a.videoCodecType)):t(E.t.actions.setVideoCodecType(T())),void 0!==a.debug&&t(E.t.actions.setDebug(a.debug)),void 0!==a.debugType&&t(E.t.actions.setDebugType(a.debugType)),void 0!==a.mute&&t(E.t.actions.setMute(a.mute)),void 0!==a.dataChannelSignaling&&t(E.t.actions.setDataChannelSignaling(a.dataChannelSignaling)),void 0!==a.ignoreDisconnectWebSocket&&t(E.t.actions.setIgnoreDisconnectWebSocket(a.ignoreDisconnectWebSocket)),void 0!==a.micDevice&&t(E.t.actions.setMicDevice(a.micDevice)),void 0!==a.cameraDevice&&t(E.t.actions.setCameraDevice(a.cameraDevice)),void 0!==a.audioTrack&&t(E.t.actions.setAudioTrack(a.audioTrack)),void 0!==a.videoTrack&&t(E.t.actions.setVideoTrack(a.videoTrack)),void 0!==a.googCpuOveruseDetection&&null!==a.googCpuOveruseDetection&&t(E.t.actions.setGoogCpuOveruseDetection(a.googCpuOveruseDetection)),void 0!==a.bundleId&&t(E.t.actions.setBundleId(a.bundleId)),void 0!==a.clientId&&t(E.t.actions.setClientId(a.clientId)),void 0!==a.metadata&&t(E.t.actions.setMetadata(a.metadata)),void 0!==a.signalingNotifyMetadata&&t(E.t.actions.setSignalingNotifyMetadata(a.signalingNotifyMetadata)),void 0!==a.signalingUrlCandidates&&t(E.t.actions.setSignalingUrlCandidates(a.signalingUrlCandidates)),void 0!==a.dataChannels&&t(E.t.actions.setDataChannels(a.dataChannels)),void 0!==a.audioContentHint&&t(E.t.actions.setAudioContentHint(a.audioContentHint)),void 0!==a.videoContentHint&&t(E.t.actions.setVideoContentHint(a.videoContentHint)),void 0!==a.reconnect&&t(E.t.actions.setReconnect(a.reconnect)),void 0!==a.aspectRatio&&t(E.t.actions.setAspectRatio(a.aspectRatio)),void 0!==a.resizeMode&&t(E.t.actions.setResizeMode(a.resizeMode)),void 0!==a.blurRadius&&t(E.t.actions.setBlurRadius(a.blurRadius)),void 0!==a.mediaProcessorsNoiseSuppression&&t(E.t.actions.setMediaProcessorsNoiseSuppression(a.mediaProcessorsNoiseSuppression)),void 0!==a.apiUrl&&null!==a.apiUrl&&t(E.t.actions.setApiUrl(a.apiUrl)),void 0!==a.role&&t(E.t.actions.setRole(a.role)),t(E.t.actions.setInitialFakeContents()),u=n(),d=u.bundleId,f=u.clientId,p=u.dataChannels,m=u.dataChannelSignaling,h=u.e2ee,v=u.ignoreDisconnectWebSocket,x=u.metadata,b=u.signalingNotifyMetadata,j=u.signalingUrlCandidates,!h){e.next=77;break}y="Faild to execute WebAssembly '".concat("https://sora-e2ee-wasm.shiguredo.jp/2020.2/wasm.wasm","'."),e.next=68;break;case 68:return e.prev=68,e.next=71,l.Z.initE2EE("https://sora-e2ee-wasm.shiguredo.jp/2020.2/wasm.wasm");case 71:e.next=77;break;case 73:return e.prev=73,e.t0=e.catch(68),t(E.t.actions.setSoraErrorAlertMessage(y)),e.abrupt("return");case 77:""!==d&&t(E.t.actions.setEnabledBundleId(!0)),""!==f&&t(E.t.actions.setEnabledClientId(!0)),""!==x&&t(E.t.actions.setEnabledMetadata(!0)),""!==b&&t(E.t.actions.setEnabledSignalingNotifyMetadata(!0)),0<j.length&&t(E.t.actions.setEnabledSignalingUrlCandidates(!0)),""===m&&""===v||t(E.t.actions.setEnabledDataChannel(!0)),""!==p&&t(E.t.actions.setEnabledDataChannels(!0)),t(E.t.actions.setSoraConnectionStatus("disconnected"));case 85:case"end":return e.stop()}}),e,null,[[68,73]])})));return function(t,n){return e.apply(this,arguments)}}()),e(W()),function(){e(L())}}),[]),(0,ct.jsxs)(ct.Fragment,{children:[(0,ct.jsx)(Tr,{}),(0,ct.jsx)(Ar,{}),(0,ct.jsx)("main",{role:"main",children:(0,ct.jsx)("div",{className:"container",children:(0,ct.jsxs)("div",{className:"row",children:[(0,ct.jsx)(Cr,{}),(0,ct.jsx)(pn,{})]})})}),(0,ct.jsx)(wr,{})]})}},7478:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/devtools",function(){return n(2230)}])}},function(e){e.O(0,[716,962,120,774,888,179],(function(){return t=7478,e(e.s=t);var t}));var t=e.O();_N_E=t}]);