(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[888],{5295:function(e,t,n){"use strict";function i(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];throw Error("[Immer] minified error nr: "+e+(n.length?" "+n.map((function(e){return"'"+e+"'"})).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function o(e){return!!e&&!!e[Y]}function r(e){return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;var n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object||"function"==typeof n&&Function.toString.call(n)===Q}(e)||Array.isArray(e)||!!e[H]||!!e.constructor[H]||g(e)||f(e))}function a(e,t,n){void 0===n&&(n=!1),0===s(e)?(n?Object.keys:J)(e).forEach((function(i){n&&"symbol"==typeof i||t(i,e[i],e)})):e.forEach((function(n,i){return t(i,n,e)}))}function s(e){var t=e[Y];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:g(e)?2:f(e)?3:0}function c(e,t){return 2===s(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function l(e,t){return 2===s(e)?e.get(t):e[t]}function u(e,t,n){var i=s(e);2===i?e.set(t,n):3===i?(e.delete(t),e.add(n)):e[t]=n}function d(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function g(e){return G&&e instanceof Map}function f(e){return X&&e instanceof Set}function p(e){return e.o||e.t}function h(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=K(e);delete t[Y];for(var n=J(t),i=0;i<n.length;i++){var o=n[i],r=t[o];!1===r.writable&&(r.writable=!0,r.configurable=!0),(r.get||r.set)&&(t[o]={configurable:!0,writable:!0,enumerable:r.enumerable,value:e[o]})}return Object.create(Object.getPrototypeOf(e),t)}function m(e,t){return void 0===t&&(t=!1),C(e)||o(e)||!r(e)||(s(e)>1&&(e.set=e.add=e.clear=e.delete=y),Object.freeze(e),t&&a(e,(function(e,t){return m(t,!0)}),!0)),e}function y(){i(2)}function C(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function b(e){var t=z[e];return t||i(18,e),t}function v(e,t){z[e]||(z[e]=t)}function w(){return W}function I(e,t){t&&(b("Patches"),e.u=[],e.s=[],e.v=t)}function S(e){O(e),e.p.forEach(A),e.p=null}function O(e){e===W&&(W=e.l)}function E(e){return W={p:[],l:W,h:e,m:!0,_:0}}function A(e){var t=e[Y];0===t.i||1===t.i?t.j():t.O=!0}function T(e,t){t._=t.p.length;var n=t.p[0],o=void 0!==e&&e!==n;return t.h.g||b("ES5").S(t,e,o),o?(n[Y].P&&(S(t),i(4)),r(e)&&(e=R(t,e),t.l||k(t,e)),t.u&&b("Patches").M(n[Y].t,e,t.u,t.s)):e=R(t,n,[]),S(t),t.u&&t.v(t.u,t.s),e!==L?e:void 0}function R(e,t,n){if(C(t))return t;var i=t[Y];if(!i)return a(t,(function(o,r){return D(e,i,t,o,r,n)}),!0),t;if(i.A!==e)return t;if(!i.P)return k(e,i.t,!0),i.t;if(!i.I){i.I=!0,i.A._--;var o=4===i.i||5===i.i?i.o=h(i.k):i.o;a(3===i.i?new Set(o):o,(function(t,r){return D(e,i,o,t,r,n)})),k(e,o,!1),n&&e.u&&b("Patches").R(i,n,e.u,e.s)}return i.o}function D(e,t,n,i,a,s){if(o(a)){var l=R(e,a,s&&t&&3!==t.i&&!c(t.D,i)?s.concat(i):void 0);if(u(n,i,l),!o(l))return;e.m=!1}if(r(a)&&!C(a)){if(!e.h.F&&e._<1)return;R(e,a),t&&t.A.l||k(e,a)}}function k(e,t,n){void 0===n&&(n=!1),e.h.F&&e.m&&m(t,n)}function M(e,t){var n=e[Y];return(n?p(n):e)[t]}function P(e,t){if(t in e)for(var n=Object.getPrototypeOf(e);n;){var i=Object.getOwnPropertyDescriptor(n,t);if(i)return i;n=Object.getPrototypeOf(n)}}function _(e){e.P||(e.P=!0,e.l&&_(e.l))}function Z(e){e.o||(e.o=h(e.t))}function F(e,t,n){var i=g(t)?b("MapSet").N(t,n):f(t)?b("MapSet").T(t,n):e.g?function(e,t){var n=Array.isArray(e),i={i:n?1:0,A:t?t.A:w(),P:!1,I:!1,D:{},l:t,t:e,k:null,o:null,j:null,C:!1},o=i,r=$;n&&(o=[i],r=q);var a=Proxy.revocable(o,r),s=a.revoke,c=a.proxy;return i.k=c,i.j=s,c}(t,n):b("ES5").J(t,n);return(n?n.A:w()).p.push(i),i}function N(e){return o(e)||i(22,e),function e(t){if(!r(t))return t;var n,i=t[Y],o=s(t);if(i){if(!i.P&&(i.i<4||!b("ES5").K(i)))return i.t;i.I=!0,n=V(t,o),i.I=!1}else n=V(t,o);return a(n,(function(t,o){i&&l(i.t,t)===o||u(n,t,e(o))})),3===o?new Set(n):n}(e)}function V(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return h(e)}function x(){function e(e,t){var n=r[e];return n?n.enumerable=t:r[e]=n={configurable:!0,enumerable:t,get:function(){var t=this[Y];return $.get(t,e)},set:function(t){var n=this[Y];$.set(n,e,t)}},n}function t(e){for(var t=e.length-1;t>=0;t--){var o=e[t][Y];if(!o.P)switch(o.i){case 5:i(o)&&_(o);break;case 4:n(o)&&_(o)}}}function n(e){for(var t=e.t,n=e.k,i=J(n),o=i.length-1;o>=0;o--){var r=i[o];if(r!==Y){var a=t[r];if(void 0===a&&!c(t,r))return!0;var s=n[r],l=s&&s[Y];if(l?l.t!==a:!d(s,a))return!0}}var u=!!t[Y];return i.length!==J(t).length+(u?0:1)}function i(e){var t=e.k;if(t.length!==e.t.length)return!0;var n=Object.getOwnPropertyDescriptor(t,t.length-1);if(n&&!n.get)return!0;for(var i=0;i<t.length;i++)if(!t.hasOwnProperty(i))return!0;return!1}var r={};v("ES5",{J:function(t,n){var i=Array.isArray(t),o=function(t,n){if(t){for(var i=Array(n.length),o=0;o<n.length;o++)Object.defineProperty(i,""+o,e(o,!0));return i}var r=K(n);delete r[Y];for(var a=J(r),s=0;s<a.length;s++){var c=a[s];r[c]=e(c,t||!!r[c].enumerable)}return Object.create(Object.getPrototypeOf(n),r)}(i,t),r={i:i?5:4,A:n?n.A:w(),P:!1,I:!1,D:{},l:n,t:t,k:o,o:null,O:!1,C:!1};return Object.defineProperty(o,Y,{value:r,writable:!0}),o},S:function(e,n,r){r?o(n)&&n[Y].A===e&&t(e.p):(e.u&&function e(t){if(t&&"object"==typeof t){var n=t[Y];if(n){var o=n.t,r=n.k,s=n.D,l=n.i;if(4===l)a(r,(function(t){t!==Y&&(void 0!==o[t]||c(o,t)?s[t]||e(r[t]):(s[t]=!0,_(n)))})),a(o,(function(e){void 0!==r[e]||c(r,e)||(s[e]=!1,_(n))}));else if(5===l){if(i(n)&&(_(n),s.length=!0),r.length<o.length)for(var u=r.length;u<o.length;u++)s[u]=!1;else for(var d=o.length;d<r.length;d++)s[d]=!0;for(var g=Math.min(r.length,o.length),f=0;f<g;f++)r.hasOwnProperty(f)||(s[f]=!0),void 0===s[f]&&e(r[f])}}}}(e.p[0]),t(e.p))},K:function(e){return 4===e.i?n(e):i(e)}})}n.d(t,{xC:function(){return ke},oM:function(){return _e}});var j,W,U="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),G="undefined"!=typeof Map,X="undefined"!=typeof Set,B="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,L=U?Symbol.for("immer-nothing"):((j={})["immer-nothing"]=!0,j),H=U?Symbol.for("immer-draftable"):"__$immer_draftable",Y=U?Symbol.for("immer-state"):"__$immer_state",Q=("undefined"!=typeof Symbol&&Symbol.iterator,""+Object.prototype.constructor),J="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,K=Object.getOwnPropertyDescriptors||function(e){var t={};return J(e).forEach((function(n){t[n]=Object.getOwnPropertyDescriptor(e,n)})),t},z={},$={get:function(e,t){if(t===Y)return e;var n=p(e);if(!c(n,t))return function(e,t,n){var i,o=P(t,n);return o?"value"in o?o.value:null===(i=o.get)||void 0===i?void 0:i.call(e.k):void 0}(e,n,t);var i=n[t];return e.I||!r(i)?i:i===M(e.t,t)?(Z(e),e.o[t]=F(e.A.h,i,e)):i},has:function(e,t){return t in p(e)},ownKeys:function(e){return Reflect.ownKeys(p(e))},set:function(e,t,n){var i=P(p(e),t);if(null==i?void 0:i.set)return i.set.call(e.k,n),!0;if(!e.P){var o=M(p(e),t),r=null==o?void 0:o[Y];if(r&&r.t===n)return e.o[t]=n,e.D[t]=!1,!0;if(d(n,o)&&(void 0!==n||c(e.t,t)))return!0;Z(e),_(e)}return e.o[t]===n&&"number"!=typeof n&&(void 0!==n||t in e.o)||(e.o[t]=n,e.D[t]=!0,!0)},deleteProperty:function(e,t){return void 0!==M(e.t,t)||t in e.t?(e.D[t]=!1,Z(e),_(e)):delete e.D[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var n=p(e),i=Reflect.getOwnPropertyDescriptor(n,t);return i?{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:i.enumerable,value:n[t]}:i},defineProperty:function(){i(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){i(12)}},q={};a($,(function(e,t){q[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),q.deleteProperty=function(e,t){return q.set.call(this,e,t,void 0)},q.set=function(e,t,n){return $.set.call(this,e[0],t,n,e[0])};var ee=new(function(){function e(e){var t=this;this.g=B,this.F=!0,this.produce=function(e,n,o){if("function"==typeof e&&"function"!=typeof n){var a=n;n=e;var s=t;return function(e){var t=this;void 0===e&&(e=a);for(var i=arguments.length,o=Array(i>1?i-1:0),r=1;r<i;r++)o[r-1]=arguments[r];return s.produce(e,(function(e){var i;return(i=n).call.apply(i,[t,e].concat(o))}))}}var c;if("function"!=typeof n&&i(6),void 0!==o&&"function"!=typeof o&&i(7),r(e)){var l=E(t),u=F(t,e,void 0),d=!0;try{c=n(u),d=!1}finally{d?S(l):O(l)}return"undefined"!=typeof Promise&&c instanceof Promise?c.then((function(e){return I(l,o),T(e,l)}),(function(e){throw S(l),e})):(I(l,o),T(c,l))}if(!e||"object"!=typeof e){if(void 0===(c=n(e))&&(c=e),c===L&&(c=void 0),t.F&&m(c,!0),o){var g=[],f=[];b("Patches").M(e,c,g,f),o(g,f)}return c}i(21,e)},this.produceWithPatches=function(e,n){if("function"==typeof e)return function(n){for(var i=arguments.length,o=Array(i>1?i-1:0),r=1;r<i;r++)o[r-1]=arguments[r];return t.produceWithPatches(n,(function(t){return e.apply(void 0,[t].concat(o))}))};var i,o,r=t.produce(e,n,(function(e,t){i=e,o=t}));return"undefined"!=typeof Promise&&r instanceof Promise?r.then((function(e){return[e,i,o]})):[r,i,o]},"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze)}var t=e.prototype;return t.createDraft=function(e){r(e)||i(8),o(e)&&(e=N(e));var t=E(this),n=F(this,e,void 0);return n[Y].C=!0,O(t),n},t.finishDraft=function(e,t){var n=(e&&e[Y]).A;return I(n,t),T(void 0,n)},t.setAutoFreeze=function(e){this.F=e},t.setUseProxies=function(e){e&&!B&&i(20),this.g=e},t.applyPatches=function(e,t){var n;for(n=t.length-1;n>=0;n--){var i=t[n];if(0===i.path.length&&"replace"===i.op){e=i.value;break}}n>-1&&(t=t.slice(n+1));var r=b("Patches").$;return o(e)?r(e,t):this.produce(e,(function(e){return r(e,t)}))},e}()),te=ee.produce,ne=(ee.produceWithPatches.bind(ee),ee.setAutoFreeze.bind(ee),ee.setUseProxies.bind(ee),ee.applyPatches.bind(ee),ee.createDraft.bind(ee),ee.finishDraft.bind(ee),te);function ie(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function oe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(n),!0).forEach((function(t){ie(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ae(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var se="function"===typeof Symbol&&Symbol.observable||"@@observable",ce=function(){return Math.random().toString(36).substring(7).split("").join(".")},le={INIT:"@@redux/INIT"+ce(),REPLACE:"@@redux/REPLACE"+ce(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+ce()}};function ue(e){if("object"!==typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function de(e,t,n){var i;if("function"===typeof t&&"function"===typeof n||"function"===typeof n&&"function"===typeof arguments[3])throw new Error(ae(0));if("function"===typeof t&&"undefined"===typeof n&&(n=t,t=void 0),"undefined"!==typeof n){if("function"!==typeof n)throw new Error(ae(1));return n(de)(e,t)}if("function"!==typeof e)throw new Error(ae(2));var o=e,r=t,a=[],s=a,c=!1;function l(){s===a&&(s=a.slice())}function u(){if(c)throw new Error(ae(3));return r}function d(e){if("function"!==typeof e)throw new Error(ae(4));if(c)throw new Error(ae(5));var t=!0;return l(),s.push(e),function(){if(t){if(c)throw new Error(ae(6));t=!1,l();var n=s.indexOf(e);s.splice(n,1),a=null}}}function g(e){if(!ue(e))throw new Error(ae(7));if("undefined"===typeof e.type)throw new Error(ae(8));if(c)throw new Error(ae(9));try{c=!0,r=o(r,e)}finally{c=!1}for(var t=a=s,n=0;n<t.length;n++){(0,t[n])()}return e}function f(e){if("function"!==typeof e)throw new Error(ae(10));o=e,g({type:le.REPLACE})}function p(){var e,t=d;return(e={subscribe:function(e){if("object"!==typeof e||null===e)throw new Error(ae(11));function n(){e.next&&e.next(u())}return n(),{unsubscribe:t(n)}}})[se]=function(){return this},e}return g({type:le.INIT}),(i={dispatch:g,subscribe:d,getState:u,replaceReducer:f})[se]=p,i}function ge(e){for(var t=Object.keys(e),n={},i=0;i<t.length;i++){var o=t[i];0,"function"===typeof e[o]&&(n[o]=e[o])}var r,a=Object.keys(n);try{!function(e){Object.keys(e).forEach((function(t){var n=e[t];if("undefined"===typeof n(void 0,{type:le.INIT}))throw new Error(ae(12));if("undefined"===typeof n(void 0,{type:le.PROBE_UNKNOWN_ACTION()}))throw new Error(ae(13))}))}(n)}catch(s){r=s}return function(e,t){if(void 0===e&&(e={}),r)throw r;for(var i=!1,o={},s=0;s<a.length;s++){var c=a[s],l=n[c],u=e[c],d=l(u,t);if("undefined"===typeof d){t&&t.type;throw new Error(ae(14))}o[c]=d,i=i||d!==u}return(i=i||a.length!==Object.keys(e).length)?o:e}}function fe(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}function pe(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return function(){var n=e.apply(void 0,arguments),i=function(){throw new Error(ae(15))},o={getState:n.getState,dispatch:function(){return i.apply(void 0,arguments)}},r=t.map((function(e){return e(o)}));return i=fe.apply(void 0,r)(n.dispatch),re(re({},n),{},{dispatch:i})}}}function he(e){return function(t){var n=t.dispatch,i=t.getState;return function(t){return function(o){return"function"===typeof o?o(n,i,e):t(o)}}}}var me=he();me.withExtraArgument=he;var ye=me,Ce=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),be=function(e,t){for(var n=0,i=t.length,o=e.length;n<i;n++,o++)e[o]=t[n];return e},ve=Object.defineProperty,we=(Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols),Ie=Object.prototype.hasOwnProperty,Se=Object.prototype.propertyIsEnumerable,Oe=function(e,t,n){return t in e?ve(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n},Ee=function(e,t){for(var n in t||(t={}))Ie.call(t,n)&&Oe(e,n,t[n]);if(we)for(var i=0,o=we(t);i<o.length;i++){n=o[i];Se.call(t,n)&&Oe(e,n,t[n])}return e},Ae="undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(0!==arguments.length)return"object"===typeof arguments[0]?fe:fe.apply(null,arguments)};"undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__;function Te(e){if("object"!==typeof e||null===e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;for(var n=t;null!==Object.getPrototypeOf(n);)n=Object.getPrototypeOf(n);return t===n}var Re=function(e){function t(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var o=e.apply(this,n)||this;return Object.setPrototypeOf(o,t.prototype),o}return Ce(t,e),Object.defineProperty(t,Symbol.species,{get:function(){return t},enumerable:!1,configurable:!0}),t.prototype.concat=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.prototype.concat.apply(this,t)},t.prototype.prepend=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return 1===e.length&&Array.isArray(e[0])?new(t.bind.apply(t,be([void 0],e[0].concat(this)))):new(t.bind.apply(t,be([void 0],e.concat(this))))},t}(Array);function De(){return function(e){return function(e){void 0===e&&(e={});var t=e.thunk,n=void 0===t||t,i=(e.immutableCheck,e.serializableCheck,new Re);n&&(!function(e){return"boolean"===typeof e}(n)?i.push(ye.withExtraArgument(n.extraArgument)):i.push(ye));0;return i}(e)}}function ke(e){var t,n=De(),i=e||{},o=i.reducer,r=void 0===o?void 0:o,a=i.middleware,s=void 0===a?n():a,c=i.devTools,l=void 0===c||c,u=i.preloadedState,d=void 0===u?void 0:u,g=i.enhancers,f=void 0===g?void 0:g;if("function"===typeof r)t=r;else{if(!Te(r))throw new Error('"reducer" is a required argument, and must be a function or an object of functions that can be passed to combineReducers');t=ge(r)}var p=s;"function"===typeof p&&(p=p(n));var h=pe.apply(void 0,p),m=fe;l&&(m=Ae(Ee({trace:!1},"object"===typeof l&&l)));var y=[h];return Array.isArray(f)?y=be([h],f):"function"===typeof f&&(y=f(y)),de(t,d,m.apply(void 0,y))}function Me(e,t){function n(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];if(t){var o=t.apply(void 0,n);if(!o)throw new Error("prepareAction did not return an object");return Ee(Ee({type:e,payload:o.payload},"meta"in o&&{meta:o.meta}),"error"in o&&{error:o.error})}return{type:e,payload:n[0]}}return n.toString=function(){return""+e},n.type=e,n.match=function(t){return t.type===e},n}function Pe(e){var t,n={},i=[],o={addCase:function(e,t){var i="string"===typeof e?e:e.type;if(i in n)throw new Error("addCase cannot be called with two reducers for the same action type");return n[i]=t,o},addMatcher:function(e,t){return i.push({matcher:e,reducer:t}),o},addDefaultCase:function(e){return t=e,o}};return e(o),[n,i,t]}function _e(e){var t=e.name;if(!t)throw new Error("`name` is a required option for createSlice");var n,i="function"==typeof e.initialState?e.initialState:ne(e.initialState,(function(){})),a=e.reducers||{},s=Object.keys(a),c={},l={},u={};function d(){var t="function"===typeof e.extraReducers?Pe(e.extraReducers):[e.extraReducers],n=t[0],a=void 0===n?{}:n,s=t[1],c=void 0===s?[]:s,u=t[2],d=void 0===u?void 0:u,g=Ee(Ee({},a),l);return function(e,t,n,i){void 0===n&&(n=[]);var a,s="function"===typeof t?Pe(t):[t,n,i],c=s[0],l=s[1],u=s[2];if(function(e){return"function"===typeof e}(e))a=function(){return ne(e(),(function(){}))};else{var d=ne(e,(function(){}));a=function(){return d}}function g(e,t){void 0===e&&(e=a());var n=be([c[t.type]],l.filter((function(e){return(0,e.matcher)(t)})).map((function(e){return e.reducer})));return 0===n.filter((function(e){return!!e})).length&&(n=[u]),n.reduce((function(e,n){if(n){var i;if(o(e))return"undefined"===typeof(i=n(e,t))?e:i;if(r(e))return ne(e,(function(e){return n(e,t)}));if("undefined"===typeof(i=n(e,t))){if(null===e)return e;throw Error("A case reducer on a non-draftable value must not return undefined")}return i}return e}),e)}return g.getInitialState=a,g}(i,g,c,d)}return s.forEach((function(e){var n,i,o=a[e],r=t+"/"+e;"reducer"in o?(n=o.reducer,i=o.prepare):n=o,c[e]=n,l[r]=n,u[e]=i?Me(r,i):Me(r)})),{name:t,reducer:function(e,t){return n||(n=d()),n(e,t)},actions:u,caseReducers:c,getInitialState:function(){return n||(n=d()),n.getInitialState()}}}x()},4020:function(e){"use strict";var t="%[a-f0-9]{2}",n=new RegExp(t,"gi"),i=new RegExp("("+t+")+","gi");function o(e,t){try{return decodeURIComponent(e.join(""))}catch(r){}if(1===e.length)return e;t=t||1;var n=e.slice(0,t),i=e.slice(t);return Array.prototype.concat.call([],o(n),o(i))}function r(e){try{return decodeURIComponent(e)}catch(r){for(var t=e.match(n),i=1;i<t.length;i++)t=(e=o(t,i).join("")).match(n);return e}}e.exports=function(e){if("string"!==typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var n={"%FE%FF":"\ufffd\ufffd","%FF%FE":"\ufffd\ufffd"},o=i.exec(e);o;){try{n[o[0]]=decodeURIComponent(o[0])}catch(t){var a=r(o[0]);a!==o[0]&&(n[o[0]]=a)}o=i.exec(e)}n["%C2"]="\ufffd";for(var s=Object.keys(n),c=0;c<s.length;c++){var l=s[c];e=e.replace(new RegExp(l,"g"),n[l])}return e}(e)}}},2806:function(e){"use strict";e.exports=function(e,t){for(var n={},i=Object.keys(e),o=Array.isArray(t),r=0;r<i.length;r++){var a=i[r],s=e[a];(o?-1!==t.indexOf(a):t(a,s,e))&&(n[a]=s)}return n}},8679:function(e,t,n){"use strict";var i=n(9864),o={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},r={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},a={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s={};function c(e){return i.isMemo(e)?a:s[e.$$typeof]||o}s[i.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},s[i.Memo]=a;var l=Object.defineProperty,u=Object.getOwnPropertyNames,d=Object.getOwnPropertySymbols,g=Object.getOwnPropertyDescriptor,f=Object.getPrototypeOf,p=Object.prototype;e.exports=function e(t,n,i){if("string"!==typeof n){if(p){var o=f(n);o&&o!==p&&e(t,o,i)}var a=u(n);d&&(a=a.concat(d(n)));for(var s=c(t),h=c(n),m=0;m<a.length;++m){var y=a[m];if(!r[y]&&(!i||!i[y])&&(!h||!h[y])&&(!s||!s[y])){var C=g(n,y);try{l(t,y,C)}catch(b){}}}}return t}},9979:function(e,t,n){"use strict";n.d(t,{eO:function(){return Y},Yr:function(){return Z},Hi:function(){return L},b_:function(){return Q},E1:function(){return N},eX:function(){return F},I6:function(){return He},i8:function(){return J},du:function(){return K},EG:function(){return z},$p:function(){return $},VY:function(){return q},PQ:function(){return ee},mK:function(){return te},hS:function(){return ne},SV:function(){return ie},XP:function(){return oe},yn:function(){return re},bH:function(){return ae},gF:function(){return U},cA:function(){return se},Xk:function(){return ce},Gc:function(){return ue},bl:function(){return le},ew:function(){return de},eU:function(){return ge},pD:function(){return fe},I$:function(){return pe},c0:function(){return j},LN:function(){return he},lW:function(){return me},pv:function(){return ye},rY:function(){return be},VI:function(){return Ce},yq:function(){return ve},vq:function(){return we},Nd:function(){return Ie},eW:function(){return Se},co:function(){return Oe},b3:function(){return Ee},H_:function(){return X},pI:function(){return V},rv:function(){return Ae},y5:function(){return Te},yC:function(){return Re},vX:function(){return W},fj:function(){return De},sk:function(){return ke},P6:function(){return Me},Ik:function(){return Pe},H6:function(){return _e},l7:function(){return Ze},vM:function(){return Fe},XH:function(){return Ne},CV:function(){return Ve},TT:function(){return xe},qV:function(){return je},ge:function(){return We},as:function(){return Ue},h2:function(){return Ge},w6:function(){return Xe},lZ:function(){return Be},e_:function(){return Le},Lb:function(){return x}});var i=n(2640),o=n(29),r=n(7794),a=n.n(r),s=n(5295),c=n(3454);var l=(()=>{var e="file:///Users/yuitowest/Work/shiguredo/sora-devtools/node_modules/@shiguredo/noise-suppression/dist/noise_suppression.mjs";return function(t){t="undefined"!==typeof(t=t||{})?t:{};var i,o,r=Object.assign;t.ready=new Promise((function(e,t){i=e,o=t})),Object.getOwnPropertyDescriptor(t.ready,"_rnnoise_process_frame")||(Object.defineProperty(t.ready,"_rnnoise_process_frame",{configurable:!0,get:function(){L("You are getting _rnnoise_process_frame on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(t.ready,"_rnnoise_process_frame",{configurable:!0,set:function(){L("You are setting _rnnoise_process_frame on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(t.ready,"_rnnoise_destroy")||(Object.defineProperty(t.ready,"_rnnoise_destroy",{configurable:!0,get:function(){L("You are getting _rnnoise_destroy on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(t.ready,"_rnnoise_destroy",{configurable:!0,set:function(){L("You are setting _rnnoise_destroy on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(t.ready,"_rnnoise_create")||(Object.defineProperty(t.ready,"_rnnoise_create",{configurable:!0,get:function(){L("You are getting _rnnoise_create on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(t.ready,"_rnnoise_create",{configurable:!0,set:function(){L("You are setting _rnnoise_create on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(t.ready,"_rnnoise_get_frame_size")||(Object.defineProperty(t.ready,"_rnnoise_get_frame_size",{configurable:!0,get:function(){L("You are getting _rnnoise_get_frame_size on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(t.ready,"_rnnoise_get_frame_size",{configurable:!0,set:function(){L("You are setting _rnnoise_get_frame_size on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(t.ready,"_malloc")||(Object.defineProperty(t.ready,"_malloc",{configurable:!0,get:function(){L("You are getting _malloc on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(t.ready,"_malloc",{configurable:!0,set:function(){L("You are setting _malloc on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(t.ready,"_free")||(Object.defineProperty(t.ready,"_free",{configurable:!0,get:function(){L("You are getting _free on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(t.ready,"_free",{configurable:!0,set:function(){L("You are setting _free on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(t.ready,"_fflush")||(Object.defineProperty(t.ready,"_fflush",{configurable:!0,get:function(){L("You are getting _fflush on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(t.ready,"_fflush",{configurable:!0,set:function(){L("You are setting _fflush on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(t.ready,"onRuntimeInitialized")||(Object.defineProperty(t.ready,"onRuntimeInitialized",{configurable:!0,get:function(){L("You are getting onRuntimeInitialized on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(t.ready,"onRuntimeInitialized",{configurable:!0,set:function(){L("You are setting onRuntimeInitialized on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}));var a=r({},t),s="object"===typeof window,l="function"===typeof importScripts,u="object"===typeof c&&"object"===typeof c.versions&&"string"===typeof c.versions.node,d=!s&&!u&&!l;if(t.ENVIRONMENT)throw new Error("Module.ENVIRONMENT has been deprecated. To force the environment, use the ENVIRONMENT compile-time option (for example, -s ENVIRONMENT=web or -s ENVIRONMENT=node)");var g,f,p,h,m,y,C="";if(u){if("object"!==typeof c||"function"!==typeof require)throw new Error("not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)");C=l?require("path").dirname(C)+"/":__dirname+"/",y=function(){m||(h=require("fs"),m=require("path"))},g=function(e,t){return y(),e=m.normalize(e),h.readFileSync(e,t?null:"utf8")},p=function(e){var t=g(e,!0);return t.buffer||(t=new Uint8Array(t)),O(t.buffer),t},f=function(e,t,n){y(),e=m.normalize(e),h.readFile(e,(function(e,i){e?n(e):t(i.buffer)}))},c.argv.length>1&&c.argv[1].replace(/\\/g,"/"),c.argv.slice(2),c.on("uncaughtException",(function(e){if(!(e instanceof se))throw e})),c.on("unhandledRejection",(function(e){throw e})),t.inspect=function(){return"[Emscripten Module object]"}}else if(d){if("object"===typeof c&&"function"===typeof require||"object"===typeof window||"function"===typeof importScripts)throw new Error("not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)");"undefined"!=typeof read&&(g=function(e){return read(e)}),p=function(e){let t;return"function"===typeof readbuffer?new Uint8Array(readbuffer(e)):(t=read(e,"binary"),O("object"===typeof t),t)},f=function(e,t,n){setTimeout((()=>t(p(e))),0)},"undefined"!=typeof scriptArgs&&scriptArgs,"undefined"!==typeof print&&("undefined"===typeof console&&(console={}),console.log=print,console.warn=console.error="undefined"!==typeof printErr?printErr:print)}else{if(!s&&!l)throw new Error("environment detection error");if(l?C=self.location.href:"undefined"!==typeof document&&document.currentScript&&(C=document.currentScript.src),C=0!==(C=e).indexOf("blob:")?C.substr(0,C.replace(/[?#].*/,"").lastIndexOf("/")+1):"","object"!==typeof window&&"function"!==typeof importScripts)throw new Error("not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)");g=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},l&&(p=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),f=function(e,t,n){var i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="arraybuffer",i.onload=function(){200==i.status||0==i.status&&i.response?t(i.response):n()},i.onerror=n,i.send(null)}}t.print||console.log.bind(console);var b,v,w=t.printErr||console.warn.bind(console);function I(e){I.shown||(I.shown={}),I.shown[e]||(I.shown[e]=1,w(e))}r(t,a),a=null,t.arguments,Object.getOwnPropertyDescriptor(t,"arguments")||Object.defineProperty(t,"arguments",{configurable:!0,get:function(){L("Module.arguments has been replaced with plain arguments_ (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)")}}),t.thisProgram,Object.getOwnPropertyDescriptor(t,"thisProgram")||Object.defineProperty(t,"thisProgram",{configurable:!0,get:function(){L("Module.thisProgram has been replaced with plain thisProgram (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)")}}),t.quit,Object.getOwnPropertyDescriptor(t,"quit")||Object.defineProperty(t,"quit",{configurable:!0,get:function(){L("Module.quit has been replaced with plain quit_ (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)")}}),O("undefined"===typeof t.memoryInitializerPrefixURL,"Module.memoryInitializerPrefixURL option was removed, use Module.locateFile instead"),O("undefined"===typeof t.pthreadMainPrefixURL,"Module.pthreadMainPrefixURL option was removed, use Module.locateFile instead"),O("undefined"===typeof t.cdInitializerPrefixURL,"Module.cdInitializerPrefixURL option was removed, use Module.locateFile instead"),O("undefined"===typeof t.filePackagePrefixURL,"Module.filePackagePrefixURL option was removed, use Module.locateFile instead"),O("undefined"===typeof t.read,"Module.read option was removed (modify read_ in JS)"),O("undefined"===typeof t.readAsync,"Module.readAsync option was removed (modify readAsync in JS)"),O("undefined"===typeof t.readBinary,"Module.readBinary option was removed (modify readBinary in JS)"),O("undefined"===typeof t.setWindowTitle,"Module.setWindowTitle option was removed (modify setWindowTitle in JS)"),O("undefined"===typeof t.TOTAL_MEMORY,"Module.TOTAL_MEMORY has been renamed Module.INITIAL_MEMORY"),Object.getOwnPropertyDescriptor(t,"read")||Object.defineProperty(t,"read",{configurable:!0,get:function(){L("Module.read has been replaced with plain read_ (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)")}}),Object.getOwnPropertyDescriptor(t,"readAsync")||Object.defineProperty(t,"readAsync",{configurable:!0,get:function(){L("Module.readAsync has been replaced with plain readAsync (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)")}}),Object.getOwnPropertyDescriptor(t,"readBinary")||Object.defineProperty(t,"readBinary",{configurable:!0,get:function(){L("Module.readBinary has been replaced with plain readBinary (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)")}}),Object.getOwnPropertyDescriptor(t,"setWindowTitle")||Object.defineProperty(t,"setWindowTitle",{configurable:!0,get:function(){L("Module.setWindowTitle has been replaced with plain setWindowTitle (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)")}}),O(!d,"shell environment detected but not enabled at build time.  Add 'shell' to `-s ENVIRONMENT` to enable."),t.wasmBinary&&(b=t.wasmBinary),Object.getOwnPropertyDescriptor(t,"wasmBinary")||Object.defineProperty(t,"wasmBinary",{configurable:!0,get:function(){L("Module.wasmBinary has been replaced with plain wasmBinary (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)")}}),t.noExitRuntime,Object.getOwnPropertyDescriptor(t,"noExitRuntime")||Object.defineProperty(t,"noExitRuntime",{configurable:!0,get:function(){L("Module.noExitRuntime has been replaced with plain noExitRuntime (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)")}}),"object"!==typeof WebAssembly&&L("no native wasm support detected");var S=!1;function O(e,t){e||L("Assertion failed"+(t?": "+t:""))}var E,A,T,R,D="undefined"!==typeof TextDecoder?new TextDecoder("utf8"):void 0;function k(e,t){return e?function(e,t,n){for(var i=t+n,o=t;e[o]&&!(o>=i);)++o;if(o-t>16&&e.subarray&&D)return D.decode(e.subarray(t,o));for(var r="";t<o;){var a=e[t++];if(128&a){var s=63&e[t++];if(192!=(224&a)){var c=63&e[t++];if(224==(240&a)?a=(15&a)<<12|s<<6|c:(240!=(248&a)&&I("Invalid UTF-8 leading byte 0x"+a.toString(16)+" encountered when deserializing a UTF-8 string in wasm memory to a JS string!"),a=(7&a)<<18|s<<12|c<<6|63&e[t++]),a<65536)r+=String.fromCharCode(a);else{var l=a-65536;r+=String.fromCharCode(55296|l>>10,56320|1023&l)}}else r+=String.fromCharCode((31&a)<<6|s)}else r+=String.fromCharCode(a)}return r}(A,e,t):""}function M(e){E=e,t.HEAP8=new Int8Array(e),t.HEAP16=new Int16Array(e),t.HEAP32=T=new Int32Array(e),t.HEAPU8=A=new Uint8Array(e),t.HEAPU16=new Uint16Array(e),t.HEAPU32=R=new Uint32Array(e),t.HEAPF32=new Float32Array(e),t.HEAPF64=new Float64Array(e)}"undefined"!==typeof TextDecoder&&new TextDecoder("utf-16le");var P=5242880;t.TOTAL_STACK&&O(P===t.TOTAL_STACK,"the stack size can no longer be determined at runtime");var _,Z=t.INITIAL_MEMORY||16777216;function F(){var e=ae();O(0==(3&e)),T[e+4>>2]=34821223,T[e+8>>2]=2310721022,T[0]=1668509029}function N(){if(!S){var e=ae(),t=R[e+4>>2],n=R[e+8>>2];34821223==t&&2310721022==n||L("Stack overflow! Stack cookie has been overwritten, expected hex dwords 0x89BACDFE and 0x2135467, but received 0x"+n.toString(16)+" 0x"+t.toString(16)),1668509029!==T[0]&&L("Runtime error: The application has corrupted its heap memory area (address zero)!")}}Object.getOwnPropertyDescriptor(t,"INITIAL_MEMORY")||Object.defineProperty(t,"INITIAL_MEMORY",{configurable:!0,get:function(){L("Module.INITIAL_MEMORY has been replaced with plain INITIAL_MEMORY (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)")}}),O(Z>=P,"INITIAL_MEMORY should be larger than TOTAL_STACK, was "+Z+"! (TOTAL_STACK="+"5242880)"),O("undefined"!==typeof Int32Array&&"undefined"!==typeof Float64Array&&void 0!==Int32Array.prototype.subarray&&void 0!==Int32Array.prototype.set,"JS engine does not provide full typed array support"),O(!t.wasmMemory,"Use of `wasmMemory` detected.  Use -s IMPORTED_MEMORY to define wasmMemory externally"),O(16777216==Z,"Detected runtime INITIAL_MEMORY setting.  Use -s IMPORTED_MEMORY to define wasmMemory dynamically"),function(){var e=new Int16Array(1),t=new Int8Array(e.buffer);if(e[0]=25459,115!==t[0]||99!==t[1])throw"Runtime error: expected the system to be little-endian! (Run with -s SUPPORT_BIG_ENDIAN=1 to bypass)"}();var V=[],x=[],j=[],W=!1;O(Math.imul,"This browser does not support Math.imul(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill"),O(Math.fround,"This browser does not support Math.fround(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill"),O(Math.clz32,"This browser does not support Math.clz32(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill"),O(Math.trunc,"This browser does not support Math.trunc(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill");var U=0,G=null,X=null,B={};function L(e){t.onAbort&&t.onAbort(e),w(e="Aborted("+e+")"),S=!0;var n=new WebAssembly.RuntimeError(e);throw o(n),n}t.preloadedImages={},t.preloadedAudios={};var H={error:function(){L("Filesystem support (FS) was not included. The problem is that you are using files from JS, but files were not used from C/C++, so filesystem support was not auto-included. You can force-include filesystem support with  -s FORCE_FILESYSTEM=1")},init:function(){H.error()},createDataFile:function(){H.error()},createPreloadedFile:function(){H.error()},createLazyFile:function(){H.error()},open:function(){H.error()},mkdev:function(){H.error()},registerDevice:function(){H.error()},analyzePath:function(){H.error()},loadFilesFromDB:function(){H.error()},ErrnoError:function(){H.error()}};t.FS_createDataFile=H.createDataFile,t.FS_createPreloadedFile=H.createPreloadedFile;var Y,Q;function J(e){return e.startsWith("data:application/octet-stream;base64,")}function K(e){return e.startsWith("file://")}function z(e,n){return function(){var i=e,o=n;return n||(o=t.asm),O(W,"native function `"+i+"` called before runtime initialization"),O(!0,"native function `"+i+"` called after runtime exit (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),o[e]||O(o[e],"exported native function `"+i+"` not found"),o[e].apply(null,arguments)}}function $(e){try{if(e==Y&&b)return new Uint8Array(b);if(p)return p(e);throw"both async and sync fetching of the wasm failed"}catch(w){L(w)}}function q(e){for(;e.length>0;){var n=e.shift();if("function"!=typeof n){var i=n.func;"number"===typeof i?void 0===n.arg?te(i)():te(i)(n.arg):i(void 0===n.arg?null:n.arg)}else n(t)}}t.locateFile?J(Y="rnnoise.wasm")||(Q=Y,Y=t.locateFile?t.locateFile(Q,C):C+Q):Y=new n.U(n(8981)).toString();var ee=[];function te(e){var t=ee[e];return t||(e>=ee.length&&(ee.length=e+1),ee[e]=t=_.get(e)),O(_.get(e)==t,"JavaScript-side Wasm function table mirror is out of date!"),t}function ne(e){try{return v.grow(e-E.byteLength+65535>>>16),M(v.buffer),1}catch(t){w("emscripten_realloc_buffer: Attempted to grow heap from "+E.byteLength+" bytes to "+e+" bytes, but got error: "+t)}}var ie={__assert_fail:function(e,t,n,i){L("Assertion failed: "+k(e)+", at: "+[t?k(t):"unknown filename",n,i?k(i):"unknown function"])},emscripten_memcpy_big:function(e,t,n){A.copyWithin(e,t,t+n)},emscripten_resize_heap:function(e){var t=A.length;O((e>>>=0)>t);var n,i,o=2147483648;if(e>o)return w("Cannot enlarge memory, asked to go up to "+e+" bytes, but the limit is "+"2147483648 bytes!"),!1;for(var r=1;r<=4;r*=2){var a=t*(1+.2/r);a=Math.min(a,e+100663296);var s=Math.min(o,((n=Math.max(e,a))%(i=65536)>0&&(n+=i-n%i),n));if(ne(s))return!0}return w("Failed to grow the heap from "+t+" bytes to "+s+" bytes, not enough memory!"),!1}};!function(){var e,n={env:ie,wasi_snapshot_preview1:ie};function i(e,n){var i,o=e.exports;t.asm=o,O(v=t.asm.memory,"memory not found in wasm exports"),M(v.buffer),O(_=t.asm.__indirect_function_table,"table not found in wasm exports"),i=t.asm.__wasm_call_ctors,x.unshift(i),function(e){if(U--,t.monitorRunDependencies&&t.monitorRunDependencies(U),e?(O(B[e]),delete B[e]):w("warning: run dependency removed without ID"),0==U&&(null!==G&&(clearInterval(G),G=null),X)){var n=X;X=null,n()}}("wasm-instantiate")}e="wasm-instantiate",U++,t.monitorRunDependencies&&t.monitorRunDependencies(U),e?(O(!B[e]),B[e]=1,null===G&&"undefined"!==typeof setInterval&&(G=setInterval((function(){if(S)return clearInterval(G),void(G=null);var e=!1;for(var t in B)e||(e=!0,w("still waiting on run dependencies:")),w("dependency: "+t);e&&w("(end of list)")}),1e4))):w("warning: run dependency added without ID");var r=t;function a(e){O(t===r,"the Module object should not be replaced during async compilation - perhaps the order of HTML elements is wrong?"),r=null,i(e.instance)}function c(e){return function(){if(!b&&(s||l)){if("function"===typeof fetch&&!K(Y))return fetch(Y,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+Y+"'";return e.arrayBuffer()})).catch((function(){return $(Y)}));if(f)return new Promise((function(e,t){f(Y,(function(t){e(new Uint8Array(t))}),t)}))}return Promise.resolve().then((function(){return $(Y)}))}().then((function(e){return WebAssembly.instantiate(e,n)})).then((function(e){return e})).then(e,(function(e){w("failed to asynchronously prepare wasm: "+e),K(Y)&&w("warning: Loading from a file URI ("+Y+") is not supported in most browsers. See https://emscripten.org/docs/getting_started/FAQ.html#how-do-i-run-a-local-webserver-for-testing-why-does-my-program-stall-in-downloading-or-preparing"),L(e)}))}if(t.instantiateWasm)try{return t.instantiateWasm(n,i)}catch(u){return w("Module.instantiateWasm callback failed with error: "+u),!1}(b||"function"!==typeof WebAssembly.instantiateStreaming||J(Y)||K(Y)||"function"!==typeof fetch?c(a):fetch(Y,{credentials:"same-origin"}).then((function(e){return WebAssembly.instantiateStreaming(e,n).then(a,(function(e){return w("wasm streaming compile failed: "+e),w("falling back to ArrayBuffer instantiation"),c(a)}))}))).catch(o)}(),t.___wasm_call_ctors=z("__wasm_call_ctors"),t._rnnoise_get_frame_size=z("rnnoise_get_frame_size"),t._rnnoise_create=z("rnnoise_create"),t._rnnoise_destroy=z("rnnoise_destroy"),t._rnnoise_process_frame=z("rnnoise_process_frame"),t.___errno_location=z("__errno_location"),t._fflush=z("fflush");var oe=t._emscripten_stack_init=function(){return(oe=t._emscripten_stack_init=t.asm.emscripten_stack_init).apply(null,arguments)};t._emscripten_stack_get_free=function(){return(t._emscripten_stack_get_free=t.asm.emscripten_stack_get_free).apply(null,arguments)};var re,ae=t._emscripten_stack_get_end=function(){return(ae=t._emscripten_stack_get_end=t.asm.emscripten_stack_get_end).apply(null,arguments)};function se(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function ce(e){function n(){re||(re=!0,t.calledRun=!0,S||(N(),O(!W),W=!0,q(x),i(t),t.onRuntimeInitialized&&t.onRuntimeInitialized(),O(!t._main,'compiled without a main, but one is present. if you added it from JS, use Module["onRuntimeInitialized"]'),function(){if(N(),t.postRun)for("function"==typeof t.postRun&&(t.postRun=[t.postRun]);t.postRun.length;)e=t.postRun.shift(),j.unshift(e);var e;q(j)}()))}U>0||(oe(),F(),function(){if(t.preRun)for("function"==typeof t.preRun&&(t.preRun=[t.preRun]);t.preRun.length;)e=t.preRun.shift(),V.unshift(e);var e;q(V)}(),U>0||(t.setStatus?(t.setStatus("Running..."),setTimeout((function(){setTimeout((function(){t.setStatus("")}),1),n()}),1)):n(),N()))}if(t.stackSave=z("stackSave"),t.stackRestore=z("stackRestore"),t.stackAlloc=z("stackAlloc"),t._malloc=z("malloc"),t._free=z("free"),Object.getOwnPropertyDescriptor(t,"intArrayFromString")||(t.intArrayFromString=function(){L("'intArrayFromString' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"intArrayToString")||(t.intArrayToString=function(){L("'intArrayToString' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"ccall")||(t.ccall=function(){L("'ccall' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"cwrap")||(t.cwrap=function(){L("'cwrap' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"setValue")||(t.setValue=function(){L("'setValue' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"getValue")||(t.getValue=function(){L("'getValue' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"allocate")||(t.allocate=function(){L("'allocate' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"UTF8ArrayToString")||(t.UTF8ArrayToString=function(){L("'UTF8ArrayToString' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"UTF8ToString")||(t.UTF8ToString=function(){L("'UTF8ToString' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"stringToUTF8Array")||(t.stringToUTF8Array=function(){L("'stringToUTF8Array' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"stringToUTF8")||(t.stringToUTF8=function(){L("'stringToUTF8' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"lengthBytesUTF8")||(t.lengthBytesUTF8=function(){L("'lengthBytesUTF8' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"stackTrace")||(t.stackTrace=function(){L("'stackTrace' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"addOnPreRun")||(t.addOnPreRun=function(){L("'addOnPreRun' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"addOnInit")||(t.addOnInit=function(){L("'addOnInit' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"addOnPreMain")||(t.addOnPreMain=function(){L("'addOnPreMain' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"addOnExit")||(t.addOnExit=function(){L("'addOnExit' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"addOnPostRun")||(t.addOnPostRun=function(){L("'addOnPostRun' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"writeStringToMemory")||(t.writeStringToMemory=function(){L("'writeStringToMemory' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"writeArrayToMemory")||(t.writeArrayToMemory=function(){L("'writeArrayToMemory' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"writeAsciiToMemory")||(t.writeAsciiToMemory=function(){L("'writeAsciiToMemory' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"addRunDependency")||(t.addRunDependency=function(){L("'addRunDependency' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),Object.getOwnPropertyDescriptor(t,"removeRunDependency")||(t.removeRunDependency=function(){L("'removeRunDependency' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),Object.getOwnPropertyDescriptor(t,"FS_createFolder")||(t.FS_createFolder=function(){L("'FS_createFolder' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"FS_createPath")||(t.FS_createPath=function(){L("'FS_createPath' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),Object.getOwnPropertyDescriptor(t,"FS_createDataFile")||(t.FS_createDataFile=function(){L("'FS_createDataFile' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),Object.getOwnPropertyDescriptor(t,"FS_createPreloadedFile")||(t.FS_createPreloadedFile=function(){L("'FS_createPreloadedFile' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),Object.getOwnPropertyDescriptor(t,"FS_createLazyFile")||(t.FS_createLazyFile=function(){L("'FS_createLazyFile' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),Object.getOwnPropertyDescriptor(t,"FS_createLink")||(t.FS_createLink=function(){L("'FS_createLink' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"FS_createDevice")||(t.FS_createDevice=function(){L("'FS_createDevice' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),Object.getOwnPropertyDescriptor(t,"FS_unlink")||(t.FS_unlink=function(){L("'FS_unlink' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),Object.getOwnPropertyDescriptor(t,"getLEB")||(t.getLEB=function(){L("'getLEB' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"getFunctionTables")||(t.getFunctionTables=function(){L("'getFunctionTables' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"alignFunctionTables")||(t.alignFunctionTables=function(){L("'alignFunctionTables' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"registerFunctions")||(t.registerFunctions=function(){L("'registerFunctions' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"addFunction")||(t.addFunction=function(){L("'addFunction' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"removeFunction")||(t.removeFunction=function(){L("'removeFunction' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"getFuncWrapper")||(t.getFuncWrapper=function(){L("'getFuncWrapper' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"prettyPrint")||(t.prettyPrint=function(){L("'prettyPrint' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"dynCall")||(t.dynCall=function(){L("'dynCall' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"getCompilerSetting")||(t.getCompilerSetting=function(){L("'getCompilerSetting' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"print")||(t.print=function(){L("'print' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"printErr")||(t.printErr=function(){L("'printErr' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"getTempRet0")||(t.getTempRet0=function(){L("'getTempRet0' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"setTempRet0")||(t.setTempRet0=function(){L("'setTempRet0' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"callMain")||(t.callMain=function(){L("'callMain' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"abort")||(t.abort=function(){L("'abort' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"keepRuntimeAlive")||(t.keepRuntimeAlive=function(){L("'keepRuntimeAlive' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"zeroMemory")||(t.zeroMemory=function(){L("'zeroMemory' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"stringToNewUTF8")||(t.stringToNewUTF8=function(){L("'stringToNewUTF8' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"setFileTime")||(t.setFileTime=function(){L("'setFileTime' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"emscripten_realloc_buffer")||(t.emscripten_realloc_buffer=function(){L("'emscripten_realloc_buffer' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"ENV")||(t.ENV=function(){L("'ENV' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"withStackSave")||(t.withStackSave=function(){L("'withStackSave' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"ERRNO_CODES")||(t.ERRNO_CODES=function(){L("'ERRNO_CODES' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"ERRNO_MESSAGES")||(t.ERRNO_MESSAGES=function(){L("'ERRNO_MESSAGES' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"setErrNo")||(t.setErrNo=function(){L("'setErrNo' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"inetPton4")||(t.inetPton4=function(){L("'inetPton4' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"inetNtop4")||(t.inetNtop4=function(){L("'inetNtop4' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"inetPton6")||(t.inetPton6=function(){L("'inetPton6' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"inetNtop6")||(t.inetNtop6=function(){L("'inetNtop6' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"readSockaddr")||(t.readSockaddr=function(){L("'readSockaddr' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"writeSockaddr")||(t.writeSockaddr=function(){L("'writeSockaddr' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"DNS")||(t.DNS=function(){L("'DNS' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"getHostByName")||(t.getHostByName=function(){L("'getHostByName' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"GAI_ERRNO_MESSAGES")||(t.GAI_ERRNO_MESSAGES=function(){L("'GAI_ERRNO_MESSAGES' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"Protocols")||(t.Protocols=function(){L("'Protocols' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"Sockets")||(t.Sockets=function(){L("'Sockets' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"getRandomDevice")||(t.getRandomDevice=function(){L("'getRandomDevice' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"traverseStack")||(t.traverseStack=function(){L("'traverseStack' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"convertFrameToPC")||(t.convertFrameToPC=function(){L("'convertFrameToPC' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"UNWIND_CACHE")||(t.UNWIND_CACHE=function(){L("'UNWIND_CACHE' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"saveInUnwindCache")||(t.saveInUnwindCache=function(){L("'saveInUnwindCache' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"convertPCtoSourceLocation")||(t.convertPCtoSourceLocation=function(){L("'convertPCtoSourceLocation' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"readAsmConstArgsArray")||(t.readAsmConstArgsArray=function(){L("'readAsmConstArgsArray' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"readAsmConstArgs")||(t.readAsmConstArgs=function(){L("'readAsmConstArgs' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"mainThreadEM_ASM")||(t.mainThreadEM_ASM=function(){L("'mainThreadEM_ASM' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"jstoi_q")||(t.jstoi_q=function(){L("'jstoi_q' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"jstoi_s")||(t.jstoi_s=function(){L("'jstoi_s' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"getExecutableName")||(t.getExecutableName=function(){L("'getExecutableName' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"listenOnce")||(t.listenOnce=function(){L("'listenOnce' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"autoResumeAudioContext")||(t.autoResumeAudioContext=function(){L("'autoResumeAudioContext' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"dynCallLegacy")||(t.dynCallLegacy=function(){L("'dynCallLegacy' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"getDynCaller")||(t.getDynCaller=function(){L("'getDynCaller' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"dynCall")||(t.dynCall=function(){L("'dynCall' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"callRuntimeCallbacks")||(t.callRuntimeCallbacks=function(){L("'callRuntimeCallbacks' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"wasmTableMirror")||(t.wasmTableMirror=function(){L("'wasmTableMirror' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"setWasmTableEntry")||(t.setWasmTableEntry=function(){L("'setWasmTableEntry' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"getWasmTableEntry")||(t.getWasmTableEntry=function(){L("'getWasmTableEntry' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"handleException")||(t.handleException=function(){L("'handleException' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"runtimeKeepalivePush")||(t.runtimeKeepalivePush=function(){L("'runtimeKeepalivePush' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"runtimeKeepalivePop")||(t.runtimeKeepalivePop=function(){L("'runtimeKeepalivePop' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"callUserCallback")||(t.callUserCallback=function(){L("'callUserCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"maybeExit")||(t.maybeExit=function(){L("'maybeExit' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"safeSetTimeout")||(t.safeSetTimeout=function(){L("'safeSetTimeout' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"asmjsMangle")||(t.asmjsMangle=function(){L("'asmjsMangle' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"asyncLoad")||(t.asyncLoad=function(){L("'asyncLoad' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"alignMemory")||(t.alignMemory=function(){L("'alignMemory' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"mmapAlloc")||(t.mmapAlloc=function(){L("'mmapAlloc' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"reallyNegative")||(t.reallyNegative=function(){L("'reallyNegative' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"unSign")||(t.unSign=function(){L("'unSign' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"reSign")||(t.reSign=function(){L("'reSign' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"formatString")||(t.formatString=function(){L("'formatString' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"PATH")||(t.PATH=function(){L("'PATH' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"PATH_FS")||(t.PATH_FS=function(){L("'PATH_FS' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"SYSCALLS")||(t.SYSCALLS=function(){L("'SYSCALLS' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"syscallMmap2")||(t.syscallMmap2=function(){L("'syscallMmap2' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"syscallMunmap")||(t.syscallMunmap=function(){L("'syscallMunmap' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"getSocketFromFD")||(t.getSocketFromFD=function(){L("'getSocketFromFD' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"getSocketAddress")||(t.getSocketAddress=function(){L("'getSocketAddress' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"JSEvents")||(t.JSEvents=function(){L("'JSEvents' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"registerKeyEventCallback")||(t.registerKeyEventCallback=function(){L("'registerKeyEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"specialHTMLTargets")||(t.specialHTMLTargets=function(){L("'specialHTMLTargets' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"maybeCStringToJsString")||(t.maybeCStringToJsString=function(){L("'maybeCStringToJsString' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"findEventTarget")||(t.findEventTarget=function(){L("'findEventTarget' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"findCanvasEventTarget")||(t.findCanvasEventTarget=function(){L("'findCanvasEventTarget' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"getBoundingClientRect")||(t.getBoundingClientRect=function(){L("'getBoundingClientRect' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"fillMouseEventData")||(t.fillMouseEventData=function(){L("'fillMouseEventData' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"registerMouseEventCallback")||(t.registerMouseEventCallback=function(){L("'registerMouseEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"registerWheelEventCallback")||(t.registerWheelEventCallback=function(){L("'registerWheelEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"registerUiEventCallback")||(t.registerUiEventCallback=function(){L("'registerUiEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"registerFocusEventCallback")||(t.registerFocusEventCallback=function(){L("'registerFocusEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"fillDeviceOrientationEventData")||(t.fillDeviceOrientationEventData=function(){L("'fillDeviceOrientationEventData' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"registerDeviceOrientationEventCallback")||(t.registerDeviceOrientationEventCallback=function(){L("'registerDeviceOrientationEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"fillDeviceMotionEventData")||(t.fillDeviceMotionEventData=function(){L("'fillDeviceMotionEventData' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"registerDeviceMotionEventCallback")||(t.registerDeviceMotionEventCallback=function(){L("'registerDeviceMotionEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"screenOrientation")||(t.screenOrientation=function(){L("'screenOrientation' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"fillOrientationChangeEventData")||(t.fillOrientationChangeEventData=function(){L("'fillOrientationChangeEventData' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"registerOrientationChangeEventCallback")||(t.registerOrientationChangeEventCallback=function(){L("'registerOrientationChangeEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"fillFullscreenChangeEventData")||(t.fillFullscreenChangeEventData=function(){L("'fillFullscreenChangeEventData' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"registerFullscreenChangeEventCallback")||(t.registerFullscreenChangeEventCallback=function(){L("'registerFullscreenChangeEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"registerRestoreOldStyle")||(t.registerRestoreOldStyle=function(){L("'registerRestoreOldStyle' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"hideEverythingExceptGivenElement")||(t.hideEverythingExceptGivenElement=function(){L("'hideEverythingExceptGivenElement' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"restoreHiddenElements")||(t.restoreHiddenElements=function(){L("'restoreHiddenElements' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"setLetterbox")||(t.setLetterbox=function(){L("'setLetterbox' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"currentFullscreenStrategy")||(t.currentFullscreenStrategy=function(){L("'currentFullscreenStrategy' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"restoreOldWindowedStyle")||(t.restoreOldWindowedStyle=function(){L("'restoreOldWindowedStyle' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"softFullscreenResizeWebGLRenderTarget")||(t.softFullscreenResizeWebGLRenderTarget=function(){L("'softFullscreenResizeWebGLRenderTarget' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"doRequestFullscreen")||(t.doRequestFullscreen=function(){L("'doRequestFullscreen' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"fillPointerlockChangeEventData")||(t.fillPointerlockChangeEventData=function(){L("'fillPointerlockChangeEventData' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"registerPointerlockChangeEventCallback")||(t.registerPointerlockChangeEventCallback=function(){L("'registerPointerlockChangeEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"registerPointerlockErrorEventCallback")||(t.registerPointerlockErrorEventCallback=function(){L("'registerPointerlockErrorEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"requestPointerLock")||(t.requestPointerLock=function(){L("'requestPointerLock' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"fillVisibilityChangeEventData")||(t.fillVisibilityChangeEventData=function(){L("'fillVisibilityChangeEventData' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"registerVisibilityChangeEventCallback")||(t.registerVisibilityChangeEventCallback=function(){L("'registerVisibilityChangeEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"registerTouchEventCallback")||(t.registerTouchEventCallback=function(){L("'registerTouchEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"fillGamepadEventData")||(t.fillGamepadEventData=function(){L("'fillGamepadEventData' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"registerGamepadEventCallback")||(t.registerGamepadEventCallback=function(){L("'registerGamepadEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"registerBeforeUnloadEventCallback")||(t.registerBeforeUnloadEventCallback=function(){L("'registerBeforeUnloadEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"fillBatteryEventData")||(t.fillBatteryEventData=function(){L("'fillBatteryEventData' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"battery")||(t.battery=function(){L("'battery' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"registerBatteryEventCallback")||(t.registerBatteryEventCallback=function(){L("'registerBatteryEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"setCanvasElementSize")||(t.setCanvasElementSize=function(){L("'setCanvasElementSize' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"getCanvasElementSize")||(t.getCanvasElementSize=function(){L("'getCanvasElementSize' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"demangle")||(t.demangle=function(){L("'demangle' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"demangleAll")||(t.demangleAll=function(){L("'demangleAll' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"jsStackTrace")||(t.jsStackTrace=function(){L("'jsStackTrace' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"stackTrace")||(t.stackTrace=function(){L("'stackTrace' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"getEnvStrings")||(t.getEnvStrings=function(){L("'getEnvStrings' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"checkWasiClock")||(t.checkWasiClock=function(){L("'checkWasiClock' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"flush_NO_FILESYSTEM")||(t.flush_NO_FILESYSTEM=function(){L("'flush_NO_FILESYSTEM' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"writeI53ToI64")||(t.writeI53ToI64=function(){L("'writeI53ToI64' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"writeI53ToI64Clamped")||(t.writeI53ToI64Clamped=function(){L("'writeI53ToI64Clamped' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"writeI53ToI64Signaling")||(t.writeI53ToI64Signaling=function(){L("'writeI53ToI64Signaling' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"writeI53ToU64Clamped")||(t.writeI53ToU64Clamped=function(){L("'writeI53ToU64Clamped' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"writeI53ToU64Signaling")||(t.writeI53ToU64Signaling=function(){L("'writeI53ToU64Signaling' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"readI53FromI64")||(t.readI53FromI64=function(){L("'readI53FromI64' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"readI53FromU64")||(t.readI53FromU64=function(){L("'readI53FromU64' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"convertI32PairToI53")||(t.convertI32PairToI53=function(){L("'convertI32PairToI53' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"convertU32PairToI53")||(t.convertU32PairToI53=function(){L("'convertU32PairToI53' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"setImmediateWrapped")||(t.setImmediateWrapped=function(){L("'setImmediateWrapped' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"clearImmediateWrapped")||(t.clearImmediateWrapped=function(){L("'clearImmediateWrapped' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"polyfillSetImmediate")||(t.polyfillSetImmediate=function(){L("'polyfillSetImmediate' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"Browser")||(t.Browser=function(){L("'Browser' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"funcWrappers")||(t.funcWrappers=function(){L("'funcWrappers' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"getFuncWrapper")||(t.getFuncWrapper=function(){L("'getFuncWrapper' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"setMainLoop")||(t.setMainLoop=function(){L("'setMainLoop' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"wget")||(t.wget=function(){L("'wget' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"FS")||(t.FS=function(){L("'FS' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"MEMFS")||(t.MEMFS=function(){L("'MEMFS' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"TTY")||(t.TTY=function(){L("'TTY' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"PIPEFS")||(t.PIPEFS=function(){L("'PIPEFS' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"SOCKFS")||(t.SOCKFS=function(){L("'SOCKFS' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"_setNetworkCallback")||(t._setNetworkCallback=function(){L("'_setNetworkCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"warnOnce")||(t.warnOnce=function(){L("'warnOnce' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"stackSave")||(t.stackSave=function(){L("'stackSave' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"stackRestore")||(t.stackRestore=function(){L("'stackRestore' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"stackAlloc")||(t.stackAlloc=function(){L("'stackAlloc' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"AsciiToString")||(t.AsciiToString=function(){L("'AsciiToString' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"stringToAscii")||(t.stringToAscii=function(){L("'stringToAscii' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"UTF16ToString")||(t.UTF16ToString=function(){L("'UTF16ToString' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"stringToUTF16")||(t.stringToUTF16=function(){L("'stringToUTF16' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"lengthBytesUTF16")||(t.lengthBytesUTF16=function(){L("'lengthBytesUTF16' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"UTF32ToString")||(t.UTF32ToString=function(){L("'UTF32ToString' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"stringToUTF32")||(t.stringToUTF32=function(){L("'stringToUTF32' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"lengthBytesUTF32")||(t.lengthBytesUTF32=function(){L("'lengthBytesUTF32' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"allocateUTF8")||(t.allocateUTF8=function(){L("'allocateUTF8' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(t,"allocateUTF8OnStack")||(t.allocateUTF8OnStack=function(){L("'allocateUTF8OnStack' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),t.writeStackCookie=F,t.checkStackCookie=N,Object.getOwnPropertyDescriptor(t,"ALLOC_NORMAL")||Object.defineProperty(t,"ALLOC_NORMAL",{configurable:!0,get:function(){L("'ALLOC_NORMAL' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}}),Object.getOwnPropertyDescriptor(t,"ALLOC_STACK")||Object.defineProperty(t,"ALLOC_STACK",{configurable:!0,get:function(){L("'ALLOC_STACK' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}}),X=function e(){re||ce(),re||(X=e)},t.run=ce,t.preInit)for("function"==typeof t.preInit&&(t.preInit=[t.preInit]);t.preInit.length>0;)t.preInit.pop()();return ce(),t.ready}})();class u{rnnoiseModule;frameSize;constructor(e){this.rnnoiseModule=e,this.frameSize=e._rnnoise_get_frame_size()}static async load(e={}){const t=await(async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11])))().then((t=>l({locateFile:(n,i)=>(void 0!==e.assetsPath&&(i=e.assetsPath+"/"),void 0!==e.wasmFileName?(n=e.wasmFileName,console.debug("Loads rnnoise-wasm: ",i+n)):t?(n="rnnoise_simd.wasm",console.debug("Loads rnnoise-wasm (SIMD ver): ",i+n)):console.debug("Loads rnnoise-wasm (non SIMD ver): ",i+n),i+n)})));return Promise.resolve(new u(t))}createDenoiseState(){return new d(this.rnnoiseModule)}}class d{rnnoiseModule;state;pcmInputBuf;pcmOutputBuf;frameSize;constructor(e){this.rnnoiseModule=e,this.frameSize=this.rnnoiseModule._rnnoise_get_frame_size();const t=this.rnnoiseModule._rnnoise_create(),n=this.rnnoiseModule._malloc(4*this.frameSize),i=this.rnnoiseModule._malloc(4*this.frameSize);if(!t||!n||!i)throw this.destroy(),Error("Failed to allocate DenoiseState or PCM buffers.");this.state=t,this.pcmInputBuf=n,this.pcmOutputBuf=i}processFrame(e){if(void 0===this.rnnoiseModule)throw Error("This denoise state has already been destroyed.");if(e.length!=this.frameSize)throw Error(`Expected frame size ${this.frameSize}, but got ${e.length}`);const t=this.pcmInputBuf/4,n=this.pcmOutputBuf/4;this.rnnoiseModule.HEAPF32.set(e,t);const i=this.rnnoiseModule._rnnoise_process_frame(this.state,this.pcmOutputBuf,this.pcmInputBuf);return e.set(this.rnnoiseModule.HEAPF32.subarray(n,n+this.frameSize)),i}destroy(){void 0!==this.rnnoiseModule&&(this.rnnoiseModule._rnnoise_destroy(this.state),this.rnnoiseModule._free(this.pcmInputBuf),this.rnnoiseModule._free(this.pcmOutputBuf),this.rnnoiseModule=void 0)}}class g{assetsPath;rnnoise;trackProcessor;constructor(e){this.assetsPath=function(e){if("/"===e.slice(-1))return e.slice(0,-1);return e}(e)}static isSupported(){return!("undefined"===typeof MediaStreamTrackProcessor||"undefined"===typeof MediaStreamTrackGenerator)}async startProcessing(e){if(this.isProcessing())throw Error("Noise suppression processing has already started.");return void 0===this.rnnoise&&(this.rnnoise=await u.load({assetsPath:this.assetsPath})),this.trackProcessor=new f(e,this.rnnoise),this.trackProcessor.startProcessing()}stopProcessing(){void 0!==this.trackProcessor&&(this.trackProcessor.stopProcessing(),this.trackProcessor=void 0)}isProcessing(){return void 0!==this.trackProcessor}}class f{track;abortController;denoiseState;buffer;frameSize;bufferFrameCount;nextTimestamp;constructor(e,t){this.track=e,this.denoiseState=t.createDenoiseState(),this.buffer=new Float32Array(t.frameSize),this.frameSize=t.frameSize,this.bufferFrameCount=0,this.nextTimestamp=0,this.abortController=new AbortController}startProcessing(){const e=this.abortController.signal,t=new MediaStreamTrackGenerator({kind:"audio"}),n=new MediaStreamTrackProcessor({track:this.track});return n.readable.pipeThrough(new TransformStream({transform:(e,t)=>{this.transform(e,t)}}),{signal:e}).pipeTo(t.writable).catch((i=>{e.aborted?console.debug("Shutting down streams after abort."):console.warn("Error from stream transform:",i),n.readable.cancel(i).catch((e=>{console.warn("Failed to cancel `MediaStreamTrackProcessor`:",e)})),t.writable.abort(i).catch((e=>{console.warn("Failed to abort `MediaStreamTrackGenerator`:",e)}))})),Promise.resolve(t)}stopProcessing(){this.abortController.abort(),this.denoiseState.destroy()}transform(e,t){if(1!==e.numberOfChannels)throw Error("Noise suppression for stereo channel has not been supported yet.");if("f32-planar"!==e.format)throw Error(`Unsupported audio data format ${e.format}."`);0==this.bufferFrameCount&&(this.nextTimestamp=e.timestamp);let n=0;for(;n<e.numberOfFrames;){const i=Math.min(this.frameSize-this.bufferFrameCount,e.numberOfFrames-n);if(e.copyTo(this.buffer.subarray(this.bufferFrameCount),{planeIndex:0,frameOffset:n,frameCount:i}),this.bufferFrameCount+=i,n+=i,this.bufferFrameCount==this.frameSize){for(const[e,t]of this.buffer.entries())this.buffer[e]=32767*t;this.denoiseState.processFrame(this.buffer);for(const[e,t]of this.buffer.entries())this.buffer[e]=t/32767;t.enqueue(new AudioData({format:e.format,sampleRate:e.sampleRate,numberOfFrames:this.frameSize,numberOfChannels:e.numberOfChannels,timestamp:this.nextTimestamp,data:this.buffer})),this.buffer=new Float32Array(this.frameSize),this.bufferFrameCount=0,this.nextTimestamp=e.timestamp+e.duration*n/e.numberOfFrames}}e.close()}}var p="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{};(function(){var e;function t(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}var n="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};var i=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof p&&p];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);function o(e,t){if(t)e:{var o=i;e=e.split(".");for(var r=0;r<e.length-1;r++){var a=e[r];if(!(a in o))break e;o=o[a]}(t=t(r=o[e=e[e.length-1]]))!=r&&null!=t&&n(o,e,{configurable:!0,writable:!0,value:t})}}function r(e){return(e={next:e})[Symbol.iterator]=function(){return this},e}function a(e){var n="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];return n?n.call(e):{next:t(e)}}function s(e){if(!(e instanceof Array)){e=a(e);for(var t,n=[];!(t=e.next()).done;)n.push(t.value);e=n}return e}o("Symbol",(function(e){function t(e,t){this.g=e,n(this,"description",{configurable:!0,writable:!0,value:t})}if(e)return e;t.prototype.toString=function(){return this.g};var i="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",o=0;return function e(n){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new t(i+(n||"")+"_"+o++,n)}})),o("Symbol.iterator",(function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var o="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),a=0;a<o.length;a++){var s=i[o[a]];"function"===typeof s&&"function"!=typeof s.prototype[e]&&n(s.prototype,e,{configurable:!0,writable:!0,value:function(){return r(t(this))}})}return e}));var c,l="function"==typeof Object.create?Object.create:function(e){function t(){}return t.prototype=e,new t};if("function"==typeof Object.setPrototypeOf)c=Object.setPrototypeOf;else{var u;e:{var d={};try{d.__proto__={a:!0},u=d.a;break e}catch(ze){}u=!1}c=u?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var g=c;function f(e,t){if(e.prototype=l(t.prototype),e.prototype.constructor=e,g)g(e,t);else for(var n in t)if("prototype"!=n)if(Object.defineProperties){var i=Object.getOwnPropertyDescriptor(t,n);i&&Object.defineProperty(e,n,i)}else e[n]=t[n];e.ea=t.prototype}function h(){this.l=!1,this.i=null,this.h=void 0,this.g=1,this.s=this.m=0,this.j=null}function m(e){if(e.l)throw new TypeError("Generator is already running");e.l=!0}function y(e,t){e.j={U:t,V:!0},e.g=e.m||e.s}function C(e,t,n){return e.g=n,{value:t}}function b(e){this.g=new h,this.h=e}function v(e,t,n,i){try{var o=t.call(e.g.i,n);if(!(o instanceof Object))throw new TypeError("Iterator result "+o+" is not an object");if(!o.done)return e.g.l=!1,o;var r=o.value}catch(a){return e.g.i=null,y(e.g,a),w(e)}return e.g.i=null,i.call(e.g,r),w(e)}function w(e){for(;e.g.g;)try{var t=e.h(e.g);if(t)return e.g.l=!1,{value:t.value,done:!1}}catch(n){e.g.h=void 0,y(e.g,n)}if(e.g.l=!1,e.g.j){if(t=e.g.j,e.g.j=null,t.V)throw t.U;return{value:t.return,done:!0}}return{value:void 0,done:!0}}function I(e){this.next=function(t){return m(e.g),e.g.i?t=v(e,e.g.i.next,t,e.g.o):(e.g.o(t),t=w(e)),t},this.throw=function(t){return m(e.g),e.g.i?t=v(e,e.g.i.throw,t,e.g.o):(y(e.g,t),t=w(e)),t},this.return=function(t){return function(e,t){m(e.g);var n=e.g.i;return n?v(e,"return"in n?n.return:function(e){return{value:e,done:!0}},t,e.g.return):(e.g.return(t),w(e))}(e,t)},this[Symbol.iterator]=function(){return this}}function S(e,t){return t=new I(new b(t)),g&&e.prototype&&g(t,e.prototype),t}h.prototype.o=function(e){this.h=e},h.prototype.return=function(e){this.j={return:e},this.g=this.s};var O="function"==typeof Object.assign?Object.assign:function(e,t){for(var n=1;n<arguments.length;n++){var i=arguments[n];if(i)for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e};o("Object.assign",(function(e){return e||O})),o("Promise",(function(e){function t(e){this.h=0,this.i=void 0,this.g=[],this.o=!1;var t=this.j();try{e(t.resolve,t.reject)}catch(n){t.reject(n)}}function n(){this.g=null}function o(e){return e instanceof t?e:new t((function(t){t(e)}))}if(e)return e;n.prototype.h=function(e){if(null==this.g){this.g=[];var t=this;this.i((function(){t.l()}))}this.g.push(e)};var r=i.setTimeout;n.prototype.i=function(e){r(e,0)},n.prototype.l=function(){for(;this.g&&this.g.length;){var e=this.g;this.g=[];for(var t=0;t<e.length;++t){var n=e[t];e[t]=null;try{n()}catch(i){this.j(i)}}}this.g=null},n.prototype.j=function(e){this.i((function(){throw e}))},t.prototype.j=function(){function e(e){return function(i){n||(n=!0,e.call(t,i))}}var t=this,n=!1;return{resolve:e(this.C),reject:e(this.l)}},t.prototype.C=function(e){if(e===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof t)this.F(e);else{e:switch(typeof e){case"object":var n=null!=e;break e;case"function":n=!0;break e;default:n=!1}n?this.u(e):this.m(e)}},t.prototype.u=function(e){var t=void 0;try{t=e.then}catch(n){return void this.l(n)}"function"==typeof t?this.G(t,e):this.m(e)},t.prototype.l=function(e){this.s(2,e)},t.prototype.m=function(e){this.s(1,e)},t.prototype.s=function(e,t){if(0!=this.h)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.h);this.h=e,this.i=t,2===this.h&&this.D(),this.A()},t.prototype.D=function(){var e=this;r((function(){if(e.B()){var t=i.console;"undefined"!==typeof t&&t.error(e.i)}}),1)},t.prototype.B=function(){if(this.o)return!1;var e=i.CustomEvent,t=i.Event,n=i.dispatchEvent;return"undefined"===typeof n||("function"===typeof e?e=new e("unhandledrejection",{cancelable:!0}):"function"===typeof t?e=new t("unhandledrejection",{cancelable:!0}):(e=i.document.createEvent("CustomEvent")).initCustomEvent("unhandledrejection",!1,!0,e),e.promise=this,e.reason=this.i,n(e))},t.prototype.A=function(){if(null!=this.g){for(var e=0;e<this.g.length;++e)s.h(this.g[e]);this.g=null}};var s=new n;return t.prototype.F=function(e){var t=this.j();e.J(t.resolve,t.reject)},t.prototype.G=function(e,t){var n=this.j();try{e.call(t,n.resolve,n.reject)}catch(i){n.reject(i)}},t.prototype.then=function(e,n){function i(e,t){return"function"==typeof e?function(t){try{o(e(t))}catch(n){r(n)}}:t}var o,r,a=new t((function(e,t){o=e,r=t}));return this.J(i(e,o),i(n,r)),a},t.prototype.catch=function(e){return this.then(void 0,e)},t.prototype.J=function(e,t){function n(){switch(i.h){case 1:e(i.i);break;case 2:t(i.i);break;default:throw Error("Unexpected state: "+i.h)}}var i=this;null==this.g?s.h(n):this.g.push(n),this.o=!0},t.resolve=o,t.reject=function(e){return new t((function(t,n){n(e)}))},t.race=function(e){return new t((function(t,n){for(var i=a(e),r=i.next();!r.done;r=i.next())o(r.value).J(t,n)}))},t.all=function(e){var n=a(e),i=n.next();return i.done?o([]):new t((function(e,t){function r(t){return function(n){a[t]=n,0==--s&&e(a)}}var a=[],s=0;do{a.push(void 0),s++,o(i.value).J(r(a.length-1),t),i=n.next()}while(!i.done)}))},t})),o("Object.is",(function(e){return e||function(e,t){return e===t?0!==e||1/e===1/t:e!==e&&t!==t}})),o("Array.prototype.includes",(function(e){return e||function(e,t){var n=this;n instanceof String&&(n=String(n));var i=n.length;for(0>(t=t||0)&&(t=Math.max(t+i,0));t<i;t++){var o=n[t];if(o===e||Object.is(o,e))return!0}return!1}})),o("String.prototype.includes",(function(e){return e||function(e,t){if(null==this)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(e instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return-1!==this.indexOf(e,t||0)}})),o("Array.prototype.keys",(function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,i=!1,o={next:function(){if(!i&&n<e.length){var o=n++;return{value:t(o,e[o]),done:!1}}return i=!0,{done:!0,value:void 0}}};return o[Symbol.iterator]=function(){return o},o}(this,(function(e){return e}))}}));var E=this||self;function A(e,t){e=e.split(".");var n,i=E;e[0]in i||"undefined"==typeof i.execScript||i.execScript("var "+e[0]);for(;e.length&&(n=e.shift());)e.length||void 0===t?i=i[n]&&i[n]!==Object.prototype[n]?i[n]:i[n]={}:i[n]=t}function T(e,t){return t=String.fromCharCode.apply(null,t),null==e?t:e+t}var R,D,k="undefined"!==typeof TextDecoder,M="undefined"!==typeof TextEncoder;function P(e){if(M)e=(D||(D=new TextEncoder)).encode(e);else{var t=void 0;t=void 0!==t&&t;for(var n=0,i=new Uint8Array(3*e.length),o=0;o<e.length;o++){var r=e.charCodeAt(o);if(128>r)i[n++]=r;else{if(2048>r)i[n++]=r>>6|192;else{if(55296<=r&&57343>=r){if(56319>=r&&o<e.length){var a=e.charCodeAt(++o);if(56320<=a&&57343>=a){r=1024*(r-55296)+a-56320+65536,i[n++]=r>>18|240,i[n++]=r>>12&63|128,i[n++]=r>>6&63|128,i[n++]=63&r|128;continue}o--}if(t)throw Error("Found an unpaired surrogate");r=65533}i[n++]=r>>12|224,i[n++]=r>>6&63|128}i[n++]=63&r|128}}e=i.subarray(0,n)}return e}var _={},Z=null;function F(e,t){void 0===t&&(t=0),V(),t=_[t];for(var n=Array(Math.floor(e.length/3)),i=t[64]||"",o=0,r=0;o<e.length-2;o+=3){var a=e[o],s=e[o+1],c=e[o+2],l=t[a>>2];a=t[(3&a)<<4|s>>4],s=t[(15&s)<<2|c>>6],c=t[63&c],n[r++]=l+a+s+c}switch(l=0,c=i,e.length-o){case 2:c=t[(15&(l=e[o+1]))<<2]||i;case 1:e=e[o],n[r]=t[e>>2]+t[(3&e)<<4|l>>4]+c+i}return n.join("")}function N(e){var t=e.length,n=3*t/4;n%3?n=Math.floor(n):-1!="=.".indexOf(e[t-1])&&(n=-1!="=.".indexOf(e[t-2])?n-2:n-1);var i=new Uint8Array(n),o=0;return function(e,t){function n(t){for(;i<e.length;){var n=e.charAt(i++),o=Z[n];if(null!=o)return o;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return t}V();for(var i=0;;){var o=n(-1),r=n(0),a=n(64),s=n(64);if(64===s&&-1===o)break;t(o<<2|r>>4),64!=a&&(t(r<<4&240|a>>2),64!=s&&t(a<<6&192|s))}}(e,(function(e){i[o++]=e})),i.subarray(0,o)}function V(){if(!Z){Z={};for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),t=["+/=","+/","-_=","-_.","-_"],n=0;5>n;n++){var i=e.concat(t[n].split(""));_[n]=i;for(var o=0;o<i.length;o++){var r=i[o];void 0===Z[r]&&(Z[r]=o)}}}}var x,j="function"===typeof Uint8Array.prototype.slice;function W(e,t,n){return t===n?x||(x=new Uint8Array(0)):j?e.slice(t,n):new Uint8Array(e.subarray(t,n))}var U=0;function G(e,t){t=void 0!==(t=void 0===t?{}:t).v&&t.v,this.h=null,this.g=this.i=this.j=0,this.l=!1,this.v=t,e&&X(this,e)}function X(e,t){t=t.constructor===Uint8Array?t:t.constructor===ArrayBuffer||t.constructor===Array?new Uint8Array(t):t.constructor===String?N(t):t instanceof Uint8Array?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):new Uint8Array(0),e.h=t,e.j=0,e.i=e.h.length,e.g=e.j}function B(e){var t=e.h,n=t[e.g],i=127&n;return 128>n?(e.g+=1,i):(i|=(127&(n=t[e.g+1]))<<7,128>n?(e.g+=2,i):(i|=(127&(n=t[e.g+2]))<<14,128>n?(e.g+=3,i):(i|=(127&(n=t[e.g+3]))<<21,128>n?(e.g+=4,i):(i|=(15&(n=t[e.g+4]))<<28,128>n?(e.g+=5,i>>>0):(e.g+=5,128<=t[e.g++]&&128<=t[e.g++]&&128<=t[e.g++]&&128<=t[e.g++]&&e.g++,i)))))}function L(e){var t=e.h[e.g],n=e.h[e.g+1],i=e.h[e.g+2],o=e.h[e.g+3];return e.g+=4,e=2*((n=(t<<0|n<<8|i<<16|o<<24)>>>0)>>31)+1,t=n>>>23&255,n&=8388607,255==t?n?NaN:1/0*e:0==t?e*Math.pow(2,-149)*n:e*Math.pow(2,t-150)*(n+Math.pow(2,23))}G.prototype.reset=function(){this.g=this.j};var H=[];function Y(){this.g=new Uint8Array(64),this.h=0}function Q(e,t){for(;127<t;)e.push(127&t|128),t>>>=7;e.push(t)}function J(e){var t={},n=void 0!==t.N&&t.N;this.o={v:void 0!==t.v&&t.v},this.N=n,t=this.o,H.length?(n=H.pop(),t&&(n.v=t.v),e&&X(n,e),e=n):e=new G(e,t),this.g=e,this.m=this.g.g,this.h=this.i=this.l=-1,this.j=!1}function K(e){var t=e.g;if((t=t.g==t.i)||(t=e.j)||(t=(t=e.g).l||0>t.g||t.g>t.i),t)return!1;e.m=e.g.g;var n=7&(t=B(e.g));return 0!=n&&5!=n&&1!=n&&2!=n&&3!=n&&4!=n?(e.j=!0,!1):(e.i=t,e.l=t>>>3,e.h=n,!0)}function z(e){switch(e.h){case 0:if(0!=e.h)z(e);else{for(e=e.g;128&e.h[e.g];)e.g++;e.g++}break;case 1:1!=e.h?z(e):(e=e.g).g+=8;break;case 2:if(2!=e.h)z(e);else{var t=B(e.g);(e=e.g).g+=t}break;case 5:5!=e.h?z(e):(e=e.g).g+=4;break;case 3:for(t=e.l;;){if(!K(e)){e.j=!0;break}if(4==e.h){e.l!=t&&(e.j=!0);break}z(e)}break;default:e.j=!0}}function $(e,t,n){var i=e.g.i,o=B(e.g);return o=e.g.g+o,e.g.i=o,n(t,e),e.g.g=o,e.g.i=i,t}function q(e){var t,n=B(e.g),i=(e=e.g).g;if(e.g+=n,e=e.h,k)(t=R)||(t=R=new TextDecoder("utf-8",{fatal:!1})),t=t.decode(e.subarray(i,i+n));else{n=i+n;for(var o,r,a,s=[],c=null;i<n;)128>(o=e[i++])?s.push(o):224>o?i>=n?s.push(65533):(r=e[i++],194>o||128!==(192&r)?(i--,s.push(65533)):s.push((31&o)<<6|63&r)):240>o?i>=n-1?s.push(65533):128!==(192&(r=e[i++]))||224===o&&160>r||237===o&&160<=r||128!==(192&(t=e[i++]))?(i--,s.push(65533)):s.push((15&o)<<12|(63&r)<<6|63&t):244>=o?i>=n-2?s.push(65533):128!==(192&(r=e[i++]))||0!==r-144+(o<<28)>>30||128!==(192&(t=e[i++]))||128!==(192&(a=e[i++]))?(i--,s.push(65533)):(o=(7&o)<<18|(63&r)<<12|(63&t)<<6|63&a,o-=65536,s.push(55296+(o>>10&1023),56320+(1023&o))):s.push(65533),8192<=s.length&&(c=T(c,s),s.length=0);t=T(c,s)}return t}function ee(){this.h=[],this.i=0,this.g=new Y}function te(e,t){0!==t.length&&(e.h.push(t),e.i+=t.length)}function ne(e){var t=e.i+e.g.length();if(0===t)return new Uint8Array(0);t=new Uint8Array(t);for(var n=e.h,i=n.length,o=0,r=0;r<i;r++){var a=n[r];0!==a.length&&(t.set(a,o),o+=a.length)}return 0!==(i=(n=e.g).h)&&(t.set(n.g.subarray(0,i),o),n.h=0),e.h=[t],t}function ie(e,t,n){if(null!=n){Q(e.g,8*t+5),e=e.g;var i=n;0===(i=(n=0>i?1:0)?-i:i)?0<1/i?U=0:(0,U=2147483648):isNaN(i)?(0,U=2147483647):34028234663852886e22<i?(0,U=(n<<31|2139095040)>>>0):11754943508222875e-54>i?(i=Math.round(i/Math.pow(2,-149)),0,U=(n<<31|i)>>>0):(t=Math.floor(Math.log(i)/Math.LN2),i*=Math.pow(2,-t),i=8388607&Math.round(8388608*i),0,U=(n<<31|t+127<<23|i)>>>0),n=U,e.push(n>>>0&255),e.push(n>>>8&255),e.push(n>>>16&255),e.push(n>>>24&255)}}Y.prototype.push=function(e){if(!(this.h+1<this.g.length)){var t=this.g;this.g=new Uint8Array(Math.ceil(1+2*this.g.length)),this.g.set(t)}this.g[this.h++]=e},Y.prototype.length=function(){return this.h},Y.prototype.end=function(){var e=this.g,t=this.h;return this.h=0,W(e,0,t)},J.prototype.reset=function(){this.g.reset(),this.h=this.l=-1};var oe="function"===typeof Uint8Array;function re(e,t,n){if(null!=e)return"object"===typeof e?oe&&e instanceof Uint8Array?n(e):ae(e,t,n):t(e)}function ae(e,t,n){if(Array.isArray(e)){for(var i=Array(e.length),o=0;o<e.length;o++)i[o]=re(e[o],t,n);return Array.isArray(e)&&e.W&&ue(i),i}for(o in i={},e)i[o]=re(e[o],t,n);return i}function se(e){return"number"===typeof e?isFinite(e)?e:String(e):e}var ce,le={W:{value:!0,configurable:!0}};function ue(e){return Array.isArray(e)&&!Object.isFrozen(e)&&Object.defineProperties(e,le),e}function de(e,t,n){var i=ce;if(ce=null,e||(e=i),i=this.constructor.ca,e||(e=i?[i]:[]),this.j=i?0:-1,this.i=null,this.g=e,e=(i=this.g.length)-1,i&&null!==(i=this.g[e])&&"object"===typeof i&&i.constructor===Object?(this.l=e-this.j,this.h=i):void 0!==t&&-1<t?(this.l=Math.max(t,e+1-this.j),this.h=null):this.l=Number.MAX_VALUE,n)for(t=0;t<n.length;t++)(e=n[t])<this.l?(e+=this.j,(i=this.g[e])?ue(i):this.g[e]=ge):(fe(this),(i=this.h[e])?ue(i):this.h[e]=ge)}var ge=Object.freeze(ue([]));function fe(e){var t=e.l+e.j;e.g[t]||(e.h=e.g[t]={})}function pe(e,t,n){return-1===t?null:void 0!==n&&n||t>=e.l?e.h?e.h[t]:void 0:e.g[t+e.j]}function he(e){var t=void 0!==t&&t,n=pe(e,1,t);return null==n&&(n=ge),n===ge&&ye(e,1,n=ue([]),t),n}function me(e,t,n){return null==(e=null==(e=pe(e,t))?e:+e)?void 0===n?0:n:e}function ye(e,t,n,i){void 0!==i&&i||t>=e.l?(fe(e),e.h[t]=n):e.g[t+e.j]=n}function Ce(e,t){e.i||(e.i={});var n=e.i[1];if(!n){var i=he(e);n=[];for(var o=0;o<i.length;o++)n[o]=new t(i[o]);e.i[1]=n}return n}function be(e,t,n,i){var o=Ce(e,n);t=t||new n,e=he(e),void 0!=i?(o.splice(i,0,t),e.splice(i,0,ve(t))):(o.push(t),e.push(ve(t)))}function ve(e,t){if(e.i)for(var n in e.i){var i=e.i[n];if(Array.isArray(i))for(var o=0;o<i.length;o++)i[o]&&ve(i[o]);else i&&ve(i)}return e.g}function we(e,t){return null==(e=pe(e,t))?0:e}function Ie(e,t){return null==(e=pe(e,t))?"":e}function Se(e,t){if(e=e.m){te(t,t.g.end());for(var n=0;n<e.length;n++)te(t,e[n])}}function Oe(e,t){if(4==t.h)return!1;var n=t.m;return z(t),t.N||(t=W(t.g.h,n,t.g.g),(n=e.m)?n.push(t):e.m=[t]),!0}function Ee(e,t){var n=void 0;return new(n||(n=Promise))((function(i,o){function r(e){try{s(t.next(e))}catch(n){o(n)}}function a(e){try{s(t.throw(e))}catch(n){o(n)}}function s(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(r,a)}s((t=t.apply(e,void 0)).next())}))}function Ae(e){de.call(this,e)}function Te(e,t){for(;K(t);)switch(t.i){case 8:var n=B(t.g);ye(e,1,n);break;case 21:ye(e,2,n=L(t.g));break;case 26:ye(e,3,n=q(t));break;case 34:ye(e,4,n=q(t));break;default:if(!Oe(e,t))return e}return e}function Re(e){de.call(this,e,-1,De)}de.prototype.toJSON=function(){return ae(ve(this),se,F)},de.prototype.toString=function(){return ve(this).toString()},f(Ae,de),f(Re,de),Re.prototype.addClassification=function(e,t){be(this,e,Ae,t)};var De=[1];function ke(e){de.call(this,e)}function Me(e,t){for(;K(t);)switch(t.i){case 13:var n=L(t.g);ye(e,1,n);break;case 21:ye(e,2,n=L(t.g));break;case 29:ye(e,3,n=L(t.g));break;case 37:ye(e,4,n=L(t.g));break;case 45:ye(e,5,n=L(t.g));break;default:if(!Oe(e,t))return e}return e}function Pe(e){de.call(this,e,-1,_e)}f(ke,de),f(Pe,de);var _e=[1];function Ze(e){de.call(this,e)}function Fe(e,t,n){if(n=e.createShader(0===n?e.VERTEX_SHADER:e.FRAGMENT_SHADER),e.shaderSource(n,t),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS))throw Error("Could not compile WebGL shader.\n\n"+e.getShaderInfoLog(n));return n}function Ne(e){return Ce(e,Ae).map((function(e){return{index:we(e,1),Y:me(e,2),label:null!=pe(e,3)?Ie(e,3):void 0,displayName:null!=pe(e,4)?Ie(e,4):void 0}}))}function Ve(e){return{x:me(e,1),y:me(e,2),z:me(e,3),visibility:null!=pe(e,4)?me(e,4):void 0}}function xe(e,t){this.h=e,this.g=t,this.l=0}function je(e,t,n){return function(e,t){var n=e.g;if(void 0===e.m){var i=Fe(n,"\n  attribute vec2 aVertex;\n  attribute vec2 aTex;\n  varying vec2 vTex;\n  void main(void) {\n    gl_Position = vec4(aVertex, 0.0, 1.0);\n    vTex = aTex;\n  }",0),o=Fe(n,"\n  precision mediump float;\n  varying vec2 vTex;\n  uniform sampler2D sampler0;\n  void main(){\n    gl_FragColor = texture2D(sampler0, vTex);\n  }",1),r=n.createProgram();if(n.attachShader(r,i),n.attachShader(r,o),n.linkProgram(r),!n.getProgramParameter(r,n.LINK_STATUS))throw Error("Could not compile WebGL program.\n\n"+n.getProgramInfoLog(r));i=e.m=r,n.useProgram(i),o=n.getUniformLocation(i,"sampler0"),e.j={I:n.getAttribLocation(i,"aVertex"),H:n.getAttribLocation(i,"aTex"),da:o},e.s=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,e.s),n.enableVertexAttribArray(e.j.I),n.vertexAttribPointer(e.j.I,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),e.o=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,e.o),n.enableVertexAttribArray(e.j.H),n.vertexAttribPointer(e.j.H,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),n.uniform1i(o,0)}i=e.j,n.useProgram(e.m),n.canvas.width=t.width,n.canvas.height=t.height,n.viewport(0,0,t.width,t.height),n.activeTexture(n.TEXTURE0),e.h.bindTexture2d(t.glName),n.enableVertexAttribArray(i.I),n.bindBuffer(n.ARRAY_BUFFER,e.s),n.vertexAttribPointer(i.I,2,n.FLOAT,!1,0,0),n.enableVertexAttribArray(i.H),n.bindBuffer(n.ARRAY_BUFFER,e.o),n.vertexAttribPointer(i.H,2,n.FLOAT,!1,0,0),n.bindFramebuffer(n.DRAW_FRAMEBUFFER?n.DRAW_FRAMEBUFFER:n.FRAMEBUFFER,null),n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT),n.colorMask(!0,!0,!0,!0),n.drawArrays(n.TRIANGLE_FAN,0,4),n.disableVertexAttribArray(i.I),n.disableVertexAttribArray(i.H),n.bindBuffer(n.ARRAY_BUFFER,null),e.h.bindTexture2d(0)}(e,t),"function"===typeof e.g.canvas.transferToImageBitmap?Promise.resolve(e.g.canvas.transferToImageBitmap()):n?Promise.resolve(e.g.canvas):"function"===typeof createImageBitmap?createImageBitmap(e.g.canvas):(void 0===e.i&&(e.i=document.createElement("canvas")),new Promise((function(t){e.i.height=e.g.canvas.height,e.i.width=e.g.canvas.width,e.i.getContext("2d",{}).drawImage(e.g.canvas,0,0,e.g.canvas.width,e.g.canvas.height),t(e.i)})))}function We(e){this.g=e}f(Ze,de);var Ue=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function Ge(e,t){return t+e}function Xe(e,t){window[e]=t}function Be(e){if(this.g=e,this.listeners={},this.j={},this.F={},this.m={},this.s={},this.G=this.o=this.R=!0,this.C=Promise.resolve(),this.P="",this.B={},this.locateFile=e&&e.locateFile||Ge,"object"===typeof window)var t=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else{if("undefined"===typeof location)throw Error("solutions can only be loaded on a web page or in a web worker");t=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/"}if(this.S=t,e.options)for(var n=(t=a(Object.keys(e.options))).next();!n.done;n=t.next()){n=n.value;var i=e.options[n].default;void 0!==i&&(this.j[n]="function"===typeof i?i():i)}}function Le(e){return Ee(e,(function e(){var t,n,i,o,r,a,c,l,u,d,g,f=this;return S(e,(function(e){switch(e.g){case 1:return t=f,f.R?(n=function(e,t){return void 0===e.g.files?[]:"function"===typeof e.g.files?e.g.files(t):e.g.files}(f,f.j),C(e,function(){return Ee(this,(function e(){return S(e,(function(e){switch(e.g){case 1:return e.m=2,C(e,WebAssembly.instantiate(Ue),4);case 4:e.g=3,e.m=0;break;case 2:return e.m=0,e.j=null,e.return(!1);case 3:return e.return(!0)}}))}))}(),2)):e.return();case 2:if(i=e.h,"object"===typeof window)return Xe("createMediapipeSolutionsWasm",{locateFile:f.locateFile}),Xe("createMediapipeSolutionsPackedAssets",{locateFile:f.locateFile}),a=n.filter((function(e){return void 0!==e.data})),c=n.filter((function(e){return void 0===e.data})),l=Promise.all(a.map((function(e){var n=He(t,e.url);if(void 0!==e.path){var i=e.path;n=n.then((function(e){return t.overrideFile(i,e),Promise.resolve(e)}))}return n}))),u=Promise.all(c.map((function(e){return void 0===e.simd||e.simd&&i||!e.simd&&!i?function(e){var t=document.createElement("script");return t.setAttribute("src",e),t.setAttribute("crossorigin","anonymous"),new Promise((function(e){t.addEventListener("load",(function(){e()}),!1),t.addEventListener("error",(function(){e()}),!1),document.body.appendChild(t)}))}(t.locateFile(e.url,t.S)):Promise.resolve()}))).then((function(){return Ee(t,(function e(){var t,n,i=this;return S(e,(function(e){if(1==e.g)return t=window.createMediapipeSolutionsWasm,n=window.createMediapipeSolutionsPackedAssets,C(e,t(n),2);i.h=e.h,e.g=0}))}))})),d=Ee(t,(function e(){var t=this;return S(e,(function(e){return t.g.graph&&t.g.graph.url?e=C(e,He(t,t.g.graph.url),0):(e.g=0,e=void 0),e}))})),C(e,Promise.all([u,l,d]),7);if("function"!==typeof importScripts)throw Error("solutions can only be loaded on a web page or in a web worker");return o=n.filter((function(e){return void 0===e.simd||e.simd&&i||!e.simd&&!i})).map((function(e){return t.locateFile(e.url,t.S)})),importScripts.apply(null,s(o)),C(e,createMediapipeSolutionsWasm(Module),6);case 6:f.h=e.h,f.l=new OffscreenCanvas(1,1),f.h.canvas=f.l,r=f.h.GL.createContext(f.l,{antialias:!1,alpha:!1,ba:"undefined"!==typeof WebGL2RenderingContext?2:1}),f.h.GL.makeContextCurrent(r),e.g=4;break;case 7:if(f.l=document.createElement("canvas"),!(g=f.l.getContext("webgl2",{}))&&!(g=f.l.getContext("webgl",{})))return alert("Failed to create WebGL canvas context when passing video frame."),e.return();f.D=g,f.h.canvas=f.l,f.h.createContext(f.l,!0,!0,{});case 4:f.i=new f.h.SolutionWasm,f.R=!1,e.g=0}}))}))}function He(e,t){return Ee(e,(function e(){var n,i,o=this;return S(e,(function(e){return t in o.F?e.return(o.F[t]):(n=o.locateFile(t,""),i=fetch(n).then((function(e){return e.arrayBuffer()})),o.F[t]=i,e.return(i))}))}))}function Ye(e,t,n){return Ee(e,(function e(){var i,o,r,s,c,l,u,d,g,f,p,h,m,y,b=this;return S(e,(function(e){switch(e.g){case 1:if(!n)return e.return(t);for(i={},o=0,r=a(Object.keys(n)),s=r.next();!s.done;s=r.next())c=s.value,"string"!==typeof(l=n[c])&&"texture"===l.type&&void 0!==t[l.stream]&&++o;1<o&&(b.G=!1),u=a(Object.keys(n)),s=u.next();case 2:if(s.done){e.g=4;break}if(d=s.value,"string"===typeof(g=n[d]))return m=i,y=d,C(e,function(e,t,n){return Ee(e,(function e(){var i,o=this;return S(e,(function(e){return"number"===typeof n||n instanceof Uint8Array||n instanceof o.h.Uint8BlobList?e.return(n):n instanceof o.h.Texture2dDataOut?((i=o.s[t])||(i=new xe(o.h,o.D),o.s[t]=i),e.return(je(i,n,o.G))):e.return(void 0)}))}))}(b,d,t[g]),14);if(f=t[g.stream],"detection_list"===g.type){if(f){for(var v=f.getRectList(),w=f.getLandmarksList(),I=f.getClassificationsList(),O=[],E=0;E<v.size();++E){var A=v.get(E);e:{var T=new Ze;for(A=new J(A);K(A);)switch(A.i){case 13:var R=L(A.g);ye(T,1,R);break;case 21:ye(T,2,R=L(A.g));break;case 29:ye(T,3,R=L(A.g));break;case 37:ye(T,4,R=L(A.g));break;case 45:ye(T,5,R=L(A.g));break;case 48:for(var D=A.g,k=128,M=0,P=R=0;4>P&&128<=k;P++)M|=(127&(k=D.h[D.g++]))<<7*P;if(128<=k&&(M|=(127&(k=D.h[D.g++]))<<28,R|=(127&k)>>4),128<=k)for(P=0;5>P&&128<=k;P++)R|=(127&(k=D.h[D.g++]))<<7*P+3;128>k?(D=M>>>0,(R=2147483648&(k=R>>>0))&&(k=~k>>>0,0==(D=1+~D>>>0)&&(k=k+1>>>0)),D=4294967296*k+(D>>>0),R=R?-D:D):(D.l=!0,R=void 0),ye(T,6,R);break;default:if(!Oe(T,A))break e}}T={Z:me(T,1),$:me(T,2),height:me(T,3),width:me(T,4),rotation:me(T,5,0),X:we(T,6)},R=w.get(E);e:for(A=new Pe,R=new J(R);K(R);)switch(R.i){case 10:be(A,D=$(R,new ke,Me),ke,void 0);break;default:if(!Oe(A,R))break e}A=Ce(A,ke).map(Ve),D=I.get(E);e:for(R=new Re,D=new J(D);K(D);)switch(D.i){case 10:R.addClassification($(D,new Ae,Te));break;default:if(!Oe(R,D))break e}T={T:T,O:A,M:Ne(R)},O.push(T)}v=O}else v=[];i[d]=v,e.g=7;break}if("proto_list"===g.type){if(f){for(v=Array(f.size()),w=0;w<f.size();w++)v[w]=f.get(w);f.delete()}else v=[];i[d]=v,e.g=7;break}if(void 0===f){e.g=3;break}if("float_list"===g.type){i[d]=f,e.g=7;break}if("proto"===g.type){i[d]=f,e.g=7;break}if("texture"!==g.type)throw Error("Unknown output config type: '"+g.type+"'");return(p=b.s[d])||(p=new xe(b.h,b.D),b.s[d]=p),C(e,je(p,f,b.G),13);case 13:h=e.h,i[d]=h;case 7:g.transform&&i[d]&&(i[d]=g.transform(i[d])),e.g=3;break;case 14:m[y]=e.h;case 3:s=u.next(),e.g=2;break;case 4:return e.return(i)}}))}))}function Qe(e,t){for(var n=t.name||"$",i=[].concat(s(t.wants)),o=new e.h.StringList,r=a(t.wants),c=r.next();!c.done;c=r.next())o.push_back(c.value);r=e.h.PacketListener.implement({onResults:function(o){for(var r={},a=0;a<t.wants.length;++a)r[i[a]]=o.get(a);var s=e.listeners[n];s&&(e.C=Ye(e,r,t.outs).then((function(n){n=s(n);for(var o=0;o<t.wants.length;++o){var a=r[i[o]];"object"===typeof a&&a.hasOwnProperty&&a.hasOwnProperty("delete")&&a.delete()}n&&(e.C=n)})))}}),e.i.attachMultiListener(o,r),o.delete()}function Je(e){switch(void 0===e&&(e=0),e){case 1:return"selfie_segmentation_landscape.tflite";default:return"selfie_segmentation.tflite"}}function Ke(e){var t=this;e=e||{},this.g=new Be({locateFile:e.locateFile,files:function(e){return[{simd:!0,url:"selfie_segmentation_solution_simd_wasm_bin.js"},{simd:!1,url:"selfie_segmentation_solution_wasm_bin.js"},{data:!0,url:Je(e.modelSelection)}]},graph:{url:"selfie_segmentation.binarypb"},listeners:[{wants:["segmentation_mask","image_transformed"],outs:{image:{type:"texture",stream:"image_transformed"},segmentationMask:{type:"texture",stream:"segmentation_mask"}}}],inputs:{image:{type:"video",stream:"input_frames_gpu"}},options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},modelSelection:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorModelSelection",fieldName:"int_value"},onChange:function(e){return Ee(t,(function t(){var n,i,o,r=this;return S(t,(function(t){return 1==t.g?(n=Je(e),i="third_party/mediapipe/modules/selfie_segmentation/"+n,C(t,He(r.g,n),2)):(o=t.h,r.g.overrideFile(i,o),t.return(!0))}))}))}}}})}(e=Be.prototype).close=function(){return this.i&&this.i.delete(),Promise.resolve()},e.reset=function(){return Ee(this,(function e(){var t=this;return S(e,(function(e){t.i&&(t.i.reset(),t.m={},t.s={}),e.g=0}))}))},e.setOptions=function(e,t){var n=this;if(t=t||this.g.options){for(var i=[],o=[],r={},s=a(Object.keys(e)),c=s.next();!c.done;r={K:r.K,L:r.L},c=s.next()){var l=c.value;l in this.j&&this.j[l]===e[l]||(this.j[l]=e[l],void 0!==(c=t[l])&&(c.onChange&&(r.K=c.onChange,r.L=e[l],i.push(function(e){return function(){return Ee(n,(function t(){var n=this;return S(t,(function(t){if(1==t.g)return C(t,e.K(e.L),2);!0===t.h&&(n.o=!0),t.g=0}))}))}}(r))),c.graphOptionXref&&(l={valueNumber:1===c.type?e[l]:0,valueBoolean:0===c.type&&e[l],valueString:2===c.type?e[l]:""},c=Object.assign(Object.assign(Object.assign({},{calculatorName:"",calculatorIndex:0}),c.graphOptionXref),l),o.push(c))))}0===i.length&&0===o.length||(this.o=!0,this.A=(void 0===this.A?[]:this.A).concat(o),this.u=(void 0===this.u?[]:this.u).concat(i))}},e.initialize=function(){return Ee(this,(function e(){var t=this;return S(e,(function(e){return 1==e.g?C(e,Le(t),2):3!=e.g?C(e,Ee(t,(function e(){var t,n,i,o,r,s,c,l,u=this;return S(e,(function(e){if(1==e.g)return u.g.graph&&u.g.graph.url&&u.P===u.g.graph.url?e.return():(u.o=!0,u.g.graph&&u.g.graph.url?(u.P=u.g.graph.url,C(e,He(u,u.g.graph.url),3)):void(e.g=2));for(2!=e.g&&(t=e.h,u.i.loadGraph(t)),n=a(Object.keys(u.B)),i=n.next();!i.done;i=n.next())o=i.value,u.i.overrideFile(o,u.B[o]);if(u.B={},u.g.listeners)for(r=a(u.g.listeners),s=r.next();!s.done;s=r.next())c=s.value,Qe(u,c);l=u.j,u.j={},u.setOptions(l),e.g=0}))})),3):C(e,function(e){return Ee(e,(function e(){var t,n,i,o,r,s,c=this;return S(e,(function(e){switch(e.g){case 1:if(!c.o)return e.return();if(!c.u){e.g=2;break}t=a(c.u),n=t.next();case 3:if(n.done){e.g=5;break}return C(e,(0,n.value)(),4);case 4:n=t.next(),e.g=3;break;case 5:c.u=void 0;case 2:if(c.A){for(i=new c.h.GraphOptionChangeRequestList,o=a(c.A),r=o.next();!r.done;r=o.next())s=r.value,i.push_back(s);c.i.changeOptions(i),i.delete(),c.A=void 0}c.o=!1,e.g=0}}))}))}(t),0)}))}))},e.overrideFile=function(e,t){this.i?this.i.overrideFile(e,t):this.B[e]=t},e.clearOverriddenFiles=function(){this.B={},this.i&&this.i.clearOverriddenFiles()},e.send=function(e,t){return Ee(this,(function n(){var i,o,r,s,c,l,u,d,g,f=this;return S(n,(function(n){switch(n.g){case 1:return f.g.inputs?(i=1e3*(void 0===t||null===t?performance.now():t),C(n,f.C,2)):n.return();case 2:return C(n,f.initialize(),3);case 3:for(o=new f.h.PacketDataList,r=a(Object.keys(e)),s=r.next();!s.done;s=r.next())if(c=s.value,l=f.g.inputs[c]){e:{var p=f,h=e[c];switch(l.type){case"video":var m=p.m[l.stream];if(m||(m=new xe(p.h,p.D),p.m[l.stream]=m),0===(p=m).l&&(p.l=p.h.createTexture()),"undefined"!==typeof HTMLVideoElement&&h instanceof HTMLVideoElement){var y=h.videoWidth;m=h.videoHeight}else"undefined"!==typeof HTMLImageElement&&h instanceof HTMLImageElement?(y=h.naturalWidth,m=h.naturalHeight):(y=h.width,m=h.height);m={glName:p.l,width:y,height:m},(y=p.g).canvas.width=m.width,y.canvas.height=m.height,y.activeTexture(y.TEXTURE0),p.h.bindTexture2d(p.l),y.texImage2D(y.TEXTURE_2D,0,y.RGBA,y.RGBA,y.UNSIGNED_BYTE,h),p.h.bindTexture2d(0),p=m;break e;case"detections":for((m=p.m[l.stream])||(m=new We(p.h),p.m[l.stream]=m),(p=m).data||(p.data=new p.g.DetectionListData),p.data.reset(h.length),m=0;m<h.length;++m){y=h[m];var b=p.data,v=b.setBoundingBox,w=m,I=y.T,S=new Ze;ye(S,1,I.Z),ye(S,2,I.$),ye(S,3,I.height),ye(S,4,I.width),ye(S,5,I.rotation),ye(S,6,I.X);var O=I=new ee;ie(O,1,pe(S,1)),ie(O,2,pe(S,2)),ie(O,3,pe(S,3)),ie(O,4,pe(S,4)),ie(O,5,pe(S,5));var E=pe(S,6);if(null!=E&&null!=E){Q(O.g,48);var A=O.g,T=E;E=0>T;var R=(T=Math.abs(T))>>>0;for(T=Math.floor((T-R)/4294967296),T>>>=0,E&&(T=~T>>>0,4294967295<(R=1+(~R>>>0))&&(R=0,4294967295<++T&&(T=0))),E=U=R,R=T;0<R||127<E;)A.push(127&E|128),E=(E>>>7|R<<25)>>>0,R>>>=7;A.push(E)}if(Se(S,O),I=ne(I),v.call(b,w,I),y.O)for(b=0;b<y.O.length;++b)O=!!(S=y.O[b]).visibility,w=(v=p.data).addNormalizedLandmark,I=m,S=Object.assign(Object.assign({},S),{visibility:O?S.visibility:0}),ye(O=new ke,1,S.x),ye(O,2,S.y),ye(O,3,S.z),S.visibility&&ye(O,4,S.visibility),ie(A=S=new ee,1,pe(O,1)),ie(A,2,pe(O,2)),ie(A,3,pe(O,3)),ie(A,4,pe(O,4)),ie(A,5,pe(O,5)),Se(O,A),S=ne(S),w.call(v,I,S);if(y.M)for(b=0;b<y.M.length;++b){if(w=(v=p.data).addClassification,I=m,S=y.M[b],ye(O=new Ae,2,S.Y),S.index&&ye(O,1,S.index),S.label&&ye(O,3,S.label),S.displayName&&ye(O,4,S.displayName),A=S=new ee,null!=(R=pe(O,1))&&null!=R)if(Q(A.g,8),E=A.g,0<=R)Q(E,R);else{for(T=0;9>T;T++)E.push(127&R|128),R>>=7;E.push(1)}ie(A,2,pe(O,2)),null!=(E=pe(O,3))&&(E=P(E),Q(A.g,26),Q(A.g,E.length),te(A,A.g.end()),te(A,E)),null!=(E=pe(O,4))&&(E=P(E),Q(A.g,34),Q(A.g,E.length),te(A,A.g.end()),te(A,E)),Se(O,A),S=ne(S),w.call(v,I,S)}}p=p.data;break e;default:p={}}}switch(u=p,d=l.stream,l.type){case"video":o.pushTexture2d(Object.assign(Object.assign({},u),{stream:d,timestamp:i}));break;case"detections":(g=u).stream=d,g.timestamp=i,o.pushDetectionList(g);break;default:throw Error("Unknown input config type: '"+l.type+"'")}}return f.i.send(o),C(n,f.C,4);case 4:o.delete(),n.g=0}}))}))},e.onResults=function(e,t){this.listeners[t||"$"]=e},A("Solution",Be),A("OptionType",{BOOL:0,NUMBER:1,aa:2,0:"BOOL",1:"NUMBER",2:"STRING"}),(e=Ke.prototype).close=function(){return this.g.close(),Promise.resolve()},e.onResults=function(e){this.g.onResults(e)},e.initialize=function(){return Ee(this,(function e(){var t=this;return S(e,(function(e){return C(e,t.g.initialize(),0)}))}))},e.reset=function(){this.g.reset()},e.send=function(e){return Ee(this,(function t(){var n=this;return S(t,(function(t){return C(t,n.g.send(e),0)}))}))},e.setOptions=function(e){this.g.setOptions(e)},A("SelfieSegmentation",Ke),A("VERSION","0.1.1632777926")}).call(p);var h=SelfieSegmentation;class m{segmentation;trackProcessor;constructor(e){const t={};e=function(e){if("/"===e.slice(-1))return e.slice(0,-1);return e}(e),t.locateFile=t=>`${e}/${t}`,this.segmentation=new h(t)}static isSupported(){return!("undefined"===typeof MediaStreamTrackProcessor||"undefined"===typeof MediaStreamTrackGenerator)}startProcessing(e,t={}){if(this.isProcessing())throw Error("Virtual background processing has already started.");return this.trackProcessor=new y(e,this.segmentation,t),this.trackProcessor.startProcessing()}stopProcessing(){void 0!==this.trackProcessor&&(this.trackProcessor.stopProcessing(),this.trackProcessor=void 0)}isProcessing(){return void 0!==this.trackProcessor}}class y{options;track;canvas;canvasCtx;segmentation;abortController;constructor(e,t,n){this.options=n,this.track=e;const i=e.getSettings().width,o=e.getSettings().height;if(void 0===i||void 0===o)throw Error("Could not retrieve the resolution of the video track: {track}");this.canvas=new OffscreenCanvas(i,o);const r=this.canvas.getContext("2d",{desynchronized:!0});if(!r)throw Error("Failed to get the 2D context of an OffscreenCanvas");this.canvasCtx=r;let a=1;n.segmentationModel&&"selfie-general"===n.segmentationModel&&(a=0),t.setOptions({modelSelection:a}),t.onResults((e=>{this.updateOffscreenCanvas(e)})),this.segmentation=t,this.abortController=new AbortController}async startProcessing(){await this.segmentation.initialize();const e=this.abortController.signal,t=new MediaStreamTrackGenerator({kind:"video"}),n=new MediaStreamTrackProcessor({track:this.track});return n.readable.pipeThrough(new TransformStream({transform:async(e,t)=>{await this.transform(e,t)}}),{signal:e}).pipeTo(t.writable).catch((i=>{e.aborted?console.debug("Shutting down streams after abort."):console.warn("Error from stream transform:",i),n.readable.cancel(i).catch((e=>{console.warn("Failed to cancel `MediaStreamTrackProcessor`:",e)})),t.writable.abort(i).catch((e=>{console.warn("Failed to abort `MediaStreamTrackGenerator`:",e)}))})),t}stopProcessing(){this.abortController.abort(),this.segmentation.onResults((()=>{}))}async transform(e,t){const n=e.timestamp,i=e.duration,o=await createImageBitmap(e);e.close(),await this.segmentation.send({image:o}),o.close(),t.enqueue(new VideoFrame(this.canvas,{timestamp:n,duration:i}))}updateOffscreenCanvas(e){this.canvasCtx.save(),this.canvasCtx.clearRect(0,0,this.canvas.width,this.canvas.height),this.canvasCtx.drawImage(e.segmentationMask,0,0,this.canvas.width,this.canvas.height),this.canvasCtx.globalCompositeOperation="source-in",this.canvasCtx.drawImage(e.image,0,0,this.canvas.width,this.canvas.height),void 0!==this.options.blurRadius&&(this.canvasCtx.filter=`blur(${this.options.blurRadius}px)`),this.canvasCtx.globalCompositeOperation="destination-over",void 0!==this.options.backgroundImage?this.canvasCtx.drawImage(this.options.backgroundImage,0,0,this.canvas.width,this.canvas.height):this.canvasCtx.drawImage(e.image,0,0),this.canvasCtx.restore()}}var C=n(2923),b=n(8459),v=n(1477);function w(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return I(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return I(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,r=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw r}}}}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var S={alertMessages:[],audio:!0,audioBitRate:"",audioCodecType:"",audioContentHint:"",audioInput:"",audioInputDevices:[],audioOutput:"",audioOutputDevices:[],autoGainControl:"",blurRadius:"",clientId:"",channelId:"sora",googCpuOveruseDetection:null,timelineMessages:[],debug:!1,debugFilterText:"",debugType:"timeline",dataChannelSignaling:"",dataChannels:"",dataChannelMessages:[],displayResolution:"",displaySettings:{audio:!1,audioBitRate:!1,audioCodecType:!1,audioContentHint:!1,audioConstraints:!1,audioInput:!1,audioOutput:!1,audioTrack:!1,cameraDevice:!1,displayResolution:!1,mediaType:!1,micDevice:!1,simulcastRid:!1,spotlightFocusRid:!1,spotlightNumber:!1,spotlightUnfocusRid:!1,video:!1,videoBitRate:!1,videoCodecType:!1,videoContentHint:!1,videoConstraints:!1,videoInput:!1,videoTrack:!1},e2ee:!1,echoCancellation:"",echoCancellationType:"",enabledClientId:!1,enabledDataChannel:!1,enabledDataChannels:!1,enabledMetadata:!1,enabledSignalingNotifyMetadata:!1,enabledSignalingUrlCandidates:!1,fakeVolume:"0",fakeContents:{worker:null,colorCode:0,gainNode:null},frameRate:"",soraContents:{connectionStatus:"disconnected",reconnecting:!1,reconnectingTrials:0,sora:null,connectionId:null,clientId:null,localMediaStream:null,remoteMediaStreams:[],prevStatsReport:[],statsReport:[],datachannels:[]},ignoreDisconnectWebSocket:"",logMessages:[],mediaProcessorsNoiseSuppression:!1,mediaType:"getUserMedia",metadata:"",multistream:!1,mute:!1,noiseSuppression:"",notifyMessages:[],pushMessages:[],resolution:"",showStats:!1,simulcast:!1,spotlight:!1,signalingMessages:[],signalingNotifyMetadata:"",signalingUrlCandidates:[],simulcastRid:"",spotlightNumber:"",spotlightFocusRid:"",spotlightUnfocusRid:"",focusedSpotlightConnectionIds:{},video:!0,videoBitRate:"",videoCodecType:"",videoContentHint:"",videoInput:"",videoInputDevices:[],version:JSON.parse('{"i8":"2022.1.0-canary.7"}').i8,cameraDevice:!0,videoTrack:!0,micDevice:!0,audioTrack:!0,role:"sendonly",reconnect:!1,apiUrl:null,aspectRatio:"",resizeMode:"",noiseSuppressionProcessor:null,virtualBackgroundProcessor:null},O=(0,s.oM)({name:"soraDevtools",initialState:S,reducers:{resetState:function(e){Object.assign(e,S)},setAudio:function(e,t){e.audio=t.payload},setAudioInput:function(e,t){e.audioInput=t.payload},setAudioOutput:function(e,t){e.audioOutput=t.payload},setAudioBitRate:function(e,t){e.audioBitRate=t.payload},setAudioCodecType:function(e,t){e.audioCodecType=t.payload},setAudioContentHint:function(e,t){if(e.audioContentHint=t.payload,e.soraContents.localMediaStream){var n,i=w(e.soraContents.localMediaStream.getAudioTracks());try{for(i.s();!(n=i.n()).done;){n.value.contentHint=e.audioContentHint}}catch(o){i.e(o)}finally{i.f()}}},setAutoGainControl:function(e,t){e.autoGainControl=t.payload},setClientId:function(e,t){e.clientId=t.payload},setChannelId:function(e,t){e.channelId=t.payload},setTimelineMessage:function(e,t){e.timelineMessages.push(t.payload)},setDataChannelSignaling:function(e,t){e.dataChannelSignaling=t.payload},setDataChannels:function(e,t){e.dataChannels=t.payload},setDataChannelMessage:function(e,t){e.dataChannelMessages.push(t.payload)},setGoogCpuOveruseDetection:function(e,t){e.googCpuOveruseDetection=t.payload},setDisplayResolution:function(e,t){e.displayResolution=t.payload},setE2EE:function(e,t){e.e2ee=t.payload},setEchoCancellation:function(e,t){e.echoCancellation=t.payload},setEchoCancellationType:function(e,t){e.echoCancellationType=t.payload},setEnabledClientId:function(e,t){e.enabledClientId=t.payload},setEnabledDataChannels:function(e,t){e.enabledDataChannels=t.payload},setEnabledDataChannel:function(e,t){e.enabledDataChannel=t.payload},setEnabledMetadata:function(e,t){e.enabledMetadata=t.payload},setIgnoreDisconnectWebSocket:function(e,t){e.ignoreDisconnectWebSocket=t.payload},setSignalingMessage:function(e,t){e.signalingMessages.push(t.payload)},setEnabledSignalingNotifyMetadata:function(e,t){e.enabledSignalingNotifyMetadata=t.payload},setEnabledSignalingUrlCandidates:function(e,t){e.enabledSignalingUrlCandidates=t.payload},setFakeVolume:function(e,t){var n=parseFloat(t.payload);isNaN(n)?e.fakeVolume="0":e.fakeVolume=1<n?"1":String(n),e.fakeContents.gainNode&&e.fakeContents.gainNode.gain.setValueAtTime(parseFloat(e.fakeVolume),0)},setFakeContentsGainNode:function(e,t){e.fakeContents.gainNode=t.payload},setInitialFakeContents:function(e){e.fakeContents.colorCode=Math.floor(16777215*Math.random());var t=URL.createObjectURL(new Blob([b.lt],{type:"application/javascript"}));e.fakeContents.worker=new Worker(t)},setInitialDisplaySettings:function(e,t){e.displaySettings=t.payload},setFrameRate:function(e,t){e.frameRate=t.payload},setMute:function(e,t){e.mute=t.payload},setNoiseSuppression:function(e,t){e.noiseSuppression=t.payload},setMediaType:function(e,t){e.mediaType=t.payload},setMetadata:function(e,t){e.metadata=t.payload},setResolution:function(e,t){e.resolution=t.payload},setSignalingNotifyMetadata:function(e,t){e.signalingNotifyMetadata=t.payload},setSignalingUrlCandidates:function(e,t){e.signalingUrlCandidates=t.payload},setSimulcastRid:function(e,t){e.simulcastRid=t.payload},setSpotlightNumber:function(e,t){e.spotlightNumber=t.payload},setSpotlightFocusRid:function(e,t){e.spotlightFocusRid=t.payload},setSpotlightUnfocusRid:function(e,t){e.spotlightUnfocusRid=t.payload},setVideo:function(e,t){e.video=t.payload},setVideoInput:function(e,t){e.videoInput=t.payload},setVideoBitRate:function(e,t){e.videoBitRate=t.payload},setVideoCodecType:function(e,t){e.videoCodecType=t.payload},setVideoContentHint:function(e,t){if(e.videoContentHint=t.payload,e.soraContents.localMediaStream){var n,i=w(e.soraContents.localMediaStream.getVideoTracks());try{for(i.s();!(n=i.n()).done;){n.value.contentHint=e.videoContentHint}}catch(o){i.e(o)}finally{i.f()}}},setSora:function(e,t){e.soraContents.sora=t.payload,e.soraContents.sora?(e.soraContents.connectionId=e.soraContents.sora.connectionId,e.soraContents.clientId=e.soraContents.sora.clientId):(e.soraContents.connectionId=null,e.soraContents.clientId=null,e.soraContents.datachannels=[])},setSoraConnectionStatus:function(e,t){e.soraContents.connectionStatus=t.payload},setSoraReconnecting:function(e,t){e.soraContents.reconnecting=t.payload,!1===e.soraContents.reconnecting&&(e.soraContents.reconnectingTrials=0)},setSoraReconnectingTrials:function(e,t){e.soraContents.reconnectingTrials=t.payload},setSoraDataChannels:function(e,t){e.soraContents.datachannels.push(t.payload)},setLocalMediaStream:function(e,t){e.soraContents.localMediaStream&&e.soraContents.localMediaStream.getTracks().forEach((function(e){e.stop()})),e.soraContents.localMediaStream=t.payload},setRemoteMediaStream:function(e,t){e.soraContents.remoteMediaStreams.push(t.payload)},setStatsReport:function(e,t){e.soraContents.prevStatsReport=e.soraContents.statsReport,e.soraContents.statsReport=t.payload},removeRemoteMediaStream:function(e,t){var n=e.soraContents.remoteMediaStreams.filter((function(e){return e.id!==t.payload}));e.soraContents.remoteMediaStreams=n},removeAllRemoteMediaStreams:function(e){e.soraContents.remoteMediaStreams=[]},setAudioInputDevices:function(e,t){e.audioInputDevices=t.payload},setVideoInputDevices:function(e,t){e.videoInputDevices=t.payload},setAudioOutputDevices:function(e,t){e.audioOutputDevices=t.payload},setSoraInfoAlertMessage:function(e,t){var n={title:"Sora info",type:"info",message:t.payload,timestamp:(new Date).getTime()};E(e.alertMessages,e.logMessages,n)},setSoraErrorAlertMessage:function(e,t){var n={title:"Sora error",type:"error",message:t.payload,timestamp:(new Date).getTime()};E(e.alertMessages,e.logMessages,n)},setAPIInfoAlertMessage:function(e,t){var n={title:"API info",type:"info",message:t.payload,timestamp:(new Date).getTime()};E(e.alertMessages,e.logMessages,n)},setAPIErrorAlertMessage:function(e,t){var n={title:"API error",type:"error",message:t.payload,timestamp:(new Date).getTime()};E(e.alertMessages,e.logMessages,n)},deleteAlertMessage:function(e,t){var n=e.alertMessages.filter((function(e){return e.timestamp!==t.payload}));e.alertMessages=n},setDebug:function(e,t){e.debug=t.payload},setDebugFilterText:function(e,t){e.debugFilterText=t.payload},setDebugType:function(e,t){e.debugFilterText="",e.debugType=t.payload},setLogMessages:function(e,t){e.logMessages.push({timestamp:(new Date).getTime(),message:{title:t.payload.title,description:t.payload.description}})},setNotifyMessages:function(e,t){e.notifyMessages.push(t.payload)},setPushMessages:function(e,t){e.pushMessages.push(t.payload)},setFocusedSpotlightConnectionId:function(e,t){e.focusedSpotlightConnectionIds[t.payload]=!0},setUnFocusedSpotlightConnectionId:function(e,t){e.focusedSpotlightConnectionIds[t.payload]=!1},deleteFocusedSpotlightConnectionId:function(e,t){delete e.focusedSpotlightConnectionIds[t.payload]},setShowStats:function(e,t){e.showStats=t.payload},setCameraDevice:function(e,t){e.cameraDevice=t.payload},setMicDevice:function(e,t){e.micDevice=t.payload},setAudioTrack:function(e,t){if(e.audioTrack=t.payload,e.soraContents.localMediaStream){var n,i=w(e.soraContents.localMediaStream.getAudioTracks());try{for(i.s();!(n=i.n()).done;){n.value.enabled=e.audioTrack}}catch(o){i.e(o)}finally{i.f()}}},setVideoTrack:function(e,t){if(e.videoTrack=t.payload,e.soraContents.localMediaStream){var n,i=w(e.soraContents.localMediaStream.getVideoTracks());try{for(i.s();!(n=i.n()).done;){n.value.enabled=e.videoTrack}}catch(o){i.e(o)}finally{i.f()}}},setRole:function(e,t){e.role=t.payload},setMultistream:function(e,t){e.multistream=t.payload},setSimulcast:function(e,t){e.simulcast=t.payload},setSpotlight:function(e,t){e.spotlight=t.payload},setReconnect:function(e,t){e.reconnect=t.payload},setApiUrl:function(e,t){e.apiUrl=t.payload},clearDataChannelMessages:function(e){e.dataChannelMessages=[]},setAspectRatio:function(e,t){e.aspectRatio=t.payload},setResizeMode:function(e,t){e.resizeMode=t.payload},setBlurRadius:function(e,t){if(""!==t.payload&&null===e.virtualBackgroundProcessor){var n=new m("https://cdn.jsdelivr.net/npm/@shiguredo/virtual-background@latest/dist");e.virtualBackgroundProcessor=n}e.blurRadius=t.payload},setMediaProcessorsNoiseSuppression:function(e,t){if(t.payload&&null===e.noiseSuppressionProcessor){var n=new g("https://cdn.jsdelivr.net/npm/@shiguredo/noise-suppression@latest/dist");e.noiseSuppressionProcessor=n}e.mediaProcessorsNoiseSuppression=t.payload}}});function E(e,t,n){if(10<=e.length)for(var i=0;i<=e.length-5;i++)e.pop();e.unshift(n),t.push({timestamp:n.timestamp,message:{title:"ALERT MESSAGE ".concat(n.title),description:JSON.stringify({title:n.title,type:n.type,message:n.message})}})}function A(e,t){return T.apply(this,arguments)}function T(){return(T=(0,o.Z)(a().mark((function e(t,n){var i,o,r,s,c,l,u,d,g,f,p,h,m,y,C,b,I,S,E,A,T,R,D,k,P,_,Z,F,N,V,x;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i="MEDIA_CONSTRAINTS","getDisplayMedia"!==n.mediaType){e.next=16;break}if(n.video&&n.cameraDevice){e.next=4;break}return e.abrupt("return",[new MediaStream,null]);case 4:if(void 0!==navigator.mediaDevices){e.next=6;break}throw new Error("Failed to call getUserMedia. Make sure domain is secure");case 6:return o=(0,v.fR)({frameRate:n.frameRate,resolution:n.resolution,aspectRatio:n.aspectRatio,resizeMode:n.resizeMode}),t(O.actions.setLogMessages({title:i,description:JSON.stringify(o)})),t(O.actions.setTimelineMessage(M("media-constraints",o))),e.next=11,navigator.mediaDevices.getDisplayMedia(o);case 11:r=e.sent,t(O.actions.setTimelineMessage(M("succeed-get-display-media"))),s=w(r.getVideoTracks());try{for(s.s();!(c=s.n()).done;)void 0!==(l=c.value).contentHint&&(l.contentHint=n.videoContentHint),l.enabled=n.videoTrack,t(O.actions.setTimelineMessage(M("".concat(l.kind,"-mediastream-track-properties"),(0,v.We)(l))))}catch(a){s.e(a)}finally{s.f()}return e.abrupt("return",[r,null]);case 16:if("fakeMedia"!==n.mediaType||!n.fakeContents.worker){e.next=28;break}u=(0,v._8)({audio:n.audio&&n.micDevice,video:n.video&&n.cameraDevice,frameRate:n.frameRate,resolution:n.resolution,volume:n.fakeVolume,aspectRatio:n.aspectRatio,resizeMode:n.resizeMode}),t(O.actions.setLogMessages({title:i,description:JSON.stringify(u)})),t(O.actions.setTimelineMessage(M("media-constraints",u))),d=(0,v.gU)(u),g=d.canvas,f=d.mediaStream,p=d.gainNode,null!==g&&(n.fakeContents.worker.onmessage=function(e){var t=e.data;"update"===t.type&&(0,v.zW)(g,n.fakeContents.colorCode,u.fontSize,t.counter.toString())},n.fakeContents.worker.postMessage({type:"stop"}),n.fakeContents.worker.postMessage({type:"start",interval:1e3/u.frameRate})),h=w(f.getVideoTracks());try{for(h.s();!(m=h.n()).done;)void 0!==(y=m.value).contentHint&&(y.contentHint=n.videoContentHint),y.enabled=n.videoTrack,t(O.actions.setTimelineMessage(M("".concat(y.kind,"-mediastream-track-properties"),(0,v.We)(y))))}catch(a){h.e(a)}finally{h.f()}C=w(f.getAudioTracks());try{for(C.s();!(b=C.n()).done;)void 0!==(I=b.value).contentHint&&(I.contentHint=n.audioContentHint),I.enabled=n.audioTrack,t(O.actions.setTimelineMessage(M("".concat(I.kind,"-mediastream-track-properties"),(0,v.We)(I))))}catch(a){C.e(a)}finally{C.f()}return t(O.actions.setTimelineMessage(M("succeed-create-fake-media"))),e.abrupt("return",[f,p]);case 28:if(void 0!==navigator.mediaDevices){e.next=30;break}throw new Error("Failed to call getUserMedia. Make sure domain is secure");case 30:if(S=new MediaStream,!(E=(0,v.dV)({audio:n.audio&&n.micDevice,autoGainControl:n.autoGainControl,noiseSuppression:n.noiseSuppression,echoCancellation:n.echoCancellation,echoCancellationType:n.echoCancellationType,audioInput:n.audioInput}))){e.next=47;break}return t(O.actions.setLogMessages({title:i,description:JSON.stringify({audio:E})})),t(O.actions.setTimelineMessage(M("audio-media-constraints",{audio:E}))),e.next=37,navigator.mediaDevices.getUserMedia({audio:E});case 37:if(A=e.sent,T=A.getAudioTracks()[0],!n.mediaProcessorsNoiseSuppression){e.next=45;break}if(null!==n.noiseSuppressionProcessor){e.next=42;break}throw new Error("Failed to start NoiseSuppressionProcessor. NoiseSuppressionProcessor is 'null'");case 42:return e.next=44,n.noiseSuppressionProcessor.startProcessing(T);case 44:T=e.sent;case 45:t(O.actions.setTimelineMessage(M("succeed-audio-get-user-media"))),S.addTrack(T);case 47:if(!(R=(0,v.Tm)({aspectRatio:n.aspectRatio,frameRate:n.frameRate,resizeMode:n.resizeMode,resolution:n.resolution,video:n.video&&n.cameraDevice,videoInput:n.videoInput}))){e.next=64;break}return t(O.actions.setLogMessages({title:i,description:JSON.stringify({video:R})})),t(O.actions.setTimelineMessage(M("video-media-constraints",{video:R}))),e.next=53,navigator.mediaDevices.getUserMedia({video:R});case 53:if(D=e.sent,k=D.getVideoTracks()[0],""===n.blurRadius){e.next=62;break}if(null!==n.virtualBackgroundProcessor){e.next=58;break}throw new Error("Failed to start VirtualBackgroundProcessor. VirtualBackgroundProcessor is 'null'");case 58:return P={blurRadius:(0,v.Yw)(n.blurRadius)},e.next=61,n.virtualBackgroundProcessor.startProcessing(k,P);case 61:k=e.sent;case 62:t(O.actions.setTimelineMessage(M("succeed-video-get-user-media"))),S.addTrack(k);case 64:_=w(S.getVideoTracks());try{for(_.s();!(Z=_.n()).done;)void 0!==(F=Z.value).contentHint&&(F.contentHint=n.videoContentHint),F.enabled=n.videoTrack,t(O.actions.setTimelineMessage(M("".concat(F.kind,"-mediastream-track-properties"),(0,v.We)(F))))}catch(a){_.e(a)}finally{_.f()}N=w(S.getAudioTracks());try{for(N.s();!(V=N.n()).done;)void 0!==(x=V.value).contentHint&&(x.contentHint=n.audioContentHint),x.enabled=n.audioTrack,t(O.actions.setTimelineMessage(M("".concat(x.kind,"-mediastream-track-properties"),(0,v.We)(x))))}catch(a){N.e(a)}finally{N.f()}return e.abrupt("return",[S,null]);case 69:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function R(e,t,n){n.on("log",(function(t,n){e(O.actions.setLogMessages({title:t,description:JSON.stringify(n)}))})),n.on("notify",(function(t,n){"spotlight.focused"===t.event_type&&"string"===typeof t.connection_id&&e(O.actions.setFocusedSpotlightConnectionId(t.connection_id)),"spotlight.unfocused"===t.event_type&&"string"===typeof t.connection_id&&e(O.actions.setUnFocusedSpotlightConnectionId(t.connection_id)),"connection.destroyed"===t.event_type&&"string"===typeof t.connection_id&&e(O.actions.deleteFocusedSpotlightConnectionId(t.connection_id)),e(O.actions.setNotifyMessages({timestamp:(new Date).getTime(),message:t,transportType:n}))})),n.on("push",(function(t,n){e(O.actions.setPushMessages({timestamp:(new Date).getTime(),message:t,transportType:n}))})),n.on("track",(function(n){if(e(O.actions.setTimelineMessage(M("event-on-track"))),!t().soraContents.remoteMediaStreams.find((function(e){return e.id===n.streams[0].id}))){var i,o=w(n.streams[0].getTracks());try{for(o.s();!(i=o.n()).done;){var r=i.value;e(O.actions.setTimelineMessage(M("mediastream-track-properties",(0,v.We)(r))))}}catch(a){o.e(a)}finally{o.f()}e(O.actions.setRemoteMediaStream(n.streams[0]))}})),n.on("removetrack",(function(n){e(O.actions.setTimelineMessage(M("event-on-removetrack"))),t().soraContents.remoteMediaStreams.find((function(e){if(null!==n&&void 0!==n&&n.target)return e.id===n.target.id}))&&e(O.actions.removeRemoteMediaStream(n.target.id))})),n.on("disconnect",(function(n){var i={type:n.type,title:n.title};void 0!==n.code&&(i.code=n.code),void 0!==n.reason&&(i.reason=n.reason),void 0!==n.params&&(i.params=n.params),e(O.actions.setTimelineMessage(M("event-on-disconnect",i)));var o=t(),r=o.fakeContents,a=o.soraContents,s=o.reconnect,c=o.noiseSuppressionProcessor,l=o.virtualBackgroundProcessor,u=a.localMediaStream,d=a.remoteMediaStreams;l&&l.stopProcessing(),c&&c.stopProcessing(),u&&u.getTracks().forEach((function(e){e.stop()})),d.forEach((function(e){e.getTracks().forEach((function(e){e.stop()}))})),r.worker&&r.worker.postMessage({type:"stop"}),e(O.actions.setSora(null)),e(O.actions.setSoraConnectionStatus("disconnected")),e(O.actions.setLocalMediaStream(null)),e(O.actions.removeAllRemoteMediaStreams()),e(O.actions.setSoraInfoAlertMessage("Disconnect Sora.")),e(O.actions.setTimelineMessage(M("disconnected"))),"abend"===n.type&&s&&e(O.actions.setSoraReconnecting(!0))})),n.on("timeline",(function(t){var n={timestamp:(new Date).getTime(),type:t.type,data:t.data,dataChannelId:t.dataChannelId,dataChannelLabel:t.dataChannelLabel,logType:t.logType};e(O.actions.setTimelineMessage(n)),t.data&&"object"===typeof t.data&&"sdp"in t.data&&e(O.actions.setTimelineMessage(M("".concat(t.type,"-sdp"),t.data.sdp)))})),n.on("signaling",(function(t){var n={timestamp:(new Date).getTime(),transportType:t.transportType,type:t.type,data:t.data};e(O.actions.setSignalingMessage(n))})),n.on("message",(function(t){e(O.actions.setDataChannelMessage({timestamp:(new Date).getTime(),label:t.label,data:t.data}))})),n.on("datachannel",(function(t){e(O.actions.setSoraDataChannels(t.datachannel))}))}function D(e){var t={audio:e.audio,video:e.video};e.audioCodecType&&(t.audioCodecType=e.audioCodecType);var n=parseInt(e.audioBitRate,10);n&&(t.audioBitRate=n),e.videoCodecType&&(t.videoCodecType=e.videoCodecType);var i=parseInt(e.videoBitRate,10);if(i&&(t.videoBitRate=i),e.multistream&&(t.multistream=!0),e.e2ee&&(t.e2ee=!0),e.spotlight&&(t.spotlight=!0,e.spotlightNumber&&(t.spotlightNumber=parseInt(e.spotlightNumber)),!0===t.spotlight&&e.spotlightFocusRid&&(t.spotlightFocusRid=e.spotlightFocusRid),!0===t.spotlight&&e.spotlightUnfocusRid&&(t.spotlightUnfocusRid=e.spotlightUnfocusRid)),e.simulcast&&(t.simulcast=!0,e.simulcastRid&&(t.simulcastRid=e.simulcastRid)),e.enabledSignalingNotifyMetadata&&(t.signalingNotifyMetadata=(0,v.BB)(!0,e.signalingNotifyMetadata)),e.enabledClientId&&(t.clientId=e.clientId),e.enabledDataChannel&&("true"===e.dataChannelSignaling?t.dataChannelSignaling=!0:"false"===e.dataChannelSignaling&&(t.dataChannelSignaling=!1),"true"===e.ignoreDisconnectWebSocket?t.ignoreDisconnectWebSocket=!0:"false"===e.ignoreDisconnectWebSocket&&(t.ignoreDisconnectWebSocket=!1)),""!==e.dataChannels){var o=[];try{o=JSON.parse(e.dataChannels)}catch(r){console.warn("Illegal format DataChannels")}Array.isArray(o)&&(t.dataChannels=o)}return t}function k(e){return{audio:e.audio,audioBitRate:e.audioBitRate,audioCodecType:e.audioCodecType,clientId:e.clientId,dataChannels:e.enabledDataChannels?e.dataChannels:"",dataChannelSignaling:e.dataChannelSignaling,e2ee:e.e2ee,enabledClientId:e.enabledClientId,enabledDataChannel:e.enabledDataChannel,enabledSignalingNotifyMetadata:e.enabledSignalingNotifyMetadata,ignoreDisconnectWebSocket:e.ignoreDisconnectWebSocket,multistream:e.multistream,signalingNotifyMetadata:e.signalingNotifyMetadata,simulcast:e.simulcast,simulcastRid:e.simulcastRid,spotlight:e.spotlight,spotlightFocusRid:e.spotlightFocusRid,spotlightNumber:e.spotlightNumber,spotlightUnfocusRid:e.spotlightUnfocusRid,video:e.video,videoBitRate:e.videoBitRate,videoCodecType:e.videoCodecType}}function M(e,t){return{type:e,logType:"sora-devtools",timestamp:(new Date).getTime(),data:t}}function P(e,t){return _.apply(this,arguments)}function _(){return(_=(0,o.Z)(a().mark((function e(t,n){var i,o,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.pc||"closed"===(null===(i=n.pc)||void 0===i?void 0:i.iceConnectionState)){e.next=7;break}return e.next=3,n.pc.getStats();case 3:o=e.sent,r=[],o.forEach((function(e){r.push(e)})),t(O.actions.setStatsReport(r));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Z=function(){return function(){var e=(0,o.Z)(a().mark((function e(t,n){var r,s,c,l,u,d,g,f,p,h,m,y,b,w;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t(O.actions.setTimelineMessage(M("start-connection"))),t(O.actions.setSoraConnectionStatus("connecting")),!(r=n()).soraContents.sora){e.next=6;break}return e.next=6,r.soraContents.sora.disconnect();case 6:if(s=(0,v.EO)(r.enabledSignalingUrlCandidates,r.signalingUrlCandidates),t(O.actions.setLogMessages({title:"SIGNALING_URL",description:JSON.stringify(s)})),c=C.Z.connection(s,r.debug),l=k(r),u=D(l),d=(0,v.BB)(r.enabledMetadata,r.metadata),e.prev=12,"sendonly"!==r.role){e.next=28;break}return(g=c.sendonly(r.channelId,null,u)).metadata=d,"boolean"===typeof r.googCpuOveruseDetection&&(g.constraints={optional:[{googCpuOveruseDetection:r.googCpuOveruseDetection}]}),R(t,n,g),e.next=20,A(t,r).catch((function(e){throw t(O.actions.setSoraErrorAlertMessage(e.toString())),t(O.actions.setSoraConnectionStatus("disconnected")),e}));case 20:return h=e.sent,m=(0,i.Z)(h,2),f=m[0],p=m[1],e.next=26,g.connect(f);case 26:e.next=49;break;case 28:if("sendrecv"!==r.role){e.next=43;break}return(g=c.sendrecv(r.channelId,null,u)).metadata=d,"boolean"===typeof r.googCpuOveruseDetection&&(g.constraints={optional:[{googCpuOveruseDetection:r.googCpuOveruseDetection}]}),R(t,n,g),e.next=35,A(t,r).catch((function(e){throw t(O.actions.setSoraErrorAlertMessage(e.toString())),t(O.actions.setSoraConnectionStatus("disconnected")),e}));case 35:return y=e.sent,b=(0,i.Z)(y,2),f=b[0],p=b[1],e.next=41,g.connect(f);case 41:e.next=49;break;case 43:if("recvonly"!==r.role){e.next=49;break}return(g=c.recvonly(r.channelId,null,u)).metadata=d,R(t,n,g),e.next=49,g.connect();case 49:e.next=56;break;case 51:throw e.prev=51,e.t0=e.catch(12),e.t0 instanceof Error&&t(O.actions.setSoraErrorAlertMessage("Failed to connect Sora. ".concat(e.t0.message))),t(O.actions.setSoraConnectionStatus("disconnected")),e.t0;case 56:if(void 0!==g){e.next=58;break}throw new Error("Failed to connect Sora. Connection object is 'undefined'");case 58:return t(O.actions.setSoraInfoAlertMessage("Succeeded to connect Sora.")),e.next=61,P(t,g);case 61:w=setInterval((0,o.Z)(a().mark((function e(){var i,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n(),!(o=i.soraContents).sora){e.next=6;break}return e.next=4,P(t,o.sora);case 4:e.next=7;break;case 6:clearInterval(w);case 7:case"end":return e.stop()}}),e)}))),1e3),t(O.actions.setSora(g)),f&&t(O.actions.setLocalMediaStream(f)),p&&t(O.actions.setFakeContentsGainNode(p)),t(O.actions.setSoraConnectionStatus("connected")),t(O.actions.setTimelineMessage(M("connected")));case 67:case"end":return e.stop()}}),e,null,[[12,51]])})));return function(t,n){return e.apply(this,arguments)}}()},F=function(){return function(){var e=(0,o.Z)(a().mark((function e(t,n){var r,s,c,l,u,d,g,f,p,h,m,y,b,w;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t(O.actions.setTimelineMessage(M("start-reconnect"))),t(O.actions.setSoraConnectionStatus("connecting")),!(r=n()).soraContents.sora){e.next=6;break}return e.next=6,r.soraContents.sora.disconnect();case 6:if(s=(0,v.EO)(r.enabledSignalingUrlCandidates,r.signalingUrlCandidates),t(O.actions.setLogMessages({title:"SIGNALING_URL",description:JSON.stringify(s)})),c=C.Z.connection(s,r.debug),l=k(r),u=D(l),d=(0,v.BB)(r.enabledMetadata,r.metadata),"sendonly"!==r.role&&"sendrecv"!==r.role){e.next=19;break}return e.next=15,A(t,r).catch((function(e){throw t(O.actions.setSoraErrorAlertMessage(e.toString())),t(O.actions.setSoraConnectionStatus("disconnected")),e}));case 15:h=e.sent,m=(0,i.Z)(h,2),f=m[0],p=m[1];case 19:y=a().mark((function e(i){var o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=n(),!1!==o.soraContents.reconnecting){e.next=3;break}return e.abrupt("return","break");case 3:if(t(O.actions.setSoraReconnectingTrials(i)),e.prev=4,"sendonly"!==r.role){e.next=15;break}if((g=c.sendonly(r.channelId,null,u)).metadata=d,"boolean"===typeof r.googCpuOveruseDetection&&(g.constraints={optional:[{googCpuOveruseDetection:r.googCpuOveruseDetection}]}),R(t,n,g),!f){e.next=13;break}return e.next=13,g.connect(f);case 13:e.next=31;break;case 15:if("sendrecv"!==r.role){e.next=25;break}if((g=c.sendrecv(r.channelId,null,u)).metadata=d,"boolean"===typeof r.googCpuOveruseDetection&&(g.constraints={optional:[{googCpuOveruseDetection:r.googCpuOveruseDetection}]}),R(t,n,g),!f){e.next=23;break}return e.next=23,g.connect(f);case 23:e.next=31;break;case 25:if("recvonly"!==r.role){e.next=31;break}return(g=c.recvonly(r.channelId,null,u)).metadata=d,R(t,n,g),e.next=31,g.connect();case 31:e.next=37;break;case 33:e.prev=33,e.t0=e.catch(4),e.t0 instanceof Error&&t(O.actions.setSoraErrorAlertMessage("(trials ".concat(i,") Failed to connect Sora. ").concat(e.t0.message))),g=void 0;case 37:if(void 0===g){e.next=39;break}return e.abrupt("return","break");case 39:return e.next=41,new Promise((function(e){return setTimeout(e,500*i+500)}));case 41:case"end":return e.stop()}}),e,null,[[4,33]])})),b=1;case 21:if(!(b<=10)){e.next=29;break}return e.delegateYield(y(b),"t0",23);case 23:if("break"!==e.t0){e.next=26;break}return e.abrupt("break",29);case 26:b++,e.next=21;break;case 29:if(void 0!==g){e.next=34;break}return t(O.actions.setSoraErrorAlertMessage("Failed to reconnect Sora.")),t(O.actions.setSoraConnectionStatus("disconnected")),t(O.actions.setSoraReconnecting(!1)),e.abrupt("return");case 34:return t(O.actions.setSoraInfoAlertMessage("Succeeded to reconnect Sora.")),e.next=37,P(t,g);case 37:w=setInterval((0,o.Z)(a().mark((function e(){var i,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n(),!(o=i.soraContents).sora){e.next=6;break}return e.next=4,P(t,o.sora);case 4:e.next=7;break;case 6:clearInterval(w);case 7:case"end":return e.stop()}}),e)}))),1e3),t(O.actions.setSora(g)),f&&t(O.actions.setLocalMediaStream(f)),p&&t(O.actions.setFakeContentsGainNode(p)),t(O.actions.setSoraConnectionStatus("connected")),t(O.actions.setTimelineMessage(M("connected"))),t(O.actions.setSoraReconnecting(!1));case 44:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},N=function(){return function(){var e=(0,o.Z)(a().mark((function e(t,n){var i,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n(),!(o=i.soraContents).sora){e.next=6;break}return t(O.actions.setSoraConnectionStatus("disconnecting")),e.next=5,o.sora.disconnect();case 5:t(O.actions.setSoraConnectionStatus("disconnected"));case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},V=function(){return function(){var e=(0,o.Z)(a().mark((function e(t,n){var i,o,r,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,v.PW)();case 2:i=e.sent,o=[],r=[],s=[],i.forEach((function(e){""!==e.deviceId&&("audioinput"===e.kind?o.push(e.toJSON()):"audiooutput"===e.kind?s.push(e.toJSON()):"videoinput"===e.kind&&r.push(e.toJSON()))})),t(O.actions.setAudioInputDevices(o)),t(O.actions.setVideoInputDevices(r)),t(O.actions.setAudioOutputDevices(s));case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},x=function(){return function(){var e=(0,o.Z)(a().mark((function e(t,n){var o,r,s,c,l;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((o=n()).soraContents.sora){e.next=3;break}return e.abrupt("return");case 3:return o.virtualBackgroundProcessor&&o.virtualBackgroundProcessor.stopProcessing(),o.noiseSuppressionProcessor&&o.noiseSuppressionProcessor.stopProcessing(),o.soraContents.localMediaStream&&o.soraContents.localMediaStream.getTracks().forEach((function(e){e.stop()})),e.next=8,A(t,o).catch((function(e){throw t(O.actions.setSoraErrorAlertMessage(e.toString())),t(O.actions.setSoraConnectionStatus("disconnected")),e}));case 8:r=e.sent,s=(0,i.Z)(r,2),c=s[0],l=s[1],c.getTracks().forEach((function(e){if(o.soraContents.sora&&o.soraContents.sora.pc){var t=o.soraContents.sora.pc.getSenders().find((function(t){return!!t.track&&t.track.kind===e.kind}));t&&t.replaceTrack(e)}})),t(O.actions.setLocalMediaStream(c)),t(O.actions.setFakeContentsGainNode(l));case 15:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},j=function(e){return function(){var t=(0,o.Z)(a().mark((function t(n,i){var o;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=14;break}o="Faild to execute WebAssembly '".concat("https://sora-e2ee-wasm.shiguredo.jp/2020.2/wasm.wasm","'."),t.next=5;break;case 5:return t.prev=5,t.next=8,C.Z.initE2EE("https://sora-e2ee-wasm.shiguredo.jp/2020.2/wasm.wasm");case 8:t.next=14;break;case 10:return t.prev=10,t.t0=t.catch(5),n(O.actions.setSoraErrorAlertMessage(o)),t.abrupt("return");case 14:n(O.actions.setE2EE(e));case 15:case"end":return t.stop()}}),t,null,[[5,10]])})));return function(e,n){return t.apply(this,arguments)}}()},W=function(e){return function(){var t=(0,o.Z)(a().mark((function t(n,o){var r,s,c,l,u,d;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((r=o()).soraContents.localMediaStream&&r.soraContents.sora){t.next=4;break}return n(O.actions.setMicDevice(e)),t.abrupt("return");case 4:if(!e){t.next=18;break}return s={aspectRatio:r.aspectRatio,audio:r.audio,audioContentHint:r.audioContentHint,audioInput:r.audioInput,audioTrack:r.audioTrack,autoGainControl:r.autoGainControl,blurRadius:r.blurRadius,cameraDevice:r.cameraDevice,echoCancellation:r.echoCancellation,echoCancellationType:r.echoCancellationType,fakeContents:r.fakeContents,fakeVolume:r.fakeVolume,frameRate:r.frameRate,mediaProcessorsNoiseSuppression:r.mediaProcessorsNoiseSuppression,mediaType:r.mediaType,micDevice:e,noiseSuppression:r.noiseSuppression,noiseSuppressionProcessor:r.noiseSuppressionProcessor,resizeMode:r.resizeMode,resolution:r.resolution,video:!1,videoContentHint:r.videoContentHint,videoInput:r.videoInput,videoTrack:r.videoTrack,virtualBackgroundProcessor:r.virtualBackgroundProcessor},t.next=8,A(n,s).catch((function(e){throw n(O.actions.setSoraErrorAlertMessage(e.toString())),e}));case 8:if(c=t.sent,l=(0,i.Z)(c,2),u=l[0],d=l[1],!(0<u.getAudioTracks().length)){t.next=16;break}return t.next=15,r.soraContents.sora.replaceAudioTrack(r.soraContents.localMediaStream,u.getAudioTracks()[0]);case 15:n(O.actions.setFakeContentsGainNode(d));case 16:t.next=19;break;case 18:r.soraContents.sora.stopAudioTrack(r.soraContents.localMediaStream);case 19:n(O.actions.setMicDevice(e));case 20:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},U=function(e){return function(){var t=(0,o.Z)(a().mark((function t(n,o){var r,s,c,l,u,d;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((r=o()).soraContents.localMediaStream&&r.soraContents.sora){t.next=4;break}return n(O.actions.setCameraDevice(e)),t.abrupt("return");case 4:if(!e){t.next=15;break}return s={aspectRatio:r.aspectRatio,audio:!1,audioContentHint:r.audioContentHint,audioInput:r.audioInput,audioTrack:r.audioTrack,autoGainControl:r.autoGainControl,blurRadius:r.blurRadius,cameraDevice:e,echoCancellation:r.echoCancellation,echoCancellationType:r.echoCancellationType,fakeContents:r.fakeContents,fakeVolume:r.fakeVolume,frameRate:r.frameRate,mediaProcessorsNoiseSuppression:r.mediaProcessorsNoiseSuppression,mediaType:r.mediaType,micDevice:r.micDevice,noiseSuppression:r.noiseSuppression,noiseSuppressionProcessor:r.noiseSuppressionProcessor,resizeMode:r.resizeMode,resolution:r.resolution,video:r.video,videoContentHint:r.videoContentHint,videoInput:r.videoInput,videoTrack:r.videoTrack,virtualBackgroundProcessor:r.virtualBackgroundProcessor},t.next=8,A(n,s).catch((function(e){throw n(O.actions.setSoraErrorAlertMessage(e.toString())),e}));case 8:c=t.sent,l=(0,i.Z)(c,2),u=l[0],d=l[1],0<u.getVideoTracks().length&&(r.soraContents.sora.replaceVideoTrack(r.soraContents.localMediaStream,u.getVideoTracks()[0]),n(O.actions.setFakeContentsGainNode(d))),t.next=16;break;case 15:r.soraContents.sora.stopVideoTrack(r.soraContents.localMediaStream);case 16:n(O.actions.setCameraDevice(e));case 17:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()};function G(e,t,n,i){void 0!==n&&e(t(n)),void 0!==i&&e(t(i))}var X=function(e){return function(){var t=(0,o.Z)(a().mark((function t(n,i){var o,r,s,c,l,u,d,g,f,p,h,m;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(O.actions.resetState()),o=(0,v.dD)(),G(n,O.actions.setAudio,e.audio,o.audio),G(n,O.actions.setAudioBitRate,e.audioBitRate,o.audioBitRate),G(n,O.actions.setAudioCodecType,e.audioCodecType,o.audioCodecType),t.next=7,(0,v.PW)();case 7:if(void 0!==(r=t.sent).find((function(e){return"audioinput"===e.kind&&e.deviceId===o.audioInput}))&&G(n,O.actions.setAudioInput,e.audioInput,o.audioInput),void 0!==r.find((function(e){return"audiooutput"===e.kind&&e.deviceId===o.audioOutput}))&&G(n,O.actions.setAudioOutput,e.audioOutput,o.audioOutput),void 0!==r.find((function(e){return"videoinput"===e.kind&&e.deviceId===o.videoInput}))&&G(n,O.actions.setVideoInput,e.videoInput,o.videoInput),G(n,O.actions.setAutoGainControl,e.autoGainControl,o.autoGainControl),G(n,O.actions.setChannelId,e.channelId,o.channelId),G(n,O.actions.setDisplayResolution,e.displayResolution,o.displayResolution),G(n,O.actions.setE2EE,e.e2ee,o.e2ee),G(n,O.actions.setEchoCancellation,e.echoCancellation,o.echoCancellation),G(n,O.actions.setEchoCancellationType,e.echoCancellationType,o.echoCancellationType),G(n,O.actions.setMediaType,e.mediaType,o.mediaType),G(n,O.actions.setFakeVolume,e.fakeVolume,o.fakeVolume),G(n,O.actions.setFrameRate,e.frameRate,o.frameRate),G(n,O.actions.setNoiseSuppression,e.noiseSuppression,o.noiseSuppression),G(n,O.actions.setResolution,e.resolution,o.resolution),G(n,O.actions.setShowStats,e.showStats,o.showStats),G(n,O.actions.setSimulcastRid,e.simulcastRid,o.simulcastRid),G(n,O.actions.setSpotlightNumber,e.spotlightNumber,o.spotlightNumber),G(n,O.actions.setSpotlightFocusRid,e.spotlightFocusRid,o.spotlightFocusRid),G(n,O.actions.setSpotlightUnfocusRid,e.spotlightUnfocusRid,o.spotlightUnfocusRid),G(n,O.actions.setVideo,e.video,o.video),G(n,O.actions.setVideoBitRate,e.videoBitRate,o.videoBitRate),G(n,O.actions.setVideoCodecType,e.videoCodecType,o.videoCodecType),G(n,O.actions.setDebug,e.debug,o.debug),G(n,O.actions.setDebugType,e.debugType,o.debugType),G(n,O.actions.setMute,e.mute,o.mute),G(n,O.actions.setDataChannelSignaling,e.dataChannelSignaling,o.dataChannelSignaling),G(n,O.actions.setIgnoreDisconnectWebSocket,e.ignoreDisconnectWebSocket,o.ignoreDisconnectWebSocket),G(n,O.actions.setMicDevice,e.micDevice,o.micDevice),G(n,O.actions.setCameraDevice,e.cameraDevice,o.cameraDevice),G(n,O.actions.setAudioTrack,e.audioTrack,o.audioTrack),G(n,O.actions.setVideoTrack,e.videoTrack,o.videoTrack),"boolean"===typeof o.googCpuOveruseDetection&&n(O.actions.setGoogCpuOveruseDetection(o.googCpuOveruseDetection)),G(n,O.actions.setClientId,e.clientId,o.clientId),G(n,O.actions.setMetadata,e.metadata,o.metadata),G(n,O.actions.setSignalingNotifyMetadata,e.signalingNotifyMetadata,o.signalingNotifyMetadata),G(n,O.actions.setSignalingUrlCandidates,e.signalingUrlCandidates,o.signalingUrlCandidates),G(n,O.actions.setDataChannels,e.dataChannels,o.dataChannels),G(n,O.actions.setAudioContentHint,e.audioContentHint,o.audioContentHint),G(n,O.actions.setVideoContentHint,e.videoContentHint,o.videoContentHint),G(n,O.actions.setReconnect,e.reconnect,o.reconnect),G(n,O.actions.setAspectRatio,e.aspectRatio,o.aspectRatio),G(n,O.actions.setResizeMode,e.resizeMode,o.resizeMode),G(n,O.actions.setBlurRadius,e.blurRadius,o.blurRadius),G(n,O.actions.setMediaProcessorsNoiseSuppression,e.mediaProcessorsNoiseSuppression,o.mediaProcessorsNoiseSuppression),"string"===typeof o.apiUrl&&n(O.actions.setApiUrl(o.apiUrl)),n(O.actions.setInitialFakeContents()),null===e.role||void 0===e.role){t.next=58;break}n(O.actions.setRole(e.role)),t.next=59;break;case 58:throw new Error("Failed to initialize. Invalid role parameter '".concat(e.role,"'."));case 59:if("boolean"!==typeof e.multistream){t.next=63;break}n(O.actions.setMultistream(e.multistream)),t.next=64;break;case 63:throw new Error("Failed to initialize. Invalid multistream parameter '".concat(e.multistream,"'."));case 64:if("boolean"!==typeof e.simulcast){t.next=68;break}n(O.actions.setSimulcast(e.simulcast)),t.next=69;break;case 68:throw new Error("Failed to initialize. Invalid simulcast parameter '".concat(e.simulcast,"'."));case 69:if("boolean"!==typeof e.spotlight){t.next=73;break}n(O.actions.setSpotlight(e.spotlight)),t.next=74;break;case 73:throw new Error("Failed to initialize. Invalid spotlight parameter '".concat(e.spotlight,"'."));case 74:if(n(O.actions.setInitialDisplaySettings((0,v.JJ)(e.role,e.multistream,e.simulcast,e.spotlight,!!e.dataChannelMessagingOnly))),s=i(),c=s.clientId,l=s.dataChannels,u=s.dataChannelSignaling,d=s.e2ee,g=s.ignoreDisconnectWebSocket,f=s.metadata,p=s.signalingNotifyMetadata,h=s.signalingUrlCandidates,!d){t.next=90;break}m="Faild to execute WebAssembly '".concat("https://sora-e2ee-wasm.shiguredo.jp/2020.2/wasm.wasm","'."),t.next=81;break;case 81:return t.prev=81,t.next=84,C.Z.initE2EE("https://sora-e2ee-wasm.shiguredo.jp/2020.2/wasm.wasm");case 84:t.next=90;break;case 86:return t.prev=86,t.t0=t.catch(81),n(O.actions.setSoraErrorAlertMessage(m)),t.abrupt("return");case 90:""!==c&&n(O.actions.setEnabledClientId(!0)),""!==f&&n(O.actions.setEnabledMetadata(!0)),""!==p&&n(O.actions.setEnabledSignalingNotifyMetadata(!0)),0<h.length&&n(O.actions.setEnabledSignalingUrlCandidates(!0)),""===u&&""===g||n(O.actions.setEnabledDataChannel(!0)),""!==l&&n(O.actions.setEnabledDataChannels(!0));case 96:case"end":return t.stop()}}),t,null,[[81,86]])})));return function(e,n){return t.apply(this,arguments)}}()};function B(e,t){if(t)return e}var L=function(){return function(e,t){var n=t(),i={mediaType:B(n.mediaType,"getUserMedia"!==n.mediaType&&n.displaySettings.mediaType),channelId:n.channelId,audio:B(n.audio,n.displaySettings.audio),audioBitRate:B(n.audioBitRate,n.displaySettings.audioBitRate),audioCodecType:B(n.audioCodecType,n.displaySettings.audioCodecType),audioContentHint:B(n.audioContentHint,""!==n.audioContentHint&&n.displaySettings.audioContentHint),autoGainControl:B(n.autoGainControl,""!==n.autoGainControl&&n.displaySettings.audioConstraints),noiseSuppression:B(n.noiseSuppression,""!==n.noiseSuppression&&n.displaySettings.audioConstraints),echoCancellation:B(n.echoCancellation,""!==n.echoCancellation&&n.displaySettings.audioConstraints),echoCancellationType:B(n.echoCancellationType,""!==n.echoCancellationType&&n.displaySettings.audioConstraints),video:B(n.video,n.displaySettings.video),videoBitRate:B(n.videoBitRate,n.displaySettings.videoBitRate),videoCodecType:B(n.videoCodecType,n.displaySettings.videoCodecType),videoContentHint:B(n.videoContentHint,""!==n.videoContentHint&&n.displaySettings.videoContentHint),resolution:B(n.resolution,n.displaySettings.videoConstraints),frameRate:B(n.frameRate,""!==n.frameRate&&n.displaySettings.videoConstraints),aspectRatio:B(n.aspectRatio,""!==n.aspectRatio&&n.displaySettings.videoConstraints),resizeMode:B(n.resizeMode,""!==n.resizeMode&&n.displaySettings.videoConstraints),blurRadius:B(n.blurRadius,""!==n.blurRadius&&n.displaySettings.videoConstraints),mediaProcessorsNoiseSuppression:B(n.mediaProcessorsNoiseSuppression,n.mediaProcessorsNoiseSuppression),simulcastRid:B(n.simulcastRid,n.displaySettings.simulcastRid),audioInput:B(n.audioInput,""!==n.audioInput&&n.displaySettings.audioInput),audioOutput:B(n.audioOutput,""!==n.audioOutput&&n.displaySettings.audioOutput),videoInput:B(n.videoInput,""!==n.videoInput&&n.displaySettings.videoInput),displayResolution:B(n.displayResolution,""!==n.displayResolution),micDevice:B(n.micDevice,!n.micDevice&&n.displaySettings.micDevice),cameraDevice:B(n.cameraDevice,!n.cameraDevice&&n.displaySettings.cameraDevice),audioTrack:B(n.audioTrack,!n.audioTrack&&n.displaySettings.audioTrack),videoTrack:B(n.videoTrack,!n.videoTrack&&n.displaySettings.videoTrack),spotlightNumber:B(n.spotlightNumber,n.displaySettings.spotlightNumber),spotlightFocusRid:B(n.spotlightFocusRid,n.displaySettings.spotlightFocusRid),spotlightUnfocusRid:B(n.spotlightUnfocusRid,n.displaySettings.spotlightUnfocusRid),e2ee:B(n.e2ee,n.e2ee),clientId:B(n.clientId,n.enabledClientId),metadata:B(n.metadata,n.enabledMetadata),signalingNotifyMetadata:B(n.signalingNotifyMetadata,n.enabledSignalingNotifyMetadata),dataChannelSignaling:B(n.dataChannelSignaling,n.enabledDataChannel),ignoreDisconnectWebSocket:B(n.ignoreDisconnectWebSocket,n.enabledDataChannel),signalingUrlCandidates:B(n.signalingUrlCandidates,n.enabledSignalingUrlCandidates),dataChannels:B(n.dataChannels,n.enabledDataChannels),reconnect:B(n.reconnect,n.reconnect),debug:n.debug,fakeVolume:"fakeMedia"===n.mediaType?n.fakeVolume:void 0,apiUrl:null!==n.apiUrl?n.apiUrl:void 0},o=Object.keys(i).map((function(e){var t=i[e];if(void 0!==t)return"signalingUrlCandidates"===e?"".concat(e,"=").concat(encodeURIComponent(JSON.stringify(t))):"".concat(e,"=").concat(encodeURIComponent(t))})).filter((function(e){return void 0!==e}));(0,v.f7)("".concat(location.origin).concat(location.pathname,"?").concat(o.join("&")))}},H=O.actions,Y=H.clearDataChannelMessages,Q=H.deleteAlertMessage,J=H.setAPIErrorAlertMessage,K=H.setAPIInfoAlertMessage,z=H.setAspectRatio,$=H.setAudio,q=H.setAudioBitRate,ee=H.setAudioCodecType,te=H.setAudioContentHint,ne=H.setAudioInput,ie=H.setAudioOutput,oe=H.setAudioTrack,re=H.setAutoGainControl,ae=H.setBlurRadius,se=H.setChannelId,ce=H.setClientId,le=H.setDataChannels,ue=H.setDataChannelSignaling,de=H.setDebug,ge=H.setDebugFilterText,fe=H.setDebugType,pe=H.setDisplayResolution,he=H.setEchoCancellation,me=H.setEchoCancellationType,ye=H.setEnabledClientId,Ce=H.setEnabledDataChannels,be=H.setEnabledDataChannel,ve=H.setEnabledMetadata,we=H.setEnabledSignalingNotifyMetadata,Ie=H.setEnabledSignalingUrlCandidates,Se=H.setFakeVolume,Oe=H.setFrameRate,Ee=H.setIgnoreDisconnectWebSocket,Ae=(H.setLocalMediaStream,H.setLogMessages,H.setMediaProcessorsNoiseSuppression),Te=H.setMediaType,Re=H.setMetadata,De=H.setNoiseSuppression,ke=(H.setNotifyMessages,H.setReconnect),Me=H.setResizeMode,Pe=H.setResolution,_e=H.setSignalingNotifyMetadata,Ze=H.setSignalingUrlCandidates,Fe=H.setSimulcastRid,Ne=(H.setSora,H.setSoraReconnecting),Ve=(H.setSoraErrorAlertMessage,H.setSoraInfoAlertMessage,H.setSpotlightFocusRid),xe=H.setSpotlightNumber,je=H.setSpotlightUnfocusRid,We=H.setVideo,Ue=H.setVideoBitRate,Ge=H.setVideoCodecType,Xe=H.setVideoContentHint,Be=H.setVideoInput,Le=H.setVideoTrack,He=O.reducer},1271:function(e,t,n){"use strict";n.d(t,{h:function(){return r}});var i=n(5295),o=(n(4500),n(9979)),r=(0,i.xC)({reducer:o.I6,middleware:function(e){var t=e({serializableCheck:{ignoredActions:["soraDevtools/setSora","soraDevtools/setLocalMediaStream","soraDevtools/setRemoteMediaStream","soraDevtools/setFakeContentsGainNode","soraDevtools/setDataChannelMessage"],ignoredPaths:["soraContents","fakeContents","dataChannelMessages","logMessages","notifyMessages","pushMessages","signalingMessages","virtualBackgroundProcessor","noiseSuppressionProcessor"]},immutableCheck:{ignoredPaths:["soraContents","fakeContents","dataChannelMessages","logMessages","notifyMessages","pushMessages","signalingMessages","noiseSuppressionProcessor"]}});return t}})},8459:function(e,t,n){"use strict";n.d(t,{o1:function(){return i},xR:function(){return o},Sh:function(){return r},Q5:function(){return a},Vf:function(){return s},hJ:function(){return c},YX:function(){return l},iN:function(){return u},ad:function(){return d},PS:function(){return g},cJ:function(){return f},w_:function(){return p},Xr:function(){return h},I7:function(){return m},WJ:function(){return y},l9:function(){return C},kt:function(){return b},aF:function(){return v},nT:function(){return w},QO:function(){return I},Ii:function(){return S},L4:function(){return O},G_:function(){return E},lt:function(){return A}});var i=["","OPUS"],o=["","8","16","24","32","64","96","128","256"],r=["","VP8","VP9","H264","H265","AV1"],a=["","10","30","50","100","300","500","800","1000","1500","2000","2500","3000","5000","10000","15000","20000","30000","50000"],s=["","2160p (3840x2160)","1080p (1920x1080)","720p (1280x720)","480p (640x480)","360p (640x360)","240p (320x240)","180p (320x180)","120p (160x120)"],c=["","480p (640x480)","240p (320x240)"],l=["","60","30","24","20","15","10"],u=["","true","false"],d=["","true","false"],g=["","true","false"],f=["","browser","system"],p=["getUserMedia","getDisplayMedia","fakeMedia"],h=["","1","2","3","4","5","6","7","8"],m=["","none","r0","r1","r2"],y=["","r0","r1","r2"],C=["","true","false"],b=["","true","false"],v=["log","notify","push","stats","timeline","signaling","messaging"],w=["","speech","speech-recognition","music"],I=["","motion","detail","text"],S=["","4:3","16:9","21:9"],O=["","none","crop-and-scale"],E=["","weak","midium","strong"],A='\nself.onmessage = (event) => {\n  const data = event.data;\n  if (data.type === "start") {\n    const interval = data.interval;\n    self.counter = 0;\n    const intervalId = setInterval(() => {\n      const message = { type: "update", counter: self.counter };\n      self.postMessage(message);\n      self.counter++;\n    }, interval);\n    self.intervalId = intervalId;\n  } else if (data.type === "stop") {\n    if (self.intervalId) {\n      clearInterval(self.intervalId);\n    }\n    const message = { type: "stop" };\n    self.postMessage(message);\n  }\n};\n'},7600:function(e,t,n){"use strict";n.r(t);var i=n(9499),o=(n(8210),n(7583),n(5617)),r=n(1271),a=n(5893);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.default=function(e){var t=e.Component,n=e.pageProps;return(0,a.jsx)(o.zt,{store:r.h,children:(0,a.jsx)(t,c({},n))})}},1477:function(e,t,n){"use strict";n.d(t,{o5:function(){return c},f7:function(){return l},yP:function(){return u},nu:function(){return d},ou:function(){return g},Uz:function(){return f},zM:function(){return p},ko:function(){return h},F9:function(){return m},Ee:function(){return y},E7:function(){return C},Tp:function(){return b},Gn:function(){return v},EQ:function(){return w},iF:function(){return I},zG:function(){return S},nm:function(){return O},ug:function(){return E},to:function(){return A},ej:function(){return T},s2:function(){return R},vG:function(){return D},gV:function(){return k},Jx:function(){return M},dD:function(){return P},EO:function(){return _},fl:function(){return Z},Yw:function(){return N},dV:function(){return V},Tm:function(){return x},_8:function(){return j},fR:function(){return W},gU:function(){return U},zW:function(){return G},BB:function(){return B},Sg:function(){return L},PW:function(){return H},JJ:function(){return Q},nh:function(){return J},We:function(){return K}});var i=n(29),o=n(7794),r=n.n(o),a=n(7563),s=n(8459);function c(e){var t=new Date(e),n=t.getFullYear(),i=t.getMonth()+1,o=t.getDate(),r=t.getHours().toString().padStart(2,"0"),a=t.getMinutes().toString().padStart(2,"0"),s=t.getSeconds().toString().padStart(2,"0"),c=t.getMilliseconds().toString().padStart(3,"0");return"".concat(n,"-").concat(i,"-").concat(o," ").concat(r,":").concat(a,":").concat(s,".").concat(c)}function l(e){return navigator.clipboard?navigator.clipboard.writeText(e):Promise.resolve()}function u(e){return s.o1.indexOf(e)>=0}function d(e){return s.xR.indexOf(e)>=0}function g(e){return s.Sh.indexOf(e)>=0}function f(e){return s.Q5.indexOf(e)>=0}function p(e){return s.Vf.indexOf(e)>=0}function h(e){return s.hJ.indexOf(e)>=0}function m(e){return s.YX.indexOf(e)>=0}function y(e){return s.iN.indexOf(e)>=0}function C(e){return s.ad.indexOf(e)>=0}function b(e){return s.PS.indexOf(e)>=0}function v(e){return s.cJ.indexOf(e)>=0}function w(e){return s.Xr.indexOf(e)>=0}function I(e){return s.I7.indexOf(e)>=0}function S(e){return s.WJ.indexOf(e)>=0}function O(e){return s.w_.indexOf(e)>=0}function E(e){return s.l9.indexOf(e)>=0}function A(e){return s.kt.indexOf(e)>=0}function T(e){return s.nT.indexOf(e)>=0}function R(e){return s.QO.indexOf(e)>=0}function D(e){return s.Ii.indexOf(e)>=0}function k(e){return s.L4.indexOf(e)>=0}function M(e){return s.G_.indexOf(e)>=0}function P(){var e=a.parse(location.search,{parseBooleans:!0}),t=e.apiUrl,n=e.aspectRatio,i=e.audio,o=e.audioBitRate,r=e.audioCodecType,c=e.audioContentHint,l=e.audioInput,P=e.audioOutput,_=e.audioTrack,Z=e.autoGainControl,F=e.blurRadius,N=e.cameraDevice,V=e.channelId,x=e.clientId,j=e.dataChannelSignaling,W=e.dataChannels,U=e.debug,G=e.debugType,X=e.displayResolution,B=e.e2ee,L=e.echoCancellation,H=e.echoCancellationType,Y=e.fakeVolume,Q=e.frameRate,J=e.googCpuOveruseDetection,K=e.ignoreDisconnectWebSocket,z=e.mediaType,$=e.metadata,q=e.micDevice,ee=e.mute,te=e.mediaProcessorsNoiseSuppression,ne=e.noiseSuppression,ie=e.reconnect,oe=e.resizeMode,re=e.resolution,ae=e.showStats,se=e.signalingNotifyMetadata,ce=e.signalingUrlCandidates,le=e.simulcastRid,ue=e.spotlightFocusRid,de=e.spotlightNumber,ge=e.spotlightUnfocusRid,fe=e.video,pe=e.videoBitRate,he=e.videoCodecType,me=e.videoContentHint,ye=e.videoInput,Ce=e.videoTrack,be={};"string"===typeof t&&(be.apiUrl=t),"boolean"===typeof i&&(be.audio=i),"string"===typeof o&&d(o)&&(be.audioBitRate=o),"string"===typeof r&&u(r)&&(be.audioCodecType=r);var ve=String(Z);y(ve)&&(be.autoGainControl=ve),void 0!==V&&(be.channelId=String(V)),void 0!==x&&(be.clientId=String(x)),"boolean"===typeof J&&(be.googCpuOveruseDetection=J),"boolean"===typeof U&&(be.debug=U),"string"===typeof G&&function(e){return s.aF.indexOf(e)>=0}(G)&&(be.debugType=G),"string"===typeof X&&h(X)&&(be.displayResolution=X),"boolean"===typeof B&&(be.e2ee=B);var we=String(L);b(we)&&(be.echoCancellation=we),"string"===typeof H&&v(H)&&(be.echoCancellationType=H);var Ie=String(ne);if(C(Ie)&&(be.noiseSuppression=Ie),Y&&(be.fakeVolume=String(Y)),"string"===typeof Q&&m(Q)&&(be.frameRate=Q),"string"===typeof z&&O(z)&&(be.mediaType=z),$&&(be.metadata=String($)),"boolean"===typeof ae&&(be.showStats=ae),se&&(be.signalingNotifyMetadata=String(se)),ce&&"string"===typeof ce){var Se=JSON.parse(ce);Array.isArray(Se)&&(be.signalingUrlCandidates=Se)}"string"===typeof le&&S(le)&&(be.simulcastRid=le),"string"===typeof de&&w(de)&&(be.spotlightNumber=de),"string"===typeof ue&&I(ue)&&(be.spotlightFocusRid=ue),"string"===typeof ge&&I(ge)&&(be.spotlightUnfocusRid=ge),"string"===typeof re&&p(re)&&(be.resolution=re),"boolean"===typeof fe&&(be.video=fe),"string"===typeof pe&&f(pe)&&(be.videoBitRate=pe),"string"===typeof he&&g(he)&&(be.videoCodecType=he),l&&(be.audioInput=String(l)),ye&&(be.videoInput=String(ye)),P&&(be.audioOutput=String(P)),"boolean"===typeof ee&&(be.mute=ee);var Oe=String(j);E(Oe)&&(be.dataChannelSignaling=Oe);var Ee=String(K);A(Ee)&&(be.ignoreDisconnectWebSocket=Ee),"boolean"===typeof q&&(be.micDevice=q),"boolean"===typeof N&&(be.cameraDevice=N),"boolean"===typeof _&&(be.audioTrack=_),"boolean"===typeof Ce&&(be.videoTrack=Ce),"string"===typeof W&&(be.dataChannels=W),"boolean"===typeof ie&&(be.reconnect=ie);var Ae=String(c);T(Ae)&&(be.audioContentHint=Ae);var Te=String(me);R(Te)&&(be.videoContentHint=Te);var Re=String(n);D(Re)&&(be.aspectRatio=Re);var De=String(oe);k(De)&&(be.resizeMode=De);var ke=String(F);return M(ke)&&(be.blurRadius=ke),"boolean"===typeof te&&(be.mediaProcessorsNoiseSuppression=te),be}function _(e,t){if(e)return t.filter((function(e){return""!==e}));var n="https:"===window.location.protocol?"wss://":"ws://",i=window.location.port?":".concat(window.location.port):"";return n+window.location.hostname+i+"/signaling"}function Z(e){switch(e){case"120p (160x120)":return{width:160,height:120};case"180p (320x180)":return{width:320,height:180};case"240p (320x240)":return{width:320,height:240};case"360p (640x360)":return{width:640,height:360};case"480p (640x480)":return{width:640,height:480};case"720p (1280x720)":return{width:1280,height:720};case"1080p (1920x1080)":return{width:1920,height:1080};case"2160p (3840x2160)":return{width:3840,height:2160};default:return{width:0,height:0}}}function F(e){switch(e){case"4:3":return 4/3;case"16:9":return 16/9;case"21:9":return 20/9;default:return NaN}}function N(e){switch(e){case"weak":return 5;case"midium":return 10;case"strong":return 15;default:return 0}}function V(e){var t=e.audio,n=e.autoGainControl,i=e.noiseSuppression,o=e.echoCancellation,r=e.echoCancellationType,a=e.audioInput;if(!t)return!1;if(!n&&!i&&!o&&!r&&!a)return t;var s={};a&&(s.deviceId={exact:a});var c=X(n);void 0!==c&&(s.autoGainControl=c);var l=X(i);void 0!==l&&(s.noiseSuppression=l);var u=X(o);return void 0!==u&&(s.echoCancellation=u),r&&(s.echoCancellationType=r),s}function x(e){var t=e.video,n=e.frameRate,i=e.resolution,o=e.videoInput,r=e.aspectRatio,a=e.resizeMode;if(!t)return!1;if(!n&&!i&&!o&&!r&&!a)return t;var s={};if(n&&(s.frameRate={min:parseInt(n,10),max:parseInt(n,10)}),i){var c=Z(i),l=c.width,u=c.height;0<l&&0<u&&(s.width={exact:l},s.height={exact:u})}return o&&(s.deviceId={exact:o}),r&&(s.aspectRatio=F(r)),a&&(s.resizeMode=a),s}function j(e){var t=e.audio,n=e.video,i=e.frameRate,o=e.resolution,r=e.volume,a=e.aspectRatio,s=e.resizeMode,c=parseInt(i,10)||30,l=Z(o),u=l.width||240,d={audio:t,video:n,frameRate:c,width:u,height:l.height||160,fontSize:Math.floor(u/5),volume:parseFloat(r)};return n&&(a||s)&&(d.videoTrackConstraints={},a&&(d.videoTrackConstraints.aspectRatio=F(a)),s&&(d.videoTrackConstraints.resizeMode=s)),d}function W(e){var t=e.aspectRatio,n=e.frameRate,i=e.resizeMode,o=e.resolution;if(!n&&!o&&!t&&!i)return{video:!0};var r={};if(n&&(r.frameRate=parseInt(n,10)),o){var a=Z(o),s=a.width,c=a.height;0<s&&0<c&&(r.width=s,r.height=c)}return t&&(r.aspectRatio=F(t)),i&&(r.resizeMode=i),{video:r}}function U(e){var t=new MediaStream,n=null;if(e.video){(n=document.createElement("canvas")).getContext("2d"),n.width=e.width,n.height=e.height;var i=n.captureStream(e.frameRate).getTracks()[0];e.videoTrackConstraints&&i.applyConstraints(e.videoTrackConstraints),t.addTrack(i)}var o=null;if(e.audio){var r=new(window.AudioContext||window.webkitAudioContext),a=r.createOscillator();a.type="sine",o=r.createGain(),a.connect(o),a.start(0);var s=r.createMediaStreamDestination();o.connect(s);var c=s.stream.getTracks();t.addTrack(c[0]),o.gain.setValueAtTime(e.volume,0)}return{canvas:n,mediaStream:t,gainNode:o}}function G(e,t,n,i){if(null!==e){var o=e.getContext("2d");if(o){o.globalCompositeOperation="source-over",o.clearRect(0,0,e.width,e.height),o.fillStyle="#"+("0".repeat(6)+t.toString(16)).slice(-6),o.fillRect(0,0,e.width,e.height),o.fillStyle="#"+("0".repeat(6)+(16777215-t).toString(16)).slice(-6),o.font="".concat(n,"px Arial");var r=e.width/2-n/2,a=n/4*(i.length-1),s=e.height/2+n/2.5;o.fillText(i,r-a,s)}}}function X(e){return"true"===e||"false"!==e&&void 0}function B(e,t){if(e){try{return JSON.parse(t)}catch(n){}return t}}function L(e){if(!RTCRtpSender.getCapabilities)return e;var t=RTCRtpSender.getCapabilities("video");if(!t||!t.codecs)return e;var n=t.codecs.map((function(e){return e.mimeType.replace("video/","")}));return n.includes(e)?e:n.includes("VP9")?"VP9":n.includes("VP8")?"VP8":n.includes("H264")?"H264":n.includes("AV1")?"AV1":n.includes("H265")?"H265":e}function H(){return Y.apply(this,arguments)}function Y(){return(Y=(0,i.Z)(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==navigator.mediaDevices){e.next=2;break}return e.abrupt("return",[]);case 2:return e.prev=2,e.next=5,navigator.mediaDevices.enumerateDevices();case 5:return e.abrupt("return",e.sent);case 8:e.prev=8,e.t0=e.catch(2);case 10:return e.abrupt("return",[]);case 11:case"end":return e.stop()}}),e,null,[[2,8]])})))).apply(this,arguments)}function Q(e,t,n,i,o){var r={audio:!1,audioBitRate:!1,audioCodecType:!1,audioContentHint:!1,audioConstraints:!1,audioInput:!1,audioOutput:!1,audioTrack:!1,cameraDevice:!1,displayResolution:!1,mediaType:!1,micDevice:!1,simulcastRid:!1,spotlightFocusRid:!1,spotlightNumber:!1,spotlightUnfocusRid:!1,video:!1,videoBitRate:!1,videoCodecType:!1,videoContentHint:!1,videoConstraints:!1,videoInput:!1,videoTrack:!1};return o||(r.audio=!0,r.video=!0,r.displayResolution=!0,"sendonly"===e||"sendrecv"===e?(r.audioBitRate=!0,r.audioCodecType=!0,r.audioContentHint=!0,r.audioConstraints=!0,r.audioInput=!0,r.audioOutput=!0,r.audioTrack=!0,r.cameraDevice=!0,r.mediaType=!0,r.micDevice=!0,r.videoBitRate=!0,r.videoCodecType=!0,r.videoContentHint=!0,r.videoConstraints=!0,r.videoInput=!0,r.videoTrack=!0):"recvonly"===e&&(r.audioCodecType=!0,r.videoCodecType=!0,r.audioOutput=!0),"recvonly"===e&&t&&(r.audioCodecType=!1,r.videoCodecType=!1),"recvonly"!==e&&"sendrecv"!==e||!n||i||(r.simulcastRid=!0),i&&(r.spotlightNumber=!0),"recvonly"!==e&&"sendrecv"!==e||!i||(r.spotlightFocusRid=!0,r.spotlightUnfocusRid=!0)),r}function J(e){return"connected"===e||"connecting"===e}function K(e){return{id:e.id,label:e.label,kind:e.kind,enabled:e.enabled,muted:e.muted,readyState:e.readyState,contentHint:e.contentHint,getConstraints:e.getConstraints(),getCapabilities:e.getCapabilities?e.getCapabilities():null,getSettings:e.getSettings()}}},3454:function(e,t,n){"use strict";var i,o;e.exports=(null===(i=n.g.process)||void 0===i?void 0:i.env)&&"object"===typeof(null===(o=n.g.process)||void 0===o?void 0:o.env)?n.g.process:n(7663)},6363:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/_app",function(){return n(7600)}])},8210:function(){},7583:function(){},7663:function(e){!function(){var t={162:function(e){var t,n,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function a(e){if(t===setTimeout)return setTimeout(e,0);if((t===o||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(i){try{return t.call(null,e,0)}catch(i){return t.call(this,e,0)}}}!function(){try{t="function"===typeof setTimeout?setTimeout:o}catch(e){t=o}try{n="function"===typeof clearTimeout?clearTimeout:r}catch(e){n=r}}();var s,c=[],l=!1,u=-1;function d(){l&&s&&(l=!1,s.length?c=s.concat(c):u=-1,c.length&&g())}function g(){if(!l){var e=a(d);l=!0;for(var t=c.length;t;){for(s=c,c=[];++u<t;)s&&s[u].run();u=-1,t=c.length}s=null,l=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===r||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function p(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new f(e,t)),1!==c.length||l||a(g)},f.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=p,i.addListener=p,i.once=p,i.off=p,i.removeListener=p,i.removeAllListeners=p,i.emit=p,i.prependListener=p,i.prependOnceListener=p,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}}},n={};function i(e){var o=n[e];if(void 0!==o)return o.exports;var r=n[e]={exports:{}},a=!0;try{t[e](r,r.exports,i),a=!1}finally{a&&delete n[e]}return r.exports}i.ab="//";var o=i(162);e.exports=o}()},7563:function(e,t,n){"use strict";const i=n(610),o=n(4020),r=n(500),a=n(2806),s=Symbol("encodeFragmentIdentifier");function c(e){if("string"!==typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function l(e,t){return t.encode?t.strict?i(e):encodeURIComponent(e):e}function u(e,t){return t.decode?o(e):e}function d(e){return Array.isArray(e)?e.sort():"object"===typeof e?d(Object.keys(e)).sort(((e,t)=>Number(e)-Number(t))).map((t=>e[t])):e}function g(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function f(e){const t=(e=g(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function p(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"===typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function h(e,t){c((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);const n=function(e){let t;switch(e.arrayFormat){case"index":return(e,n,i)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===i[e]&&(i[e]={}),i[e][t[1]]=n):i[e]=n};case"bracket":return(e,n,i)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==i[e]?i[e]=[].concat(i[e],n):i[e]=[n]:i[e]=n};case"colon-list-separator":return(e,n,i)=>{t=/(:list)$/.exec(e),e=e.replace(/:list$/,""),t?void 0!==i[e]?i[e]=[].concat(i[e],n):i[e]=[n]:i[e]=n};case"comma":case"separator":return(t,n,i)=>{const o="string"===typeof n&&n.includes(e.arrayFormatSeparator),r="string"===typeof n&&!o&&u(n,e).includes(e.arrayFormatSeparator);n=r?u(n,e):n;const a=o||r?n.split(e.arrayFormatSeparator).map((t=>u(t,e))):null===n?n:u(n,e);i[t]=a};case"bracket-separator":return(t,n,i)=>{const o=/(\[\])$/.test(t);if(t=t.replace(/\[\]$/,""),!o)return void(i[t]=n?u(n,e):n);const r=null===n?[]:n.split(e.arrayFormatSeparator).map((t=>u(t,e)));void 0!==i[t]?i[t]=[].concat(i[t],r):i[t]=r};default:return(e,t,n)=>{void 0!==n[e]?n[e]=[].concat(n[e],t):n[e]=t}}}(t),i=Object.create(null);if("string"!==typeof e)return i;if(!(e=e.trim().replace(/^[?#&]/,"")))return i;for(const o of e.split("&")){if(""===o)continue;let[e,a]=r(t.decode?o.replace(/\+/g," "):o,"=");a=void 0===a?null:["comma","separator","bracket-separator"].includes(t.arrayFormat)?a:u(a,t),n(u(e,t),a,i)}for(const o of Object.keys(i)){const e=i[o];if("object"===typeof e&&null!==e)for(const n of Object.keys(e))e[n]=p(e[n],t);else i[o]=p(e,t)}return!1===t.sort?i:(!0===t.sort?Object.keys(i).sort():Object.keys(i).sort(t.sort)).reduce(((e,t)=>{const n=i[t];return Boolean(n)&&"object"===typeof n&&!Array.isArray(n)?e[t]=d(n):e[t]=n,e}),Object.create(null))}t.extract=f,t.parse=h,t.stringify=(e,t)=>{if(!e)return"";c((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);const n=n=>{return t.skipNull&&(null===(i=e[n])||void 0===i)||t.skipEmptyString&&""===e[n];var i},i=function(e){switch(e.arrayFormat){case"index":return t=>(n,i)=>{const o=n.length;return void 0===i||e.skipNull&&null===i||e.skipEmptyString&&""===i?n:null===i?[...n,[l(t,e),"[",o,"]"].join("")]:[...n,[l(t,e),"[",l(o,e),"]=",l(i,e)].join("")]};case"bracket":return t=>(n,i)=>void 0===i||e.skipNull&&null===i||e.skipEmptyString&&""===i?n:null===i?[...n,[l(t,e),"[]"].join("")]:[...n,[l(t,e),"[]=",l(i,e)].join("")];case"colon-list-separator":return t=>(n,i)=>void 0===i||e.skipNull&&null===i||e.skipEmptyString&&""===i?n:null===i?[...n,[l(t,e),":list="].join("")]:[...n,[l(t,e),":list=",l(i,e)].join("")];case"comma":case"separator":case"bracket-separator":{const t="bracket-separator"===e.arrayFormat?"[]=":"=";return n=>(i,o)=>void 0===o||e.skipNull&&null===o||e.skipEmptyString&&""===o?i:(o=null===o?"":o,0===i.length?[[l(n,e),t,l(o,e)].join("")]:[[i,l(o,e)].join(e.arrayFormatSeparator)])}default:return t=>(n,i)=>void 0===i||e.skipNull&&null===i||e.skipEmptyString&&""===i?n:null===i?[...n,l(t,e)]:[...n,[l(t,e),"=",l(i,e)].join("")]}}(t),o={};for(const a of Object.keys(e))n(a)||(o[a]=e[a]);const r=Object.keys(o);return!1!==t.sort&&r.sort(t.sort),r.map((n=>{const o=e[n];return void 0===o?"":null===o?l(n,t):Array.isArray(o)?0===o.length&&"bracket-separator"===t.arrayFormat?l(n,t)+"[]":o.reduce(i(n),[]).join("&"):l(n,t)+"="+l(o,t)})).filter((e=>e.length>0)).join("&")},t.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);const[n,i]=r(e,"#");return Object.assign({url:n.split("?")[0]||"",query:h(f(e),t)},t&&t.parseFragmentIdentifier&&i?{fragmentIdentifier:u(i,t)}:{})},t.stringifyUrl=(e,n)=>{n=Object.assign({encode:!0,strict:!0,[s]:!0},n);const i=g(e.url).split("?")[0]||"",o=t.extract(e.url),r=t.parse(o,{sort:!1}),a=Object.assign(r,e.query);let c=t.stringify(a,n);c&&(c=`?${c}`);let u=function(e){let t="";const n=e.indexOf("#");return-1!==n&&(t=e.slice(n)),t}(e.url);return e.fragmentIdentifier&&(u=`#${n[s]?l(e.fragmentIdentifier,n):e.fragmentIdentifier}`),`${i}${c}${u}`},t.pick=(e,n,i)=>{i=Object.assign({parseFragmentIdentifier:!0,[s]:!1},i);const{url:o,query:r,fragmentIdentifier:c}=t.parseUrl(e,i);return t.stringifyUrl({url:o,query:a(r,n),fragmentIdentifier:c},i)},t.exclude=(e,n,i)=>{const o=Array.isArray(n)?e=>!n.includes(e):(e,t)=>!n(e,t);return t.pick(e,o,i)}},9921:function(e,t){"use strict";var n="function"===typeof Symbol&&Symbol.for,i=n?Symbol.for("react.element"):60103,o=n?Symbol.for("react.portal"):60106,r=n?Symbol.for("react.fragment"):60107,a=n?Symbol.for("react.strict_mode"):60108,s=n?Symbol.for("react.profiler"):60114,c=n?Symbol.for("react.provider"):60109,l=n?Symbol.for("react.context"):60110,u=n?Symbol.for("react.async_mode"):60111,d=n?Symbol.for("react.concurrent_mode"):60111,g=n?Symbol.for("react.forward_ref"):60112,f=n?Symbol.for("react.suspense"):60113,p=n?Symbol.for("react.suspense_list"):60120,h=n?Symbol.for("react.memo"):60115,m=n?Symbol.for("react.lazy"):60116,y=n?Symbol.for("react.block"):60121,C=n?Symbol.for("react.fundamental"):60117,b=n?Symbol.for("react.responder"):60118,v=n?Symbol.for("react.scope"):60119;function w(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case i:switch(e=e.type){case u:case d:case r:case s:case a:case f:return e;default:switch(e=e&&e.$$typeof){case l:case g:case m:case h:case c:return e;default:return t}}case o:return t}}}function I(e){return w(e)===d}t.AsyncMode=u,t.ConcurrentMode=d,t.ContextConsumer=l,t.ContextProvider=c,t.Element=i,t.ForwardRef=g,t.Fragment=r,t.Lazy=m,t.Memo=h,t.Portal=o,t.Profiler=s,t.StrictMode=a,t.Suspense=f,t.isAsyncMode=function(e){return I(e)||w(e)===u},t.isConcurrentMode=I,t.isContextConsumer=function(e){return w(e)===l},t.isContextProvider=function(e){return w(e)===c},t.isElement=function(e){return"object"===typeof e&&null!==e&&e.$$typeof===i},t.isForwardRef=function(e){return w(e)===g},t.isFragment=function(e){return w(e)===r},t.isLazy=function(e){return w(e)===m},t.isMemo=function(e){return w(e)===h},t.isPortal=function(e){return w(e)===o},t.isProfiler=function(e){return w(e)===s},t.isStrictMode=function(e){return w(e)===a},t.isSuspense=function(e){return w(e)===f},t.isValidElementType=function(e){return"string"===typeof e||"function"===typeof e||e===r||e===d||e===s||e===a||e===f||e===p||"object"===typeof e&&null!==e&&(e.$$typeof===m||e.$$typeof===h||e.$$typeof===c||e.$$typeof===l||e.$$typeof===g||e.$$typeof===C||e.$$typeof===b||e.$$typeof===v||e.$$typeof===y)},t.typeOf=w},9864:function(e,t,n){"use strict";e.exports=n(9921)},5617:function(e,t,n){"use strict";n.d(t,{zt:function(){return u},I0:function(){return h},v9:function(){return b}});var i=n(7294),o=i.createContext(null);var r=function(e){e()},a=function(){return r};var s={notify:function(){},get:function(){return[]}};function c(e,t){var n,i=s;function o(){c.onStateChange&&c.onStateChange()}function r(){n||(n=t?t.addNestedSub(o):e.subscribe(o),i=function(){var e=a(),t=null,n=null;return{clear:function(){t=null,n=null},notify:function(){e((function(){for(var e=t;e;)e.callback(),e=e.next}))},get:function(){for(var e=[],n=t;n;)e.push(n),n=n.next;return e},subscribe:function(e){var i=!0,o=n={callback:e,next:null,prev:n};return o.prev?o.prev.next=o:t=o,function(){i&&null!==t&&(i=!1,o.next?o.next.prev=o.prev:n=o.prev,o.prev?o.prev.next=o.next:t=o.next)}}}}())}var c={addNestedSub:function(e){return r(),i.subscribe(e)},notifyNestedSubs:function(){i.notify()},handleChangeWrapper:o,isSubscribed:function(){return Boolean(n)},trySubscribe:r,tryUnsubscribe:function(){n&&(n(),n=void 0,i.clear(),i=s)},getListeners:function(){return i}};return c}var l="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement?i.useLayoutEffect:i.useEffect;var u=function(e){var t=e.store,n=e.context,r=e.children,a=(0,i.useMemo)((function(){var e=c(t);return e.onStateChange=e.notifyNestedSubs,{store:t,subscription:e}}),[t]),s=(0,i.useMemo)((function(){return t.getState()}),[t]);l((function(){var e=a.subscription;return e.trySubscribe(),s!==t.getState()&&e.notifyNestedSubs(),function(){e.tryUnsubscribe(),e.onStateChange=null}}),[a,s]);var u=n||o;return i.createElement(u.Provider,{value:a},r)};n(8679),n(2973);n(7462);function d(){return(0,i.useContext)(o)}function g(e){void 0===e&&(e=o);var t=e===o?d:function(){return(0,i.useContext)(e)};return function(){return t().store}}var f=g();function p(e){void 0===e&&(e=o);var t=e===o?f:g(e);return function(){return t().dispatch}}var h=p(),m=function(e,t){return e===t};function y(e){void 0===e&&(e=o);var t=e===o?d:function(){return(0,i.useContext)(e)};return function(e,n){void 0===n&&(n=m);var o=t(),r=function(e,t,n,o){var r,a=(0,i.useReducer)((function(e){return e+1}),0)[1],s=(0,i.useMemo)((function(){return c(n,o)}),[n,o]),u=(0,i.useRef)(),d=(0,i.useRef)(),g=(0,i.useRef)(),f=(0,i.useRef)(),p=n.getState();try{if(e!==d.current||p!==g.current||u.current){var h=e(p);r=void 0!==f.current&&t(h,f.current)?f.current:h}else r=f.current}catch(m){throw u.current&&(m.message+="\nThe error may be correlated with this previous error:\n"+u.current.stack+"\n\n"),m}return l((function(){d.current=e,g.current=p,f.current=r,u.current=void 0})),l((function(){function e(){try{var e=n.getState();if(e===g.current)return;var i=d.current(e);if(t(i,f.current))return;f.current=i,g.current=e}catch(m){u.current=m}a()}return s.onStateChange=e,s.trySubscribe(),e(),function(){return s.tryUnsubscribe()}}),[n,s]),r}(e,n,o.store,o.subscription);return(0,i.useDebugValue)(r),r}}var C,b=y(),v=n(3935);C=v.unstable_batchedUpdates,r=C},8359:function(e,t){"use strict";var n=60103,i=60106,o=60107,r=60108,a=60114,s=60109,c=60110,l=60112,u=60113,d=60120,g=60115,f=60116,p=60121,h=60122,m=60117,y=60129,C=60131;if("function"===typeof Symbol&&Symbol.for){var b=Symbol.for;n=b("react.element"),i=b("react.portal"),o=b("react.fragment"),r=b("react.strict_mode"),a=b("react.profiler"),s=b("react.provider"),c=b("react.context"),l=b("react.forward_ref"),u=b("react.suspense"),d=b("react.suspense_list"),g=b("react.memo"),f=b("react.lazy"),p=b("react.block"),h=b("react.server.block"),m=b("react.fundamental"),y=b("react.debug_trace_mode"),C=b("react.legacy_hidden")}function v(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:switch(e=e.type){case o:case a:case r:case u:case d:return e;default:switch(e=e&&e.$$typeof){case c:case l:case f:case g:case s:return e;default:return t}}case i:return t}}}},2973:function(e,t,n){"use strict";n(8359)},4500:function(e,t,n){!function(e){"use strict";function t(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}function i(e,t){Object.defineProperty(this,"kind",{value:e,enumerable:!0}),t&&t.length&&Object.defineProperty(this,"path",{value:t,enumerable:!0})}function o(e,t,n){o.super_.call(this,"E",e),Object.defineProperty(this,"lhs",{value:t,enumerable:!0}),Object.defineProperty(this,"rhs",{value:n,enumerable:!0})}function r(e,t){r.super_.call(this,"N",e),Object.defineProperty(this,"rhs",{value:t,enumerable:!0})}function a(e,t){a.super_.call(this,"D",e),Object.defineProperty(this,"lhs",{value:t,enumerable:!0})}function s(e,t,n){s.super_.call(this,"A",e),Object.defineProperty(this,"index",{value:t,enumerable:!0}),Object.defineProperty(this,"item",{value:n,enumerable:!0})}function c(e,t,n){var i=e.slice((n||t)+1||e.length);return e.length=t<0?e.length+t:t,e.push.apply(e,i),e}function l(e){var t="undefined"==typeof e?"undefined":k(e);return"object"!==t?t:e===Math?"math":null===e?"null":Array.isArray(e)?"array":"[object Date]"===Object.prototype.toString.call(e)?"date":"function"==typeof e.toString&&/^\/.*\//.test(e.toString())?"regexp":"object"}function u(e,t,n,i,d,g,f){f=f||[];var p=(d=d||[]).slice(0);if("undefined"!=typeof g){if(i){if("function"==typeof i&&i(p,g))return;if("object"===("undefined"==typeof i?"undefined":k(i))){if(i.prefilter&&i.prefilter(p,g))return;if(i.normalize){var h=i.normalize(p,g,e,t);h&&(e=h[0],t=h[1])}}}p.push(g)}"regexp"===l(e)&&"regexp"===l(t)&&(e=e.toString(),t=t.toString());var m="undefined"==typeof e?"undefined":k(e),y="undefined"==typeof t?"undefined":k(t),C="undefined"!==m||f&&f[f.length-1].lhs&&f[f.length-1].lhs.hasOwnProperty(g),b="undefined"!==y||f&&f[f.length-1].rhs&&f[f.length-1].rhs.hasOwnProperty(g);if(!C&&b)n(new r(p,t));else if(!b&&C)n(new a(p,e));else if(l(e)!==l(t))n(new o(p,e,t));else if("date"===l(e)&&e-t!==0)n(new o(p,e,t));else if("object"===m&&null!==e&&null!==t)if(f.filter((function(t){return t.lhs===e})).length)e!==t&&n(new o(p,e,t));else{if(f.push({lhs:e,rhs:t}),Array.isArray(e)){var v;for(e.length,v=0;v<e.length;v++)v>=t.length?n(new s(p,v,new a(void 0,e[v]))):u(e[v],t[v],n,i,p,v,f);for(;v<t.length;)n(new s(p,v,new r(void 0,t[v++])))}else{var w=Object.keys(e),I=Object.keys(t);w.forEach((function(o,r){var a=I.indexOf(o);a>=0?(u(e[o],t[o],n,i,p,o,f),I=c(I,a)):u(e[o],void 0,n,i,p,o,f)})),I.forEach((function(e){u(void 0,t[e],n,i,p,e,f)}))}f.length=f.length-1}else e!==t&&("number"===m&&isNaN(e)&&isNaN(t)||n(new o(p,e,t)))}function d(e,t,n,i){return i=i||[],u(e,t,(function(e){e&&i.push(e)}),n),i.length?i:void 0}function g(e,t,n){if(n.path&&n.path.length){var i,o=e[t],r=n.path.length-1;for(i=0;i<r;i++)o=o[n.path[i]];switch(n.kind){case"A":g(o[n.path[i]],n.index,n.item);break;case"D":delete o[n.path[i]];break;case"E":case"N":o[n.path[i]]=n.rhs}}else switch(n.kind){case"A":g(e[t],n.index,n.item);break;case"D":e=c(e,t);break;case"E":case"N":e[t]=n.rhs}return e}function f(e,t,n){if(e&&t&&n&&n.kind){for(var i=e,o=-1,r=n.path?n.path.length-1:0;++o<r;)"undefined"==typeof i[n.path[o]]&&(i[n.path[o]]="number"==typeof n.path[o]?[]:{}),i=i[n.path[o]];switch(n.kind){case"A":g(n.path?i[n.path[o]]:i,n.index,n.item);break;case"D":delete i[n.path[o]];break;case"E":case"N":i[n.path[o]]=n.rhs}}}function p(e,t,n){if(n.path&&n.path.length){var i,o=e[t],r=n.path.length-1;for(i=0;i<r;i++)o=o[n.path[i]];switch(n.kind){case"A":p(o[n.path[i]],n.index,n.item);break;case"D":case"E":o[n.path[i]]=n.lhs;break;case"N":delete o[n.path[i]]}}else switch(n.kind){case"A":p(e[t],n.index,n.item);break;case"D":case"E":e[t]=n.lhs;break;case"N":e=c(e,t)}return e}function h(e,t,n){if(e&&t&&n&&n.kind){var i,o,r=e;for(o=n.path.length-1,i=0;i<o;i++)"undefined"==typeof r[n.path[i]]&&(r[n.path[i]]={}),r=r[n.path[i]];switch(n.kind){case"A":p(r[n.path[i]],n.index,n.item);break;case"D":case"E":r[n.path[i]]=n.lhs;break;case"N":delete r[n.path[i]]}}}function m(e,t,n){e&&t&&u(e,t,(function(i){n&&!n(e,t,i)||f(e,t,i)}))}function y(e){return"color: "+_[e].color+"; font-weight: bold"}function C(e){var t=e.kind,n=e.path,i=e.lhs,o=e.rhs,r=e.index,a=e.item;switch(t){case"E":return[n.join("."),i,"\u2192",o];case"N":return[n.join("."),o];case"D":return[n.join(".")];case"A":return[n.join(".")+"["+r+"]",a];default:return[]}}function b(e,t,n,i){var o=d(e,t);try{i?n.groupCollapsed("diff"):n.group("diff")}catch(e){n.log("diff")}o?o.forEach((function(e){var t=e.kind,i=C(e);n.log.apply(n,["%c "+_[t].text,y(t)].concat(M(i)))})):n.log("\u2014\u2014 no diff \u2014\u2014");try{n.groupEnd()}catch(e){n.log("\u2014\u2014 diff end \u2014\u2014 ")}}function v(e,t,n,i){switch("undefined"==typeof e?"undefined":k(e)){case"object":return"function"==typeof e[i]?e[i].apply(e,M(n)):e[i];case"function":return e(t);default:return e}}function w(e){var t=e.timestamp,n=e.duration;return function(e,i,o){var r=["action"];return r.push("%c"+String(e.type)),t&&r.push("%c@ "+i),n&&r.push("%c(in "+o.toFixed(2)+" ms)"),r.join(" ")}}function I(e,t){var n=t.logger,i=t.actionTransformer,o=t.titleFormatter,r=void 0===o?w(t):o,a=t.collapsed,s=t.colors,c=t.level,l=t.diff,u="undefined"==typeof t.titleFormatter;e.forEach((function(o,d){var g=o.started,f=o.startedTime,p=o.action,h=o.prevState,m=o.error,y=o.took,C=o.nextState,w=e[d+1];w&&(C=w.prevState,y=w.started-g);var I=i(p),S="function"==typeof a?a((function(){return C}),p,o):a,O=R(f),E=s.title?"color: "+s.title(I)+";":"",A=["color: gray; font-weight: lighter;"];A.push(E),t.timestamp&&A.push("color: gray; font-weight: lighter;"),t.duration&&A.push("color: gray; font-weight: lighter;");var T=r(I,O,y);try{S?s.title&&u?n.groupCollapsed.apply(n,["%c "+T].concat(A)):n.groupCollapsed(T):s.title&&u?n.group.apply(n,["%c "+T].concat(A)):n.group(T)}catch(e){n.log(T)}var D=v(c,I,[h],"prevState"),k=v(c,I,[I],"action"),M=v(c,I,[m,h],"error"),P=v(c,I,[C],"nextState");if(D)if(s.prevState){var _="color: "+s.prevState(h)+"; font-weight: bold";n[D]("%c prev state",_,h)}else n[D]("prev state",h);if(k)if(s.action){var Z="color: "+s.action(I)+"; font-weight: bold";n[k]("%c action    ",Z,I)}else n[k]("action    ",I);if(m&&M)if(s.error){var F="color: "+s.error(m,h)+"; font-weight: bold;";n[M]("%c error     ",F,m)}else n[M]("error     ",m);if(P)if(s.nextState){var N="color: "+s.nextState(C)+"; font-weight: bold";n[P]("%c next state",N,C)}else n[P]("next state",C);l&&b(h,C,n,S);try{n.groupEnd()}catch(e){n.log("\u2014\u2014 log end \u2014\u2014")}}))}function S(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.assign({},Z,e),n=t.logger,i=t.stateTransformer,o=t.errorTransformer,r=t.predicate,a=t.logErrors,s=t.diffPredicate;if("undefined"==typeof n)return function(){return function(e){return function(t){return e(t)}}};if(e.getState&&e.dispatch)return console.error("[redux-logger] redux-logger not installed. Make sure to pass logger instance as middleware:\n// Logger with default options\nimport { logger } from 'redux-logger'\nconst store = createStore(\n  reducer,\n  applyMiddleware(logger)\n)\n// Or you can create your own logger with custom options http://bit.ly/redux-logger-options\nimport createLogger from 'redux-logger'\nconst logger = createLogger({\n  // ...options\n});\nconst store = createStore(\n  reducer,\n  applyMiddleware(logger)\n)\n"),function(){return function(e){return function(t){return e(t)}}};var c=[];return function(e){var n=e.getState;return function(e){return function(l){if("function"==typeof r&&!r(n,l))return e(l);var u={};c.push(u),u.started=D.now(),u.startedTime=new Date,u.prevState=i(n()),u.action=l;var d=void 0;if(a)try{d=e(l)}catch(e){u.error=o(e)}else d=e(l);u.took=D.now()-u.started,u.nextState=i(n());var g=t.diff&&"function"==typeof s?s(n,l):t.diff;if(I(c,Object.assign({},t,{diff:g})),c.length=0,u.error)throw u.error;return d}}}}var O,E,A=function(e,t){return new Array(t+1).join(e)},T=function(e,t){return A("0",t-e.toString().length)+e},R=function(e){return T(e.getHours(),2)+":"+T(e.getMinutes(),2)+":"+T(e.getSeconds(),2)+"."+T(e.getMilliseconds(),3)},D="undefined"!=typeof performance&&null!==performance&&"function"==typeof performance.now?performance:Date,k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},M=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)},P=[];O="object"===("undefined"==typeof n.g?"undefined":k(n.g))&&n.g?n.g:"undefined"!=typeof window?window:{},(E=O.DeepDiff)&&P.push((function(){"undefined"!=typeof E&&O.DeepDiff===d&&(O.DeepDiff=E,E=void 0)})),t(o,i),t(r,i),t(a,i),t(s,i),Object.defineProperties(d,{diff:{value:d,enumerable:!0},observableDiff:{value:u,enumerable:!0},applyDiff:{value:m,enumerable:!0},applyChange:{value:f,enumerable:!0},revertChange:{value:h,enumerable:!0},isConflict:{value:function(){return"undefined"!=typeof E},enumerable:!0},noConflict:{value:function(){return P&&(P.forEach((function(e){e()})),P=null),d},enumerable:!0}});var _={E:{color:"#2196F3",text:"CHANGED:"},N:{color:"#4CAF50",text:"ADDED:"},D:{color:"#F44336",text:"DELETED:"},A:{color:"#2196F3",text:"ARRAY:"}},Z={level:"log",logger:console,logErrors:!0,collapsed:void 0,predicate:void 0,duration:!1,timestamp:!0,stateTransformer:function(e){return e},actionTransformer:function(e){return e},errorTransformer:function(e){return e},colors:{title:function(){return"inherit"},prevState:function(){return"#9E9E9E"},action:function(){return"#03A9F4"},nextState:function(){return"#4CAF50"},error:function(){return"#F20404"}},diff:!1,diffPredicate:void 0,transformer:void 0},F=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.dispatch,n=e.getState;return"function"==typeof t||"function"==typeof n?S()({dispatch:t,getState:n}):void console.error("\n[redux-logger v3] BREAKING CHANGE\n[redux-logger v3] Since 3.0.0 redux-logger exports by default logger with default settings.\n[redux-logger v3] Change\n[redux-logger v3] import createLogger from 'redux-logger'\n[redux-logger v3] to\n[redux-logger v3] import { createLogger } from 'redux-logger'\n")};e.defaults=Z,e.createLogger=S,e.logger=F,e.default=F,Object.defineProperty(e,"__esModule",{value:!0})}(t)},500:function(e){"use strict";e.exports=(e,t)=>{if("string"!==typeof e||"string"!==typeof t)throw new TypeError("Expected the arguments to be of type `string`");if(""===t)return[e];const n=e.indexOf(t);return-1===n?[e]:[e.slice(0,n),e.slice(n+t.length)]}},610:function(e){"use strict";e.exports=e=>encodeURIComponent(e).replace(/[!'()*]/g,(e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`))},8981:function(e,t,n){"use strict";e.exports=n.p+"static/media/rnnoise.11b5e664.wasm"},7462:function(e,t,n){"use strict";function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}n.d(t,{Z:function(){return i}})},29:function(e,t,n){"use strict";function i(e,t,n,i,o,r,a){try{var s=e[r](a),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(i,o)}function o(e){return function(){var t=this,n=arguments;return new Promise((function(o,r){var a=e.apply(t,n);function s(e){i(a,o,r,s,c,"next",e)}function c(e){i(a,o,r,s,c,"throw",e)}s(void 0)}))}}n.d(t,{Z:function(){return o}})},9499:function(e,t,n){"use strict";function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,{Z:function(){return i}})},2640:function(e,t,n){"use strict";function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,o,r=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(i=n.next()).done)&&(r.push(i.value),!t||r.length!==t);a=!0);}catch(c){s=!0,o=c}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return r}}(e,t)||function(e,t){if(e){if("string"===typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}n.d(t,{Z:function(){return o}})},2923:function(e,t,n){"use strict";n.d(t,{Z:function(){return ce}});var i=n(3454);class o{constructor(){if(!!!RTCRtpSender.prototype.createEncodedStreams)throw new Error("E2EE is not supported in this browser.");this.worker=null,this.onWorkerDisconnect=null}startWorker(){const e=atob("InVzZSBzdHJpY3QiOwovKiBlc2xpbnQtZGlzYWJsZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW51c2VkLXZhcnMgKi8KY29uc3QgY29ubmVjdGlvbklkTGVuZ3RoID0gMjY7CmZ1bmN0aW9uIGJ5dGVDb3VudChuKSB7CiAgICBpZiAobiA9PSAwKSB7CiAgICAgICAgcmV0dXJuIDE7CiAgICB9CiAgICAvLyBsb2cyNTYoeCkgPSBsb2coeCkgLyBsb2coMjU2KQogICAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5sb2cobikgLyBNYXRoLmxvZygyICoqIDgpICsgMSk7Cn0KZnVuY3Rpb24gYXJyYXlCdWZmZXJUb051bWJlcihhcnJheUJ1ZmZlcikgewogICAgLy8gMzJiaXQg44G+44Gn44KS5oOz5a6aIChCaWdJbnQg44G444Gu5pu444GN5o+b44GI5pmC44Gr6KaB5L+u5q2jKQogICAgY29uc3QgbmV3QXJyYXlCdWZmZXIgPSBuZXcgQXJyYXlCdWZmZXIoVWludDMyQXJyYXkuQllURVNfUEVSX0VMRU1FTlQpOwogICAgY29uc3QgbmV3RGF0YVZpZXcgPSBuZXcgRGF0YVZpZXcobmV3QXJyYXlCdWZmZXIpOwogICAgY29uc3QgZGF0YVZpZXcgPSBuZXcgRGF0YVZpZXcoYXJyYXlCdWZmZXIpOwogICAgY29uc3QgcGFkZGluZ0xlbmd0aCA9IFVpbnQzMkFycmF5LkJZVEVTX1BFUl9FTEVNRU5UIC0gZGF0YVZpZXcuYnl0ZUxlbmd0aDsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcGFkZGluZ0xlbmd0aDsgaSArPSAxKSB7CiAgICAgICAgbmV3RGF0YVZpZXcuc2V0VWludDgoaSwgMCk7CiAgICB9CiAgICBmb3IgKGxldCBpID0gcGFkZGluZ0xlbmd0aCwgaiA9IDA7IGkgPCBVaW50MzJBcnJheS5CWVRFU19QRVJfRUxFTUVOVDsgaSArPSAxLCBqICs9IDEpIHsKICAgICAgICBuZXdEYXRhVmlldy5zZXRVaW50OChpLCBkYXRhVmlldy5nZXRVaW50OChqKSk7CiAgICB9CiAgICByZXR1cm4gbmV3RGF0YVZpZXcuZ2V0VWludDMyKDApOwp9CmZ1bmN0aW9uIGVuY29kZVNGcmFtZUhlYWRlcihzLCBjb3VudCwga2V5SWQpIHsKICAgIC8vICAwIDEgMiAzIDQgNSA2IDcKICAgIC8vICstKy0rLSstKy0rLSstKy0rLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSsKICAgIC8vIHxTfExFTiAgfDF8S0xFTiB8ICAgS0lELi4uIChsZW5ndGg9S0xFTikgICAgfCAgICBDVFIuLi4gKGxlbmd0aD1MRU4pICAgIHwKICAgIC8vICstKy0rLSstKy0rLSstKy0rLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSsKICAgIC8vIFM6IDEgYml0CiAgICAvLyBMRU46IDMgYml0CiAgICAvLyBYOiAxIGJpdAogICAgLy8gS0xFTjogMyBiaXQKICAgIC8vIEtJRDogS0xFTiBieXRlCiAgICAvLyBDVFI6IExFTiBieXRlCiAgICAvLyBUT0RPOiBrZXlJZCAoS0lEKSDjgYwgTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVIsIDcgYnl0ZSDjgpLotoXjgYjjgabjgYTjgZ/loLTlkIjjga/jgqjjg6njg7zjgYvkvovlpJYKICAgIC8vIFRPRE86IGNvdW50IChDVFIpIOOBjCBOdW1iZXIuTUFYX1NBRkVfSU5URUdFUiwgNyBieXRlIOOCkui2heOBiOOBpuOBhOOBn+WgtOWQiOOBr+OCqOODqeODvOOBi+S+i+WklgogICAgaWYgKG1heEtleUlkIDwga2V5SWQgfHwgbWF4Q291bnQgPCBjb3VudCkgewogICAgICAgIHRocm93IG5ldyBFcnJvcigiRVhDRUVERUQtTUFYSU1VTS1CUk9BRENBU1RJTkctVElNRSIpOwogICAgfQogICAgY29uc3Qga2xlbiA9IGJ5dGVDb3VudChrZXlJZCk7CiAgICBjb25zdCBsZW4gPSBieXRlQ291bnQoY291bnQpOwogICAgY29uc3QgaGVhZGVyQnVmZmVyID0gbmV3IEFycmF5QnVmZmVyKDEgKyBrbGVuICsgbGVuKTsKICAgIGNvbnN0IGhlYWRlckRhdGFWaWV3ID0gbmV3IERhdGFWaWV3KGhlYWRlckJ1ZmZlcik7CiAgICAvLyBTLCBMRU4sIDEsIEtMRU4g44GnIDEgYnl0ZQogICAgaGVhZGVyRGF0YVZpZXcuc2V0VWludDgoMCwgKHMgPDwgNykgKyAobGVuIDw8IDQpICsgKDEgPDwgMykgKyBrbGVuKTsKICAgIGNvbnN0IGhlYWRlclVpbnQ4QXJyYXkgPSBuZXcgVWludDhBcnJheShoZWFkZXJCdWZmZXIpOwogICAgY29uc3Qga2V5SWRCdWZmZXIgPSBuZXcgQXJyYXlCdWZmZXIoVWludDMyQXJyYXkuQllURVNfUEVSX0VMRU1FTlQpOwogICAgY29uc3Qga2V5SWREYXRhVmlldyA9IG5ldyBEYXRhVmlldyhrZXlJZEJ1ZmZlcik7CiAgICBrZXlJZERhdGFWaWV3LnNldFVpbnQzMigwLCBrZXlJZCk7CiAgICBjb25zdCBrZXlJZFVpbnQ4QXJyYXkgPSBuZXcgVWludDhBcnJheShrZXlJZEJ1ZmZlcik7CiAgICBoZWFkZXJVaW50OEFycmF5LnNldChrZXlJZFVpbnQ4QXJyYXkuc3ViYXJyYXkoVWludDMyQXJyYXkuQllURVNfUEVSX0VMRU1FTlQgLSBrbGVuKSwgMSk7CiAgICBjb25zdCBjb3VudEJ1ZmZlciA9IG5ldyBBcnJheUJ1ZmZlcihVaW50MzJBcnJheS5CWVRFU19QRVJfRUxFTUVOVCk7CiAgICBjb25zdCBjb3VudERhdGFWaWV3ID0gbmV3IERhdGFWaWV3KGNvdW50QnVmZmVyKTsKICAgIGNvdW50RGF0YVZpZXcuc2V0VWludDMyKDAsIGNvdW50KTsKICAgIGNvbnN0IGNvdW50VWludDhBcnJheSA9IG5ldyBVaW50OEFycmF5KGNvdW50QnVmZmVyKTsKICAgIGhlYWRlclVpbnQ4QXJyYXkuc2V0KGNvdW50VWludDhBcnJheS5zdWJhcnJheShVaW50MzJBcnJheS5CWVRFU19QRVJfRUxFTUVOVCAtIGxlbiksIGtsZW4gKyAxKTsKICAgIHJldHVybiBoZWFkZXJVaW50OEFycmF5Owp9CmZ1bmN0aW9uIHNwbGl0SGVhZGVyKHNmcmFtZSkgewogICAgY29uc3Qgc2ZyYW1lRGF0YVZpZXcgPSBuZXcgRGF0YVZpZXcoc2ZyYW1lKTsKICAgIGNvbnN0IGhlYWRlciA9IHNmcmFtZURhdGFWaWV3LmdldFVpbnQ4KDApOwogICAgY29uc3QgbGVuID0gKGhlYWRlciAmIDB4NzApID4+IDQ7CiAgICBjb25zdCBrbGVuID0gaGVhZGVyICYgMHgwNzsKICAgIGNvbnN0IHNmcmFtZUhlYWRlckxlbmd0aCA9IDEgKyBrbGVuICsgbGVuOwogICAgY29uc3Qgc2ZyYW1lSGVhZGVyID0gc2ZyYW1lLnNsaWNlKDAsIHNmcmFtZUhlYWRlckxlbmd0aCk7CiAgICBpZiAoc2ZyYW1lSGVhZGVyLmJ5dGVMZW5ndGggPCBzZnJhbWVIZWFkZXJMZW5ndGgpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIlVORVhQRUNURUQtU0ZSQU1FLUxFTkdUSCIpOwogICAgfQogICAgY29uc3QgY29ubmVjdGlvbklkID0gc2ZyYW1lLnNsaWNlKHNmcmFtZUhlYWRlckxlbmd0aCwgc2ZyYW1lSGVhZGVyTGVuZ3RoICsgY29ubmVjdGlvbklkTGVuZ3RoKTsKICAgIGNvbnN0IGVuY3J5cHRlZEZyYW1lID0gc2ZyYW1lLnNsaWNlKHNmcmFtZUhlYWRlckxlbmd0aCArIGNvbm5lY3Rpb25JZExlbmd0aCwgc2ZyYW1lLmJ5dGVMZW5ndGgpOwogICAgcmV0dXJuIFtzZnJhbWVIZWFkZXIsIGNvbm5lY3Rpb25JZCwgZW5jcnlwdGVkRnJhbWVdOwp9CmZ1bmN0aW9uIHBhcnNlU0ZyYW1lSGVhZGVyKHNmcmFtZUhlYWRlcikgewogICAgY29uc3Qgc2ZyYW1lSGVhZGVyRGF0YVZpZXcgPSBuZXcgRGF0YVZpZXcoc2ZyYW1lSGVhZGVyKTsKICAgIGNvbnN0IGhlYWRlciA9IHNmcmFtZUhlYWRlckRhdGFWaWV3LmdldFVpbnQ4KDApOwogICAgY29uc3QgcyA9IChoZWFkZXIgJiAweDgwKSA+PiA3OwogICAgY29uc3QgbGVuID0gKGhlYWRlciAmIDB4NzApID4+IDQ7CiAgICBjb25zdCB4ID0gKGhlYWRlciAmIDB4MDgpID4+IDM7CiAgICBjb25zdCBrbGVuID0gaGVhZGVyICYgMHgwNzsKICAgIC8vIHggZmxhZwogICAgaWYgKHggIT09IDEpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIlVORVhQRUNURUQtWC1GTEFHIik7CiAgICB9CiAgICBjb25zdCBoZWFkZXJMZW5ndGggPSAxICsga2xlbiArIGxlbjsKICAgIGlmIChzZnJhbWVIZWFkZXJEYXRhVmlldy5ieXRlTGVuZ3RoIDwgaGVhZGVyTGVuZ3RoKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJVTkVYUEVDVEVELVNGUkFNRS1IRUFERVItTEVOR1RIIik7CiAgICB9CiAgICBjb25zdCBrZXlJZEJ1ZmZlciA9IHNmcmFtZUhlYWRlci5zbGljZSgxLCAxICsga2xlbik7CiAgICBjb25zdCBrZXlJZCA9IGFycmF5QnVmZmVyVG9OdW1iZXIoa2V5SWRCdWZmZXIpOwogICAgY29uc3QgY291bnRCdWZmZXIgPSBzZnJhbWVIZWFkZXIuc2xpY2UoMSArIGtsZW4sIGhlYWRlckxlbmd0aCk7CiAgICBjb25zdCBjb3VudCA9IGFycmF5QnVmZmVyVG9OdW1iZXIoY291bnRCdWZmZXIpOwogICAgcmV0dXJuIFtzLCBjb3VudCwga2V5SWRdOwp9Ci8qIGVzbGludC1kaXNhYmxlIEB0eXBlc2NyaXB0LWVzbGludC90cmlwbGUtc2xhc2gtcmVmZXJlbmNlLCBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW51c2VkLXZhcnMgKi8KLy8vIDxyZWZlcmVuY2UgcGF0aD0iLi9zZnJhbWUudHMiLz4KLy8gVE9ETzog5omx44GG5pWw5YCk44GM5aSn44GN44GE566H5omA44Gn44GvIE51bWJlciDjgYvjgokgQmlnSW50IOOBq+e9ruOBjeaPm+OBiOOCiwovLyBUT0RPOiBCaWdJbnQg44Gr572u44GN5o+b44GI44KL6Zqb44Gr5aSJ5pu044GZ44KLCmNvbnN0IG1heEtleUlkID0gMiAqKiAzMjsKY29uc3QgbWF4Q291bnQgPSAyICoqIDMyOwpjb25zdCBzZWxmRGVyaXZlS2V5TWFwID0gbmV3IE1hcCgpOwpjb25zdCBjb3VudE1hcCA9IG5ldyBNYXAoKTsKY29uc3Qgd3JpdGVJVk1hcCA9IG5ldyBNYXAoKTsKY29uc3QgcmVtb3RlRGVyaXZlS2V5TWFwID0gbmV3IE1hcCgpOwpjb25zdCBsYXRlc3RSZW1vdGVLZXlJZE1hcCA9IG5ldyBNYXAoKTsKY29uc3QgbGl0dGxlRW5kaWFuID0gdHJ1ZTsKY29uc3QgYmlnRW5kaWFuID0gIWxpdHRsZUVuZGlhbjsKY29uc3QgdGV4dEVuY29kZXIgPSBuZXcgVGV4dEVuY29kZXIoKTsKY29uc3QgdGV4dERlY29kZXIgPSBuZXcgVGV4dERlY29kZXIoKTsKLy8gVlA4IOOBruOBvwovLyBUT0RPKG5ha2FpKTogVlA5IC8gQVYxIOOCguWwhuadpeeahOOBq+WvvuW/nOOCguiAg+OBiOOCiwpjb25zdCB1bmVuY3J5cHRlZEJ5dGVzID0gewogICAgLy8gSSDjg5Xjg6zjg7zjg6AKICAgIGtleTogMTAsCiAgICAvLyDpnZ4gSSDjg5Xjg6zjg7zjg6AKICAgIGRlbHRhOiAzLAogICAgLy8g44Kq44O844OH44Kj44KqCiAgICB1bmRlZmluZWQ6IDEsCn07CmZ1bmN0aW9uIGdldENvdW50KGNvbm5lY3Rpb25JZCkgewogICAgcmV0dXJuIGNvdW50TWFwLmdldChjb25uZWN0aW9uSWQpIHx8IDA7Cn0KZnVuY3Rpb24gc2V0Q291bnQoY29ubmVjdGlvbklkLCBjb3VudCkgewogICAgcmV0dXJuIGNvdW50TWFwLnNldChjb25uZWN0aW9uSWQsIGNvdW50KTsKfQpmdW5jdGlvbiBnZXRSZW1vdGVEZXJpdmVLZXkoY29ubmVjdGlvbklkLCBrZXlJZCkgewogICAgaWYgKCFyZW1vdGVEZXJpdmVLZXlNYXAuaGFzKGNvbm5lY3Rpb25JZCkpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIlJFTU9URS1ERVJJVkVLRVktTUFQLU5PVC1GT1VORCIpOwogICAgfQogICAgY29uc3QgZGVyaXZlS2V5TWFwID0gcmVtb3RlRGVyaXZlS2V5TWFwLmdldChjb25uZWN0aW9uSWQpOwogICAgaWYgKCFkZXJpdmVLZXlNYXApIHsKICAgICAgICByZXR1cm47CiAgICB9CiAgICByZXR1cm4gZGVyaXZlS2V5TWFwLmdldChrZXlJZCk7Cn0KZnVuY3Rpb24gc2V0UmVtb3RlRGVyaXZlS2V5KGNvbm5lY3Rpb25JZCwga2V5SWQsIGRlcml2ZUtleSkgewogICAgbGV0IGRlcml2ZUtleU1hcCA9IHJlbW90ZURlcml2ZUtleU1hcC5nZXQoY29ubmVjdGlvbklkKTsKICAgIGlmICghZGVyaXZlS2V5TWFwKSB7CiAgICAgICAgZGVyaXZlS2V5TWFwID0gbmV3IE1hcCgpOwogICAgfQogICAgZGVyaXZlS2V5TWFwLnNldChrZXlJZCwgZGVyaXZlS2V5KTsKICAgIHJlbW90ZURlcml2ZUtleU1hcC5zZXQoY29ubmVjdGlvbklkLCBkZXJpdmVLZXlNYXApOwp9CmZ1bmN0aW9uIHNldExhdGVzdFJlbW90ZUtleUlkKGNvbm5lY3Rpb25JZCwga2V5SWQpIHsKICAgIGNvbnN0IGxhdGVzdFJlbW90ZUtleUlkID0gbGF0ZXN0UmVtb3RlS2V5SWRNYXAuZ2V0KGNvbm5lY3Rpb25JZCk7CiAgICBpZiAobGF0ZXN0UmVtb3RlS2V5SWQpIHsKICAgICAgICBpZiAobGF0ZXN0UmVtb3RlS2V5SWQgPCBrZXlJZCkgewogICAgICAgICAgICBsYXRlc3RSZW1vdGVLZXlJZE1hcC5zZXQoY29ubmVjdGlvbklkLCBrZXlJZCk7CiAgICAgICAgfQogICAgfQogICAgZWxzZSB7CiAgICAgICAgbGF0ZXN0UmVtb3RlS2V5SWRNYXAuc2V0KGNvbm5lY3Rpb25JZCwga2V5SWQpOwogICAgfQp9CmZ1bmN0aW9uIHJlbW92ZU9sZFJlbW90ZURlcml2ZUtleXMoKSB7CiAgICBsYXRlc3RSZW1vdGVLZXlJZE1hcC5mb3JFYWNoKChsYXRlc3RLZXlJZCwgY29ubmVjdGlvbklkKSA9PiB7CiAgICAgICAgY29uc3QgZGVyaXZlS2V5TWFwID0gcmVtb3RlRGVyaXZlS2V5TWFwLmdldChjb25uZWN0aW9uSWQpOwogICAgICAgIGlmIChkZXJpdmVLZXlNYXApIHsKICAgICAgICAgICAgZGVyaXZlS2V5TWFwLmZvckVhY2goKF8sIGtleUlkKSA9PiB7CiAgICAgICAgICAgICAgICBpZiAobGF0ZXN0S2V5SWQgIT09IGtleUlkKSB7CiAgICAgICAgICAgICAgICAgICAgZGVyaXZlS2V5TWFwLmRlbGV0ZShrZXlJZCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgIH0pOwp9CmZ1bmN0aW9uIHJlbW92ZURlcml2ZUtleShjb25uZWN0aW9uSWQpIHsKICAgIGxhdGVzdFJlbW90ZUtleUlkTWFwLmRlbGV0ZShjb25uZWN0aW9uSWQpOwogICAgcmVtb3RlRGVyaXZlS2V5TWFwLmRlbGV0ZShjb25uZWN0aW9uSWQpOwp9CmZ1bmN0aW9uIGdldExhdGVzdFNlbGZEZXJpdmVLZXkoKSB7CiAgICBjb25zdCBkZXJpdmVLZXkgPSBzZWxmRGVyaXZlS2V5TWFwLmdldCgibGF0ZXN0Iik7CiAgICBpZiAoIWRlcml2ZUtleSkgewogICAgICAgIHRocm93IG5ldyBFcnJvcigiTEFURVNULVNFTEYtREVSSVZFS0VZLU5PVF9GT1VORCIpOwogICAgfQogICAgcmV0dXJuIGRlcml2ZUtleTsKfQpmdW5jdGlvbiBzZXRTZWxmRGVyaXZlS2V5KGNvbm5lY3Rpb25JZCwga2V5SWQsIGRlcml2ZUtleSkgewogICAgY29uc3QgY3VycmVudFNlbGZEZXJpdmVLZXkgPSBzZWxmRGVyaXZlS2V5TWFwLmdldCgibGF0ZXN0Iik7CiAgICBpZiAoY3VycmVudFNlbGZEZXJpdmVLZXkpIHsKICAgICAgICBpZiAoY3VycmVudFNlbGZEZXJpdmVLZXlbImtleUlkIl0gPCBrZXlJZCkgewogICAgICAgICAgICBjb25zdCBuZXh0U2VsZkRlcml2ZUtleSA9IHsgY29ubmVjdGlvbklkLCBrZXlJZCwgZGVyaXZlS2V5IH07CiAgICAgICAgICAgIHNlbGZEZXJpdmVLZXlNYXAuc2V0KCJsYXRlc3QiLCBuZXh0U2VsZkRlcml2ZUtleSk7CiAgICAgICAgfQogICAgfQogICAgZWxzZSB7CiAgICAgICAgY29uc3QgbmV4dFNlbGZEZXJpdmVLZXkgPSB7IGNvbm5lY3Rpb25JZCwga2V5SWQsIGRlcml2ZUtleSB9OwogICAgICAgIHNlbGZEZXJpdmVLZXlNYXAuc2V0KCJsYXRlc3QiLCBuZXh0U2VsZkRlcml2ZUtleSk7CiAgICB9Cn0KZnVuY3Rpb24gc2lsZW5jZUZyYW1lKGVuY29kZWRGcmFtZSkgewogICAgLy8gY29ubmVjdGlvbi5jcmVhdGVkLCByZWNlaXZlTWVzc2FnZSDlj5fkv6HliY3jga7loLTlkIgKICAgIGlmIChlbmNvZGVkRnJhbWUudHlwZSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgLy8g6Z+z5aOw44Gv5pqX5Y+35YyW44Gv44GE44KL44Go6IGe44GR44Gf44KC44Gu44GY44KD44Gq44GE44Gu44Gn572u44GN5o+b44GI44KLCiAgICAgICAgY29uc3QgbmV3RGF0YSA9IG5ldyBBcnJheUJ1ZmZlcigzKTsKICAgICAgICBjb25zdCBuZXdVaW50OCA9IG5ldyBVaW50OEFycmF5KG5ld0RhdGEpOwogICAgICAgIC8vIE9wdXMg44K144Kk44Os44Oz44K544OV44Os44O844OgCiAgICAgICAgbmV3VWludDguc2V0KFsweGQ4LCAweGZmLCAweGZlXSk7CiAgICAgICAgZW5jb2RlZEZyYW1lLmRhdGEgPSBuZXdEYXRhOwogICAgfQogICAgZWxzZSB7CiAgICAgICAgLy8g5pig5YOP44GM5q2j5bi444GY44KD44Gq44GE44Gf44KBIFBMSSDjgrnjg4jjg7zjg6DjgYznmbrnlJ/jgZfjgabjgZfjgb7jgYYKICAgICAgICAvLyDjgZ3jga7jgZ/jgoEgMzIweDI0MCDjga7nnJ/jgaPpu5LjgarnlLvpnaLjgavnva7jgY3mj5vjgYjjgosKICAgICAgICBjb25zdCBuZXdEYXRhID0gbmV3IEFycmF5QnVmZmVyKDYwKTsKICAgICAgICBjb25zdCBuZXdVaW50OCA9IG5ldyBVaW50OEFycmF5KG5ld0RhdGEpOwogICAgICAgIC8vIHByZXR0aWVyLWlnbm9yZQogICAgICAgIG5ld1VpbnQ4LnNldChbMHhiMCwgMHgwNSwgMHgwMCwgMHg5ZCwgMHgwMSwgMHgyYSwgMHhhMCwgMHgwMCwgMHg1YSwgMHgwMCwKICAgICAgICAgICAgMHgzOSwgMHgwMywgMHgwMCwgMHgwMCwgMHgxYywgMHgyMiwgMHgxNiwgMHgxNiwgMHgyMiwgMHg2NiwKICAgICAgICAgICAgMHgxMiwgMHgyMCwgMHgwNCwgMHg5MCwgMHg0MCwgMHgwMCwgMHhjNSwgMHgwMSwgMHhlMCwgMHg3YywKICAgICAgICAgICAgMHg0ZCwgMHgyZiwgMHhmYSwgMHhkZCwgMHg0ZCwgMHhhNSwgMHg3ZiwgMHg4OSwgMHhhNSwgMHhmZiwKICAgICAgICAgICAgMHg1YiwgMHhhOSwgMHhiNCwgMHhhZiwgMHhmMSwgMHgzNCwgMHhiZiwgMHhlYiwgMHg3NSwgMHgzNiwKICAgICAgICAgICAgMHg5NSwgMHhmZSwgMHgyNiwgMHg5NiwgMHg2MCwgMHhmZSwgMHhmZiwgMHhiYSwgMHhmZiwgMHg0MCwKICAgICAgICBdKTsKICAgICAgICBlbmNvZGVkRnJhbWUuZGF0YSA9IG5ld0RhdGE7CiAgICB9CiAgICByZXR1cm4gZW5jb2RlZEZyYW1lOwp9CmZ1bmN0aW9uIHNldFdyaXRlSVYoY29ubmVjdGlvbklkLCBrZXlJZCwgd3JpdGVJVikgewogICAgY29uc3Qga2V5ID0gW2Nvbm5lY3Rpb25JZCwga2V5SWQudG9TdHJpbmcoKV0uam9pbigiOiIpOwogICAgd3JpdGVJVk1hcC5zZXQoa2V5LCB3cml0ZUlWKTsKfQpmdW5jdGlvbiBnZXRXcml0ZUlWKGNvbm5lY3Rpb25JZCwga2V5SWQpIHsKICAgIGNvbnN0IGtleSA9IFtjb25uZWN0aW9uSWQsIGtleUlkLnRvU3RyaW5nKCldLmpvaW4oIjoiKTsKICAgIHJldHVybiB3cml0ZUlWTWFwLmdldChrZXkpOwp9CmZ1bmN0aW9uIGdlbmVyYXRlSVYoY291bnQsIGNvbm5lY3Rpb25JZCwga2V5SWQpIHsKICAgIC8vIFRPRE86IGtleUlkIOOBjCBOdW1iZXIuTUFYX1NBRkVfSU5URUdFUiwgNyBieXRlIOOCkui2heOBiOOBpuOBhOOBn+WgtOWQiOOBr+OCqOODqeODvOOBi+S+i+WklgogICAgLy8gVE9ETzogY291bnQg44GMIE51bWJlci5NQVhfU0FGRV9JTlRFR0VSLCA3IGJ5dGUg44KS6LaF44GI44Gm44GE44Gf5aC05ZCI44Gv44Ko44Op44O844GL5L6L5aSWCiAgICAvLyAzMiBiaXQg44G+44GnCiAgICBpZiAobWF4S2V5SWQgPCBrZXlJZCB8fCBtYXhDb3VudCA8IGNvdW50KSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJFWENFRURFRC1NQVhJTVVNLUJST0FEQ0FTVElORy1USU1FIik7CiAgICB9CiAgICBjb25zdCB3cml0ZUlWID0gZ2V0V3JpdGVJVihjb25uZWN0aW9uSWQsIGtleUlkKTsKICAgIGlmICghd3JpdGVJVikgewogICAgICAgIHRocm93IG5ldyBFcnJvcigiV1JJVEVJVi1OT1QtRk9VTkQiKTsKICAgIH0KICAgIGNvbnN0IHBhZGRpbmdMZW5ndGggPSBObiAtIFVpbnQzMkFycmF5LkJZVEVTX1BFUl9FTEVNRU5UOwogICAgY29uc3QgY291bnRXaXRoUGFkZGluZ0J1ZmZlciA9IG5ldyBBcnJheUJ1ZmZlcihObik7CiAgICBjb25zdCBjb3VudFdpdGhQYWRkaW5nRGF0YVZpZXcgPSBuZXcgRGF0YVZpZXcoY291bnRXaXRoUGFkZGluZ0J1ZmZlcik7CiAgICBjb3VudFdpdGhQYWRkaW5nRGF0YVZpZXcuc2V0VWludDMyKHBhZGRpbmdMZW5ndGgsIGNvdW50LCBiaWdFbmRpYW4pOwogICAgY29uc3QgaXYgPSBuZXcgVWludDhBcnJheShObik7CiAgICBjb25zdCBjb3VudFdpdGhQYWRkaW5nID0gbmV3IFVpbnQ4QXJyYXkoY291bnRXaXRoUGFkZGluZ0J1ZmZlcik7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IE5uOyBpKyspIHsKICAgICAgICBpdltpXSA9IHdyaXRlSVZbaV0gXiBjb3VudFdpdGhQYWRkaW5nW2ldOwogICAgfQogICAgcmV0dXJuIGl2Owp9CmZ1bmN0aW9uIHBhcnNlUGF5bG9hZChwYXlsb2FkVHlwZSwgcGF5bG9hZCkgewogICAgcmV0dXJuIFsKICAgICAgICBuZXcgVWludDhBcnJheShwYXlsb2FkLCAwLCB1bmVuY3J5cHRlZEJ5dGVzW3BheWxvYWRUeXBlXSksCiAgICAgICAgbmV3IFVpbnQ4QXJyYXkocGF5bG9hZCwgdW5lbmNyeXB0ZWRCeXRlc1twYXlsb2FkVHlwZV0pLAogICAgXTsKfQpmdW5jdGlvbiBlbmNvZGVGcmFtZUFkZChoZWFkZXIsIHNmcmFtZUhlYWRlciwgY29ubmVjdGlvbklkKSB7CiAgICBjb25zdCBjb25uZWN0aW9uSWREYXRhID0gdGV4dEVuY29kZXIuZW5jb2RlKGNvbm5lY3Rpb25JZCk7CiAgICBjb25zdCBmcmFtZUFkZCA9IG5ldyBVaW50OEFycmF5KGhlYWRlci5ieXRlTGVuZ3RoICsgc2ZyYW1lSGVhZGVyLmJ5dGVMZW5ndGggKyBjb25uZWN0aW9uSWREYXRhLmJ5dGVMZW5ndGgpOwogICAgZnJhbWVBZGQuc2V0KGhlYWRlciwgMCk7CiAgICBmcmFtZUFkZC5zZXQoc2ZyYW1lSGVhZGVyLCBoZWFkZXIuYnl0ZUxlbmd0aCk7CiAgICBmcmFtZUFkZC5zZXQoY29ubmVjdGlvbklkRGF0YSwgaGVhZGVyLmJ5dGVMZW5ndGggKyBzZnJhbWVIZWFkZXIuYnl0ZUxlbmd0aCk7CiAgICByZXR1cm4gZnJhbWVBZGQ7Cn0KYXN5bmMgZnVuY3Rpb24gZW5jcnlwdEZ1bmN0aW9uKGVuY29kZWRGcmFtZSwgY29udHJvbGxlcikgewogICAgY29uc3QgeyBjb25uZWN0aW9uSWQsIGtleUlkLCBkZXJpdmVLZXkgfSA9IGdldExhdGVzdFNlbGZEZXJpdmVLZXkoKTsKICAgIGlmICghZGVyaXZlS2V5KSB7CiAgICAgICAgcmV0dXJuOwogICAgfQogICAgY29uc3QgY3VycmVudENvdW50ID0gZ2V0Q291bnQoY29ubmVjdGlvbklkKTsKICAgIC8vIGNvdW50IOOBjCAzMiBiaXQg5Lul5LiK44Gu5aC05ZCI44Gv5YGc5q2i44GZ44KLCiAgICBpZiAoY3VycmVudENvdW50ID4gbWF4Q291bnQpIHsKICAgICAgICBwb3N0TWVzc2FnZSh7IHR5cGU6ICJkaXNjb25uZWN0IiB9KTsKICAgIH0KICAgIGNvbnN0IGl2ID0gZ2VuZXJhdGVJVihjdXJyZW50Q291bnQsIGNvbm5lY3Rpb25JZCwga2V5SWQpOwogICAgaWYgKCFpdikgewogICAgICAgIHJldHVybjsKICAgIH0KICAgIGNvbnN0IFtoZWFkZXIsIHBheWxvYWRdID0gcGFyc2VQYXlsb2FkKGVuY29kZWRGcmFtZS50eXBlLCBlbmNvZGVkRnJhbWUuZGF0YSk7CiAgICBjb25zdCBzZnJhbWVIZWFkZXIgPSBlbmNvZGVTRnJhbWVIZWFkZXIoMCwgY3VycmVudENvdW50LCBrZXlJZCk7CiAgICBjb25zdCBmcmFtZUFkZCA9IGVuY29kZUZyYW1lQWRkKGhlYWRlciwgc2ZyYW1lSGVhZGVyLCBjb25uZWN0aW9uSWQpOwogICAgY3J5cHRvLnN1YnRsZQogICAgICAgIC5lbmNyeXB0KHsKICAgICAgICBuYW1lOiAiQUVTLUdDTSIsCiAgICAgICAgaXY6IGl2LAogICAgICAgIC8vIOaal+WPt+WMluOBleOCjOOBpuOBhOOBquOBhOmDqOWIhgogICAgICAgIGFkZGl0aW9uYWxEYXRhOiBmcmFtZUFkZCwKICAgIH0sIGRlcml2ZUtleSwgcGF5bG9hZCkKICAgICAgICAudGhlbigoY2lwaGVyVGV4dCkgPT4gewogICAgICAgIGNvbnN0IG5ld0RhdGEgPSBuZXcgQXJyYXlCdWZmZXIoZnJhbWVBZGQuYnl0ZUxlbmd0aCArIGNpcGhlclRleHQuYnl0ZUxlbmd0aCk7CiAgICAgICAgY29uc3QgbmV3RGF0YVVpbnQ4ID0gbmV3IFVpbnQ4QXJyYXkobmV3RGF0YSk7CiAgICAgICAgbmV3RGF0YVVpbnQ4LnNldChmcmFtZUFkZCwgMCk7CiAgICAgICAgbmV3RGF0YVVpbnQ4LnNldChuZXcgVWludDhBcnJheShjaXBoZXJUZXh0KSwgZnJhbWVBZGQuYnl0ZUxlbmd0aCk7CiAgICAgICAgZW5jb2RlZEZyYW1lLmRhdGEgPSBuZXdEYXRhOwogICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZShlbmNvZGVkRnJhbWUpOwogICAgfSk7CiAgICBzZXRDb3VudChjb25uZWN0aW9uSWQsIGN1cnJlbnRDb3VudCArIDEpOwp9CmFzeW5jIGZ1bmN0aW9uIGRlY3J5cHRGdW5jdGlvbihlbmNvZGVkRnJhbWUsIGNvbnRyb2xsZXIpIHsKICAgIC8vIOepuuODleODrOODvOODoOWvvuW/nAogICAgaWYgKGVuY29kZWRGcmFtZS5kYXRhLmJ5dGVMZW5ndGggPCAxKSB7CiAgICAgICAgcmV0dXJuOwogICAgfQogICAgdHJ5IHsKICAgICAgICBjb25zdCBmcmFtZU1ldGFkYXRhQnVmZmVyID0gZW5jb2RlZEZyYW1lLmRhdGEuc2xpY2UoMCwgdW5lbmNyeXB0ZWRCeXRlc1tlbmNvZGVkRnJhbWUudHlwZV0pOwogICAgICAgIGNvbnN0IGZyYW1lTWV0YWRhdGEgPSBuZXcgVWludDhBcnJheShmcmFtZU1ldGFkYXRhQnVmZmVyKTsKICAgICAgICBjb25zdCBbc2ZyYW1lSGVhZGVyQnVmZmVyLCBjb25uZWN0aW9uSWRCdWZmZXIsIGVuY3J5cHRlZEZyYW1lQnVmZmVyXSA9IHNwbGl0SGVhZGVyKGVuY29kZWRGcmFtZS5kYXRhLnNsaWNlKHVuZW5jcnlwdGVkQnl0ZXNbZW5jb2RlZEZyYW1lLnR5cGVdKSk7CiAgICAgICAgY29uc3Qgc2ZyYW1lSGVhZGVyID0gbmV3IFVpbnQ4QXJyYXkoc2ZyYW1lSGVhZGVyQnVmZmVyKTsKICAgICAgICBjb25zdCBjb25uZWN0aW9uSWQgPSB0ZXh0RGVjb2Rlci5kZWNvZGUoY29ubmVjdGlvbklkQnVmZmVyKTsKICAgICAgICBjb25zdCBbcywgY291bnQsIGtleUlkXSA9IHBhcnNlU0ZyYW1lSGVhZGVyKHNmcmFtZUhlYWRlckJ1ZmZlcik7CiAgICAgICAgLy8g5LuK5Zue44GvIHMgZmxhZyDjga8gMCDjga7jgb8KICAgICAgICBpZiAocyAhPT0gMCkgewogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIlVORVhQRUNURUQtUy1GTEFHIik7CiAgICAgICAgfQogICAgICAgIGNvbnN0IGRlcml2ZUtleSA9IGdldFJlbW90ZURlcml2ZUtleShjb25uZWN0aW9uSWQsIGtleUlkKTsKICAgICAgICBpZiAoIWRlcml2ZUtleSkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGNvbnN0IGl2ID0gZ2VuZXJhdGVJVihjb3VudCwgY29ubmVjdGlvbklkLCBrZXlJZCk7CiAgICAgICAgaWYgKCFpdikgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGNvbnN0IGZyYW1lQWRkID0gZW5jb2RlRnJhbWVBZGQoZnJhbWVNZXRhZGF0YSwgc2ZyYW1lSGVhZGVyLCBjb25uZWN0aW9uSWQpOwogICAgICAgIGNyeXB0by5zdWJ0bGUKICAgICAgICAgICAgLmRlY3J5cHQoewogICAgICAgICAgICBuYW1lOiAiQUVTLUdDTSIsCiAgICAgICAgICAgIGl2OiBpdiwKICAgICAgICAgICAgYWRkaXRpb25hbERhdGE6IGZyYW1lQWRkLAogICAgICAgIH0sIGRlcml2ZUtleSwgbmV3IFVpbnQ4QXJyYXkoZW5jcnlwdGVkRnJhbWVCdWZmZXIpKQogICAgICAgICAgICAudGhlbigocGxhaW5UZXh0KSA9PiB7CiAgICAgICAgICAgIGNvbnN0IG5ld0RhdGEgPSBuZXcgQXJyYXlCdWZmZXIoZnJhbWVNZXRhZGF0YUJ1ZmZlci5ieXRlTGVuZ3RoICsgcGxhaW5UZXh0LmJ5dGVMZW5ndGgpOwogICAgICAgICAgICBjb25zdCBuZXdVaW50OCA9IG5ldyBVaW50OEFycmF5KG5ld0RhdGEpOwogICAgICAgICAgICBuZXdVaW50OC5zZXQobmV3IFVpbnQ4QXJyYXkoZnJhbWVNZXRhZGF0YUJ1ZmZlciwgMCwgdW5lbmNyeXB0ZWRCeXRlc1tlbmNvZGVkRnJhbWUudHlwZV0pKTsKICAgICAgICAgICAgbmV3VWludDguc2V0KG5ldyBVaW50OEFycmF5KHBsYWluVGV4dCksIHVuZW5jcnlwdGVkQnl0ZXNbZW5jb2RlZEZyYW1lLnR5cGVdKTsKICAgICAgICAgICAgZW5jb2RlZEZyYW1lLmRhdGEgPSBuZXdEYXRhOwogICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoZW5jb2RlZEZyYW1lKTsKICAgICAgICB9KTsKICAgIH0KICAgIGNhdGNoIChlKSB7CiAgICAgICAgLy8g5oOz5a6a5aSW44Gu44OR44Kx44OD44OI44OV44Kp44O844Oe44OD44OI44KS5Y+X5L+h44GX44Gf5aC05ZCICiAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHNpbGVuY2VGcmFtZShlbmNvZGVkRnJhbWUpKTsKICAgIH0KfQovKiBlc2xpbnQtZGlzYWJsZSBAdHlwZXNjcmlwdC1lc2xpbnQvdHJpcGxlLXNsYXNoLXJlZmVyZW5jZSAqLwovLy8gPHJlZmVyZW5jZSBwYXRoPSIuL2UyZWUudHMiLz4KLy8gbm9uY2Ug44K144Kk44K6CmNvbnN0IE5uID0gMTI7Ci8vIGtleSDjgrXjgqTjgroKY29uc3QgTmsgPSAxNjsKLy8ga2V5IOOCteOCpOOCuu+8iGJpdO+8iQpjb25zdCBrZXlMZW5ndGggPSBOayAqIDg7CmFzeW5jIGZ1bmN0aW9uIGdlbmVyYXRlRGVyaXZlS2V5KG1hdGVyaWFsKSB7CiAgICBjb25zdCBzYWx0ID0gdGV4dEVuY29kZXIuZW5jb2RlKCJTRnJhbWUxMCIpOwogICAgY29uc3QgaW5mbyA9IHRleHRFbmNvZGVyLmVuY29kZSgia2V5Iik7CiAgICBjb25zdCBkZXJpdmVLZXkgPSBhd2FpdCBjcnlwdG8uc3VidGxlLmRlcml2ZUtleSh7CiAgICAgICAgbmFtZTogIkhLREYiLAogICAgICAgIHNhbHQ6IHNhbHQsCiAgICAgICAgaGFzaDogIlNIQS0yNTYiLAogICAgICAgIGluZm86IGluZm8sCiAgICB9LCBtYXRlcmlhbCwgewogICAgICAgIG5hbWU6ICJBRVMtR0NNIiwKICAgICAgICBsZW5ndGg6IGtleUxlbmd0aCwKICAgIH0sIGZhbHNlLCBbImVuY3J5cHQiLCAiZGVjcnlwdCJdKTsKICAgIHJldHVybiBkZXJpdmVLZXk7Cn0KYXN5bmMgZnVuY3Rpb24gZ2VuZXJhdGVXcml0ZUlWKG1hdGVyaWFsKSB7CiAgICBjb25zdCBzYWx0ID0gdGV4dEVuY29kZXIuZW5jb2RlKCJTRnJhbWUxMCIpOwogICAgY29uc3QgaW5mbyA9IHRleHRFbmNvZGVyLmVuY29kZSgic2FsdCIpOwogICAgY29uc3Qgd3JpdGVJVkJ1ZmZlciA9IGF3YWl0IGNyeXB0by5zdWJ0bGUuZGVyaXZlQml0cyh7CiAgICAgICAgbmFtZTogIkhLREYiLAogICAgICAgIHNhbHQ6IHNhbHQsCiAgICAgICAgaGFzaDogIlNIQS0zODQiLAogICAgICAgIGluZm86IGluZm8sCiAgICB9LCBtYXRlcmlhbCwgCiAgICAvLyBJViDjga8gOTYg44OT44OD44OI44Gq44Gu44GnCiAgICBObiAqIDgpOwogICAgY29uc3Qgd3JpdGVJViA9IG5ldyBVaW50OEFycmF5KHdyaXRlSVZCdWZmZXIpOwogICAgcmV0dXJuIHdyaXRlSVY7Cn0KbGV0IHJlbW92YWxUaW1lb3V0SWQgPSAwOwpvbm1lc3NhZ2UgPSAoZXZlbnQpID0+IHsKICAgIGNvbnN0IHsgdHlwZSB9ID0gZXZlbnQuZGF0YTsKICAgIGlmICh0eXBlID09PSAic2VsZlNlY3JldEtleU1hdGVyaWFsIikgewogICAgICAgIGNvbnN0IHsgc2VsZlNlY3JldEtleU1hdGVyaWFsLCBzZWxmQ29ubmVjdGlvbklkLCBzZWxmS2V5SWQsIHdhaXRpbmdUaW1lIH0gPSBldmVudC5kYXRhOwogICAgICAgIGNvbnN0IHRpbWVvdXRJZCA9IHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICBjcnlwdG8uc3VidGxlCiAgICAgICAgICAgICAgICAuaW1wb3J0S2V5KCJyYXciLCBzZWxmU2VjcmV0S2V5TWF0ZXJpYWwuYnVmZmVyLCAiSEtERiIsIGZhbHNlLCBbImRlcml2ZUJpdHMiLCAiZGVyaXZlS2V5Il0pCiAgICAgICAgICAgICAgICAudGhlbigobWF0ZXJpYWwpID0+IHsKICAgICAgICAgICAgICAgIGdlbmVyYXRlRGVyaXZlS2V5KG1hdGVyaWFsKS50aGVuKChkZXJpdmVLZXkpID0+IHsKICAgICAgICAgICAgICAgICAgICBzZXRTZWxmRGVyaXZlS2V5KHNlbGZDb25uZWN0aW9uSWQsIHNlbGZLZXlJZCwgZGVyaXZlS2V5KTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgZ2VuZXJhdGVXcml0ZUlWKG1hdGVyaWFsKS50aGVuKCh3cml0ZUlWKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgc2V0V3JpdGVJVihzZWxmQ29ubmVjdGlvbklkLCBzZWxmS2V5SWQsIHdyaXRlSVYpOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dElkKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfSwgd2FpdGluZ1RpbWUgfHwgMCk7CiAgICAgICAgLy8gVE9ETzogKzEwMDAg44Gn6Y2155Sf5oiQ5b6M44Gr5a6f6KGM44GV44KM44KL44KI44GG44Gr44GX44Gm44GE44KL44GM55+t44GE5aC05ZCI44Gv5Ly444Gw44GZCiAgICAgICAgY29uc3QgcmVtb3ZhbFdhaXRpbmdUaW1lID0gKHdhaXRpbmdUaW1lIHx8IDApICsgMTAwMDsKICAgICAgICBpZiAocmVtb3ZhbFRpbWVvdXRJZCkgewogICAgICAgICAgICAvLyDli5XkvZzmuIjjgb/jgr/jgqTjg57jg7zmnInjgooKICAgICAgICAgICAgaWYgKHdhaXRpbmdUaW1lKSB7CiAgICAgICAgICAgICAgICAvLyBjb25uZWN0aW9uLmRlc3Ryb3llZAogICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHJlbW92YWxUaW1lb3V0SWQpOwogICAgICAgICAgICAgICAgcmVtb3ZhbFRpbWVvdXRJZCA9IHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgICAgICAgIHJlbW92ZU9sZFJlbW90ZURlcml2ZUtleXMoKTsKICAgICAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQocmVtb3ZhbFRpbWVvdXRJZCk7CiAgICAgICAgICAgICAgICAgICAgcmVtb3ZhbFRpbWVvdXRJZCA9IDA7CiAgICAgICAgICAgICAgICB9LCByZW1vdmFsV2FpdGluZ1RpbWUpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICAvLyDli5XkvZzmuIjjgb/jgr/jgqTjg57jg7zjgarjgZcKICAgICAgICAgICAgLy8gY29ubmVjdGlvbi5jcmVhdGVkIOOBruWgtOWQiOOCguWwkeOBl+Wun+ihjOOCkumBheOCieOBm+OCiwogICAgICAgICAgICByZW1vdmFsVGltZW91dElkID0gc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgICByZW1vdmVPbGRSZW1vdGVEZXJpdmVLZXlzKCk7CiAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQocmVtb3ZhbFRpbWVvdXRJZCk7CiAgICAgICAgICAgICAgICByZW1vdmFsVGltZW91dElkID0gMDsKICAgICAgICAgICAgfSwgcmVtb3ZhbFdhaXRpbmdUaW1lKTsKICAgICAgICB9CiAgICB9CiAgICBlbHNlIGlmICh0eXBlID09PSAicmVtb3RlU2VjcmV0S2V5TWF0ZXJpYWxzIikgewogICAgICAgIGNvbnN0IHsgcmVtb3RlU2VjcmV0S2V5TWF0ZXJpYWxzIH0gPSBldmVudC5kYXRhOwogICAgICAgIGZvciAoY29uc3QgW2Nvbm5lY3Rpb25JZCwgcmVtb3RlU2VjcmV0S2V5TWF0ZXJpYWxdIG9mIE9iamVjdC5lbnRyaWVzKHJlbW90ZVNlY3JldEtleU1hdGVyaWFscykpIHsKICAgICAgICAgICAgY29uc3QgeyBrZXlJZCwgc2VjcmV0S2V5TWF0ZXJpYWwgfSA9IHJlbW90ZVNlY3JldEtleU1hdGVyaWFsOwogICAgICAgICAgICBjcnlwdG8uc3VidGxlCiAgICAgICAgICAgICAgICAuaW1wb3J0S2V5KCJyYXciLCBzZWNyZXRLZXlNYXRlcmlhbC5idWZmZXIsICJIS0RGIiwgZmFsc2UsIFsiZGVyaXZlQml0cyIsICJkZXJpdmVLZXkiXSkKICAgICAgICAgICAgICAgIC50aGVuKChtYXRlcmlhbCkgPT4gewogICAgICAgICAgICAgICAgZ2VuZXJhdGVEZXJpdmVLZXkobWF0ZXJpYWwpLnRoZW4oKGRlcml2ZUtleSkgPT4gewogICAgICAgICAgICAgICAgICAgIHNldFJlbW90ZURlcml2ZUtleShjb25uZWN0aW9uSWQsIGtleUlkLCBkZXJpdmVLZXkpOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBnZW5lcmF0ZVdyaXRlSVYobWF0ZXJpYWwpLnRoZW4oKHdyaXRlSVYpID0+IHsKICAgICAgICAgICAgICAgICAgICBzZXRXcml0ZUlWKGNvbm5lY3Rpb25JZCwga2V5SWQsIHdyaXRlSVYpOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBzZXRMYXRlc3RSZW1vdGVLZXlJZChjb25uZWN0aW9uSWQsIGtleUlkKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfQogICAgfQogICAgZWxzZSBpZiAodHlwZSA9PT0gInJlbW92ZVJlbW90ZURlcml2ZUtleSIpIHsKICAgICAgICBjb25zdCB7IGNvbm5lY3Rpb25JZCB9ID0gZXZlbnQuZGF0YTsKICAgICAgICByZW1vdmVEZXJpdmVLZXkoY29ubmVjdGlvbklkKTsKICAgIH0KICAgIGVsc2UgaWYgKHR5cGUgPT09ICJlbmNyeXB0IikgewogICAgICAgIGNvbnN0IHsgcmVhZGFibGVTdHJlYW0sIHdyaXRhYmxlU3RyZWFtIH0gPSBldmVudC5kYXRhOwogICAgICAgIGNvbnN0IHRyYW5zZm9ybVN0cmVhbSA9IG5ldyBUcmFuc2Zvcm1TdHJlYW0oewogICAgICAgICAgICB0cmFuc2Zvcm06IGVuY3J5cHRGdW5jdGlvbiwKICAgICAgICB9KTsKICAgICAgICByZWFkYWJsZVN0cmVhbS5waXBlVGhyb3VnaCh0cmFuc2Zvcm1TdHJlYW0pLnBpcGVUbyh3cml0YWJsZVN0cmVhbSk7CiAgICB9CiAgICBlbHNlIGlmICh0eXBlID09PSAiZGVjcnlwdCIpIHsKICAgICAgICBjb25zdCB7IHJlYWRhYmxlU3RyZWFtLCB3cml0YWJsZVN0cmVhbSB9ID0gZXZlbnQuZGF0YTsKICAgICAgICBjb25zdCB0cmFuc2Zvcm1TdHJlYW0gPSBuZXcgVHJhbnNmb3JtU3RyZWFtKHsKICAgICAgICAgICAgdHJhbnNmb3JtOiBkZWNyeXB0RnVuY3Rpb24sCiAgICAgICAgfSk7CiAgICAgICAgcmVhZGFibGVTdHJlYW0ucGlwZVRocm91Z2godHJhbnNmb3JtU3RyZWFtKS5waXBlVG8od3JpdGFibGVTdHJlYW0pOwogICAgfQogICAgZWxzZSBpZiAodHlwZSA9PT0gImNsZWFyIikgewogICAgICAgIGNvdW50TWFwLmNsZWFyKCk7CiAgICAgICAgd3JpdGVJVk1hcC5jbGVhcigpOwogICAgICAgIHJlbW90ZURlcml2ZUtleU1hcC5jbGVhcigpOwogICAgICAgIGxhdGVzdFJlbW90ZUtleUlkTWFwLmNsZWFyKCk7CiAgICAgICAgc2VsZkRlcml2ZUtleU1hcC5jbGVhcigpOwogICAgfQp9Owo=");this.worker=new Worker(URL.createObjectURL(new Blob([e],{type:"application/javascript"}))),this.worker.onmessage=e=>{const{operation:t}=e.data;"disconnect"===t&&"function"===typeof this.onWorkerDisconnect&&this.onWorkerDisconnect()}}clearWorker(){this.worker&&this.worker.postMessage({type:"clear"})}terminateWorker(){this.worker&&this.worker.terminate()}async init(){const{preKeyBundle:e}=await window.e2ee.init();return e}setupSenderTransform(e){if(!e.track)return;const t=e.createEncodedStreams(),n=t.readableStream||t.readable,i=t.writableStream||t.writable;if(!this.worker)throw new Error("Worker is null. Call startWorker in advance.");const o={type:"encrypt",readableStream:n,writableStream:i};this.worker.postMessage(o,[n,i])}setupReceiverTransform(e){const t=e.createEncodedStreams(),n=t.readableStream||t.readable,i=t.writableStream||t.writable;if(!this.worker)throw new Error("Worker is null. Call startWorker in advance.");const o={type:"decrypt",readableStream:n,writableStream:i};this.worker.postMessage(o,[n,i])}postRemoteSecretKeyMaterials(e){if(!this.worker)throw new Error("Worker is null. Call startWorker in advance.");this.worker.postMessage({type:"remoteSecretKeyMaterials",remoteSecretKeyMaterials:e.remoteSecretKeyMaterials})}postRemoveRemoteDeriveKey(e){if(!this.worker)throw new Error("Worker is null. Call startWorker in advance.");this.worker.postMessage({type:"removeRemoteDeriveKey",connectionId:e})}postSelfSecretKeyMaterial(e,t,n,i=0){if(!this.worker)throw new Error("Worker is null. Call startWorker in advance.");this.worker.postMessage({type:"selfSecretKeyMaterial",selfConnectionId:e,selfKeyId:t,selfSecretKeyMaterial:n,waitingTime:i})}startSession(e,t){const[n,i]=window.e2ee.startSession(e,t.identityKey,t.signedPreKey,t.preKeySignature);if(i)throw i;return n}stopSession(e){const[t,n]=window.e2ee.stopSession(e);if(n)throw n;return t}receiveMessage(e){const[t,n]=window.e2ee.receiveMessage(e);if(n)throw n;return t}start(e){const[t,n]=window.e2ee.start(e);if(n)throw n;return t}addPreKeyBundle(e,t){const n=window.e2ee.addPreKeyBundle(e,t.identityKey,t.signedPreKey,t.preKeySignature);if(n)throw n}selfFingerprint(){return window.e2ee.selfFingerprint()}remoteFingerprints(){return window.e2ee.remoteFingerprints()}static async loadWasm(e){if(void 0===!window.e2ee)return void console.warn("E2ee wasm is already loaded. Will not be reload.");if((()=>{if("undefined"!==typeof global);else if("undefined"!==typeof window)window.global=window;else{if("undefined"===typeof self)throw new Error("cannot export Go (neither global, window nor self is defined)");self.global=self}if(global.require||"undefined"===typeof require||(global.require=require),!global.fs&&global.require){const e=require("fs");0!==Object.keys(e)&&(global.fs=e)}const e=()=>{const e=new Error("not implemented");return e.code="ENOSYS",e};if(!global.fs){let t="";global.fs={constants:{O_WRONLY:-1,O_RDWR:-1,O_CREAT:-1,O_TRUNC:-1,O_APPEND:-1,O_EXCL:-1},writeSync(e,i){t+=n.decode(i);const o=t.lastIndexOf("\n");return-1!=o&&(console.log(t.substr(0,o)),t=t.substr(o+1)),i.length},write(t,n,i,o,r,a){0===i&&o===n.length&&null===r?a(null,this.writeSync(t,n)):a(e())},chmod(t,n,i){i(e())},chown(t,n,i,o){o(e())},close(t,n){n(e())},fchmod(t,n,i){i(e())},fchown(t,n,i,o){o(e())},fstat(t,n){n(e())},fsync(e,t){t(null)},ftruncate(t,n,i){i(e())},lchown(t,n,i,o){o(e())},link(t,n,i){i(e())},lstat(t,n){n(e())},mkdir(t,n,i){i(e())},open(t,n,i,o){o(e())},read(t,n,i,o,r,a){a(e())},readdir(t,n){n(e())},readlink(t,n){n(e())},rename(t,n,i){i(e())},rmdir(t,n){n(e())},stat(t,n){n(e())},symlink(t,n,i){i(e())},truncate(t,n,i){i(e())},unlink(t,n){n(e())},utimes(t,n,i,o){o(e())}}}if(global.process||(global.process={getuid:()=>-1,getgid:()=>-1,geteuid:()=>-1,getegid:()=>-1,getgroups(){throw e()},pid:-1,ppid:-1,umask(){throw e()},cwd(){throw e()},chdir(){throw e()}}),!global.crypto){const e=require("crypto");global.crypto={getRandomValues(t){e.randomFillSync(t)}}}global.performance||(global.performance={now(){const[e,t]=i.hrtime();return 1e3*e+t/1e6}}),global.TextEncoder||(global.TextEncoder=require("util").TextEncoder),global.TextDecoder||(global.TextDecoder=require("util").TextDecoder);const t=new TextEncoder("utf-8"),n=new TextDecoder("utf-8");if(global.Go=class{constructor(){this.argv=["js"],this.env={},this.exit=e=>{0!==e&&console.warn("exit code:",e)},this._exitPromise=new Promise((e=>{this._resolveExitPromise=e})),this._pendingEvent=null,this._scheduledTimeouts=new Map,this._nextCallbackTimeoutID=1;const e=(e,t)=>{this.mem.setUint32(e+0,t,!0),this.mem.setUint32(e+4,Math.floor(t/4294967296),!0)},i=e=>this.mem.getUint32(e+0,!0)+4294967296*this.mem.getInt32(e+4,!0),o=e=>{const t=this.mem.getFloat64(e,!0);if(0===t)return;if(!isNaN(t))return t;const n=this.mem.getUint32(e,!0);return this._values[n]},r=(e,t)=>{const n=2146959360;if("number"===typeof t&&0!==t)return isNaN(t)?(this.mem.setUint32(e+4,n,!0),void this.mem.setUint32(e,0,!0)):void this.mem.setFloat64(e,t,!0);if(void 0===t)return void this.mem.setFloat64(e,0,!0);let i=this._ids.get(t);void 0===i&&(i=this._idPool.pop(),void 0===i&&(i=this._values.length),this._values[i]=t,this._goRefCounts[i]=0,this._ids.set(t,i)),this._goRefCounts[i]++;let o=0;switch(typeof t){case"object":null!==t&&(o=1);break;case"string":o=2;break;case"symbol":o=3;break;case"function":o=4}this.mem.setUint32(e+4,n|o,!0),this.mem.setUint32(e,i,!0)},a=e=>{const t=i(e+0),n=i(e+8);return new Uint8Array(this._inst.exports.mem.buffer,t,n)},s=e=>{const t=i(e+0),n=i(e+8),r=new Array(n);for(let i=0;i<n;i++)r[i]=o(t+8*i);return r},c=e=>{const t=i(e+0),o=i(e+8);return n.decode(new DataView(this._inst.exports.mem.buffer,t,o))},l=Date.now()-performance.now();this.importObject={go:{"runtime.wasmExit":e=>{const t=this.mem.getInt32(e+8,!0);this.exited=!0,delete this._inst,delete this._values,delete this._goRefCounts,delete this._ids,delete this._idPool,this.exit(t)},"runtime.wasmWrite":e=>{const t=i(e+8),n=i(e+16),o=this.mem.getInt32(e+24,!0);fs.writeSync(t,new Uint8Array(this._inst.exports.mem.buffer,n,o))},"runtime.resetMemoryDataView":e=>{this.mem=new DataView(this._inst.exports.mem.buffer)},"runtime.nanotime1":t=>{e(t+8,1e6*(l+performance.now()))},"runtime.walltime1":t=>{const n=(new Date).getTime();e(t+8,n/1e3),this.mem.setInt32(t+16,n%1e3*1e6,!0)},"runtime.scheduleTimeoutEvent":e=>{const t=this._nextCallbackTimeoutID;this._nextCallbackTimeoutID++,this._scheduledTimeouts.set(t,setTimeout((()=>{for(this._resume();this._scheduledTimeouts.has(t);)console.warn("scheduleTimeoutEvent: missed timeout event"),this._resume()}),i(e+8)+1)),this.mem.setInt32(e+16,t,!0)},"runtime.clearTimeoutEvent":e=>{const t=this.mem.getInt32(e+8,!0);clearTimeout(this._scheduledTimeouts.get(t)),this._scheduledTimeouts.delete(t)},"runtime.getRandomData":e=>{crypto.getRandomValues(a(e+8))},"syscall/js.finalizeRef":e=>{const t=this.mem.getUint32(e+8,!0);if(this._goRefCounts[t]--,0===this._goRefCounts[t]){const e=this._values[t];this._values[t]=null,this._ids.delete(e),this._idPool.push(t)}},"syscall/js.stringVal":e=>{r(e+24,c(e+8))},"syscall/js.valueGet":e=>{const t=Reflect.get(o(e+8),c(e+16));e=this._inst.exports.getsp(),r(e+32,t)},"syscall/js.valueSet":e=>{Reflect.set(o(e+8),c(e+16),o(e+32))},"syscall/js.valueDelete":e=>{Reflect.deleteProperty(o(e+8),c(e+16))},"syscall/js.valueIndex":e=>{r(e+24,Reflect.get(o(e+8),i(e+16)))},"syscall/js.valueSetIndex":e=>{Reflect.set(o(e+8),i(e+16),o(e+24))},"syscall/js.valueCall":e=>{try{const t=o(e+8),n=Reflect.get(t,c(e+16)),i=s(e+32),a=Reflect.apply(n,t,i);e=this._inst.exports.getsp(),r(e+56,a),this.mem.setUint8(e+64,1)}catch(Z){r(e+56,Z),this.mem.setUint8(e+64,0)}},"syscall/js.valueInvoke":e=>{try{const t=o(e+8),n=s(e+16),i=Reflect.apply(t,void 0,n);e=this._inst.exports.getsp(),r(e+40,i),this.mem.setUint8(e+48,1)}catch(Z){r(e+40,Z),this.mem.setUint8(e+48,0)}},"syscall/js.valueNew":e=>{try{const t=o(e+8),n=s(e+16),i=Reflect.construct(t,n);e=this._inst.exports.getsp(),r(e+40,i),this.mem.setUint8(e+48,1)}catch(Z){r(e+40,Z),this.mem.setUint8(e+48,0)}},"syscall/js.valueLength":t=>{e(t+16,parseInt(o(t+8).length))},"syscall/js.valuePrepareString":n=>{const i=t.encode(String(o(n+8)));r(n+16,i),e(n+24,i.length)},"syscall/js.valueLoadString":e=>{const t=o(e+8);a(e+16).set(t)},"syscall/js.valueInstanceOf":e=>{this.mem.setUint8(e+24,o(e+8)instanceof o(e+16)?1:0)},"syscall/js.copyBytesToGo":t=>{const n=a(t+8),i=o(t+32);if(!(i instanceof Uint8Array||i instanceof Uint8ClampedArray))return void this.mem.setUint8(t+48,0);const r=i.subarray(0,n.length);n.set(r),e(t+40,r.length),this.mem.setUint8(t+48,1)},"syscall/js.copyBytesToJS":t=>{const n=o(t+8),i=a(t+16);if(!(n instanceof Uint8Array||n instanceof Uint8ClampedArray))return void this.mem.setUint8(t+48,0);const r=i.subarray(0,n.length);n.set(r),e(t+40,r.length),this.mem.setUint8(t+48,1)},debug:e=>{console.log(e)}}}}async run(e){this._inst=e,this.mem=new DataView(this._inst.exports.mem.buffer),this._values=[NaN,0,null,!0,!1,global,this],this._goRefCounts=new Array(this._values.length).fill(1/0),this._ids=new Map([[0,1],[null,2],[!0,3],[!1,4],[global,5],[this,6]]),this._idPool=[],this.exited=!1;let n=4096;const i=e=>{const i=n,o=t.encode(e+"\0");return new Uint8Array(this.mem.buffer,n,o.length).set(o),n+=o.length,n%8!==0&&(n+=8-n%8),i},o=this.argv.length,r=[];this.argv.forEach((e=>{r.push(i(e))})),r.push(0),Object.keys(this.env).sort().forEach((e=>{r.push(i(`${e}=${this.env[e]}`))})),r.push(0);const a=n;r.forEach((e=>{this.mem.setUint32(n,e,!0),this.mem.setUint32(n+4,0,!0),n+=8})),this._inst.exports.run(o,a),this.exited&&this._resolveExitPromise(),await this._exitPromise}_resume(){if(this.exited)throw new Error("Go program has already exited");this._inst.exports.resume(),this.exited&&this._resolveExitPromise()}_makeFuncWrapper(e){const t=this;return function(){const n={id:e,this:this,args:arguments};return t._pendingEvent=n,t._resume(),n.result}}},global.require&&global.require.main===module&&global.process&&global.process.versions&&!global.process.versions.electron){i.argv.length<3&&(console.error("usage: go_js_wasm_exec [wasm binary] [arguments]"),i.exit(1));const e=new Go;e.argv=i.argv.slice(2),e.env=Object.assign({TMPDIR:require("os").tmpdir()},i.env),e.exit=i.exit,WebAssembly.instantiate(fs.readFileSync(i.argv[2]),e.importObject).then((t=>(i.on("exit",(t=>{0!==t||e.exited||(e._pendingEvent={id:0},e._resume())})),e.run(t.instance)))).catch((e=>{console.error(e),i.exit(1)}))}})(),!window.Go)throw new Error(`Failed to load module Go. window.Go is ${window.Go}.`);const t=new Go,{instance:n}=await WebAssembly.instantiateStreaming(fetch(e),t.importObject);if(t.run(n),!window.e2ee)throw new Error(`Failed to load module e2ee. window.e2ee is ${window.e2ee}.`)}static version(){return"2021.1.0"}static wasmVersion(){return window.e2ee.version()}}var r=Uint8Array,a=Uint16Array,s=Uint32Array,c=new r([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),l=new r([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),u=new r([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),d=function(e,t){for(var n=new a(31),i=0;i<31;++i)n[i]=t+=1<<e[i-1];var o=new s(n[30]);for(i=1;i<30;++i)for(var r=n[i];r<n[i+1];++r)o[r]=r-n[i]<<5|i;return[n,o]},g=d(c,2),f=g[0],p=g[1];f[28]=258,p[258]=28;for(var h=d(l,0),m=h[0],y=h[1],C=new a(32768),b=0;b<32768;++b){var v=(43690&b)>>>1|(21845&b)<<1;v=(61680&(v=(52428&v)>>>2|(13107&v)<<2))>>>4|(3855&v)<<4,C[b]=((65280&v)>>>8|(255&v)<<8)>>>1}var w=function(e,t,n){for(var i=e.length,o=0,r=new a(t);o<i;++o)e[o]&&++r[e[o]-1];var s,c=new a(t);for(o=0;o<t;++o)c[o]=c[o-1]+r[o-1]<<1;if(n){s=new a(1<<t);var l=15-t;for(o=0;o<i;++o)if(e[o])for(var u=o<<4|e[o],d=t-e[o],g=c[e[o]-1]++<<d,f=g|(1<<d)-1;g<=f;++g)s[C[g]>>>l]=u}else for(s=new a(i),o=0;o<i;++o)e[o]&&(s[o]=C[c[e[o]-1]++]>>>15-e[o]);return s},I=new r(288);for(b=0;b<144;++b)I[b]=8;for(b=144;b<256;++b)I[b]=9;for(b=256;b<280;++b)I[b]=7;for(b=280;b<288;++b)I[b]=8;var S=new r(32);for(b=0;b<32;++b)S[b]=5;var O=w(I,9,0),E=w(I,9,1),A=w(S,5,0),T=w(S,5,1),R=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},D=function(e,t,n){var i=t/8|0;return(e[i]|e[i+1]<<8)>>(7&t)&n},k=function(e,t){var n=t/8|0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>(7&t)},M=function(e){return(e+7)/8|0},P=function(e,t,n){(null==t||t<0)&&(t=0),(null==n||n>e.length)&&(n=e.length);var i=new(2==e.BYTES_PER_ELEMENT?a:4==e.BYTES_PER_ELEMENT?s:r)(n-t);return i.set(e.subarray(t,n)),i},_=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Z=function(e,t,n){var i=new Error(t||_[e]);if(i.code=e,Error.captureStackTrace&&Error.captureStackTrace(i,Z),!n)throw i;return i},F=function(e,t,n){n<<=7&t;var i=t/8|0;e[i]|=n,e[i+1]|=n>>>8},N=function(e,t,n){n<<=7&t;var i=t/8|0;e[i]|=n,e[i+1]|=n>>>8,e[i+2]|=n>>>16},V=function(e,t){for(var n=[],i=0;i<e.length;++i)e[i]&&n.push({s:i,f:e[i]});var o=n.length,s=n.slice();if(!o)return[B,0];if(1==o){var c=new r(n[0].s+1);return c[n[0].s]=1,[c,1]}n.sort((function(e,t){return e.f-t.f})),n.push({s:-1,f:25001});var l=n[0],u=n[1],d=0,g=1,f=2;for(n[0]={s:-1,f:l.f+u.f,l:l,r:u};g!=o-1;)l=n[n[d].f<n[f].f?d++:f++],u=n[d!=g&&n[d].f<n[f].f?d++:f++],n[g++]={s:-1,f:l.f+u.f,l:l,r:u};var p=s[0].s;for(i=1;i<o;++i)s[i].s>p&&(p=s[i].s);var h=new a(p+1),m=x(n[g-1],h,0);if(m>t){i=0;var y=0,C=m-t,b=1<<C;for(s.sort((function(e,t){return h[t.s]-h[e.s]||e.f-t.f}));i<o;++i){var v=s[i].s;if(!(h[v]>t))break;y+=b-(1<<m-h[v]),h[v]=t}for(y>>>=C;y>0;){var w=s[i].s;h[w]<t?y-=1<<t-h[w]++-1:++i}for(;i>=0&&y;--i){var I=s[i].s;h[I]==t&&(--h[I],++y)}m=t}return[new r(h),m]},x=function(e,t,n){return-1==e.s?Math.max(x(e.l,t,n+1),x(e.r,t,n+1)):t[e.s]=n},j=function(e){for(var t=e.length;t&&!e[--t];);for(var n=new a(++t),i=0,o=e[0],r=1,s=function(e){n[i++]=e},c=1;c<=t;++c)if(e[c]==o&&c!=t)++r;else{if(!o&&r>2){for(;r>138;r-=138)s(32754);r>2&&(s(r>10?r-11<<5|28690:r-3<<5|12305),r=0)}else if(r>3){for(s(o),--r;r>6;r-=6)s(8304);r>2&&(s(r-3<<5|8208),r=0)}for(;r--;)s(o);r=1,o=e[c]}return[n.subarray(0,i),t]},W=function(e,t){for(var n=0,i=0;i<t.length;++i)n+=e[i]*t[i];return n},U=function(e,t,n){var i=n.length,o=M(t+2);e[o]=255&i,e[o+1]=i>>>8,e[o+2]=255^e[o],e[o+3]=255^e[o+1];for(var r=0;r<i;++r)e[o+r+4]=n[r];return 8*(o+4+i)},G=function(e,t,n,i,o,r,s,d,g,f,p){F(t,p++,n),++o[256];for(var h=V(o,15),m=h[0],y=h[1],C=V(r,15),b=C[0],v=C[1],E=j(m),T=E[0],R=E[1],D=j(b),k=D[0],M=D[1],P=new a(19),_=0;_<T.length;++_)P[31&T[_]]++;for(_=0;_<k.length;++_)P[31&k[_]]++;for(var Z=V(P,7),x=Z[0],G=Z[1],X=19;X>4&&!x[u[X-1]];--X);var B,L,H,Y,Q=f+5<<3,J=W(o,I)+W(r,S)+s,K=W(o,m)+W(r,b)+s+14+3*X+W(P,x)+(2*P[16]+3*P[17]+7*P[18]);if(Q<=J&&Q<=K)return U(t,p,e.subarray(g,g+f));if(F(t,p,1+(K<J)),p+=2,K<J){B=w(m,y,0),L=m,H=w(b,v,0),Y=b;var z=w(x,G,0);F(t,p,R-257),F(t,p+5,M-1),F(t,p+10,X-4),p+=14;for(_=0;_<X;++_)F(t,p+3*_,x[u[_]]);p+=3*X;for(var $=[T,k],q=0;q<2;++q){var ee=$[q];for(_=0;_<ee.length;++_){var te=31&ee[_];F(t,p,z[te]),p+=x[te],te>15&&(F(t,p,ee[_]>>>5&127),p+=ee[_]>>>12)}}}else B=O,L=I,H=A,Y=S;for(_=0;_<d;++_)if(i[_]>255){te=i[_]>>>18&31;N(t,p,B[te+257]),p+=L[te+257],te>7&&(F(t,p,i[_]>>>23&31),p+=c[te]);var ne=31&i[_];N(t,p,H[ne]),p+=Y[ne],ne>3&&(N(t,p,i[_]>>>5&8191),p+=l[ne])}else N(t,p,B[i[_]]),p+=L[i[_]];return N(t,p,B[256]),p+L[256]},X=new s([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),B=new r(0),L=function(e,t,n,i,o){return function(e,t,n,i,o,u){var d=e.length,g=new r(i+d+5*(1+Math.ceil(d/7e3))+o),f=g.subarray(i,g.length-o),h=0;if(!t||d<8)for(var m=0;m<=d;m+=65535){var C=m+65535;C>=d&&(f[h>>3]=u),h=U(f,h+1,e.subarray(m,C))}else{for(var b=X[t-1],v=b>>>13,w=8191&b,I=(1<<n)-1,S=new a(32768),O=new a(I+1),E=Math.ceil(n/3),A=2*E,T=function(t){return(e[t]^e[t+1]<<E^e[t+2]<<A)&I},R=new s(25e3),D=new a(288),k=new a(32),_=0,Z=0,F=(m=0,0),N=0,V=0;m<d;++m){var x=T(m),j=32767&m,W=O[x];if(S[j]=W,O[x]=j,N<=m){var L=d-m;if((_>7e3||F>24576)&&L>423){h=G(e,f,0,R,D,k,Z,F,V,m-V,h),F=_=Z=0,V=m;for(var H=0;H<286;++H)D[H]=0;for(H=0;H<30;++H)k[H]=0}var Y=2,Q=0,J=w,K=j-W&32767;if(L>2&&x==T(m-K))for(var z=Math.min(v,L)-1,$=Math.min(32767,m),q=Math.min(258,L);K<=$&&--J&&j!=W;){if(e[m+Y]==e[m+Y-K]){for(var ee=0;ee<q&&e[m+ee]==e[m+ee-K];++ee);if(ee>Y){if(Y=ee,Q=K,ee>z)break;var te=Math.min(K,ee-2),ne=0;for(H=0;H<te;++H){var ie=m-K+H+32768&32767,oe=ie-S[ie]+32768&32767;oe>ne&&(ne=oe,W=ie)}}}K+=(j=W)-(W=S[j])+32768&32767}if(Q){R[F++]=268435456|p[Y]<<18|y[Q];var re=31&p[Y],ae=31&y[Q];Z+=c[re]+l[ae],++D[257+re],++k[ae],N=m+Y,++_}else R[F++]=e[m],++D[e[m]]}}h=G(e,f,u,R,D,k,Z,F,V,m-V,h),!u&&7&h&&(h=U(f,h+1,B))}return P(g,0,i+M(h)+o)}(e,null==t.level?6:t.level,null==t.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(e.length)))):12+t.mem,n,i,!o)};function H(e,t){t||(t={});var n=function(){var e=1,t=0;return{p:function(n){for(var i=e,o=t,r=0|n.length,a=0;a!=r;){for(var s=Math.min(a+2655,r);a<s;++a)o+=i+=n[a];i=(65535&i)+15*(i>>16),o=(65535&o)+15*(o>>16)}e=i,t=o},d:function(){return(255&(e%=65521))<<24|e>>>8<<16|(255&(t%=65521))<<8|t>>>8}}}();n.p(e);var i=L(e,t,2,4);return function(e,t){var n=t.level,i=0==n?0:n<6?1:9==n?3:2;e[0]=120,e[1]=i<<6|(i?32-2*i:1)}(i,t),function(e,t,n){for(;n;++t)e[t]=n,n>>>=8}(i,i.length-4,n.d()),i}function Y(e,t){return function(e,t,n){var i=e.length;if(!i||n&&n.f&&!n.l)return t||new r(0);var o=!t||n,a=!n||n.i;n||(n={}),t||(t=new r(3*i));var s=function(e){var n=t.length;if(e>n){var i=new r(Math.max(2*n,e));i.set(t),t=i}},d=n.f||0,g=n.p||0,p=n.b||0,h=n.l,y=n.d,C=n.m,b=n.n,v=8*i;do{if(!h){d=D(e,g,1);var I=D(e,g+1,3);if(g+=3,!I){var S=e[(G=M(g)+4)-4]|e[G-3]<<8,O=G+S;if(O>i){a&&Z(0);break}o&&s(p+S),t.set(e.subarray(G,O),p),n.b=p+=S,n.p=g=8*O,n.f=d;continue}if(1==I)h=E,y=T,C=9,b=5;else if(2==I){var A=D(e,g,31)+257,_=D(e,g+10,15)+4,F=A+D(e,g+5,31)+1;g+=14;for(var N=new r(F),V=new r(19),x=0;x<_;++x)V[u[x]]=D(e,g+3*x,7);g+=3*_;var j=R(V),W=(1<<j)-1,U=w(V,j,1);for(x=0;x<F;){var G,X=U[D(e,g,W)];if(g+=15&X,(G=X>>>4)<16)N[x++]=G;else{var B=0,L=0;for(16==G?(L=3+D(e,g,3),g+=2,B=N[x-1]):17==G?(L=3+D(e,g,7),g+=3):18==G&&(L=11+D(e,g,127),g+=7);L--;)N[x++]=B}}var H=N.subarray(0,A),Y=N.subarray(A);C=R(H),b=R(Y),h=w(H,C,1),y=w(Y,b,1)}else Z(1);if(g>v){a&&Z(0);break}}o&&s(p+131072);for(var Q=(1<<C)-1,J=(1<<b)-1,K=g;;K=g){var z=(B=h[k(e,g)&Q])>>>4;if((g+=15&B)>v){a&&Z(0);break}if(B||Z(2),z<256)t[p++]=z;else{if(256==z){K=g,h=null;break}var $=z-254;if(z>264){var q=c[x=z-257];$=D(e,g,(1<<q)-1)+f[x],g+=q}var ee=y[k(e,g)&J],te=ee>>>4;if(ee||Z(3),g+=15&ee,Y=m[te],te>3&&(q=l[te],Y+=k(e,g)&(1<<q)-1,g+=q),g>v){a&&Z(0);break}o&&s(p+131072);for(var ne=p+$;p<ne;p+=4)t[p]=t[p-Y],t[p+1]=t[p+1-Y],t[p+2]=t[p+2-Y],t[p+3]=t[p+3-Y];p=ne}}n.l=h,n.p=K,n.b=p,n.f=d,h&&(d=1,n.m=C,n.d=y,n.n=b)}while(!d);return p==t.length?t:P(t,0,p)}(((8!=(15&(n=e)[0])||n[0]>>>4>7||(n[0]<<8|n[1])%31)&&Z(6,"invalid zlib data"),32&n[1]&&Z(6,"invalid zlib data: preset dictionaries not supported"),e.subarray(2,-4)),t);var n}var Q="undefined"!=typeof TextDecoder&&new TextDecoder;try{Q.decode(B,{stream:!0}),1}catch(le){}function J(e){if("object"!==typeof e||null===e)throw new Error("Failed to parse options dataChannels. Options dataChannels element must be type 'object'");const t=e,n={};return"string"===typeof t.label&&(n.label=t.label),"string"===typeof t.direction&&(n.direction=t.direction),"boolean"===typeof t.ordered&&(n.ordered=t.ordered),"boolean"===typeof t.compress&&(n.compress=t.compress),"number"===typeof t.maxPacketLifeTime&&(n.max_packet_life_time=t.maxPacketLifeTime),"number"===typeof t.maxRetransmits&&(n.max_retransmits=t.maxRetransmits),"string"===typeof t.protocol&&(n.protocol=t.protocol),n}function K(){return"safari"===function(){const e=window.navigator.userAgent.toLocaleLowerCase();return-1!==e.indexOf("edge")?"edge":-1!==e.indexOf("chrome")&&-1===e.indexOf("edge")?"chrome":-1!==e.indexOf("safari")&&-1===e.indexOf("chrome")?"safari":-1!==e.indexOf("opera")?"opera":-1!==e.indexOf("firefox")?"firefox":null}()}function z(e,t,n,i,o,r){if("sendrecv"!==t&&"sendonly"!==t&&"recvonly"!==t)throw new Error("Unknown role type");if(null===n||void 0===n)throw new Error("channelId can not be null or undefined");const a={type:"connect",sora_client:"Sora JavaScript SDK 2021.2.3",environment:window.navigator.userAgent,role:t,channel_id:n,sdp:e,audio:!0,video:!0};if(void 0!==i&&(a.metadata=i),r&&(a.redirect=!0),"signalingNotifyMetadata"in o&&(a.signaling_notify_metadata=o.signalingNotifyMetadata),"multistream"in o&&!0===o.multistream&&(a.multistream=!0,"spotlight"in o&&(a.spotlight=o.spotlight,"spotlightNumber"in o&&(a.spotlight_number=o.spotlightNumber)),!0===a.spotlight)){const e=["none","r0","r1","r2"];void 0!==o.spotlightFocusRid&&0<=e.indexOf(o.spotlightFocusRid)&&(a.spotlight_focus_rid=o.spotlightFocusRid),void 0!==o.spotlightUnfocusRid&&0<=e.indexOf(o.spotlightUnfocusRid)&&(a.spotlight_unfocus_rid=o.spotlightUnfocusRid)}if("simulcast"in o||"simulcastRid"in o){"simulcast"in o&&!0===o.simulcast&&(a.simulcast=!0);const e=["r0","r1","r2"];void 0!==o.simulcastRid&&0<=e.indexOf(o.simulcastRid)&&(a.simulcast_rid=o.simulcastRid)}"clientId"in o&&void 0!==o.clientId&&(a.client_id=o.clientId),"dataChannelSignaling"in o&&"boolean"===typeof o.dataChannelSignaling&&(a.data_channel_signaling=o.dataChannelSignaling),"ignoreDisconnectWebSocket"in o&&"boolean"===typeof o.ignoreDisconnectWebSocket&&(a.ignore_disconnect_websocket=o.ignoreDisconnectWebSocket);const s=["audioCodecType","audioBitRate"],c=["audioOpusParamsChannels","audioOpusParamsClockRate","audioOpusParamsMaxplaybackrate","audioOpusParamsStereo","audioOpusParamsSpropStereo","audioOpusParamsMinptime","audioOpusParamsPtime","audioOpusParamsUseinbandfec","audioOpusParamsUsedtx"],l=["videoCodecType","videoBitRate"],u=Object.assign({},o);Object.keys(u).forEach((e=>{"audio"===e&&"boolean"===typeof u[e]||"video"===e&&"boolean"===typeof u[e]||0<=s.indexOf(e)&&null!==u[e]||0<=c.indexOf(e)&&null!==u[e]||0<=l.indexOf(e)&&null!==u[e]||delete u[e]})),void 0!==u.audio&&(a.audio=u.audio);const d=Object.keys(u).some((e=>0<=s.indexOf(e)));a.audio&&d&&(a.audio={},"audioCodecType"in u&&(a.audio.codec_type=u.audioCodecType),"audioBitRate"in u&&(a.audio.bit_rate=u.audioBitRate));const g=Object.keys(u).some((e=>0<=c.indexOf(e)));a.audio&&g&&("object"!=typeof a.audio&&(a.audio={}),a.audio.opus_params={},"audioOpusParamsChannels"in u&&(a.audio.opus_params.channels=u.audioOpusParamsChannels),"audioOpusParamsClockRate"in u&&(a.audio.opus_params.clock_rate=u.audioOpusParamsClockRate),"audioOpusParamsMaxplaybackrate"in u&&(a.audio.opus_params.maxplaybackrate=u.audioOpusParamsMaxplaybackrate),"audioOpusParamsStereo"in u&&(a.audio.opus_params.stereo=u.audioOpusParamsStereo),"audioOpusParamsSpropStereo"in u&&(a.audio.opus_params.sprop_stereo=u.audioOpusParamsSpropStereo),"audioOpusParamsMinptime"in u&&(a.audio.opus_params.minptime=u.audioOpusParamsMinptime),"audioOpusParamsPtime"in u&&(a.audio.opus_params.ptime=u.audioOpusParamsPtime),"audioOpusParamsUseinbandfec"in u&&(a.audio.opus_params.useinbandfec=u.audioOpusParamsUseinbandfec),"audioOpusParamsUsedtx"in u&&(a.audio.opus_params.usedtx=u.audioOpusParamsUsedtx)),void 0!==u.video&&(a.video=u.video);const f=Object.keys(u).some((e=>0<=l.indexOf(e)));if(a.video&&f&&(a.video={},"videoCodecType"in u&&(a.video.codec_type=u.videoCodecType),"videoBitRate"in u&&(a.video.bit_rate=u.videoBitRate)),a.simulcast&&!function(){if(!window.RTCRtpSender)return!1;if(!RTCRtpSender.getCapabilities)return!1;const e=RTCRtpSender.getCapabilities("video");if(!e)return!1;const t=e.headerExtensions.map((e=>e.uri));return["urn:ietf:params:rtp-hdrext:sdes:mid","urn:ietf:params:rtp-hdrext:sdes:rtp-stream-id","urn:ietf:params:rtp-hdrext:sdes:repaired-rtp-stream-id"].every((e=>t.includes(e)))}()&&"recvonly"!==t)throw new Error("Simulcast can not be used with this browser");if(!0===o.e2ee){if(void 0===a.signaling_notify_metadata&&(a.signaling_notify_metadata={}),null===a.signaling_notify_metadata||"object"!==typeof a.signaling_notify_metadata)throw new Error("E2EE failed. Options signalingNotifyMetadata must be type 'object'");!0===a.video&&(a.video={}),a.video&&(a.video.codec_type="VP8"),a.e2ee=!0}return Array.isArray(o.dataChannels)&&0<o.dataChannels.length&&(a.data_channels=function(e){const t=[];for(const n of e)t.push(J(n));return t}(o.dataChannels)),a}function $(e){return void 0!==e.authn_metadata?e.authn_metadata:void 0!==e.metadata?e.metadata:null}function q(e){return"object"===typeof e&&null!==e&&"pre_key_bundle"in e?e.pre_key_bundle:null}class ee extends Error{}function te(e,t,n){const i=new Event(e);try{i.data=JSON.parse(JSON.stringify(t))}catch(o){i.data=t}return i.transportType=n,i}function ne(e,t,n,i,o){const r=new Event(e);try{r.data=JSON.parse(JSON.stringify(t))}catch(a){r.data=t}return r.logType=n,r.dataChannelId=i,r.dataChannelLabel=o,r}function ie(e){const t=new Event("datachannel");return t.datachannel=e,t}class oe{constructor(e,t,n,i,o,r){this.role=t,this.channelId=n,this.metadata=i,this.signalingUrlCandidates=e,this.options=o,this.connectionTimeout=6e4,"number"===typeof this.options.timeout&&(console.warn("@deprecated timeout option will be removed in a future version. Use connectionTimeout."),this.connectionTimeout=this.options.timeout),"number"===typeof this.options.connectionTimeout&&(this.connectionTimeout=this.options.connectionTimeout),this.disconnectWaitTimeout=3e3,"number"===typeof this.options.disconnectWaitTimeout&&(this.disconnectWaitTimeout=this.options.disconnectWaitTimeout),this.signalingCandidateTimeout=3e3,"number"===typeof this.options.signalingCandidateTimeout&&(this.signalingCandidateTimeout=this.options.signalingCandidateTimeout),this.constraints=null,this.debug=r,this.clientId=null,this.connectionId=null,this.remoteConnectionIds=[],this.stream=null,this.ws=null,this.pc=null,this.encodings=[],this.callbacks={disconnect:()=>{},push:()=>{},addstream:()=>{},track:()=>{},removestream:()=>{},removetrack:()=>{},notify:()=>{},log:()=>{},timeout:()=>{},timeline:()=>{},signaling:()=>{},message:()=>{},datachannel:()=>{}},this.authMetadata=null,this.e2ee=null,this.connectionTimeoutTimerId=0,this.monitorSignalingWebSocketEventTimerId=0,this.monitorIceConnectionStateChangeTimerId=0,this.soraDataChannels={},this.mids={audio:"",video:""},this.signalingSwitched=!1,this.signalingOfferMessageDataChannels={}}on(e,t){"addstream"===e?console.warn("@deprecated addstream callback will be removed in a future version. Use track callback."):"removestream"===e&&console.warn("@deprecated removestream callback will be removed in a future version. Use removetrack callback."),e in this.callbacks&&(this.callbacks[e]=t)}stopAudioTrack(e){for(const t of e.getAudioTracks())t.enabled=!1;return new Promise((t=>{setTimeout((async()=>{for(const t of e.getAudioTracks())if(t.stop(),e.removeTrack(t),null!==this.pc){const e=this.pc.getSenders().find((e=>e.track&&e.track.id===t.id));e&&await e.replaceTrack(null)}t()}),100)}))}stopVideoTrack(e){for(const t of e.getVideoTracks())t.enabled=!1;return new Promise((t=>{setTimeout((async()=>{for(const t of e.getVideoTracks())if(t.stop(),e.removeTrack(t),null!==this.pc){const e=this.pc.getSenders().find((e=>e.track&&e.track.id===t.id));e&&await e.replaceTrack(null)}t()}),100)}))}async replaceAudioTrack(e,t){await this.stopAudioTrack(e);const n=this.getAudioTransceiver();if(null===n)throw new Error("Unable to set an audio track. Audio track sender is undefined");e.addTrack(t),await n.sender.replaceTrack(t)}async replaceVideoTrack(e,t){await this.stopVideoTrack(e);const n=this.getVideoTransceiver();if(null===n)throw new Error("Unable to set video track. Video track sender is undefined");e.addTrack(t),await n.sender.replaceTrack(t)}stopStream(){return new Promise(((e,t)=>(this.debug&&console.warn("@deprecated closing MediaStream in disconnect will be removed in a future version. Close every track in the MediaStream by yourself."),this.stream?(this.stream.getTracks().forEach((e=>{e.stop()})),this.stream=null,e()):e())))}async signalingTerminate(){await this.stopStream();for(const e of Object.keys(this.soraDataChannels)){const t=this.soraDataChannels[e];t&&t.close(),delete this.soraDataChannels[e]}this.ws&&(this.ws.close(),this.ws=null),this.pc&&this.pc.close(),this.e2ee&&this.e2ee.terminateWorker(),this.initializeConnection()}async abendPeerConnectionState(e){this.clearMonitorIceConnectionStateChange(),await this.stopStream(),this.pc&&(this.pc.ondatachannel=null,this.pc.oniceconnectionstatechange=null,this.pc.onicegatheringstatechange=null,this.pc.onconnectionstatechange=null),this.ws&&(this.ws.onclose=e=>{this.writeWebSocketTimelineLog("onclose",{code:e.code,reason:e.reason})},this.ws.onmessage=null,this.ws.onerror=null);for(const n of Object.keys(this.soraDataChannels)){const e=this.soraDataChannels[n];e&&(e.onclose=e=>{const t=e.currentTarget;this.writeDataChannelTimelineLog("onclose",t),this.trace("CLOSE DATA CHANNEL",t.label)},e.onmessage=null,e.onerror=null)}for(const n of Object.keys(this.soraDataChannels)){const e=this.soraDataChannels[n];e&&e.close(),delete this.soraDataChannels[n]}this.ws&&(this.ws.close(),this.ws=null),this.pc&&this.pc.close(),this.e2ee&&this.e2ee.terminateWorker(),this.initializeConnection();const t=this.soraCloseEvent("abend",e);this.callbacks.disconnect(t),this.writeSoraTimelineLog("disconnect-abend",t)}async abend(e,t){this.clearMonitorIceConnectionStateChange(),await this.stopStream(),this.pc&&(this.pc.ondatachannel=null,this.pc.oniceconnectionstatechange=null,this.pc.onicegatheringstatechange=null,this.pc.onconnectionstatechange=null),this.ws&&(this.ws.onclose=e=>{this.writeWebSocketTimelineLog("onclose",{code:e.code,reason:e.reason})},this.ws.onmessage=null,this.ws.onerror=null);for(const i of Object.keys(this.soraDataChannels)){const e=this.soraDataChannels[i];e&&(e.onclose=e=>{const t=e.currentTarget;this.writeDataChannelTimelineLog("onclose",t),this.trace("CLOSE DATA CHANNEL",t.label)},e.onmessage=null,e.onerror=null)}if(this.soraDataChannels.signaling){const t={type:"disconnect",reason:e};if(this.signalingOfferMessageDataChannels.signaling&&!0===this.signalingOfferMessageDataChannels.signaling.compress){const e=H((new TextEncoder).encode(JSON.stringify(t)),{});if("open"===this.soraDataChannels.signaling.readyState)try{this.soraDataChannels.signaling.send(e),this.writeDataChannelSignalingLog("send-disconnect",this.soraDataChannels.signaling,t)}catch(le){const t=le.message;this.writeDataChannelSignalingLog("failed-to-send-disconnect",this.soraDataChannels.signaling,t)}}else if("open"===this.soraDataChannels.signaling.readyState)try{this.soraDataChannels.signaling.send(JSON.stringify(t)),this.writeDataChannelSignalingLog("send-disconnect",this.soraDataChannels.signaling,t)}catch(le){const t=le.message;this.writeDataChannelSignalingLog("failed-to-send-disconnect",this.soraDataChannels.signaling,t)}}for(const i of Object.keys(this.soraDataChannels)){const e=this.soraDataChannels[i];e&&(e.onerror=null,e.close()),delete this.soraDataChannels[i]}if(await this.disconnectWebSocket(e),await this.disconnectPeerConnection(),this.e2ee&&this.e2ee.terminateWorker(),this.initializeConnection(),"WEBSOCKET-ONCLOSE"===e&&t&&(1e3===t.code||1005===t.code)){const e=this.soraCloseEvent("normal","DISCONNECT",t);return this.writeSoraTimelineLog("disconnect-normal",e),void this.callbacks.disconnect(e)}const n=this.soraCloseEvent("abend",e,t);this.writeSoraTimelineLog("disconnect-abend",n),this.callbacks.disconnect(this.soraCloseEvent("abend",e,t))}initializeConnection(){this.clientId=null,this.connectionId=null,this.remoteConnectionIds=[],this.stream=null,this.ws=null,this.pc=null,this.encodings=[],this.authMetadata=null,this.e2ee=null,this.soraDataChannels={},this.mids={audio:"",video:""},this.signalingSwitched=!1,this.signalingOfferMessageDataChannels={},this.clearConnectionTimeout()}disconnectWebSocket(e){let t=0;return this.signalingSwitched?(this.ws&&(this.ws.close(),this.ws=null),Promise.resolve(null)):new Promise(((n,i)=>{if(!this.ws)return n(null);if(this.ws.onclose=e=>(this.ws&&(this.ws.close(),this.ws=null),clearTimeout(t),this.writeWebSocketTimelineLog("onclose",{code:e.code,reason:e.reason}),n({code:e.code,reason:e.reason})),1!==this.ws.readyState)return this.ws.close(),this.ws=null,n(null);{const i={type:"disconnect",reason:e};this.ws.send(JSON.stringify(i)),this.writeWebSocketSignalingLog("send-disconnect",i),t=setTimeout((()=>{this.ws&&(this.ws.close(),this.ws=null),n({code:1006,reason:""})}),this.disconnectWaitTimeout)}}))}disconnectDataChannel(){const e=()=>{for(const e of Object.keys(this.soraDataChannels)){const t=this.soraDataChannels[e];t&&(t.onerror=null,t.close()),delete this.soraDataChannels[e]}};return new Promise(((t,n)=>{if(!this.soraDataChannels.signaling)return e(),t({code:4999,reason:""});const i=setTimeout((()=>(e(),n())),this.disconnectWaitTimeout),o=[];for(const a of Object.keys(this.soraDataChannels)){const n=this.soraDataChannels[a];if(n){n.onerror=()=>(clearTimeout(i),e(),t({code:4999,reason:""}));const r=()=>new Promise(((e,t)=>{let i=0;const o=setInterval((()=>{i++,"closed"===n.readyState&&(clearInterval(o),e()),this.disconnectWaitTimeout<100*i&&(e(),clearInterval(o))}),100)}));o.push(r())}}Promise.all(o).then((()=>{0===Object.keys(this.soraDataChannels).length?t(null):t({code:4999,reason:""})})).finally((()=>{e(),clearTimeout(i)}));const r={type:"disconnect",reason:"NO-ERROR"};if(this.signalingOfferMessageDataChannels.signaling&&!0===this.signalingOfferMessageDataChannels.signaling.compress){const e=H((new TextEncoder).encode(JSON.stringify(r)),{});if("open"===this.soraDataChannels.signaling.readyState)try{this.soraDataChannels.signaling.send(e),this.writeDataChannelSignalingLog("send-disconnect",this.soraDataChannels.signaling,r)}catch(le){const t=le.message;this.writeDataChannelSignalingLog("failed-to-send-disconnect",this.soraDataChannels.signaling,t)}}else if("open"===this.soraDataChannels.signaling.readyState)try{this.soraDataChannels.signaling.send(JSON.stringify(r)),this.writeDataChannelSignalingLog("send-disconnect",this.soraDataChannels.signaling,r)}catch(le){const t=le.message;this.writeDataChannelSignalingLog("failed-to-send-disconnect",this.soraDataChannels.signaling,t)}}))}disconnectPeerConnection(){return new Promise(((e,t)=>(this.pc&&"closed"!==this.pc.connectionState&&this.pc.close(),e())))}async disconnect(){this.clearMonitorIceConnectionStateChange(),await this.stopStream(),this.pc&&(this.pc.ondatachannel=null,this.pc.oniceconnectionstatechange=null,this.pc.onicegatheringstatechange=null,this.pc.onconnectionstatechange=null),this.ws&&(this.ws.onclose=e=>{this.writeWebSocketTimelineLog("onclose",{code:e.code,reason:e.reason})},this.ws.onmessage=null,this.ws.onerror=null);for(const n of Object.keys(this.soraDataChannels)){const e=this.soraDataChannels[n];e&&(e.onmessage=null,e.onclose=e=>{const t=e.currentTarget;this.writeDataChannelTimelineLog("onclose",t),this.trace("CLOSE DATA CHANNEL",t.label)})}let e=null;if(this.signalingSwitched){try{const t=await this.disconnectDataChannel();null!==t&&(e=this.soraCloseEvent("normal","DISCONNECT",t))}catch(t){e=this.soraCloseEvent("abend","DISCONNECT-TIMEOUT")}await this.disconnectWebSocket("NO-ERROR"),await this.disconnectPeerConnection()}else{const t=await this.disconnectWebSocket("NO-ERROR");await this.disconnectPeerConnection(),null!==t&&(e=this.soraCloseEvent("normal","DISCONNECT",t))}this.e2ee&&this.e2ee.terminateWorker(),this.initializeConnection(),e&&("abend"===e.type?this.writeSoraTimelineLog("disconnect-abend",e):"normal"===e.type&&this.writeSoraTimelineLog("disconnect-normal",e),this.callbacks.disconnect(e))}setupE2EE(){!0===this.options.e2ee&&(this.e2ee=new o,this.e2ee.onWorkerDisconnect=async()=>{await this.abend("INTERNAL-ERROR",{reason:"CRASH-E2EE-WORKER"})},this.e2ee.startWorker())}startE2EE(){if(!0===this.options.e2ee&&this.e2ee){if(!this.connectionId){const e=new Error;throw e.message="E2EE failed. Self connectionId is null",e}this.e2ee.clearWorker();const e=this.e2ee.start(this.connectionId);this.e2ee.postSelfSecretKeyMaterial(this.connectionId,e.selfKeyId,e.selfSecretKeyMaterial)}}async getSignalingWebSocket(e){if("string"===typeof e){const t=e;return new Promise(((e,n)=>{const i=new WebSocket(t);i.onclose=e=>{const t=new ee(`Signaling failed. CloseEventCode:${e.code} CloseEventReason:'${e.reason}'`);t.code=e.code,t.reason=e.reason,this.writeWebSocketTimelineLog("onclose",t),n(t)},i.onopen=t=>{e(i)}}))}if(Array.isArray(e)){let t=!1;const n=e=>new Promise(((n,i)=>{const o=new WebSocket(e),r=setTimeout((()=>{this.writeWebSocketSignalingLog("signaling-url-canidate",{type:"timeout",url:o.url}),o&&!t&&(o.onclose=null,o.onerror=null,o.onopen=null,o.close(),i())}),this.signalingCandidateTimeout);o.onclose=e=>{this.writeWebSocketSignalingLog("signaling-url-canidate",{type:"close",url:o.url,message:"WebSocket closed",code:e.code,reason:e.reason}),o&&o.close(),clearInterval(r),i()},o.onerror=e=>{this.writeWebSocketSignalingLog("signaling-url-canidate",{type:"error",url:o.url,message:"Failed to connect WebSocket"}),o&&(o.onclose=null,o.close()),clearInterval(r),i()},o.onopen=e=>{o&&(clearInterval(r),t?(this.writeWebSocketSignalingLog("signaling-url-canidate",{type:"open",url:o.url,selected:!1}),o.onerror=null,o.onclose=null,o.onopen=null,o.close(),i()):(this.writeWebSocketSignalingLog("signaling-url-canidate",{type:"open",url:o.url,selected:!0}),o.onerror=null,o.onclose=null,o.onopen=null,t=!0,n(o)))}}));try{return await Promise.any(e.map((e=>n(e))))}catch(le){throw new ee("Signaling failed. All signaling URL candidates failed to connect")}}throw new ee("Signaling failed. Invalid format signaling URL candidates")}async signaling(e,t=!1){const n=await this.createOffer();return this.trace("CREATE OFFER",n),new Promise(((i,o)=>{this.writeWebSocketSignalingLog("new-websocket",e.url),e.binaryType="arraybuffer",e.onclose=async e=>{const t=new ee(`Signaling failed. CloseEventCode:${e.code} CloseEventReason:'${e.reason}'`);t.code=e.code,t.reason=e.reason,this.writeWebSocketTimelineLog("onclose",t),await this.signalingTerminate(),o(t)},e.onmessage=async e=>{if(e.data instanceof ArrayBuffer)return this.writeWebSocketSignalingLog("onmessage-e2ee",e.data),void this.signalingOnMessageE2EE(e.data);const t=JSON.parse(e.data);if("offer"==t.type)this.writeWebSocketSignalingLog("onmessage-offer",t),this.signalingOnMessageTypeOffer(t),i(t);else if("update"==t.type)this.writeWebSocketSignalingLog("onmessage-update",t),await this.signalingOnMessageTypeUpdate(t);else if("re-offer"==t.type)this.writeWebSocketSignalingLog("onmessage-re-offer",t),await this.signalingOnMessageTypeReOffer(t);else if("ping"==t.type)await this.signalingOnMessageTypePing(t);else if("push"==t.type)this.callbacks.push(t,"websocket");else if("notify"==t.type)"connection.created"===t.event_type?this.writeWebSocketTimelineLog("notify-connection.created",t):"connection.destroyed"===t.event_type&&this.writeWebSocketTimelineLog("notify-connection.destroyed",t),this.signalingOnMessageTypeNotify(t,"websocket");else if("switched"==t.type)this.writeWebSocketSignalingLog("onmessage-switched",t),this.signalingOnMessageTypeSwitched(t);else if("redirect"==t.type){this.writeWebSocketSignalingLog("onmessage-redirect",t);try{const e=await this.signalingOnMessageTypeRedirect(t);i(e)}catch(n){o(n)}}},(async()=>{let i;try{i=z(n.sdp||"",this.role,this.channelId,this.metadata,this.options,t)}catch(r){return void o(r)}if(i.e2ee&&this.e2ee){const e=await this.e2ee.init();i.signaling_notify_metadata.pre_key_bundle=e}this.trace("SIGNALING CONNECT MESSAGE",i),e&&(e.send(JSON.stringify(i)),this.writeWebSocketSignalingLog(`send-${i.type}`,i),this.ws=e)})()}))}async connectPeerConnection(e){let t=Object.assign({},e.config);if(this.e2ee&&(t=Object.assign({encodedInsertableStreams:!0},t)),void 0!==window.RTCPeerConnection.generateCertificate){const e=await window.RTCPeerConnection.generateCertificate({name:"ECDSA",namedCurve:"P-256"});t=Object.assign({certificates:[e]},t)}this.trace("PEER CONNECTION CONFIG",t),this.writePeerConnectionTimelineLog("new-peerconnection",t),this.pc=new window.RTCPeerConnection(t,this.constraints),this.pc.oniceconnectionstatechange=e=>{this.pc&&(this.writePeerConnectionTimelineLog("oniceconnectionstatechange",{connectionState:this.pc.connectionState,iceConnectionState:this.pc.iceConnectionState,iceGatheringState:this.pc.iceGatheringState}),this.trace("ONICECONNECTIONSTATECHANGE ICECONNECTIONSTATE",this.pc.iceConnectionState))},this.pc.onicegatheringstatechange=e=>{this.pc&&this.writePeerConnectionTimelineLog("onicegatheringstatechange",{connectionState:this.pc.connectionState,iceConnectionState:this.pc.iceConnectionState,iceGatheringState:this.pc.iceGatheringState})},this.pc.onconnectionstatechange=e=>{this.pc&&this.writePeerConnectionTimelineLog("onconnectionstatechange",{connectionState:this.pc.connectionState,iceConnectionState:this.pc.iceConnectionState,iceGatheringState:this.pc.iceGatheringState})},this.pc.ondatachannel=e=>{this.onDataChannel(e)}}async setRemoteDescription(e){if(!this.pc)return;const t=new RTCSessionDescription({type:"offer",sdp:e.sdp});await this.pc.setRemoteDescription(t),this.writePeerConnectionTimelineLog("set-remote-description",t)}async createAnswer(e){if(!this.pc)return;for(const n of Object.values(this.mids)){const e=this.pc.getTransceivers().find((e=>e.mid===n));e&&"recvonly"===e.direction&&(e.direction="sendrecv")}if(this.options.simulcast&&("sendrecv"===this.role||"sendonly"===this.role)){const t=this.pc.getTransceivers().find((e=>{if(null!==e.mid&&null!==e.sender.track&&(null===e.currentDirection||"sendonly"===e.currentDirection))return""!==this.mids.video&&this.mids.video===e.mid||0<=e.mid.indexOf("video")?e:void 0}));if(t){await this.setSenderParameters(t,this.encodings),await this.setRemoteDescription(e),this.trace("TRANSCEIVER SENDER GET_PARAMETERS",t.sender.getParameters()),await this.setSenderParameters(t,this.encodings);const n=await this.pc.createAnswer();return await this.pc.setLocalDescription(n),void this.trace("TRANSCEIVER SENDER GET_PARAMETERS",t.sender.getParameters())}}const t=await this.pc.createAnswer();this.writePeerConnectionTimelineLog("create-answer",t),await this.pc.setLocalDescription(t),this.writePeerConnectionTimelineLog("set-local-description",t)}sendAnswer(){if(this.pc&&this.ws&&this.pc.localDescription){this.trace("ANSWER SDP",this.pc.localDescription.sdp);const e={type:"answer",sdp:this.pc.localDescription.sdp};this.ws.send(JSON.stringify(e)),this.writeWebSocketSignalingLog("send-answer",e)}}onIceCandidate(){return new Promise(((e,t)=>{this.pc&&(this.pc.oniceconnectionstatechange=t=>{this.pc&&(this.writePeerConnectionTimelineLog("oniceconnectionstatechange",{connectionState:this.pc.connectionState,iceConnectionState:this.pc.iceConnectionState,iceGatheringState:this.pc.iceGatheringState}),this.trace("ONICECONNECTIONSTATECHANGE ICECONNECTIONSTATE",this.pc.iceConnectionState),"connected"===this.pc.iceConnectionState&&e())},this.pc.onicecandidate=t=>{if(this.writePeerConnectionTimelineLog("onicecandidate",t.candidate),this.pc&&this.trace("ONICECANDIDATE ICEGATHERINGSTATE",this.pc.iceGatheringState),null===t.candidate)e();else{const e=t.candidate.toJSON(),n=Object.assign(e,{type:"candidate"});this.trace("ONICECANDIDATE CANDIDATE MESSAGE",n),this.sendSignalingMessage(n)}})}))}waitChangeConnectionStateConnected(){return new Promise(((e,t)=>{if(this.pc&&void 0===this.pc.connectionState)return void e();const n=setInterval((()=>{if(this.pc)this.pc&&"connected"===this.pc.connectionState&&(clearInterval(n),e());else{const e=new Error;e.message="PeerConnection connectionState did not change to 'connected'",clearInterval(n),t(e)}}),10)}))}monitorSignalingWebSocketEvent(){return new Promise(((e,t)=>{this.monitorSignalingWebSocketEventTimerId=setInterval((()=>{this.ws&&(this.clearMonitorSignalingWebSocketEvent(),this.ws.onclose=async e=>{const n=new ee(`Signaling failed. CloseEventCode:${e.code} CloseEventReason:'${e.reason}'`);n.code=e.code,n.reason=e.reason,this.writeWebSocketTimelineLog("onclose",n),await this.signalingTerminate(),t(n)},this.ws.onerror=async e=>{const n=new ee("Signaling failed. WebSocket onerror was called");this.writeWebSocketSignalingLog("onerror",n),await this.signalingTerminate(),t(n)})}),100)}))}monitorWebSocketEvent(){this.ws&&(this.ws.onclose=async e=>{this.writeWebSocketTimelineLog("onclose",{code:e.code,reason:e.reason}),await this.abend("WEBSOCKET-ONCLOSE",{code:e.code,reason:e.reason})},this.ws.onerror=async e=>{this.writeWebSocketSignalingLog("onerror"),await this.abend("WEBSOCKET-ONERROR")})}monitorPeerConnectionState(){this.pc&&(this.pc.oniceconnectionstatechange=async e=>{this.pc&&void 0===this.pc.connectionState&&(this.writePeerConnectionTimelineLog("oniceconnectionstatechange",{connectionState:this.pc.connectionState,iceConnectionState:this.pc.iceConnectionState,iceGatheringState:this.pc.iceGatheringState}),this.trace("ONICECONNECTIONSTATECHANGE ICECONNECTIONSTATE",this.pc.iceConnectionState),clearTimeout(this.monitorIceConnectionStateChangeTimerId),"failed"===this.pc.iceConnectionState?await this.abendPeerConnectionState("ICE-CONNECTION-STATE-FAILED"):"disconnected"===this.pc.iceConnectionState&&(this.monitorIceConnectionStateChangeTimerId=setTimeout((async()=>{this.pc&&"disconnected"===this.pc.iceConnectionState&&await this.abendPeerConnectionState("ICE-CONNECTION-STATE-DISCONNECTED-TIMEOUT")}),1e4)))},this.pc.onconnectionstatechange=async e=>{this.pc&&(this.writePeerConnectionTimelineLog("onconnectionstatechange",{connectionState:this.pc.connectionState,iceConnectionState:this.pc.iceConnectionState,iceGatheringState:this.pc.iceGatheringState}),"failed"===this.pc.connectionState&&await this.abendPeerConnectionState("CONNECTION-STATE-FAILED"))})}setConnectionTimeout(){return new Promise(((e,t)=>{0<this.connectionTimeout&&(this.connectionTimeoutTimerId=setTimeout((async()=>{if(!this.pc||this.pc&&void 0!==this.pc.connectionState&&"connected"!==this.pc.connectionState){const e=new Error;e.message="Signaling connection timeout",this.callbacks.timeout(),this.trace("DISCONNECT","Signaling connection timeout"),this.writePeerConnectionTimelineLog("signaling-connection-timeout",{connectionTimeout:this.connectionTimeout}),await this.signalingTerminate(),t(e)}}),this.connectionTimeout))}))}clearConnectionTimeout(){clearTimeout(this.connectionTimeoutTimerId)}clearMonitorSignalingWebSocketEvent(){clearInterval(this.monitorSignalingWebSocketEventTimerId)}clearMonitorIceConnectionStateChange(){clearInterval(this.monitorIceConnectionStateChangeTimerId)}trace(e,t){this.callbacks.log(e,t),this.debug&&function(e,t,n){const i=e=>{if(e&&"object"===typeof e){let n=null;try{n=Object.keys(JSON.parse(JSON.stringify(e)))}catch(t){}n&&Array.isArray(n)?n.forEach((t=>{console.group(t),i(e[t]),console.groupEnd()})):console.info(e)}else console.info(e)};let o="";window.performance&&(o="["+(window.performance.now()/1e3).toFixed(3)+"]"),e&&(o=o+"["+e+"]"),void 0!==console.info&&void 0!==console.group?(console.group(o+" "+t),i(n),console.groupEnd()):console.log(o+" "+t+"\n",n)}(this.clientId,e,t)}writeWebSocketSignalingLog(e,t){this.callbacks.signaling(te(e,t,"websocket")),this.writeWebSocketTimelineLog(e,t)}writeDataChannelSignalingLog(e,t,n){this.callbacks.signaling(te(e,n,"datachannel")),this.writeDataChannelTimelineLog(e,t,n)}writeWebSocketTimelineLog(e,t){const n=ne(e,t,"websocket");this.callbacks.timeline(n)}writeDataChannelTimelineLog(e,t,n){const i=ne(e,n,"datachannel",t.id,t.label);this.callbacks.timeline(i)}writePeerConnectionTimelineLog(e,t){const n=ne(e,t,"peerconnection");this.callbacks.timeline(n)}writeSoraTimelineLog(e,t){const n=ne(e,t,"sora");this.callbacks.timeline(n)}async createOffer(){const e=new window.RTCPeerConnection({iceServers:[]});if(K()){e.addTransceiver("video",{direction:"recvonly"}),e.addTransceiver("audio",{direction:"recvonly"});const t=await e.createOffer();return e.close(),this.writePeerConnectionTimelineLog("create-offer",t),t}const t=await e.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});return e.close(),this.writePeerConnectionTimelineLog("create-offer",t),t}signalingOnMessageE2EE(e){if(this.e2ee){const t=new Uint8Array(e),n=this.e2ee.receiveMessage(t);this.e2ee.postRemoteSecretKeyMaterials(n),n.messages.forEach((e=>{this.sendE2EEMessage(e.buffer)}))}}signalingOnMessageTypeOffer(e){if(this.clientId=e.client_id,this.connectionId=e.connection_id,void 0!==e.metadata&&(this.authMetadata=e.metadata),Array.isArray(e.encodings)&&(this.encodings=e.encodings),void 0!==e.mid&&void 0!==e.mid.audio&&(this.mids.audio=e.mid.audio),void 0!==e.mid&&void 0!==e.mid.video&&(this.mids.video=e.mid.video),e.data_channels)for(const t of e.data_channels)this.signalingOfferMessageDataChannels[t.label]=t;this.trace("SIGNALING OFFER MESSAGE",e),this.trace("OFFER SDP",e.sdp)}sendUpdateAnswer(){this.pc&&this.ws&&this.pc.localDescription&&(this.trace("ANSWER SDP",this.pc.localDescription.sdp),this.sendSignalingMessage({type:"update",sdp:this.pc.localDescription.sdp}))}sendReAnswer(){this.pc&&this.pc.localDescription&&(this.trace("RE ANSWER SDP",this.pc.localDescription.sdp),this.sendSignalingMessage({type:"re-answer",sdp:this.pc.localDescription.sdp}))}async signalingOnMessageTypeUpdate(e){this.trace("SIGNALING UPDATE MESSGE",e),this.trace("UPDATE SDP",e.sdp),await this.setRemoteDescription(e),await this.createAnswer(e),this.sendUpdateAnswer()}async signalingOnMessageTypeReOffer(e){this.trace("SIGNALING RE OFFER MESSGE",e),this.trace("RE OFFER SDP",e.sdp),await this.setRemoteDescription(e),await this.createAnswer(e),this.sendReAnswer()}async signalingOnMessageTypePing(e){const t={type:"pong"};if(e.stats){const e=await this.getStats();t.stats=e}this.ws&&this.ws.send(JSON.stringify(t))}signalingOnMessageTypeNotify(e,t){if("connection.created"===e.event_type){const t=e.connection_id;if(this.connectionId!==t){const n=q($(e));if(n&&this.e2ee&&t){const e=this.e2ee.startSession(t,n);this.e2ee.postRemoteSecretKeyMaterials(e),e.messages.forEach((e=>{this.sendE2EEMessage(e.buffer)})),this.e2ee.postSelfSecretKeyMaterial(e.selfConnectionId,e.selfKeyId,e.selfSecretKeyMaterial)}}(function(e){return e.data&&Array.isArray(e.data)?e.data:e.metadata_list&&Array.isArray(e.metadata_list)?e.metadata_list:[]})(e).forEach((e=>{const t=q($(e)),n=e.connection_id;n&&this.e2ee&&t&&this.e2ee.addPreKeyBundle(n,t)}))}else if("connection.destroyed"===e.event_type){const t=q($(e)),n=e.connection_id;if(t&&this.e2ee&&n){const e=this.e2ee.stopSession(n);this.e2ee.postSelfSecretKeyMaterial(e.selfConnectionId,e.selfKeyId,e.selfSecretKeyMaterial,5e3),e.messages.forEach((e=>{this.sendE2EEMessage(e.buffer)})),this.e2ee.postRemoveRemoteDeriveKey(n)}}this.callbacks.notify(e,t)}signalingOnMessageTypeSwitched(e){if(this.signalingSwitched=!0,this.ws){e.ignore_disconnect_websocket&&(this.ws&&(this.ws.onclose=null,this.ws.close(),this.ws=null),this.writeWebSocketSignalingLog("close"));for(const e of this.datachannels)this.callbacks.datachannel(ie(e))}}async signalingOnMessageTypeRedirect(e){this.ws&&(this.ws.onclose=null,this.ws.onerror=null,this.ws.close(),this.ws=null);const t=await this.getSignalingWebSocket(e.location);return await this.signaling(t,!0)}async setSenderParameters(e,t){const n=e.sender.getParameters();n.encodings=t,await e.sender.setParameters(n),this.trace("TRANSCEIVER SENDER SET_PARAMETERS",n),this.writePeerConnectionTimelineLog("transceiver-sender-set-parameters",n)}async getStats(){const e=[];if(!this.pc)return e;return(await this.pc.getStats()).forEach((t=>{e.push(t)})),e}onDataChannel(e){const t=e.channel;var n;this.writeDataChannelTimelineLog("ondatachannel",t,{binaryType:(n=t).binaryType,bufferedAmount:n.bufferedAmount,bufferedAmountLowThreshold:n.bufferedAmountLowThreshold,id:n.id,label:n.label,maxPacketLifeTime:n.maxPacketLifeTime,maxRetransmits:n.maxRetransmits,negotiated:n.negotiated,ordered:n.ordered,protocol:n.protocol,readyState:n.readyState,reliable:n.reliable}),e.channel.onbufferedamountlow=e=>{const t=e.currentTarget;this.writeDataChannelTimelineLog("onbufferedamountlow",t)},e.channel.onopen=e=>{const t=e.currentTarget;t.bufferedAmountLowThreshold=65536,t.binaryType="arraybuffer",this.soraDataChannels[t.label]=t,this.trace("OPEN DATA CHANNEL",t.label),"signaling"===t.label&&this.ws?this.writeDataChannelSignalingLog("onopen",t):this.writeDataChannelTimelineLog("onopen",t)},e.channel.onclose=async e=>{const t=e.currentTarget;this.writeDataChannelTimelineLog("onclose",t),this.trace("CLOSE DATA CHANNEL",t.label),await this.disconnect()},e.channel.onerror=async e=>{const t=e.currentTarget;this.writeDataChannelTimelineLog("onerror",t),this.trace("ERROR DATA CHANNEL",t.label),await this.abend("DATA-CHANNEL-ONERROR",{params:{label:t.label}})},"signaling"===e.channel.label?e.channel.onmessage=async e=>{const t=e.currentTarget;let n=e.data;if(this.signalingOfferMessageDataChannels.signaling&&!0===this.signalingOfferMessageDataChannels.signaling.compress){const t=Y(new Uint8Array(e.data));n=(new TextDecoder).decode(t)}const i=JSON.parse(n);this.writeDataChannelSignalingLog(`onmessage-${i.type}`,t,i),"re-offer"===i.type&&await this.signalingOnMessageTypeReOffer(i)}:"notify"===e.channel.label?e.channel.onmessage=e=>{const t=e.currentTarget;let n=e.data;if(this.signalingOfferMessageDataChannels.notify&&!0===this.signalingOfferMessageDataChannels.notify.compress){const t=Y(new Uint8Array(e.data));n=(new TextDecoder).decode(t)}const i=JSON.parse(n);"connection.created"===i.event_type?this.writeDataChannelTimelineLog("notify-connection.created",t,i):"connection.destroyed"===i.event_type&&this.writeDataChannelTimelineLog("notify-connection.destroyed",t,i),this.signalingOnMessageTypeNotify(i,"datachannel")}:"push"===e.channel.label?e.channel.onmessage=e=>{let t=e.data;if(this.signalingOfferMessageDataChannels.push&&!0===this.signalingOfferMessageDataChannels.push.compress){const n=Y(new Uint8Array(e.data));t=(new TextDecoder).decode(n)}const n=JSON.parse(t);this.callbacks.push(n,"datachannel")}:"e2ee"===e.channel.label?e.channel.onmessage=e=>{const t=e.currentTarget,n=e.data;this.signalingOnMessageE2EE(n),this.writeDataChannelSignalingLog("onmessage-e2ee",t,n)}:"stats"===e.channel.label?e.channel.onmessage=async e=>{let t=e.data;if(this.signalingOfferMessageDataChannels.stats&&!0===this.signalingOfferMessageDataChannels.stats.compress){const n=Y(new Uint8Array(e.data));t=(new TextDecoder).decode(n)}if("req-stats"===JSON.parse(t).type){const e=await this.getStats();this.sendStatsMessage(e)}}:/^#.*/.exec(e.channel.label)&&(e.channel.onmessage=e=>{if(null===e.target)return;const t=e.target;let n;if("string"===typeof e.data?n=(new TextEncoder).encode(e.data):e.data instanceof ArrayBuffer?n=e.data:console.warn("Received onmessage event data is not of type String or ArrayBuffer."),void 0!==n){const e=this.signalingOfferMessageDataChannels[t.label];void 0!==e&&!0===e.compress&&(n=Y(new Uint8Array(n)).buffer),this.callbacks.message(function(e,t){const n=new Event("message");return n.label=e,n.data=t,n}(t.label,n))}})}sendSignalingMessage(e){if(this.soraDataChannels.signaling){if(this.signalingOfferMessageDataChannels.signaling&&!0===this.signalingOfferMessageDataChannels.signaling.compress){const t=H((new TextEncoder).encode(JSON.stringify(e)),{});this.soraDataChannels.signaling.send(t)}else this.soraDataChannels.signaling.send(JSON.stringify(e));this.writeDataChannelSignalingLog(`send-${e.type}`,this.soraDataChannels.signaling,e)}else null!==this.ws&&(this.ws.send(JSON.stringify(e)),this.writeWebSocketSignalingLog(`send-${e.type}`,e))}sendE2EEMessage(e){this.soraDataChannels.e2ee?(this.soraDataChannels.e2ee.send(e),this.writeDataChannelSignalingLog("send-e2ee",this.soraDataChannels.e2ee,e)):null!==this.ws&&(this.ws.send(e),this.writeWebSocketSignalingLog("send-e2ee",e))}sendStatsMessage(e){if(this.soraDataChannels.stats){const t={type:"stats",reports:e};if(this.signalingOfferMessageDataChannels.stats&&!0===this.signalingOfferMessageDataChannels.stats.compress){const e=H((new TextEncoder).encode(JSON.stringify(t)),{});this.soraDataChannels.stats.send(e)}else this.soraDataChannels.stats.send(JSON.stringify(t))}}getAudioTransceiver(){if(this.pc&&this.mids.audio){return this.pc.getTransceivers().find((e=>e.mid===this.mids.audio))||null}return null}getVideoTransceiver(){if(this.pc&&this.mids.video){return this.pc.getTransceivers().find((e=>e.mid===this.mids.video))||null}return null}soraCloseEvent(e,t,n){return new class extends Event{constructor(e,t,n){super(e),n&&(n.code&&(this.code=n.code),n.reason&&(this.reason=n.reason),n.params&&(this.params=n.params)),this.title=t}}(e,t,n)}sendMessage(e,t){const n=this.soraDataChannels[e];if(null===this.pc)return;if(void 0===n)throw new Error("Could not find DataChannel");const i=this.signalingOfferMessageDataChannels[e];if(void 0!==i&&!0===i.compress){const e=H(t,{});n.send(e)}else n.send(t)}get e2eeSelfFingerprint(){if(this.options.e2ee&&this.e2ee)return this.e2ee.selfFingerprint()}get e2eeRemoteFingerprints(){if(this.options.e2ee&&this.e2ee)return this.e2ee.remoteFingerprints()}get audio(){return null!==this.getAudioTransceiver()}get video(){return null!==this.getVideoTransceiver()}get signalingUrl(){return this.signalingUrlCandidates}get connectedSignalingUrl(){return this.ws?this.ws.url:""}get datachannels(){if(!this.signalingSwitched)return[];const e=Object.keys(this.signalingOfferMessageDataChannels).filter((e=>/^#.*/.exec(e))),t=[];for(const n of e){const e=this.soraDataChannels[n];if(!e)continue;const i=this.signalingOfferMessageDataChannels[n];if(!i)continue;const o={label:e.label,ordered:e.ordered,protocol:e.protocol,compress:i.compress,direction:i.direction};"number"===typeof e.maxPacketLifeTime&&(o.maxPacketLifeTime=e.maxPacketLifeTime),"number"===typeof e.maxRetransmits&&(o.maxRetransmits=e.maxRetransmits),t.push(o)}return t}}class re extends oe{async connect(e){return this.options.multistream?await Promise.race([this.multiStream(e).finally((()=>{this.clearConnectionTimeout(),this.clearMonitorSignalingWebSocketEvent()})),this.setConnectionTimeout(),this.monitorSignalingWebSocketEvent()]):await Promise.race([this.singleStream(e).finally((()=>{this.clearConnectionTimeout(),this.clearMonitorSignalingWebSocketEvent()})),this.setConnectionTimeout(),this.monitorSignalingWebSocketEvent()]),this.monitorWebSocketEvent(),this.monitorPeerConnectionState(),e}async singleStream(e){await this.disconnect(),this.setupE2EE();const t=await this.getSignalingWebSocket(this.signalingUrlCandidates),n=await this.signaling(t);return this.startE2EE(),await this.connectPeerConnection(n),await this.setRemoteDescription(n),e.getTracks().forEach((t=>{this.pc&&this.pc.addTrack(t,e)})),this.stream=e,await this.createAnswer(n),this.sendAnswer(),this.pc&&this.e2ee&&this.pc.getSenders().forEach((e=>{this.e2ee&&this.e2ee.setupSenderTransform(e)})),await this.onIceCandidate(),await this.waitChangeConnectionStateConnected(),e}async multiStream(e){await this.disconnect(),this.setupE2EE();const t=await this.getSignalingWebSocket(this.signalingUrlCandidates),n=await this.signaling(t);return this.startE2EE(),await this.connectPeerConnection(n),this.pc&&(this.pc.ontrack=e=>{const t=e.streams[0];if(!t)return;const n={"stream.id":t.id,id:e.track.id,label:e.track.label,enabled:e.track.enabled,kind:e.track.kind,muted:e.track.muted,readyState:e.track.readyState};this.writePeerConnectionTimelineLog("ontrack",n),"default"!==t.id&&t.id!==this.connectionId&&(this.e2ee&&this.e2ee.setupReceiverTransform(e.receiver),this.callbacks.track(e),t.onremovetrack=e=>{if(this.callbacks.removetrack(e),e.target){const t=this.remoteConnectionIds.indexOf(e.target.id);-1<t&&(delete this.remoteConnectionIds[t],e.stream=e.target,this.callbacks.removestream(e))}},-1<this.remoteConnectionIds.indexOf(t.id)||(e.stream=t,this.remoteConnectionIds.push(t.id),this.callbacks.addstream(e)))}),await this.setRemoteDescription(n),e.getTracks().forEach((t=>{this.pc&&this.pc.addTrack(t,e)})),this.stream=e,await this.createAnswer(n),this.sendAnswer(),this.pc&&this.e2ee&&this.pc.getSenders().forEach((e=>{this.e2ee&&this.e2ee.setupSenderTransform(e)})),await this.onIceCandidate(),await this.waitChangeConnectionStateConnected(),e}}class ae extends oe{async connect(){if(this.options.multistream)return await Promise.race([this.multiStream().finally((()=>{this.clearConnectionTimeout(),this.clearMonitorSignalingWebSocketEvent()})),this.setConnectionTimeout(),this.monitorSignalingWebSocketEvent()]),this.monitorWebSocketEvent(),void this.monitorPeerConnectionState();{const e=await Promise.race([this.singleStream().finally((()=>{this.clearConnectionTimeout(),this.clearMonitorSignalingWebSocketEvent()})),this.setConnectionTimeout(),this.monitorSignalingWebSocketEvent()]);return this.monitorWebSocketEvent(),this.monitorPeerConnectionState(),e}}async singleStream(){await this.disconnect(),this.setupE2EE();const e=await this.getSignalingWebSocket(this.signalingUrlCandidates),t=await this.signaling(e);return this.startE2EE(),await this.connectPeerConnection(t),this.pc&&(this.pc.ontrack=e=>{this.stream=e.streams[0];const t=this.stream.id;if("default"===t)return;const n={"stream.id":t,id:e.track.id,label:e.track.label,enabled:e.track.enabled,kind:e.track.kind,muted:e.track.muted,readyState:e.track.readyState};this.writePeerConnectionTimelineLog("ontrack",n),this.e2ee&&this.e2ee.setupReceiverTransform(e.receiver),this.callbacks.track(e),this.stream.onremovetrack=e=>{if(this.callbacks.removetrack(e),e.target){const t=this.remoteConnectionIds.indexOf(e.target.id);-1<t&&(delete this.remoteConnectionIds[t],e.stream=e.target,this.callbacks.removestream(e))}},-1<this.remoteConnectionIds.indexOf(t)||(e.stream=this.stream,this.remoteConnectionIds.push(t),this.callbacks.addstream(e))}),await this.setRemoteDescription(t),await this.createAnswer(t),this.sendAnswer(),await this.onIceCandidate(),await this.waitChangeConnectionStateConnected(),this.stream||new MediaStream}async multiStream(){await this.disconnect(),this.setupE2EE();const e=await this.getSignalingWebSocket(this.signalingUrlCandidates),t=await this.signaling(e);this.startE2EE(),await this.connectPeerConnection(t),this.pc&&(this.pc.ontrack=e=>{const t=e.streams[0];if("default"===t.id)return;if(t.id===this.connectionId)return;const n={"stream.id":t.id,id:e.track.id,label:e.track.label,enabled:e.track.enabled,kind:e.track.kind,muted:e.track.muted,readyState:e.track.readyState};this.writePeerConnectionTimelineLog("ontrack",n),this.e2ee&&this.e2ee.setupReceiverTransform(e.receiver),this.callbacks.track(e),t.onremovetrack=e=>{if(this.callbacks.removetrack(e),e.target){const t=this.remoteConnectionIds.indexOf(e.target.id);-1<t&&(delete this.remoteConnectionIds[t],e.stream=e.target,this.callbacks.removestream(e))}},-1<this.remoteConnectionIds.indexOf(t.id)||(e.stream=t,this.remoteConnectionIds.push(t.id),this.callbacks.addstream(e))}),await this.setRemoteDescription(t),await this.createAnswer(t),this.sendAnswer(),await this.onIceCandidate(),await this.waitChangeConnectionStateConnected()}}class se{constructor(e,t=!1){this.signalingUrlCandidates=e,this.debug=t}sendrecv(e,t=null,n={audio:!0,video:!0}){return new re(this.signalingUrlCandidates,"sendrecv",e,t,n,this.debug)}sendonly(e,t=null,n={audio:!0,video:!0}){return new re(this.signalingUrlCandidates,"sendonly",e,t,n,this.debug)}recvonly(e,t=null,n={audio:!0,video:!0}){return new ae(this.signalingUrlCandidates,"recvonly",e,t,n,this.debug)}get signalingUrl(){return this.signalingUrlCandidates}}var ce={initE2EE:async function(e){await o.loadWasm(e)},connection:function(e,t=!1){return new se(e,t)},version:function(){return"2021.2.3"},helpers:{applyMediaStreamConstraints:async function(e,t){if(t.audio&&"boolean"!==typeof t.audio)for(const n of e.getAudioTracks())await n.applyConstraints(t.audio);if(t.video&&"boolean"!==typeof t.video)for(const n of e.getVideoTracks())await n.applyConstraints(t.video)}}}}},function(e){var t=function(t){return e(e.s=t)};e.O(0,[774,179],(function(){return t(6363),t(9898)}));var n=e.O();_N_E=n}]);