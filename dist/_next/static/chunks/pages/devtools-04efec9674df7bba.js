(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[893],{1206:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/devtools",function(){return n(1770)}])},1770:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Os}});var a=n(1527),s=n(959),i=n(4517),o=n(2756),r=n(4029),c=n(346),l=n(1876),d=n(1123);function u(e){const t=new Date(e),n=t.getFullYear(),a=t.getMonth()+1,s=t.getDate(),i=t.getHours().toString().padStart(2,"0"),o=t.getMinutes().toString().padStart(2,"0"),r=t.getSeconds().toString().padStart(2,"0"),c=t.getMilliseconds().toString().padStart(3,"0");return"".concat(n,"-").concat(a,"-").concat(s," ").concat(i,":").concat(o,":").concat(r,".").concat(c)}function m(e){return navigator.clipboard?navigator.clipboard.writeText(e):Promise.resolve()}function g(e,t){return"string"===typeof e&&t.indexOf(e)>=0}function h(e,t){if(e)return t.filter((e=>""!==e));const n="https:"===window.location.protocol?"wss://":"ws://",a=window.location.port?":".concat(window.location.port):"";return n+window.location.hostname+a+"/signaling"}function p(e){switch(e){case"144p (256x144)":return{width:256,height:144};case"240p (320x240)":return{width:320,height:240};case"360p (640x360)":return{width:640,height:360};case"480p (720x480)":return{width:720,height:480};case"720p (1280x720)":return{width:1280,height:720};case"1080p (1920x1080)":return{width:1920,height:1080};case"1440p (2560x1440)":return{width:2560,height:1440};case"2160p (3840x2160)":return{width:3840,height:2160};default:return{width:0,height:0}}}function v(e){switch(e){case"4:3":return 4/3;case"16:9":return 16/9;case"21:9":return 20/9;default:return NaN}}function x(e){switch(e){case"weak":return 5;case"medium":return 10;case"strong":return 15;default:return 0}}function f(e){const{aspectRatio:t,frameRate:n,resizeMode:a,resolution:s}=e;if(!n&&!s&&!t&&!a)return{video:!0};const i={};if(n&&(i.frameRate=parseInt(n,10)),s){const{width:e,height:t}=p(s);0<e&&0<t&&(i.width=e,i.height=t)}return t&&(i.aspectRatio=v(t)),a&&(i.resizeMode=a),{video:i}}function j(e){return"true"===e||"false"!==e&&void 0}function C(e,t){if(e){try{return JSON.parse(t)}catch(n){}return t}}async function b(){if(void 0===navigator.mediaDevices)return[];try{return await navigator.mediaDevices.enumerateDevices()}catch(e){}return[]}function y(e){return"preparing"===e||"connected"===e||"connecting"===e}function S(e){return{id:e.id,label:e.label,kind:e.kind,enabled:e.enabled,muted:e.muted,readyState:e.readyState,contentHint:e.contentHint,getConstraints:e.getConstraints(),getCapabilities:e.getCapabilities?e.getCapabilities():null,getSettings:e.getSettings()}}function k(e){const t={audio:e.audio,video:e.video};if(!("recvonly"===e.role&&("true"===e.multistream||""===e.multistream))){e.audioCodecType&&(t.audioCodecType=e.audioCodecType);const n=parseInt(e.audioBitRate,10);n&&(t.audioBitRate=n),e.videoCodecType&&(t.videoCodecType=e.videoCodecType);const a=parseInt(e.videoBitRate,10);a&&(t.videoBitRate=a),e.enabledVideoVP9Params&&(t.videoVP9Params=C(!0,e.videoVP9Params)),e.enabledVideoH264Params&&(t.videoH264Params=C(!0,e.videoH264Params)),e.enabledVideoAV1Params&&(t.videoAV1Params=C(!0,e.videoAV1Params)),e.enabledAudioStreamingLanguageCode&&(t.audioStreamingLanguageCode=e.audioStreamingLanguageCode),e.audioLyraParamsBitrate&&(t.audioLyraParamsBitrate=parseInt(e.audioLyraParamsBitrate,10))}const n=j(e.multistream);void 0!==n&&(t.multistream=n),e.e2ee&&(t.e2ee=!0);const a=j(e.spotlight);void 0!==a&&(t.spotlight=a,!0===a&&(e.spotlightNumber&&(t.spotlightNumber=parseInt(e.spotlightNumber)),e.spotlightFocusRid&&(t.spotlightFocusRid=e.spotlightFocusRid),e.spotlightUnfocusRid&&(t.spotlightUnfocusRid=e.spotlightUnfocusRid)));const s=j(e.simulcast);if(void 0!==s&&(t.simulcast=s,!0===s&&e.simulcastRid&&(t.simulcastRid=e.simulcastRid)),e.enabledSignalingNotifyMetadata&&(t.signalingNotifyMetadata=C(!0,e.signalingNotifyMetadata)),e.enabledForwardingFilter&&(t.forwardingFilter=C(!0,e.forwardingFilter)),e.enabledBundleId&&(t.bundleId=e.bundleId),e.enabledClientId&&(t.clientId=e.clientId),e.enabledDataChannel){const n=j(e.dataChannelSignaling);void 0!==n&&(t.dataChannelSignaling=n);const a=j(e.ignoreDisconnectWebSocket);void 0!==a&&(t.ignoreDisconnectWebSocket=a)}if(""!==e.dataChannels){let n=[];try{n=JSON.parse(e.dataChannels)}catch(i){console.warn("Illegal format DataChannels")}Array.isArray(n)&&(t.dataChannels=n)}return t}var N=n(9360);const w=()=>async(e,t)=>{e(N.slice.actions.resetState());const n=function(){const e=e=>{if("string"===typeof e)return e},t=e=>{if("string"===typeof e)return j(e)},n=(e,t)=>{if(g(e,t))return e},a=l.Z.parse(location.search);let s;if("string"===typeof a.signalingUrlCandidates)try{s=JSON.parse(a.signalingUrlCandidates)}catch(o){}const i={apiUrl:e(a.apiUrl),audio:t(a.audio),audioBitRate:n(a.audioBitRate,d.xR),audioCodecType:n(a.audioCodecType,d.o1),audioStreamingLanguageCode:e(a.audioStreamingLanguageCode),autoGainControl:n(a.autoGainControl,d.iN),bundleId:e(a.bundleId),channelId:e(a.channelId),clientId:e(a.clientId),googCpuOveruseDetection:t(a.googCpuOveruseDetection),debug:t(a.debug),debugType:n(a.debugType,d.aF),displayResolution:n(a.displayResolution,d.hJ),e2ee:t(a.e2ee),echoCancellation:n(a.echoCancellation,d.PS),echoCancellationType:n(a.echoCancellationType,d.cJ),noiseSuppression:n(a.noiseSuppression,d.ad),facingMode:n(a.facingMode,d.pT),fakeVolume:e(a.fakeVolume),frameRate:n(a.frameRate,d.YX),mediaType:n(a.mediaType,d.w_),metadata:e(a.metadata),showStats:t(a.showStats),signalingNotifyMetadata:e(a.signalingNotifyMetadata),signalingUrlCandidates:Array.isArray(s)?s:void 0,forwardingFilter:e(a.forwardingFilter),simulcast:n(a.simulcast,d.VE),simulcastRid:n(a.simulcastRid,d.WJ),spotlight:n(a.spotlight,d.VJ),spotlightNumber:n(a.spotlightNumber,d.Xr),spotlightFocusRid:n(a.spotlightFocusRid,d.I7),spotlightUnfocusRid:n(a.spotlightUnfocusRid,d.I7),resolution:n(a.resolution,d.Vf),video:t(a.video),videoBitRate:n(a.videoBitRate,d.Q5),videoCodecType:n(a.videoCodecType,d.Sh),videoVP9Params:e(a.videoVP9Params),videoH264Params:e(a.videoH264Params),videoAV1Params:e(a.videoAV1Params),audioInput:e(a.audioInput),videoInput:e(a.videoInput),audioOutput:e(a.audioOutput),mute:t(a.mute),dataChannelSignaling:n(a.dataChannelSignaling,d.l9),ignoreDisconnectWebSocket:n(a.ignoreDisconnectWebSocket,d.kt),micDevice:t(a.micDevice),cameraDevice:t(a.cameraDevice),audioTrack:t(a.audioTrack),videoTrack:t(a.videoTrack),dataChannels:e(a.dataChannels),reconnect:t(a.reconnect),audioContentHint:n(a.audioContentHint,d.nT),videoContentHint:n(a.videoContentHint,d.QO),aspectRatio:n(a.aspectRatio,d.Ii),resizeMode:n(a.resizeMode,d.L4),blurRadius:n(a.blurRadius,d.G_),lightAdjustment:n(a.lightAdjustment,d.Xv),mediaProcessorsNoiseSuppression:t(a.mediaProcessorsNoiseSuppression),multistream:n(a.multistream,d.u9),role:n(a.role,d.K$),audioLyraParamsBitrate:n(a.audioLyraParamsBitrate,d.ms)};return Object.keys(i).map((e=>{void 0===i[e]&&delete i[e]})),i}();void 0!==n.audio&&e(N.slice.actions.setAudio(n.audio)),void 0!==n.audioBitRate&&e(N.slice.actions.setAudioBitRate(n.audioBitRate)),void 0!==n.audioCodecType&&e(N.slice.actions.setAudioCodecType(n.audioCodecType));const a=await b(),s=a.find((e=>"audioinput"===e.kind&&e.deviceId===n.audioInput));void 0!==s&&e(N.slice.actions.setAudioInput(s.deviceId));const i=a.find((e=>"audiooutput"===e.kind&&e.deviceId===n.audioOutput));void 0!==i&&e(N.slice.actions.setAudioOutput(i.deviceId));const o=a.find((e=>"videoinput"===e.kind&&e.deviceId===n.videoInput));void 0!==o&&e(N.slice.actions.setVideoInput(o.deviceId)),void 0!==n.autoGainControl&&e(N.slice.actions.setAutoGainControl(n.autoGainControl)),void 0!==n.channelId&&e(N.slice.actions.setChannelId(n.channelId)),void 0!==n.displayResolution&&e(N.slice.actions.setDisplayResolution(n.displayResolution)),void 0!==n.e2ee&&e(N.slice.actions.setE2EE(n.e2ee)),void 0!==n.echoCancellation&&e(N.slice.actions.setEchoCancellation(n.echoCancellation)),void 0!==n.echoCancellationType&&e(N.slice.actions.setEchoCancellationType(n.echoCancellationType)),void 0!==n.mediaType&&e(N.slice.actions.setMediaType(n.mediaType)),void 0!==n.facingMode&&e(N.slice.actions.setFacingMode(n.facingMode)),void 0!==n.fakeVolume&&e(N.slice.actions.setFakeVolume(n.fakeVolume)),void 0!==n.frameRate&&e(N.slice.actions.setFrameRate(n.frameRate)),void 0!==n.multistream&&e(N.slice.actions.setMultistream(n.multistream)),void 0!==n.noiseSuppression&&e(N.slice.actions.setNoiseSuppression(n.noiseSuppression)),void 0!==n.resolution&&e(N.slice.actions.setResolution(n.resolution)),void 0!==n.showStats&&e(N.slice.actions.setShowStats(n.showStats)),void 0!==n.simulcast&&e(N.slice.actions.setSimulcast(n.simulcast)),void 0!==n.simulcastRid&&e(N.slice.actions.setSimulcastRid(n.simulcastRid)),void 0!==n.spotlight&&e(N.slice.actions.setSpotlight(n.spotlight)),void 0!==n.spotlightNumber&&e(N.slice.actions.setSpotlightNumber(n.spotlightNumber)),void 0!==n.spotlightFocusRid&&e(N.slice.actions.setSpotlightFocusRid(n.spotlightFocusRid)),void 0!==n.spotlightUnfocusRid&&e(N.slice.actions.setSpotlightUnfocusRid(n.spotlightUnfocusRid)),void 0!==n.video&&e(N.slice.actions.setVideo(n.video)),void 0!==n.videoBitRate&&e(N.slice.actions.setVideoBitRate(n.videoBitRate)),void 0!==n.videoCodecType&&e(N.slice.actions.setVideoCodecType(n.videoCodecType)),void 0!==n.videoVP9Params&&e(N.slice.actions.setVideoVP9Params(n.videoVP9Params)),void 0!==n.videoH264Params&&e(N.slice.actions.setVideoH264Params(n.videoH264Params)),void 0!==n.videoAV1Params&&e(N.slice.actions.setVideoAV1Params(n.videoAV1Params)),void 0!==n.debug&&e(N.slice.actions.setDebug(n.debug)),void 0!==n.debugType&&e(N.slice.actions.setDebugType(n.debugType)),void 0!==n.mute&&e(N.slice.actions.setMute(n.mute)),void 0!==n.dataChannelSignaling&&e(N.slice.actions.setDataChannelSignaling(n.dataChannelSignaling)),void 0!==n.ignoreDisconnectWebSocket&&e(N.slice.actions.setIgnoreDisconnectWebSocket(n.ignoreDisconnectWebSocket)),void 0!==n.micDevice&&e(N.slice.actions.setMicDevice(n.micDevice)),void 0!==n.cameraDevice&&e(N.slice.actions.setCameraDevice(n.cameraDevice)),void 0!==n.audioTrack&&e(N.slice.actions.setAudioTrack(n.audioTrack)),void 0!==n.videoTrack&&e(N.slice.actions.setVideoTrack(n.videoTrack)),void 0!==n.googCpuOveruseDetection&&null!==n.googCpuOveruseDetection&&e(N.slice.actions.setGoogCpuOveruseDetection(n.googCpuOveruseDetection)),void 0!==n.bundleId&&e(N.slice.actions.setBundleId(n.bundleId)),void 0!==n.clientId&&e(N.slice.actions.setClientId(n.clientId)),void 0!==n.metadata&&e(N.slice.actions.setMetadata(n.metadata)),void 0!==n.signalingNotifyMetadata&&e(N.slice.actions.setSignalingNotifyMetadata(n.signalingNotifyMetadata)),void 0!==n.signalingUrlCandidates&&e(N.slice.actions.setSignalingUrlCandidates(n.signalingUrlCandidates)),void 0!==n.forwardingFilter&&e(N.slice.actions.setForwardingFilter(n.forwardingFilter)),void 0!==n.dataChannels&&e(N.slice.actions.setDataChannels(n.dataChannels)),void 0!==n.audioContentHint&&e(N.slice.actions.setAudioContentHint(n.audioContentHint)),void 0!==n.videoContentHint&&e(N.slice.actions.setVideoContentHint(n.videoContentHint)),void 0!==n.reconnect&&e(N.slice.actions.setReconnect(n.reconnect)),void 0!==n.aspectRatio&&e(N.slice.actions.setAspectRatio(n.aspectRatio)),void 0!==n.resizeMode&&e(N.slice.actions.setResizeMode(n.resizeMode)),void 0!==n.blurRadius&&e(N.slice.actions.setBlurRadius(n.blurRadius)),void 0!==n.lightAdjustment&&e(N.slice.actions.setLightAdjustment(n.lightAdjustment)),void 0!==n.mediaProcessorsNoiseSuppression&&e(N.slice.actions.setMediaProcessorsNoiseSuppression(n.mediaProcessorsNoiseSuppression)),void 0!==n.apiUrl&&null!==n.apiUrl&&e(N.slice.actions.setApiUrl(n.apiUrl)),void 0!==n.role&&e(N.slice.actions.setRole(n.role)),void 0!==n.audioStreamingLanguageCode&&e(N.slice.actions.setAudioStreamingLanguageCode(n.audioStreamingLanguageCode)),void 0!==n.audioLyraParamsBitrate&&e(N.slice.actions.setAudioLyraParamsBitrate(n.audioLyraParamsBitrate)),e(N.slice.actions.setInitialFakeContents());const{audioStreamingLanguageCode:r,bundleId:u,clientId:m,dataChannelSignaling:h,dataChannels:p,e2ee:v,ignoreDisconnectWebSocket:x,metadata:f,signalingNotifyMetadata:C,signalingUrlCandidates:y,forwardingFilter:S,videoVP9Params:k,videoH264Params:w,videoAV1Params:T}=t();if(v){const t="Faild to execute WebAssembly '".concat("https://sora-e2ee-wasm.shiguredo.app/2020.2/wasm.wasm","'.");0;try{await c.Z.initE2EE("https://sora-e2ee-wasm.shiguredo.app/2020.2/wasm.wasm")}catch(I){return void e(N.slice.actions.setSoraErrorAlertMessage(t))}}""!==u&&e(N.slice.actions.setEnabledBundleId(!0)),""!==m&&e(N.slice.actions.setEnabledClientId(!0)),""!==f&&e(N.slice.actions.setEnabledMetadata(!0)),""!==C&&e(N.slice.actions.setEnabledSignalingNotifyMetadata(!0)),0<y.length&&e(N.slice.actions.setEnabledSignalingUrlCandidates(!0)),""!==S&&e(N.slice.actions.setEnabledForwardingFilter(!0)),""===h&&""===x||e(N.slice.actions.setEnabledDataChannel(!0)),""!==p&&e(N.slice.actions.setEnabledDataChannels(!0)),""!==r&&e(N.slice.actions.setEnabledAudioStreamingLanguageCode(!0)),""!==k&&e(N.slice.actions.setEnabledVideoVP9Params(!0)),""!==w&&e(N.slice.actions.setEnabledVideoH264Params(!0)),""!==T&&e(N.slice.actions.setEnabledVideoAV1Params(!0)),e(N.slice.actions.setSoraConnectionStatus("disconnected"))};async function T(e,t){const n="MEDIA_CONSTRAINTS";if("getDisplayMedia"===t.mediaType){if(!t.video||!t.cameraDevice)return[new MediaStream,null];if(void 0===navigator.mediaDevices)throw new Error("Failed to call getUserMedia. Make sure domain is secure");const a=f({frameRate:t.frameRate,resolution:t.resolution,aspectRatio:t.aspectRatio,resizeMode:t.resizeMode});e(N.slice.actions.setLogMessages({title:n,description:JSON.stringify(a)})),e(N.slice.actions.setTimelineMessage(R("media-constraints",a)));const s=await navigator.mediaDevices.getDisplayMedia(a);e(N.slice.actions.setTimelineMessage(R("succeed-get-display-media")));for(const n of s.getVideoTracks())void 0!==n.contentHint&&(n.contentHint=t.videoContentHint),n.enabled=t.videoTrack,e(N.slice.actions.setTimelineMessage(P("start",n)));return[s,null]}if("mediacaptureRegion"===t.mediaType){if(!t.video||!t.cameraDevice)return[new MediaStream,null];if(void 0===window.CropTarget)throw new Error("Failed to call CropTarget");if(void 0===navigator.mediaDevices)throw new Error("Failed to call getDisplayMedia. Make sure domain is secure");const a=f({frameRate:t.frameRate,resolution:t.resolution,aspectRatio:t.aspectRatio,resizeMode:t.resizeMode});a.preferCurrentTab=!0,e(N.slice.actions.setLogMessages({title:n,description:JSON.stringify(a)})),e(N.slice.actions.setTimelineMessage(R("media-constraints",a)));const s=await navigator.mediaDevices.getDisplayMedia(a),i=document.querySelector("#cropArea");if(null===i)throw new Error("Failed to get CropTraget Element");const o=await window.CropTarget.fromElement(i);e(N.slice.actions.setTimelineMessage(R("succeed-get-display-media")));for(const n of s.getVideoTracks())void 0!==n.contentHint&&(n.contentHint=t.videoContentHint),n.enabled=t.videoTrack,await n.cropTo(o),e(N.slice.actions.setTimelineMessage(P("start",n)));return[s,null]}if("fakeMedia"===t.mediaType&&t.fakeContents.worker){const a=function(e){const{audio:t,video:n,frameRate:a,resolution:s,volume:i,aspectRatio:o,resizeMode:r}=e,c=parseInt(a,10)||30,l=p(s),d=l.width||240,u={audio:t,video:n,frameRate:c,width:d,height:l.height||160,fontSize:Math.floor(d/5),volume:parseFloat(i)};return n&&(o||r)&&(u.videoTrackConstraints={},o&&(u.videoTrackConstraints.aspectRatio=v(o)),r&&(u.videoTrackConstraints.resizeMode=r)),u}({audio:t.audio&&t.micDevice,video:t.video&&t.cameraDevice,frameRate:t.frameRate,resolution:t.resolution,volume:t.fakeVolume,aspectRatio:t.aspectRatio,resizeMode:t.resizeMode});e(N.slice.actions.setLogMessages({title:n,description:JSON.stringify(a)})),e(N.slice.actions.setTimelineMessage(R("media-constraints",a)));const{canvas:s,mediaStream:i,gainNode:o}=function(e){const t=new MediaStream;let n=null;if(e.video){n=document.createElement("canvas"),n.getContext("2d"),n.width=e.width,n.height=e.height;const a=n.captureStream(e.frameRate).getTracks()[0];e.videoTrackConstraints&&a.applyConstraints(e.videoTrackConstraints),t.addTrack(a)}let a=null;if(e.audio){const n=new(window.AudioContext||window.webkitAudioContext),s=n.createOscillator(),i="sine";s.type=i,a=n.createGain(),s.connect(a),s.start(0);const o=n.createMediaStreamDestination();a.connect(o);const r=o.stream.getTracks();t.addTrack(r[0]),a.gain.setValueAtTime(e.volume,0)}return{canvas:n,mediaStream:t,gainNode:a}}(a);null!==s&&(t.fakeContents.worker.onmessage=e=>{const n=e.data;"update"===n.type&&function(e,t,n,a){if(null===e)return;const s=e.getContext("2d");if(!s)return;s.globalCompositeOperation="source-over",s.clearRect(0,0,e.width,e.height),s.fillStyle="#"+("0".repeat(6)+t.toString(16)).slice(-6),s.fillRect(0,0,e.width,e.height),s.fillStyle="#"+("0".repeat(6)+(16777215-t).toString(16)).slice(-6),s.font="".concat(n,"px Arial");const i=e.width/2-n/2,o=n/4*(a.length-1),r=e.height/2+n/2.5;s.fillText(a,i-o,r)}(s,t.fakeContents.colorCode,a.fontSize,n.counter.toString())},t.fakeContents.worker.postMessage({type:"stop"}),t.fakeContents.worker.postMessage({type:"start",interval:1e3/a.frameRate}));for(const n of i.getVideoTracks())void 0!==n.contentHint&&(n.contentHint=t.videoContentHint),n.enabled=t.videoTrack,e(N.slice.actions.setTimelineMessage(P("start",n)));for(const n of i.getAudioTracks())void 0!==n.contentHint&&(n.contentHint=t.audioContentHint),n.enabled=t.audioTrack,e(N.slice.actions.setTimelineMessage(P("start",n)));return e(N.slice.actions.setTimelineMessage(R("succeed-create-fake-media"))),[i,o]}if(void 0===navigator.mediaDevices)throw new Error("Failed to call getUserMedia. Make sure domain is secure");const a=new MediaStream,s=function(e){const{audio:t,autoGainControl:n,noiseSuppression:a,echoCancellation:s,echoCancellationType:i,audioInput:o}=e;if(!t)return!1;if(!n&&!a&&!s&&!i&&!o)return t;const r={};o&&(r.deviceId={exact:o});const c=j(n);void 0!==c&&(r.autoGainControl=c);const l=j(a);void 0!==l&&(r.noiseSuppression=l);const d=j(s);return void 0!==d&&(r.echoCancellation=d),i&&(r.echoCancellationType=i),r}({audio:t.audio&&t.micDevice,autoGainControl:t.autoGainControl,noiseSuppression:t.noiseSuppression,echoCancellation:t.echoCancellation,echoCancellationType:t.echoCancellationType,audioInput:t.audioInput});if(s){e(N.slice.actions.setLogMessages({title:n,description:JSON.stringify({audio:s})})),e(N.slice.actions.setTimelineMessage(R("audio-media-constraints",{audio:s})));let i=(await navigator.mediaDevices.getUserMedia({audio:s})).getAudioTracks()[0];if(e(N.slice.actions.setTimelineMessage(P("start",i))),t.mediaProcessorsNoiseSuppression&&o.b.isSupported()){if(null===t.noiseSuppressionProcessor)throw new Error("Failed to start NoiseSuppressionProcessor. NoiseSuppressionProcessor is 'null'");t.noiseSuppressionProcessor.stopProcessing(),i=await t.noiseSuppressionProcessor.startProcessing(i)}e(N.slice.actions.setTimelineMessage(R("succeed-audio-get-user-media"))),a.addTrack(i)}const c=function(e){const{video:t,frameRate:n,resolution:a,videoInput:s,aspectRatio:i,resizeMode:o,facingMode:r}=e;if(!t)return!1;if(!n&&!a&&!s&&!i&&!o&&!r)return t;const c={};if(n&&(c.frameRate={min:parseInt(n,10),max:parseInt(n,10)}),a){const{width:e,height:t}=p(a);0<e&&0<t&&(c.width={exact:e},c.height={exact:t})}return s&&(c.deviceId={exact:s}),i&&(c.aspectRatio=v(i)),o&&(c.resizeMode=o),"front"===r?c.facingMode="user":"back"===r&&(c.facingMode={exact:"environment"}),c}({aspectRatio:t.aspectRatio,frameRate:t.frameRate,resizeMode:t.resizeMode,resolution:t.resolution,video:t.video&&t.cameraDevice,videoInput:t.videoInput,facingMode:t.facingMode});if(c){e(N.slice.actions.setLogMessages({title:n,description:JSON.stringify({video:c})})),e(N.slice.actions.setTimelineMessage(R("video-media-constraints",{video:c})));let s=(await navigator.mediaDevices.getUserMedia({video:c}).catch((e=>{throw a.getTracks().forEach((e=>{e.stop()})),e}))).getVideoTracks()[0];if(e(N.slice.actions.setTimelineMessage(P("start",s))),""!==t.lightAdjustment&&i.jA.isSupported()){if(null===t.lightAdjustmentProcessor)throw new Error("Failed to start LightAdjustmentProcessor. LightAdjustmentProcessor is 'null'");const e=function(e){switch(e){case"weak":return{adjustmentLevel:30,sharpnessLevel:0};case"medium":{const e="https://cdn.jsdelivr.net/npm/@shiguredo/light-adjustment@latest/dist";return{adjustmentLevel:50,sharpnessLevel:10,focusMask:new i.MH(e)}}case"strong":{const e="https://cdn.jsdelivr.net/npm/@shiguredo/light-adjustment@latest/dist";return{adjustmentLevel:70,sharpnessLevel:20,minIntensity:10,focusMask:new i.MH(e)}}default:return{}}}(t.lightAdjustment);t.lightAdjustmentProcessor.stopProcessing(),s=await t.lightAdjustmentProcessor.startProcessing(s,e)}if(""!==t.blurRadius&&r.sz.isSupported()){if(null===t.virtualBackgroundProcessor)throw new Error("Failed to start VirtualBackgroundProcessor. VirtualBackgroundProcessor is 'null'");const e={blurRadius:x(t.blurRadius)};t.virtualBackgroundProcessor.stopProcessing(),s=await t.virtualBackgroundProcessor.startProcessing(s,e)}e(N.slice.actions.setTimelineMessage(R("succeed-video-get-user-media"))),a.addTrack(s)}for(const i of a.getVideoTracks())void 0!==i.contentHint&&(i.contentHint=t.videoContentHint),i.enabled=t.videoTrack;for(const i of a.getAudioTracks())void 0!==i.contentHint&&(i.contentHint=t.audioContentHint),i.enabled=t.audioTrack;return[a,null]}function I(e,t,n){n.on("log",((t,n)=>{e(N.slice.actions.setLogMessages({title:t,description:JSON.stringify(n)}))})),n.on("notify",((t,n)=>{"spotlight.focused"===t.event_type&&"string"===typeof t.connection_id&&e(N.slice.actions.setFocusedSpotlightConnectionId(t.connection_id)),"spotlight.unfocused"===t.event_type&&"string"===typeof t.connection_id&&e(N.slice.actions.setUnFocusedSpotlightConnectionId(t.connection_id)),"connection.destroyed"===t.event_type&&"string"===typeof t.connection_id&&e(N.slice.actions.deleteFocusedSpotlightConnectionId(t.connection_id)),e(N.slice.actions.setNotifyMessages({timestamp:(new Date).getTime(),message:t,transportType:n}))})),n.on("push",((t,n)=>{e(N.slice.actions.setPushMessages({timestamp:(new Date).getTime(),message:t,transportType:n}))})),n.on("track",(n=>{e(N.slice.actions.setTimelineMessage(R("event-on-track")));const{soraContents:a}=t();if(!a.remoteMediaStreams.find((e=>e.id===n.streams[0].id))){for(const t of n.streams[0].getTracks())e(N.slice.actions.setTimelineMessage(R("remote-".concat(t.kind,"-mediastream-track"),S(t))));e(N.slice.actions.setRemoteMediaStream(n.streams[0]))}})),n.on("removetrack",(n=>{e(N.slice.actions.setTimelineMessage(R("event-on-removetrack")));const{soraContents:a}=t();a.remoteMediaStreams.find((e=>{if(null===n||void 0===n?void 0:n.target)return e.id===n.target.id}))&&e(N.slice.actions.removeRemoteMediaStream(n.target.id))})),n.on("disconnect",(async n=>{const a={type:n.type,title:n.title};void 0!==n.code&&(a.code=n.code),void 0!==n.reason&&(a.reason=n.reason),void 0!==n.params&&(a.params=n.params),e(N.slice.actions.setTimelineMessage(R("event-on-disconnect",a))),await F(e,t()),E(e,t());const{fakeContents:s,soraContents:i,reconnect:o}=t(),{remoteMediaStreams:r}=i;r.forEach((e=>{e.getTracks().forEach((e=>{e.stop()}))})),s.worker&&s.worker.postMessage({type:"stop"}),e(N.slice.actions.setSora(null)),e(N.slice.actions.setSoraConnectionStatus("disconnected")),e(N.slice.actions.setLocalMediaStream(null)),e(N.slice.actions.removeAllRemoteMediaStreams()),e(N.slice.actions.setSoraInfoAlertMessage("Disconnect Sora.")),e(N.slice.actions.setTimelineMessage(R("disconnected"))),"abend"===n.type&&o&&e(N.slice.actions.setSoraReconnecting(!0))})),n.on("timeline",(t=>{const n={timestamp:(new Date).getTime(),type:t.type,data:t.data,dataChannelId:t.dataChannelId,dataChannelLabel:t.dataChannelLabel,logType:t.logType};e(N.slice.actions.setTimelineMessage(n)),t.data&&"object"===typeof t.data&&"sdp"in t.data&&e(N.slice.actions.setTimelineMessage(R("".concat(t.type,"-sdp"),t.data.sdp)))})),n.on("signaling",(t=>{const n={timestamp:(new Date).getTime(),transportType:t.transportType,type:t.type,data:t.data};e(N.slice.actions.setSignalingMessage(n))})),n.on("message",(t=>{e(N.slice.actions.setDataChannelMessage({timestamp:(new Date).getTime(),label:t.label,data:t.data}))})),n.on("datachannel",(t=>{e(N.slice.actions.setSoraDataChannels(t.datachannel))}))}function M(e){return{audio:e.audio,audioBitRate:e.audioBitRate,audioCodecType:e.audioCodecType,audioStreamingLanguageCode:e.audioStreamingLanguageCode,bundleId:e.bundleId,clientId:e.clientId,dataChannelSignaling:e.dataChannelSignaling,dataChannels:e.enabledDataChannels?e.dataChannels:"",e2ee:e.e2ee,enabledAudioStreamingLanguageCode:e.enabledAudioStreamingLanguageCode,enabledBundleId:e.enabledBundleId,enabledClientId:e.enabledClientId,enabledDataChannel:e.enabledDataChannel,enabledSignalingNotifyMetadata:e.enabledSignalingNotifyMetadata,enabledForwardingFilter:e.enabledForwardingFilter,enabledVideoVP9Params:e.enabledVideoVP9Params,enabledVideoH264Params:e.enabledVideoH264Params,enabledVideoAV1Params:e.enabledVideoAV1Params,ignoreDisconnectWebSocket:e.ignoreDisconnectWebSocket,audioLyraParamsBitrate:e.audioLyraParamsBitrate,multistream:e.multistream,signalingNotifyMetadata:e.signalingNotifyMetadata,forwardingFilter:e.forwardingFilter,simulcast:e.simulcast,simulcastRid:e.simulcastRid,spotlight:e.spotlight,spotlightFocusRid:e.spotlightFocusRid,spotlightNumber:e.spotlightNumber,spotlightUnfocusRid:e.spotlightUnfocusRid,video:e.video,videoBitRate:e.videoBitRate,videoCodecType:e.videoCodecType,videoVP9Params:e.videoVP9Params,videoH264Params:e.videoH264Params,videoAV1Params:e.videoAV1Params,role:e.role}}function R(e,t){return{type:e,logType:"sora-devtools",timestamp:(new Date).getTime(),data:t}}function P(e,t){const n=S(t);return R("".concat(e,"-").concat(t.kind,"-mediastream-track"),n)}async function Z(e,t){var n;if(t.pc&&"closed"!==(null===(n=t.pc)||void 0===n?void 0:n.iceConnectionState)){const n=await t.pc.getStats(),a=[];n.forEach((e=>{a.push(e)})),e(N.slice.actions.setStatsReport(a))}}const V=()=>async(e,t)=>{const{soraContents:n}=t();n.sora&&(e(N.slice.actions.setSoraConnectionStatus("disconnecting")),await n.sora.disconnect(),e(N.slice.actions.setSoraConnectionStatus("disconnected")))},A=()=>async(e,t)=>{const n=await b(),a=[],s=[],i=[];n.forEach((e=>{""!==e.deviceId&&("audioinput"===e.kind?a.push(e.toJSON()):"audiooutput"===e.kind?i.push(e.toJSON()):"videoinput"===e.kind&&s.push(e.toJSON()))})),e(N.slice.actions.setAudioInputDevices(a)),e(N.slice.actions.setVideoInputDevices(s)),e(N.slice.actions.setAudioOutputDevices(i))},D=()=>async(e,t)=>{const n=t();if(!n.soraContents.localMediaStream)return;if(n.virtualBackgroundProcessor&&n.virtualBackgroundProcessor.isProcessing()){const t=n.virtualBackgroundProcessor.getOriginalTrack();t&&(t.stop(),e(N.slice.actions.setTimelineMessage(P("stop",t)))),n.virtualBackgroundProcessor.stopProcessing()}else n.soraContents.localMediaStream&&n.soraContents.localMediaStream.getVideoTracks().forEach((t=>{t.stop(),e(N.slice.actions.setTimelineMessage(P("stop",t)))}));if(n.noiseSuppressionProcessor&&n.noiseSuppressionProcessor.isProcessing()){const t=n.noiseSuppressionProcessor.getOriginalTrack();t&&(t.stop(),e(N.slice.actions.setTimelineMessage(P("stop",t)))),n.noiseSuppressionProcessor.stopProcessing()}else n.soraContents.localMediaStream&&n.soraContents.localMediaStream.getAudioTracks().forEach((t=>{t.stop(),e(N.slice.actions.setTimelineMessage(P("stop",t)))}));const[a,s]=await T(e,n).catch((t=>{throw e(N.slice.actions.setSoraErrorAlertMessage(t.toString())),e(N.slice.actions.setSoraConnectionStatus("disconnected")),t}));a.getTracks().forEach((e=>{if(!n.soraContents.sora||!n.soraContents.sora.pc)return;const t=n.soraContents.sora.pc.getSenders().find((t=>!!t.track&&t.track.kind===e.kind));t&&t.replaceTrack(e)})),e(N.slice.actions.setLocalMediaStream(a)),e(N.slice.actions.setFakeContentsGainNode(s))},F=async(e,t)=>{let{soraContents:n,lightAdjustmentProcessor:a,virtualBackgroundProcessor:s}=t;const{localMediaStream:i}=n;let o;if(a&&a.isProcessing()&&(o=a.getOriginalTrack(),a.stopProcessing()),s&&s.isProcessing()&&(void 0===o&&(o=s.getOriginalTrack()),s.stopProcessing()),void 0!==o)o.enabled=!1,await new Promise((e=>setTimeout(e,100))),o.stop(),null===i||void 0===i||i.removeTrack(o),e(N.slice.actions.setTimelineMessage(P("stop",o)));else{if(!i)return;i.getVideoTracks().forEach((e=>{e.enabled=!1})),await new Promise((e=>setTimeout(e,100))),i.getVideoTracks().forEach((t=>{t.stop(),i.removeTrack(t),e(N.slice.actions.setTimelineMessage(P("stop",t)))}))}},E=(e,t)=>{let{soraContents:n,noiseSuppressionProcessor:a}=t;const{localMediaStream:s}=n;if(a&&a.isProcessing()){const t=a.getOriginalTrack();t&&(t.stop(),null===s||void 0===s||s.removeTrack(t),e(N.slice.actions.setTimelineMessage(P("stop",t)))),a.stopProcessing()}else s&&s.getAudioTracks().forEach((t=>{t.stop(),s.removeTrack(t),e(N.slice.actions.setTimelineMessage(P("stop",t)))}))},{clearDataChannelMessages:O,deleteAlertMessage:B,setAPIErrorAlertMessage:H,setAPIInfoAlertMessage:L,setAspectRatio:U,setAudio:_,setAudioBitRate:J,setAudioCodecType:z,setAudioContentHint:G,setAudioInput:W,setAudioOutput:K,setAudioTrack:q,setAutoGainControl:X,setBlurRadius:Q,setBundleId:$,setChannelId:Y,setClientId:ee,setDataChannels:te,setDataChannelSignaling:ne,setDebug:ae,setDebugFilterText:se,setDebugType:ie,setDisplayResolution:oe,setEchoCancellation:re,setEchoCancellationType:ce,setEnabledBundleId:le,setEnabledClientId:de,setEnabledDataChannels:ue,setEnabledDataChannel:me,setEnabledForwardingFilter:ge,setEnabledMetadata:he,setEnabledSignalingNotifyMetadata:pe,setEnabledSignalingUrlCandidates:ve,setEnabledVideoVP9Params:xe,setEnabledVideoH264Params:fe,setEnabledVideoAV1Params:je,setAudioStreamingLanguageCode:Ce,setEnabledAudioStreamingLanguageCode:be,setFakeVolume:ye,setFacingMode:Se,setFrameRate:ke,setIgnoreDisconnectWebSocket:Ne,setLightAdjustment:we,setLocalMediaStream:Te,setLogMessages:Ie,setAudioLyraParamsBitrate:Me,setMediaProcessorsNoiseSuppression:Re,setMediaType:Pe,setMetadata:Ze,setMultistream:Ve,setNoiseSuppression:Ae,setNotifyMessages:De,setReconnect:Fe,setResizeMode:Ee,setRole:Oe,setResolution:Be,setSignalingNotifyMetadata:He,setSignalingUrlCandidates:Le,setForwardingFilter:Ue,setSimulcast:_e,setSimulcastRid:Je,setSora:ze,setSoraReconnecting:Ge,setSoraErrorAlertMessage:We,setSoraInfoAlertMessage:Ke,setSpotlight:qe,setSpotlightFocusRid:Xe,setSpotlightNumber:Qe,setSpotlightUnfocusRid:$e,setVideo:Ye,setVideoBitRate:et,setVideoCodecType:tt,setVideoContentHint:nt,setVideoInput:at,setVideoTrack:st,setVideoVP9Params:it,setVideoH264Params:ot,setVideoAV1Params:rt}=N.slice.actions;var ct=n(1698);const lt=()=>(0,ct.I0)(),dt=ct.v9;var ut=n(5567),mt=n(7112),gt=n(1457);const ht=()=>(0,a.jsxs)("svg",{width:"1em",height:"1em",viewBox:"0 0 16 16",className:"bi bi-clipboard",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:[(0,a.jsx)("path",{fillRule:"evenodd",d:"M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"}),(0,a.jsx)("path",{fillRule:"evenodd",d:"M9.5 1h-3a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"})]}),pt=e=>e.disabled?(0,a.jsx)("div",{style:{height:"31px"}}):(0,a.jsx)("button",{className:"btn btn-sm btn-dark",onClick:t=>{m(e.text),t.currentTarget.blur()},children:(0,a.jsx)(ht,{})}),vt=e=>{const{description:t}=e;return void 0===t?null:"object"!==typeof t?(0,a.jsx)("div",{className:"debug-message",children:(0,a.jsx)("div",{className:"col-sm-12",children:(0,a.jsx)("pre",{className:e.wordBreak?"word-break":"",children:t})})}):(0,a.jsx)("div",{className:"debug-message",children:(0,a.jsx)("div",{className:"col-sm-12",children:(0,a.jsx)("pre",{className:e.wordBreak?"word-break":"",children:JSON.stringify(t,null,2)})})})},xt=e=>{const{defaultShow:t,description:n,title:i,timestamp:o,label:r}=e,[c,l]=(0,s.useState)(void 0!==t&&t),d=o?i+o:i,m=void 0===n;return(0,a.jsxs)("div",{className:"border border-light rounded mb-1 bg-dark","data-title":i,children:[(0,a.jsxs)("div",{className:"d-flex justify-content-between align-items-center text-break",children:[(0,a.jsxs)("a",{className:"debug-title ".concat(m?"disabled":""),onClick:()=>l(!c),"aria-controls":d,"aria-expanded":c,children:[(0,a.jsx)("i",{className:"".concat(c?"arrow-bottom":"arrow-right"," ").concat(m?"disabled":"")})," ",o?(0,a.jsxs)("span",{className:"text-white-50 me-1",children:["[",u(o),"]"]}):null,r,(0,a.jsx)("span",{children:i})]}),(0,a.jsx)("div",{className:"border-left",children:(0,a.jsx)(pt,{text:"string"===typeof n?n:JSON.stringify(n,null,2),disabled:m})})]}),(0,a.jsx)(gt.Z,{in:c,children:(0,a.jsx)("div",{className:"border-top",children:(0,a.jsx)(vt,{description:n,wordBreak:e.wordBreak})})})]})},ft=()=>{const e=lt();return(0,a.jsx)("input",{className:"btn btn-secondary",type:"button",name:"clear",defaultValue:"clear",onClick:()=>{e(O())}})},jt=e=>{const{data:t,label:n,timestamp:s}=e;if("ZAKURO"===(new TextDecoder).decode(t.slice(0,6))){const e=(new TextDecoder).decode(t.slice(22,48)),i=new DataView(t),o=i.getBigInt64(6),r=i.getBigInt64(14),c=t.byteLength,l="connectionId: ".concat(e,"\nUnixTimeMicro: ").concat(o,"\nCounter: ").concat(r,"\nByteLength: ").concat(c);return(0,a.jsx)(xt,{title:n+" ZAKURO",timestamp:s,description:l,defaultShow:!0,wordBreak:!0})}const i=new Uint8Array(t).toString()+"\n(".concat((new TextDecoder).decode(t),")");return(0,a.jsx)(xt,{title:n,timestamp:s,description:i,defaultShow:!0,wordBreak:!0})},Ct=s.memo((e=>(0,a.jsx)(jt,{...e}))),bt=()=>{const e=dt((e=>e.dataChannelMessages));return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"py-1",children:(0,a.jsx)(ft,{})}),(0,a.jsx)("div",{className:"debug-messages",children:e.map((e=>{const t=e.label+e.timestamp;return(0,a.jsx)(Ct,{...e},t)}))})]})};var yt=n(6531),St=n(6500),kt=n(3733);const Nt=()=>{const e=dt((e=>e.debugFilterText)),t=lt();return(0,a.jsxs)(St.Z,{className:"form-inline debug-filter",controlId:"channelId",children:[(0,a.jsx)(kt.Z,{className:"text-white",children:"Filter:"}),(0,a.jsx)(yt.Z,{type:"text",placeholder:"Filter",value:e,onChange:e=>{t(se(e.target.value))},autoComplete:"off"})]})},wt=e=>{const{message:t,timestamp:n}=e;return(0,a.jsx)(xt,{title:t.title,timestamp:n,description:JSON.parse(t.description)})},Tt=s.memo((e=>(0,a.jsx)(wt,{...e}))),It=()=>{const e=dt((e=>e.logMessages)),t=dt((e=>e.debugFilterText)),n=e.filter((e=>t.split(" ").every((t=>""===t||0<=JSON.stringify(e).indexOf(t)))));return(0,a.jsx)("div",{className:"debug-messages",children:n.map(((e,t)=>(0,a.jsx)(Tt,{...e},e.message.title+String(t)+e.timestamp)))})},Mt={websocket:"#00ff00",datachannel:"#ff00ff"},Rt=e=>{const{text:t}=e,n=Object.keys(Mt).includes(t)?Mt[t]:void 0;return(0,a.jsxs)("span",{className:"me-1",style:n?{color:n}:{},children:["[",t,"]"]})},Pt=e=>{const{notify:t}=e,n=t.transportType?(0,a.jsx)(Rt,{text:t.transportType}):null;return(0,a.jsx)(xt,{title:t.message.event_type,timestamp:t.timestamp,description:t.message,label:n})},Zt=s.memo((e=>(0,a.jsx)(Pt,{...e}))),Vt=()=>{const e=dt((e=>e.notifyMessages)),t=dt((e=>e.debugFilterText)),n=e.filter((e=>t.split(" ").every((t=>""===t||0<=JSON.stringify(e).indexOf(t)))));return(0,a.jsx)("div",{className:"debug-messages",children:n.map((e=>(0,a.jsx)(Zt,{notify:e},e.message.type+e.timestamp)))})},At={websocket:"#00ff00",datachannel:"#ff00ff"},Dt=e=>{const{text:t}=e,n=Object.keys(At).includes(t)?At[t]:void 0;return(0,a.jsxs)("span",{style:n?{color:n}:{},children:["[",t,"]"]})},Ft=e=>{const{push:t}=e,n=t.transportType?(0,a.jsx)(Dt,{text:t.transportType}):null;return(0,a.jsx)(xt,{title:t.message.type,timestamp:t.timestamp,description:t.message,label:n})},Et=s.memo((e=>(0,a.jsx)(Ft,{...e}))),Ot=()=>{const e=dt((e=>e.pushMessages)),t=dt((e=>e.debugFilterText)),n=e.filter((e=>t.split(" ").every((t=>""===t||0<=JSON.stringify(e).indexOf(t)))));return(0,a.jsx)("div",{className:"debug-messages",children:n.map(((e,t)=>{const n="".concat(e.timestamp,"-").concat(t);return(0,a.jsx)(Et,{ariaControls:n,push:e},n)}))})};var Bt=n(5411),Ht=n(3739);const Lt=()=>{const e=(0,s.useRef)(null),t=(0,s.useRef)(null),n=dt((e=>e.soraContents.sora)),i=dt((e=>e.soraContents.datachannels));return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"d-flex mt-2",children:[(0,a.jsx)(St.Z,{className:"me-1",controlId:"sendDataChannelMessageLabel",children:(0,a.jsx)(Ht.Z,{name:"sendDataChannelMessageLabel",ref:e,children:i.map((e=>(0,a.jsx)("option",{value:e.label,children:e.label},e.label)))})}),(0,a.jsx)(St.Z,{className:"flex-grow-1 me-1",controlId:"sendDataChannelMessage",children:(0,a.jsx)(yt.Z,{className:"flex-fill",placeholder:"sendDataChannelMessage\u3092\u6307\u5b9a",type:"text",ref:t})}),(0,a.jsx)(Bt.Z,{variant:"secondary",onClick:()=>{if(null===e.current||null===t.current)return;const a=e.current.value;n&&n.sendMessage(a,(new TextEncoder).encode(t.current.value))},disabled:0===i.length,children:"send"})]}),0<i.length?(0,a.jsx)("pre",{className:"form-control mt-2",style:{color:"#fff",backgroundColor:"#222222",maxHeight:"250px",minHeight:"250px"},children:JSON.stringify(i,null,2)}):null]})},Ut={websocket:"#00ff00",datachannel:"#ff00ff"},_t=e=>{const{text:t}=e,n=Object.keys(Ut).includes(t)?Ut[t]:void 0;return(0,a.jsxs)("span",{className:"me-1",style:n?{color:n}:{},children:["[",t,"]"]})},Jt=e=>{const{data:t,type:n,timestamp:s,transportType:i}=e,o=i?(0,a.jsx)(_t,{text:i}):null;return(0,a.jsx)(xt,{title:n,timestamp:s,description:t,label:o})},zt=s.memo((e=>(0,a.jsx)(Jt,{...e}))),Gt=()=>{const e=dt((e=>e.signalingMessages)),t=dt((e=>e.debugFilterText)),n=e.filter((e=>t.split(" ").every((t=>""===t||0<=JSON.stringify(e).indexOf(t)))));return(0,a.jsx)("div",{className:"debug-messages",children:n.map((e=>{const t=e.type+e.timestamp;return(0,a.jsx)(zt,{...e},t)}))})},Wt=e=>(0,a.jsx)(xt,{title:"".concat(e.id,"(").concat(e.type,")"),timestamp:null,description:e}),Kt=s.memo((e=>(0,a.jsx)(Wt,{...e}))),qt=()=>{const e=dt((e=>e.soraContents.statsReport)),t=dt((e=>e.debugFilterText)),n=e.filter((e=>t.split(" ").every((t=>""===t||0<=JSON.stringify(e).indexOf(t)))));return(0,a.jsx)("div",{className:"debug-messages",children:n.map((e=>(0,a.jsx)(Kt,{...e},e.id)))})},Xt={signaling:"#ff00ff",notify:"#ffff00",push:"#98fb98",e2ee:"#00ffff",stats:"#ffc0cb"},Qt=()=>(0,a.jsx)("span",{className:"me-1",style:{color:"#00ff00"},children:"[websocket]"}),$t=()=>(0,a.jsx)("span",{className:"me-1",style:{color:"#ff8c00"},children:"[peerconnection]"}),Yt=()=>(0,a.jsx)("span",{className:"me-1",style:{color:"#bce2e8"},children:"[sora]"}),en=()=>(0,a.jsx)("span",{className:"me-1",style:{color:"#73b8e2"},children:"[sora-devtools]"}),tn=e=>{const{label:t,id:n}=e,s=t&&Object.keys(Xt).includes(t)?Xt[t]:void 0;return(0,a.jsxs)("span",{className:"me-1",style:s?{color:s}:{},children:["[datachannel]",t?"[".concat(t,"]"):"","number"===typeof n?"[".concat(n,"]"):""]})},nn=e=>{const{timestamp:t,logType:n,dataChannelId:s,dataChannelLabel:i,type:o,data:r}=e,c="".concat(o);let l;return"websocket"===n?l=(0,a.jsx)(Qt,{}):"datachannel"===n?l=(0,a.jsx)(tn,{id:s,label:i}):"peerconnection"===n?l=(0,a.jsx)($t,{}):"sora"===n?l=(0,a.jsx)(Yt,{}):"sora-devtools"===n&&(l=(0,a.jsx)(en,{})),(0,a.jsx)(xt,{title:c,timestamp:t,description:r,label:l})},an=s.memo((e=>(0,a.jsx)(nn,{...e}))),sn=()=>{const e=dt((e=>e.timelineMessages)),t=dt((e=>e.debugFilterText)),n=e.filter((e=>t.split(" ").every((t=>""===t||0<=JSON.stringify(e).indexOf(t)))));return(0,a.jsx)("div",{className:"debug-messages",children:n.map((e=>{let t="".concat(e.timestamp,"-").concat(e.type);return e.dataChannelLabel&&(t+="-".concat(e.dataChannelLabel)),(0,a.jsx)(an,{...e},t)}))})},on=()=>{const e=dt((e=>e.debug)),t=dt((e=>e.debugType)),n=lt();if(!e)return null;return(0,a.jsx)("div",{className:"col-debug col-6",children:(0,a.jsxs)(mt.Z,{id:"debug-tab",activeKey:t,defaultActiveKey:"timeline",onSelect:e=>{"log"!==e&&"notify"!==e&&"push"!==e&&"stats"!==e&&"timeline"!==e&&"signaling"!==e&&"messaging"!==e||n(ie(e))},children:[(0,a.jsxs)(ut.Z,{eventKey:"timeline",title:"Timeline",children:[(0,a.jsx)(Nt,{}),(0,a.jsx)(sn,{})]}),(0,a.jsxs)(ut.Z,{eventKey:"signaling",title:"Signaling",children:[(0,a.jsx)(Nt,{}),(0,a.jsx)(Gt,{})]}),(0,a.jsxs)(ut.Z,{eventKey:"notify",title:"Notfiy",children:[(0,a.jsx)(Nt,{}),(0,a.jsx)(Vt,{})]}),(0,a.jsxs)(ut.Z,{eventKey:"push",title:"Push",children:[(0,a.jsx)(Nt,{}),(0,a.jsx)(Ot,{})]}),(0,a.jsxs)(ut.Z,{eventKey:"stats",title:"Stats",children:[(0,a.jsx)(Nt,{}),(0,a.jsx)(qt,{})]}),(0,a.jsxs)(ut.Z,{eventKey:"log",title:"Log",children:[(0,a.jsx)(Nt,{}),(0,a.jsx)(It,{})]}),(0,a.jsxs)(ut.Z,{eventKey:"messaging",title:"Messaging",children:[(0,a.jsx)(Lt,{}),(0,a.jsx)(bt,{})]})]})})};var rn=n(6670),cn=n(3530),ln=n(7224);const dn=()=>{const e=lt(),t=dt((e=>e.soraContents.reconnectingTrials));return(0,s.useEffect)((()=>{e((async(e,t)=>{e(N.slice.actions.setTimelineMessage(R("start-reconnect"))),e(N.slice.actions.setSoraConnectionStatus("connecting"));const n=t();n.soraContents.sora&&await n.soraContents.sora.disconnect();const a=h(n.enabledSignalingUrlCandidates,n.signalingUrlCandidates);e(N.slice.actions.setLogMessages({title:"SIGNALING_URL",description:JSON.stringify(a)}));const s=c.Z.connection(a,n.debug),i=k(M(n)),o=C(n.enabledMetadata,n.metadata);let r,l,d;"sendonly"!==n.role&&"sendrecv"!==n.role||([l,d]=await T(e,n).catch((t=>{throw e(N.slice.actions.setSoraErrorAlertMessage(t.toString())),e(N.slice.actions.setSoraConnectionStatus("disconnected")),t})));for(let c=1;c<=10;c++){const{soraContents:a}=t();if(!1===a.reconnecting)break;e(N.slice.actions.setSoraReconnectingTrials(c));try{"sendonly"===n.role?(r=s.sendonly(n.channelId,null,i),r.metadata=o,"boolean"===typeof n.googCpuOveruseDetection&&(r.constraints={optional:[{googCpuOveruseDetection:n.googCpuOveruseDetection}]}),I(e,t,r),l&&await r.connect(l)):"sendrecv"===n.role?(r=s.sendrecv(n.channelId,null,i),r.metadata=o,"boolean"===typeof n.googCpuOveruseDetection&&(r.constraints={optional:[{googCpuOveruseDetection:n.googCpuOveruseDetection}]}),I(e,t,r),l&&await r.connect(l)):"recvonly"===n.role&&(r=s.recvonly(n.channelId,null,i),r.metadata=o,I(e,t,r),await r.connect())}catch(m){m instanceof Error&&e(N.slice.actions.setSoraErrorAlertMessage("(trials ".concat(c,") Failed to connect Sora. ").concat(m.message))),r=void 0}if(void 0!==r)break;await new Promise((e=>setTimeout(e,500*c+500)))}if(void 0===r)return e(N.slice.actions.setSoraErrorAlertMessage("Failed to reconnect Sora.")),e(N.slice.actions.setSoraConnectionStatus("disconnected")),void e(N.slice.actions.setSoraReconnecting(!1));e(N.slice.actions.setSoraInfoAlertMessage("Succeeded to reconnect Sora.")),await Z(e,r);const u=setInterval((async()=>{const{soraContents:n}=t();n.sora?await Z(e,n.sora):clearInterval(u)}),1e3);e(N.slice.actions.setSora(r)),l&&e(N.slice.actions.setLocalMediaStream(l)),d&&e(N.slice.actions.setFakeContentsGainNode(d)),e(N.slice.actions.setSoraConnectionStatus("connected")),e(N.slice.actions.setTimelineMessage(R("connected"))),e(N.slice.actions.setSoraReconnecting(!1))}))}),[]),(0,a.jsxs)(ln.Z,{delay:2e4,onClose:()=>{e(Ge(!1))},children:[(0,a.jsx)(ln.Z.Header,{className:"bg-warning text-white",children:(0,a.jsx)("strong",{className:"me-auto",children:"Reconnect"})}),(0,a.jsx)(ln.Z.Body,{className:"bg-light",children:(0,a.jsxs)("p",{className:"text-break font-weight-bold mb-0",children:["Reconnecting... (trials ",t,")"]})})]})},un=e=>{const t=lt(),n="error"===e.type?"bg-danger":"bg-info";return(0,a.jsxs)(ln.Z,{autohide:!0,delay:2e4,onClose:()=>{t(B(e.timestamp))},children:[(0,a.jsxs)(ln.Z.Header,{className:"".concat(n," text-white"),children:[(0,a.jsx)("strong",{className:"me-auto",children:e.title}),(0,a.jsx)("span",{children:u(e.timestamp)})]}),(0,a.jsx)(ln.Z.Body,{className:"bg-light",children:(0,a.jsx)("p",{className:"text-break font-weight-bold mb-0",children:e.message})})]})},mn=()=>{const e=dt((e=>e.alertMessages)),t=dt((e=>e.soraContents.reconnecting));return(0,a.jsxs)("div",{className:"alert-messages",children:[t?(0,a.jsx)(dn,{}):null,e.map((e=>(0,a.jsx)(un,{...e},e.timestamp)))]})},gn=e=>(0,a.jsxs)("div",{className:"d-flex align-items-center border border-secondary rounded mx-1",children:[(0,a.jsx)("p",{id:e.id,className:"mx-2 p-1",children:e.text}),(0,a.jsx)("div",{className:"border-left border-secondary",children:(0,a.jsx)("button",{className:"btn btn-sm btn-light",onClick:t=>{m(e.text),t.currentTarget.blur()},children:(0,a.jsx)(ht,{})})})]}),hn=e=>{const{localVideo:t,connectionId:n,clientId:s}=e;return(0,a.jsxs)(a.Fragment,{children:[n?(0,a.jsx)(gn,{id:t?"local-video-connection-id":void 0,text:n}):null,null!==s&&void 0!==s&&n!==s?(0,a.jsx)(gn,{id:t?"local-video-client-id":void 0,text:s}):null]})};async function pn(e,t,n,a){const s=window.location.protocol,i="https:"==s?"443":"3000",o="https:"==s?"api":"";let r="".concat(s,"//").concat(window.location.hostname,":").concat(i,"/").concat(o);null!==e&&(r=e);const c="Sora_".concat(t,".").concat(n),l=await fetch(r,{method:"POST",body:JSON.stringify(a),headers:{Accept:"application/json","Content-Type":"application/json","x-sora-target":c},mode:"cors"}),d=await l.json();if(!l.ok){let e="POST ".concat(r," ").concat(l.status," (").concat(l.statusText,") target:").concat(c);d.error_type&&(e+=" error_type: ".concat(d.error_type));throw new Error(e)}return d}function vn(e,t,n,a,s){const i={channel_id:t,recv_connection_id:n,rid:a};return s&&(i.send_connection_id=s),pn(e,"20201005","RequestRtpStream",i)}function xn(e,t,n,a){const s={channel_id:t,recv_connection_id:n};return a&&(s.send_connection_id=a),pn(e,"20201005","ResetRtpStream",s)}function fn(e,t,n,a,s,i){const o={channel_id:t,recv_connection_id:n,spotlight_focus_rid:a,spotlight_unfocus_rid:s};return i&&(o.send_connection_id=i),pn(e,"20211215","RequestSpotlightRid",o)}function jn(e,t,n,a){const s={channel_id:t,recv_connection_id:n};return a&&(s.send_connection_id=a),pn(e,"20211215","ResetSpotlightRid",s)}const Cn=e=>{const t=dt((e=>e.soraContents.sora)),n=dt((e=>e.apiUrl)),s=dt((e=>e.channelId)),i=lt();return(0,a.jsx)("div",{className:"mx-1",children:(0,a.jsx)("input",{className:"btn btn-secondary",type:"button",name:"requestSimulcastRidTo".concat(e.rid.charAt(0).toUpperCase()+e.rid.slice(1)),defaultValue:"".concat(e.rid," rid"),onClick:async()=>{if(null===t||void 0===t?void 0:t.connectionId)try{const a=await vn(n,s,t.connectionId,e.rid);i(L("POST successed. response: ".concat(JSON.stringify(a))))}catch(a){a instanceof Error&&i(H(a.message))}}})})},bn=()=>{const e=(0,s.useRef)(null),t=(0,s.useRef)(null),n=dt((e=>e.soraContents.sora)),i=dt((e=>e.channelId)),o=dt((e=>e.apiUrl)),r=lt();if(!(null===n||void 0===n?void 0:n.connectionId))return null;return(0,a.jsx)("div",{className:"mx-1",children:(0,a.jsxs)(St.Z,{className:"form-inline",children:[(0,a.jsx)(Ht.Z,{ref:e,children:d.I7.map((e=>""===e?null:(0,a.jsxs)("option",{value:e,children:["SpotlightFocusRid: ",e]},e)))}),(0,a.jsx)(Ht.Z,{ref:t,children:d.I7.map((e=>""===e?null:(0,a.jsxs)("option",{value:e,children:["SpotlightUnfocusRid: ",e,"\xa0\xa0\xa0"]},e)))}),(0,a.jsx)("input",{className:"btn btn-secondary",type:"button",name:"requestSpotlightRid",defaultValue:"requestSpotlightRid",onClick:async()=>{if(!(null===n||void 0===n?void 0:n.connectionId))return;if(null===e.current||null===t.current)return;const a=e.current.value,s=t.current.value;try{const e=await fn(o,i,n.connectionId,a,s);r(L("POST successed. response: ".concat(JSON.stringify(e))))}catch(c){c instanceof Error&&r(H(c.message))}}})]})})},yn=()=>{const e=dt((e=>e.soraContents.sora)),t=dt((e=>e.channelId)),n=dt((e=>e.apiUrl)),s=lt();return(0,a.jsx)("div",{className:"mx-1",children:(0,a.jsx)("input",{className:"btn btn-secondary",type:"button",name:"resetAllSimulcastRid",defaultValue:"reset rid",onClick:async()=>{if(null===e||void 0===e?void 0:e.connectionId)try{const a=await xn(n,t,e.connectionId);s(L("POST successed. response: ".concat(JSON.stringify(a))))}catch(a){a instanceof Error&&s(H(a.message))}}})})},Sn=()=>{const e=dt((e=>e.soraContents.sora)),t=dt((e=>e.channelId)),n=dt((e=>e.apiUrl)),s=lt();return(0,a.jsx)("div",{className:"mx-1",children:(0,a.jsx)("input",{className:"btn btn-secondary",type:"button",name:"resetAllSpotlightRid",defaultValue:"resetSpotlightRid",onClick:async()=>{if(null===e||void 0===e?void 0:e.connectionId)try{const a=await jn(n,t,e.connectionId);s(L("POST successed. response: ".concat(JSON.stringify(a))))}catch(a){a instanceof Error&&s(H(a.message))}}})})},kn=e=>{var t;const{displayResolution:n,stream:i,mute:o,audioOutput:r,setHeight:c}=e,l=(0,s.useRef)(null),d=p(n);return(0,s.useEffect)((()=>{const e=new ResizeObserver((e=>{e.forEach((e=>{c(e.contentRect.height)}))}));return l.current&&(r&&i&&i.getAudioTracks().length>0&&l.current.setSinkId(r),e.observe(l.current)),()=>{e.disconnect()}}),[]),(0,s.useEffect)((()=>{l.current&&o&&(l.current.muted=!0)}),[o]),(0,s.useEffect)((()=>{if(l.current&&i){let e;i.getVideoTracks().forEach((t=>{e=t.enabled,t.enabled=!1})),l.current.onloadedmetadata=t=>{i.getVideoTracks().forEach((t=>{void 0!==e&&(t.enabled=e)}))},l.current.srcObject=i,r&&i.getAudioTracks().length>0&&l.current.setSinkId(r)}else l.current&&null===i&&(l.current.srcObject=null)}),[i]),r&&(null===(t=l.current)||void 0===t?void 0:t.setSinkId)&&i&&i.getAudioTracks().length>0&&l.current.setSinkId(r),(0,a.jsx)("video",{id:e.localVideo?"local-video":void 0,autoPlay:!0,playsInline:!0,controls:!0,muted:o,ref:l,width:0<d.width?d.width:void 0,height:0<d.height?d.height:void 0})},Nn=s.memo((e=>(0,a.jsx)(kn,{...e}))),wn=2.5,Tn=10,In="#CCCCCC";function Mn(e,t,n){e.beginPath(),e.fillStyle=t,e.fillRect(0,n,25,Tn),e.closePath()}function Rn(e,t){const n=Math.ceil(t/12.5);let a=t-Tn;Mn(e,In,a);for(let s=0;s<n;s++)a=a-Tn-wn,Mn(e,In,a)}const Pn=e=>{const t=(0,s.useRef)(null);return(0,s.useEffect)((()=>{if(0===e.stream.getAudioTracks().length)return;const n=new(window.AudioContext||window.webkitAudioContext),a=n.createMediaStreamSource(e.stream),s=n.createAnalyser();s.fftSize=2048;const i=s.frequencyBinCount,o=new Uint8Array(i);a.connect(s);let r=null;return function e(){r=requestAnimationFrame(e),s.getByteTimeDomainData(o);const n=Array.from(o),a=Math.max.apply(null,n)-128,i=t.current;if(null===i)return;const c=i.getContext("2d");null!==c&&(c.clearRect(0,0,25,i.height),c.save(),Rn(c,i.height),function(e,t,n){const a=t*n,s=Math.ceil(a/12.5);for(let i=0;i<s;i++)Mn(e,"#000000",t-Tn*(i+1)-wn*i)}(c,i.height,a/128),c.restore())}(),()=>{n&&n.close(),r&&cancelAnimationFrame(r)}}),[e.stream]),(0,a.jsx)("canvas",{width:25,height:e.height,className:"volume-visualizer",ref:t})},Zn=e=>{const t=(0,s.useRef)(null);return(0,s.useEffect)((()=>{const e=t.current;if(null===e)return;const n=e.getContext("2d");null!==n&&(n.clearRect(0,0,25,e.height),n.save(),Rn(n,e.height),n.restore())}),[]),(0,a.jsx)("canvas",{width:25,height:e.height,className:"volume-visualizer",ref:t})},Vn=s.memo((e=>e.micDevice&&0<e.stream.getAudioTracks().length?(0,a.jsx)(Pn,{...e}):(0,a.jsx)(Zn,{...e}))),An=()=>{const[e,t]=(0,s.useState)(0),n=dt((e=>e.audio)),i=dt((e=>e.video)),o=dt((e=>e.audioOutput)),r=dt((e=>e.displayResolution)),c=dt((e=>e.focusedSpotlightConnectionIds)),l=dt((e=>e.soraContents.connectionId)),d=dt((e=>e.soraContents.localMediaStream)),u=dt((e=>e.micDevice)),m=l&&c[l];return!1===n&&!1===i?null:(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("div",{className:"d-flex",children:(0,a.jsxs)("div",{className:"d-flex flex-nowrap align-items-start video-wrapper"+(m?" spotlight-focused":""),children:[(0,a.jsx)(Nn,{stream:d,setHeight:t,audioOutput:o,displayResolution:r,localVideo:!0,mute:!0}),null!==d?(0,a.jsx)(Vn,{micDevice:u,stream:d,height:e}):null]})})})},Dn=()=>{const e=dt((e=>e.soraContents.connectionId)),t=dt((e=>e.soraContents.clientId)),n=dt((e=>e.simulcast)),s=dt((e=>e.spotlight)),i=dt((e=>e.role)),o=dt((e=>e.soraContents.localMediaStream));return(0,a.jsx)("div",{className:"row my-1",children:(0,a.jsxs)("div",{className:"col-auto",children:[(0,a.jsxs)("div",{className:"video-status mb-1",children:[null!==e||null!==t?(0,a.jsx)("div",{className:"d-flex align-items-center mb-1 video-status-inner",children:(0,a.jsx)(hn,{connectionId:e,clientId:t,localVideo:!0})}):null,null!==e&&"true"!==s&&"true"==n&&"sendonly"!==i?(0,a.jsxs)("div",{className:"d-flex align-items-center mb-1 video-status-inner",children:[(0,a.jsx)(Cn,{rid:"r0"}),(0,a.jsx)(Cn,{rid:"r1"}),(0,a.jsx)(Cn,{rid:"r2"}),(0,a.jsx)(yn,{})]}):null,null!==e&&"true"===s?(0,a.jsxs)("div",{className:"d-flex align-items-center mb-1 video-status-inner",children:[(0,a.jsx)(bn,{}),(0,a.jsx)(Sn,{})]}):null]}),null!==o&&"recvonly"!==i?(0,a.jsx)(An,{}):null]})})};function Fn(e,t,n){if(null===t)return;let a=[];"video"===n?a=t.getVideoTracks().map((e=>e.id)):"audio"===n&&(a=t.getAudioTracks().map((e=>e.id)));return e.find((e=>{if("inbound-rtp"!==e.type)return!1;if(!("kind"in e)||!("trackIdentifier"in e))return!1;const t=e;return t.kind===n&&!!a.includes(t.trackIdentifier)}))}const En=e=>{const t=dt((e=>e.soraContents.statsReport)),n=dt((e=>e.soraContents.prevStatsReport)),s=Fn(t,e.stream,e.type),i=Fn(n,e.stream,e.type);if(void 0===s)return null;if(void 0===s.jitterBufferDelay||void 0===s.jitterBufferEmittedCount)return null;let o=s.jitterBufferDelay,r=s.jitterBufferEmittedCount;void 0!==i&&void 0!==i.jitterBufferDelay&&void 0!==i.jitterBufferEmittedCount&&(o=s.jitterBufferDelay-i.jitterBufferDelay,r=s.jitterBufferEmittedCount-i.jitterBufferEmittedCount);const c=Math.floor(o/r*1e3);let l="normal-jitter-buffer";return 500<c?l="critical-jitter-buffer":300<c?l="danger-jitter-buffer":100<c&&(l="warning-jitter-buffer"),(0,a.jsx)("div",{className:"btn btn-sm mx-1 ".concat(l),children:(0,a.jsxs)("span",{children:[e.type,": ",c]})})},On=e=>{const t=dt((e=>e.soraContents.sora)),n=dt((e=>e.apiUrl)),s=dt((e=>e.channelId)),i=lt();return(0,a.jsx)("input",{className:"btn btn-secondary btn-sm mx-1",type:"button",name:"requestSimulcastRidTo".concat(e.rid.charAt(0).toUpperCase()+e.rid.slice(1)),defaultValue:"".concat(e.rid," rid"),onClick:async()=>{if(null===t||void 0===t?void 0:t.connectionId)try{const a=await vn(n,s,t.connectionId,e.rid,e.sendConnectionId);i(L("POST successed. response: ".concat(JSON.stringify(a))))}catch(a){a instanceof Error&&i(H(a.message))}}})},Bn=e=>{const t=(0,s.useRef)(null),n=(0,s.useRef)(null),i=dt((e=>e.soraContents.sora)),o=dt((e=>e.channelId)),r=dt((e=>e.apiUrl)),c=lt();if(!(null===i||void 0===i?void 0:i.connectionId))return null;return(0,a.jsx)("div",{className:"mx-1",children:(0,a.jsxs)(St.Z,{className:"form-inline",children:[(0,a.jsx)(Ht.Z,{ref:t,children:d.I7.map((e=>""===e?null:(0,a.jsxs)("option",{value:e,children:["SpotlightFocusRid: ",e]},e)))}),(0,a.jsx)(Ht.Z,{ref:n,children:d.I7.map((e=>""===e?null:(0,a.jsxs)("option",{value:e,children:["SpotlightUnfocusRid: ",e,"\xa0\xa0\xa0"]},e)))}),(0,a.jsx)("input",{className:"btn btn-secondary",type:"button",name:"requestSpotlightRidBySendConnectionId",defaultValue:"requestSpotlightRid",onClick:async()=>{if(!(null===i||void 0===i?void 0:i.connectionId))return;if(null===t.current||null===n.current)return;const a=t.current.value,s=n.current.value;try{const t=await fn(r,o,i.connectionId,a,s,e.sendConnectionId);c(L("POST successed. response: ".concat(JSON.stringify(t))))}catch(l){l instanceof Error&&c(H(l.message))}}})]})})},Hn=e=>{const t=dt((e=>e.soraContents.sora)),n=dt((e=>e.channelId)),s=dt((e=>e.apiUrl)),i=lt();return(0,a.jsx)("input",{className:"btn btn-secondary btn-sm mx-1",type:"button",name:"resetRtpStream",defaultValue:"reset rid",onClick:async()=>{if(null===t||void 0===t?void 0:t.connectionId)try{const a=await xn(s,n,t.connectionId,e.sendConnectionId);i(L("POST successed. response: ".concat(JSON.stringify(a))))}catch(a){a instanceof Error&&i(H(a.message))}}})},Ln=e=>{const t=dt((e=>e.soraContents.sora)),n=dt((e=>e.channelId)),s=dt((e=>e.apiUrl)),i=lt();return(0,a.jsx)("input",{className:"btn btn-secondary mx-1",type:"button",name:"resetSpotlightRid",defaultValue:"resetSpotlightRid",onClick:async()=>{if(null===t||void 0===t?void 0:t.connectionId)try{const a=await jn(s,n,t.connectionId,e.sendConnectionId);i(L("POST successed. response: ".concat(JSON.stringify(a))))}catch(a){a instanceof Error&&i(H(a.message))}}})};function Un(e,t){if(null===t)return[];const n=t.getTracks().map((e=>e.id)),a=[];for(const s of e)if((!s.id||s.id.match(/^RTCMediaStreamTrack/))&&"trackIdentifier"in s){const e=s;e.trackIdentifier&&n.includes(e.trackIdentifier)&&a.push(e)}return a}const _n=e=>{const t=dt((e=>e.showStats)),n=dt((e=>e.soraContents.statsReport)),s=dt((e=>e.soraContents.prevStatsReport));if(!t)return null;const i=Un(n,e.stream),o=Un(s,e.stream);return(0,a.jsx)(a.Fragment,{children:i.map((e=>{let t=0,n=0;const s=o.find((t=>e.id===t.id));return s&&(t=e.jitterBufferDelay-s.jitterBufferDelay,n=e.jitterBufferEmittedCount-s.jitterBufferEmittedCount),(0,a.jsx)("div",{children:(0,a.jsxs)("ul",{className:"mediastream-stats-report",children:[Object.entries(e).map((e=>{let[t,n]=e;return(0,a.jsxs)("li",{children:[(0,a.jsxs)("strong",{children:[t,":"]})," ",n]},t)})),(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"[jitterBufferDelay/jitterBufferEmittedCount_in_ms]"})," ",Math.floor(t/n*1e3)]})]})},e.id)}))})},Jn=e=>{const[t,n]=(0,s.useState)(0),i=dt((e=>e.audioOutput)),o=dt((e=>e.displayResolution)),r=dt((e=>e.focusedSpotlightConnectionIds)),c=dt((e=>e.multistream)),l=dt((e=>e.mute)),d=dt((e=>e.simulcast)),u=dt((e=>e.spotlight)),m=e.stream.id&&r[e.stream.id];return(0,a.jsxs)("div",{className:"col-auto",children:[(0,a.jsxs)("div",{className:"video-status",children:[(0,a.jsxs)("div",{className:"d-flex align-items-center mb-1 video-status-inner",children:[(0,a.jsx)(hn,{connectionId:e.stream.id}),(0,a.jsx)(En,{type:"audio",stream:e.stream}),(0,a.jsx)(En,{type:"video",stream:e.stream})]}),(0,a.jsxs)("div",{className:"d-flex align-items-center mb-1 video-status-inner",children:["true"!==u&&"true"===c&&"true"===d?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(On,{rid:"r0",sendConnectionId:e.stream.id}),(0,a.jsx)(On,{rid:"r1",sendConnectionId:e.stream.id}),(0,a.jsx)(On,{rid:"r2",sendConnectionId:e.stream.id}),(0,a.jsx)(Hn,{sendConnectionId:e.stream.id})]}):null,"true"===u&&"true"===c&&"true"===d?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Bn,{sendConnectionId:e.stream.id}),(0,a.jsx)(Ln,{sendConnectionId:e.stream.id})]}):null]})]}),(0,a.jsxs)("div",{className:"d-flex flex-wrap align-items-start",children:[(0,a.jsxs)("div",{className:"d-flex flex-nowrap align-items-start video-wrapper"+(m?" spotlight-focused":""),children:[(0,a.jsx)(Nn,{stream:e.stream,setHeight:n,mute:l,audioOutput:i,displayResolution:o}),(0,a.jsx)(Vn,{micDevice:!0,stream:e.stream,height:t})]}),(0,a.jsx)(_n,{stream:e.stream})]})]})},zn=()=>{const e=dt((e=>e.soraContents.remoteMediaStreams));return(0,a.jsx)("div",{className:"row my-2",children:e.map((e=>(0,a.jsx)(Jn,{stream:e},e.id)))})};var Gn=n(9363),Wn=n(1341);const Kn=e=>{const t=d.x$[e.kind];return t?(0,a.jsx)(Gn.Z,{placement:"top",overlay:(0,a.jsx)(Wn.Z,{id:"popover-basic",children:(0,a.jsx)(Wn.Z.Body,{style:{whiteSpace:"pre-wrap"},children:t.description})}),children:(0,a.jsx)(kt.Z,{children:e.children})}):(console.warn('Could not load description "'.concat(e.kind,'"')),(0,a.jsx)(kt.Z,{children:e.children}))},qn=()=>{const e=dt((e=>e.aspectRatio)),t=lt();return(0,a.jsxs)(St.Z,{className:"form-inline",controlId:"aspectRatio",children:[(0,a.jsx)(Kn,{kind:"aspectRatio",children:"aspectRatio:"}),(0,a.jsx)(Ht.Z,{name:"aspectRatio",value:e,onChange:e=>{g(e.target.value,d.Ii)&&t(U(e.target.value))},children:d.Ii.map((e=>(0,a.jsx)("option",{value:e,children:""===e?"\u672a\u6307\u5b9a":e},e)))})]})},Xn=()=>{const e=dt((e=>e.audioBitRate)),t=y(dt((e=>e.soraContents.connectionStatus))),n=lt();return(0,a.jsxs)(St.Z,{className:"form-inline",controlId:"audioBitRate",children:[(0,a.jsx)(Kn,{kind:"audioBitRate",children:"audioBitRate:"}),(0,a.jsx)(Ht.Z,{name:"audioBitRate",value:e,onChange:e=>{g(e.target.value,d.xR)&&n(J(e.target.value))},disabled:t,children:d.xR.map((e=>(0,a.jsx)("option",{value:e,children:""===e?"\u672a\u6307\u5b9a":e},e)))})]})},Qn=()=>{const e=dt((e=>e.audioCodecType)),t=y(dt((e=>e.soraContents.connectionStatus))),n=lt();return(0,a.jsxs)(St.Z,{className:"form-inline",controlId:"audioBitRate",children:[(0,a.jsx)(Kn,{kind:"audioCodecType",children:"audioCodecType:"}),(0,a.jsx)(Ht.Z,{name:"audioCodecType",value:e,onChange:e=>{g(e.target.value,d.o1)&&n(z(e.target.value))},disabled:t,children:d.o1.map((e=>(0,a.jsx)("option",{value:e,children:""===e?"\u672a\u6307\u5b9a":e},e)))})]})},$n=()=>{const e=dt((e=>e.audioContentHint)),t=lt();return(0,a.jsxs)(St.Z,{className:"form-inline",controlId:"audioContentHint",children:[(0,a.jsx)(Kn,{kind:"audioContentHint",children:"audioContentHint:"}),(0,a.jsx)(Ht.Z,{name:"audioContentHint",value:e,onChange:e=>{g(e.target.value,d.nT)&&t(G(e.target.value))},children:d.nT.map((e=>(0,a.jsx)("option",{value:e,children:""===e?"\u672a\u6307\u5b9a":e},e)))})]})};var Yn=n(7532);const ea=e=>{const{children:t,kind:n,checked:s,onChange:i,disabled:o}=e,r=d.x$[n];return r?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Yn.Z,{type:"switch",checked:s,onChange:i,disabled:o}),(0,a.jsx)(Gn.Z,{placement:"top",overlay:(0,a.jsx)(Wn.Z,{id:"popover-basic",children:(0,a.jsx)(Wn.Z.Body,{style:{whiteSpace:"pre-wrap"},children:r.description})}),children:(0,a.jsx)(kt.Z,{children:t})})]}):(console.warn('Could not load description "'.concat(n,'"')),(0,a.jsx)(kt.Z,{children:t}))},ta=()=>{const e=dt((e=>e.audio)),t=y(dt((e=>e.soraContents.connectionStatus))),n=lt();return(0,a.jsx)(St.Z,{className:"form-inline",controlId:"audio",children:(0,a.jsx)(ea,{kind:"audio",checked:e,onChange:e=>{n(_(e.target.checked))},disabled:t,children:"audio"})})},na=()=>{const e=dt((e=>e.audioInput)),t=dt((e=>e.audioInputDevices)),n=lt();return(0,a.jsxs)(St.Z,{className:"form-inline",controlId:"audioInput",children:[(0,a.jsx)(Kn,{kind:"audioInput",children:"audioInput:"}),(0,a.jsxs)(Ht.Z,{name:"audioInput",value:e,onChange:e=>{n(W(e.target.value)),n(D())},disabled:0===t.length,children:[(0,a.jsx)("option",{value:"",children:"\u672a\u6307\u5b9a"}),t.map((e=>(0,a.jsx)("option",{value:e.deviceId,children:e.label},e.deviceId)))]})]})},aa=()=>{const e=dt((e=>e.audioLyraParamsBitrate)),t=lt(),n=y(dt((e=>e.soraContents.connectionStatus)));return(0,a.jsxs)(St.Z,{className:"form-inline",controlId:"audioLyraParamsBitrate",children:[(0,a.jsx)(Kn,{kind:"audioLyraParamsBitrate",children:"audioLyraParamsBitrate:"}),(0,a.jsx)(Ht.Z,{name:"audioLyraParamsBitrate",value:e,onChange:e=>{g(e.target.value,d.ms)&&t(Me(e.target.value))},disabled:n,children:d.ms.map((e=>(0,a.jsx)("option",{value:e,children:""===e?"\u672a\u6307\u5b9a":e},e)))})]})},sa=()=>{const e=dt((e=>e.audioOutput)),t=dt((e=>e.audioOutputDevices)),n=lt();return(0,a.jsxs)(St.Z,{className:"form-inline",controlId:"audioOutput",children:[(0,a.jsx)(Kn,{kind:"audioOutput",children:"audioOutput:"}),(0,a.jsxs)(Ht.Z,{name:"audioOutput",value:e,onChange:e=>{n(K(e.target.value))},disabled:0===t.length,children:[(0,a.jsx)("option",{value:"",children:"\u672a\u6307\u5b9a"}),t.map((e=>(0,a.jsx)("option",{value:e.deviceId,children:e.label},e.deviceId)))]})]})},ia=()=>{const e=dt((e=>e.enabledAudioStreamingLanguageCode)),t=dt((e=>e.audioStreamingLanguageCode)),n=y(dt((e=>e.soraContents.connectionStatus))),s=lt();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(cn.Z,{className:"form-row",children:(0,a.jsx)(rn.Z,{className:"col-auto",children:(0,a.jsx)(St.Z,{className:"form-inline",controlId:"enabledAudioStreamingLanguageCode",children:(0,a.jsx)(ea,{kind:"audioStreamingLanguageCode",checked:e,onChange:e=>{s(be(e.target.checked))},disabled:n,children:"audioStreamingLanguageCode"})})})}),e?(0,a.jsx)(cn.Z,{className:"form-row",children:(0,a.jsx)(rn.Z,{className:"col-auto",children:(0,a.jsx)(St.Z,{className:"form-inline",controlId:"audioStreamingLanguageCode",children:(0,a.jsx)(yt.Z,{className:"flex-fill w-500",type:"text",placeholder:"audioStreamingLanguageCode\u3092\u6307\u5b9a",value:t,onChange:e=>{s(Ce(e.target.value))},disabled:n})})})}):null]})},oa=()=>{const e=dt((e=>e.audioTrack)),t=lt();return(0,a.jsx)(St.Z,{className:"form-inline",controlId:"audioTrack",children:(0,a.jsx)(ea,{kind:"audioTrack",checked:e,onChange:e=>{t(q(e.target.checked))},disabled:!1,children:"Enable audio track"})})},ra=()=>{const e=dt((e=>e.autoGainControl)),t=lt();return(0,a.jsxs)(St.Z,{className:"form-inline",controlId:"autoGainControl",children:[(0,a.jsx)(Kn,{kind:"autoGainControl",children:"autoGainControl:"}),(0,a.jsx)(Ht.Z,{name:"autoGainControl",value:e,onChange:e=>{g(e.target.value,d.iN)&&t(X(e.target.value))},children:d.iN.map((e=>(0,a.jsx)("option",{value:e,children:""===e?"\u672a\u6307\u5b9a":e},e)))})]})},ca=()=>{const e=dt((e=>e.blurRadius)),t=dt((e=>e.mediaType)),n=lt(),s="getUserMedia"!==t;return(0,a.jsxs)(St.Z,{className:"form-inline",controlId:"blurRadius",children:[(0,a.jsx)(Kn,{kind:"blurRadius",children:"blurRadius:"}),(0,a.jsx)(Ht.Z,{value:e,onChange:e=>{g(e.target.value,d.G_)&&n(Q(e.target.value))},disabled:s,children:d.G_.map((e=>(0,a.jsx)("option",{suppressHydrationWarning:!0,value:e,children:""===e||s?"\u672a\u6307\u5b9a":e},e)))})]})},la=()=>{const e=dt((e=>e.enabledBundleId)),t=dt((e=>e.bundleId)),n=y(dt((e=>e.soraContents.connectionStatus))),s=lt();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(cn.Z,{className:"form-row",children:(0,a.jsx)(rn.Z,{className:"col-auto",children:(0,a.jsx)(St.Z,{className:"form-inline",controlId:"enabledBundleId",children:(0,a.jsx)(ea,{kind:"bundleId",checked:e,onChange:e=>{s(le(e.target.checked))},disabled:n,children:"bundleId"})})})}),e?(0,a.jsx)(cn.Z,{className:"form-row",children:(0,a.jsx)(rn.Z,{className:"col-auto",children:(0,a.jsx)(St.Z,{className:"form-inline",controlId:"bundleId",children:(0,a.jsx)(yt.Z,{className:"flex-fill w-500",type:"text",placeholder:"bundleId\u3092\u6307\u5b9a",value:t,onChange:e=>{s($(e.target.value))},disabled:n})})})}):null]})},da=()=>{const e=dt((e=>e.cameraDevice)),t=dt((e=>e.soraContents.sora)),n=dt((e=>e.video)),s=!(t?t.video:n),i=lt();return(0,a.jsx)(St.Z,{className:"form-inline",controlId:"cameraDevice",children:(0,a.jsx)(ea,{kind:"cameraDevice",checked:e,onChange:e=>{i((e=>async(t,n)=>{const a=n();if(a.soraContents.localMediaStream||a.soraContents.sora){if(e){const n={aspectRatio:a.aspectRatio,audio:!1,audioContentHint:a.audioContentHint,audioInput:a.audioInput,audioTrack:a.audioTrack,autoGainControl:a.autoGainControl,blurRadius:a.blurRadius,cameraDevice:e,echoCancellation:a.echoCancellation,echoCancellationType:a.echoCancellationType,facingMode:a.facingMode,fakeContents:a.fakeContents,fakeVolume:a.fakeVolume,frameRate:a.frameRate,lightAdjustment:a.lightAdjustment,lightAdjustmentProcessor:a.lightAdjustmentProcessor,mediaProcessorsNoiseSuppression:a.mediaProcessorsNoiseSuppression,mediaType:a.mediaType,micDevice:a.micDevice,noiseSuppression:a.noiseSuppression,noiseSuppressionProcessor:a.noiseSuppressionProcessor,resizeMode:a.resizeMode,resolution:a.resolution,video:a.video,videoContentHint:a.videoContentHint,videoInput:a.videoInput,videoTrack:a.videoTrack,virtualBackgroundProcessor:a.virtualBackgroundProcessor},[s,i]=await T(t,n).catch((e=>{throw t(N.slice.actions.setSoraErrorAlertMessage(e.toString())),e}));0<s.getVideoTracks().length&&(a.soraContents.sora&&a.soraContents.localMediaStream?a.soraContents.sora.replaceVideoTrack(a.soraContents.localMediaStream,s.getVideoTracks()[0]):a.soraContents.localMediaStream&&(a.soraContents.localMediaStream.getVideoTracks().forEach((e=>{var t;e.enabled=!1,e.stop(),null===(t=a.soraContents.localMediaStream)||void 0===t||t.removeTrack(e)})),a.soraContents.localMediaStream.addTrack(s.getVideoTracks()[0])),t(N.slice.actions.setFakeContentsGainNode(i)))}else a.soraContents.sora&&a.soraContents.localMediaStream?(await F(t,a),a.soraContents.sora.stopVideoTrack(a.soraContents.localMediaStream)):a.soraContents.localMediaStream&&await F(t,a);t(N.slice.actions.setCameraDevice(e))}else t(N.slice.actions.setCameraDevice(e))})(e.target.checked))},disabled:s,children:"Enable camera device"})})},ua=()=>{const e=dt((e=>e.channelId)),t=y(dt((e=>e.soraContents.connectionStatus))),n=lt();return(0,a.jsxs)(St.Z,{className:"form-inline",controlId:"channelId",children:[(0,a.jsx)(Kn,{kind:"channelId",children:"channelId:"}),(0,a.jsx)(yt.Z,{type:"text",placeholder:"ChannelId\u3092\u6307\u5b9a",value:e,onChange:e=>{n(Y(e.target.value))},disabled:t})]})},ma=()=>{const e=dt((e=>e.enabledClientId)),t=dt((e=>e.clientId)),n=y(dt((e=>e.soraContents.connectionStatus))),s=lt();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(cn.Z,{className:"form-row",children:(0,a.jsx)(rn.Z,{className:"col-auto",children:(0,a.jsx)(St.Z,{className:"form-inline",controlId:"enabledClientId",children:(0,a.jsx)(ea,{kind:"clientId",checked:e,onChange:e=>{s(de(e.target.checked))},disabled:n,children:"clientId"})})})}),e?(0,a.jsx)(cn.Z,{className:"form-row",children:(0,a.jsx)(rn.Z,{className:"col-auto",children:(0,a.jsx)(St.Z,{className:"form-inline",controlId:"clientId",children:(0,a.jsx)(yt.Z,{className:"flex-fill w-500",type:"text",placeholder:"ClientId\u3092\u6307\u5b9a",value:t,onChange:e=>{s(ee(e.target.value))},disabled:n})})})}):null]})},ga=()=>{const e=dt((e=>e.soraContents.connectionStatus)),t=lt();return(0,a.jsx)("div",{className:"col-auto mb-1",children:(0,a.jsx)("input",{className:"btn btn-secondary",type:"button",name:"connect",defaultValue:"connect",onClick:()=>{t((async(e,t)=>{e(N.slice.actions.setTimelineMessage(R("start-connection"))),e(N.slice.actions.setSoraConnectionStatus("preparing"));const n=t();n.soraContents.sora&&await n.soraContents.sora.disconnect();const a=h(n.enabledSignalingUrlCandidates,n.signalingUrlCandidates);e(N.slice.actions.setLogMessages({title:"SIGNALING_URL",description:JSON.stringify(a)}));const s=c.Z.connection(a,n.debug),i=k(M(n)),o=C(n.enabledMetadata,n.metadata);let r,l,d;try{"sendonly"===n.role?(r=s.sendonly(n.channelId,null,i),r.metadata=o,"boolean"===typeof n.googCpuOveruseDetection&&(r.constraints={optional:[{googCpuOveruseDetection:n.googCpuOveruseDetection}]}),I(e,t,r),n.soraContents.localMediaStream?l=n.soraContents.localMediaStream:[l,d]=await T(e,n).catch((t=>{throw e(N.slice.actions.setSoraErrorAlertMessage(t.toString())),e(N.slice.actions.setSoraConnectionStatus("disconnected")),t})),e(N.slice.actions.setSoraConnectionStatus("connecting")),await r.connect(l)):"sendrecv"===n.role?(r=s.sendrecv(n.channelId,null,i),r.metadata=o,"boolean"===typeof n.googCpuOveruseDetection&&(r.constraints={optional:[{googCpuOveruseDetection:n.googCpuOveruseDetection}]}),I(e,t,r),n.soraContents.localMediaStream?l=n.soraContents.localMediaStream:[l,d]=await T(e,n).catch((t=>{throw e(N.slice.actions.setSoraErrorAlertMessage(t.toString())),e(N.slice.actions.setSoraConnectionStatus("disconnected")),t})),await r.connect(l)):"recvonly"===n.role&&(r=s.recvonly(n.channelId,null,i),r.metadata=o,I(e,t,r),e(N.slice.actions.setSoraConnectionStatus("connecting")),await r.connect())}catch(m){let t;if(m instanceof Error&&e(N.slice.actions.setSoraErrorAlertMessage("Failed to connect Sora. ".concat(m.message))),n.lightAdjustmentProcessor&&n.lightAdjustmentProcessor.isProcessing()&&(t=n.lightAdjustmentProcessor.getOriginalTrack(),n.lightAdjustmentProcessor.stopProcessing()),n.virtualBackgroundProcessor&&n.virtualBackgroundProcessor.isProcessing()&&(void 0===t&&(t=n.virtualBackgroundProcessor.getOriginalTrack()),n.virtualBackgroundProcessor.stopProcessing()),t?(t.stop(),e(N.slice.actions.setTimelineMessage(P("stop",t)))):l&&l.getVideoTracks().forEach((t=>{t.stop(),e(N.slice.actions.setTimelineMessage(P("stop",t)))})),n.noiseSuppressionProcessor&&n.noiseSuppressionProcessor.isProcessing()){const t=n.noiseSuppressionProcessor.getOriginalTrack();t&&(t.stop(),e(N.slice.actions.setTimelineMessage(P("stop",t)))),n.noiseSuppressionProcessor.stopProcessing()}else l&&l.getAudioTracks().forEach((t=>{t.stop(),e(N.slice.actions.setTimelineMessage(P("stop",t)))}));throw e(N.slice.actions.setSoraConnectionStatus("disconnected")),m}if(void 0===r)throw new Error("Failed to connect Sora. Connection object is 'undefined'");e(N.slice.actions.setSoraInfoAlertMessage("Succeeded to connect Sora.")),await Z(e,r);const u=setInterval((async()=>{const{soraContents:n}=t();n.sora?await Z(e,n.sora):clearInterval(u)}),1e3);r.stream=null,e(N.slice.actions.setSora(r)),l&&null===n.soraContents.localMediaStream&&e(N.slice.actions.setLocalMediaStream(l)),d&&e(N.slice.actions.setFakeContentsGainNode(d)),e(N.slice.actions.setSoraConnectionStatus("connected")),e(N.slice.actions.setTimelineMessage(R("connected")))}))},disabled:"disconnecting"===e||"connecting"===e||"initializing"===e})})},ha=e=>{const t=dt((e=>e.ignoreDisconnectWebSocket)),n=lt();return(0,a.jsxs)(St.Z,{className:"form-inline",controlId:"ignoreDisconnectWebSocket",children:[(0,a.jsx)(Kn,{kind:"ignoreDisconnectWebSocket",children:"ignoreDisconnectWebSocket:"}),(0,a.jsx)(Ht.Z,{name:"ignoreDisconnectWebSocket",value:t,onChange:e=>{g(e.target.value,d.kt)&&n(Ne(e.target.value))},disabled:e.disabled,children:d.kt.map((e=>(0,a.jsx)("option",{value:e,children:""===e?"\u672a\u6307\u5b9a":e},e)))})]})},pa=e=>{const t=dt((e=>e.dataChannelSignaling)),n=lt();return(0,a.jsxs)(St.Z,{className:"form-inline",controlId:"dataChannelSignaling",children:[(0,a.jsx)(Kn,{kind:"dataChannelSignaling",children:"dataChannelSignaling:"}),(0,a.jsx)(Ht.Z,{name:"dataChannelSignaling",value:t,onChange:e=>{g(e.target.value,d.l9)&&n(ne(e.target.value))},disabled:e.disabled,children:d.l9.map((e=>(0,a.jsx)("option",{value:e,children:""===e?"\u672a\u6307\u5b9a":e},e)))})]})},va=()=>{const e=dt((e=>e.enabledDataChannel)),t=y(dt((e=>e.soraContents.connectionStatus))),n=lt();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(cn.Z,{className:"form-row",children:(0,a.jsx)(rn.Z,{className:"col-auto",children:(0,a.jsx)(St.Z,{className:"form-inline",controlId:"enabledDataChannel",children:(0,a.jsx)(Yn.Z,{type:"switch",name:"enabledDataChannel",label:"dataChannel",checked:e,onChange:e=>{n(me(e.target.checked))},disabled:t})})})}),e?(0,a.jsx)(cn.Z,{className:"form-row",children:(0,a.jsx)(rn.Z,{className:"col-auto",children:(0,a.jsxs)(cn.Z,{xs:"auto",children:[(0,a.jsx)(rn.Z,{children:(0,a.jsx)(pa,{disabled:t})}),(0,a.jsx)(rn.Z,{children:(0,a.jsx)(ha,{disabled:t})})]})})}):null]})},xa=()=>{const e=dt((e=>e.enabledDataChannels)),t=dt((e=>e.dataChannels)),n=y(dt((e=>e.soraContents.connectionStatus))),s=lt(),i="dataChannels\u3092\u6307\u5b9a\n(\u4f8b)\n"+JSON.stringify([{label:"#spam",maxPacketLifeTime:10,ordered:!0,protocol:"efg",compress:!1,direction:"sendrecv"}],null,2);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(cn.Z,{className:"form-row",children:(0,a.jsx)(rn.Z,{className:"col-auto",children:(0,a.jsx)(St.Z,{className:"form-inline",controlId:"enabledDataChannels",children:(0,a.jsx)(ea,{kind:"dataChannels",checked:e,onChange:e=>{s(ue(e.target.checked))},disabled:n,children:"dataChannels"})})})}),e?(0,a.jsx)(cn.Z,{className:"form-row",children:(0,a.jsx)(rn.Z,{className:"col-auto",children:(0,a.jsx)(St.Z,{className:"form-inline",controlId:"dataChannels",children:(0,a.jsx)(yt.Z,{className:"flex-fill",as:"textarea",placeholder:i,value:t,onChange:e=>{s(te(e.target.value))},rows:12,cols:100,disabled:n})})})}):null]})},fa=()=>{const e=dt((e=>e.soraContents.connectionStatus)),t=lt();return(0,a.jsx)("div",{className:"col-auto mb-1",children:(0,a.jsx)("input",{className:"btn btn-secondary",type:"button",name:"disconnect",defaultValue:"disconnect",onClick:()=>{t(V())},disabled:"disconnecting"===e||"connecting"===e||"initializing"===e})})},ja=()=>{const e=dt((e=>e.displayResolution)),t=lt();return(0,a.jsxs)(St.Z,{className:"form-inline",controlId:"displayResolution",children:[(0,a.jsx)(Kn,{kind:"displayResolution",children:"displayResolution:"}),(0,a.jsx)(Ht.Z,{name:"displayResolution",value:e,onChange:e=>{g(e.target.value,d.hJ)&&t(oe(e.target.value))},children:d.hJ.map((e=>(0,a.jsx)("option",{value:e,children:""===e?"\u672a\u6307\u5b9a":e},e)))})]})},Ca=()=>{const e=lt(),t=dt((e=>e.soraContents.connectionStatus)),n=dt((e=>e.soraContents.sora)),s="recvonly"===dt((e=>e.role))||null!==n||y(t);return(0,a.jsx)("div",{className:"col-auto mb-1",children:(0,a.jsx)("input",{className:"btn btn-outline-secondary",type:"button",name:"media_access",defaultValue:"dispose media",onClick:()=>{e((async(e,t)=>{const{fakeContents:n,soraContents:a,lightAdjustmentProcessor:s,noiseSuppressionProcessor:i,virtualBackgroundProcessor:o}=t(),{localMediaStream:r}=a;let c;if(s&&s.isProcessing()&&(c=s.getOriginalTrack(),s.stopProcessing()),o&&o.isProcessing()&&(void 0===c&&(c=o.getOriginalTrack()),o.stopProcessing()),void 0!==c?(c.stop(),null===r||void 0===r||r.removeTrack(c),e(N.slice.actions.setTimelineMessage(P("stop",c)))):r&&r.getVideoTracks().forEach((t=>{t.stop(),r.removeTrack(t),e(N.slice.actions.setTimelineMessage(P("stop",t)))})),i&&i.isProcessing()){const t=i.getOriginalTrack();t&&(t.stop(),null===r||void 0===r||r.removeTrack(t),e(N.slice.actions.setTimelineMessage(P("stop",t)))),i.stopProcessing()}else r&&r.getAudioTracks().forEach((t=>{t.stop(),r.removeTrack(t),e(N.slice.actions.setTimelineMessage(P("stop",t)))}));n.worker&&n.worker.postMessage({type:"stop"}),e(N.slice.actions.setLocalMediaStream(null))}))},disabled:s})})};var ba=n(1744);const ya=()=>{const[e,t]=(0,s.useState)(!1),n=dt((e=>e.e2ee)),i=y(dt((e=>e.soraContents.connectionStatus))),o=lt();return(0,s.useEffect)((()=>{n&&t(!1)}),[n]),(0,a.jsx)(cn.Z,{className:"form-row",children:(0,a.jsx)(rn.Z,{className:"col-auto",children:(0,a.jsxs)(St.Z,{className:"form-inline",controlId:"e2ee",children:[(0,a.jsx)(ea,{kind:"e2ee",checked:n,onChange:e=>{e.target.checked&&t(!0),o((e=>async(t,n)=>{if(e){const e="Faild to execute WebAssembly '".concat("https://sora-e2ee-wasm.shiguredo.app/2020.2/wasm.wasm","'.");try{await c.Z.initE2EE("https://sora-e2ee-wasm.shiguredo.app/2020.2/wasm.wasm")}catch(a){return void t(N.slice.actions.setSoraErrorAlertMessage(e))}}t(N.slice.actions.setE2EE(e))})(e.target.checked))},disabled:i,children:"e2ee"}),e?(0,a.jsx)(ba.Z,{className:"spinner-status",variant:"primary",animation:"border",role:"status"}):null]})})})},Sa=()=>{const e=dt((e=>e.echoCancellation)),t=lt();return(0,a.jsxs)(St.Z,{className:"form-inline",controlId:"echoCancellation",children:[(0,a.jsx)(Kn,{kind:"echoCancellation",children:"echoCancellation:"}),(0,a.jsx)(Ht.Z,{name:"echoCancellation",value:e,onChange:e=>{g(e.target.value,d.PS)&&t(re(e.target.value))},children:d.PS.map((e=>(0,a.jsx)("option",{value:e,children:""===e?"\u672a\u6307\u5b9a":e},e)))})]})},ka=()=>{const e=dt((e=>e.echoCancellationType)),t=lt();return(0,a.jsxs)(St.Z,{className:"form-inline",controlId:"echoCancellationType",children:[(0,a.jsx)(Kn,{kind:"echoCancellationType",children:"echoCancellationType:"}),(0,a.jsx)(Ht.Z,{name:"echoCancellationType",value:e,onChange:e=>{g(e.target.value,d.cJ)&&t(ce(e.target.value))},children:d.cJ.map((e=>(0,a.jsx)("option",{value:e,children:""===e?"\u672a\u6307\u5b9a":e},e)))})]})},Na=()=>{const e=dt((e=>e.facingMode)),t=dt((e=>e.mediaType)),n=lt(),s="getUserMedia"!==t;return(0,a.jsxs)(St.Z,{className:"form-inline",controlId:"facingMode",children:[(0,a.jsx)(Kn,{kind:"facingMode",children:"facingMode:"}),(0,a.jsx)(Ht.Z,{name:"facingMode",value:e,onChange:e=>{g(e.target.value,d.pT)&&n(Se(e.target.value))},disabled:s,children:d.pT.map((e=>(0,a.jsx)("option",{value:e,children:""===e?"\u672a\u6307\u5b9a":e},e)))})]})};var wa=n(3109);const Ta=()=>{const e=dt((e=>e.mediaType)),t=dt((e=>e.fakeVolume)),n=lt();return"fakeMedia"!==e?null:(0,a.jsxs)(St.Z,{className:"form-inline",controlId:"fakeVolume",children:[(0,a.jsx)(Kn,{kind:"fakeVolume",children:"fakeVolume:"}),(0,a.jsx)(wa.Z.Range,{min:"0",max:"1",step:"0.25",value:t,onChange:e=>{n(ye(e.target.value))}})]})},Ia=()=>{const e=dt((e=>e.enabledForwardingFilter)),t=dt((e=>e.forwardingFilter)),n=y(dt((e=>e.soraContents.connectionStatus))),s=lt();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(cn.Z,{className:"form-row",children:(0,a.jsx)(rn.Z,{className:"col-auto",children:(0,a.jsx)(St.Z,{className:"form-inline",controlId:"enabledForwardingFilter",children:(0,a.jsx)(ea,{kind:"forwardingFilter",checked:e,onChange:e=>{s(ge(e.target.checked))},disabled:n,children:"forwardingFilter"})})})}),e?(0,a.jsx)(cn.Z,{className:"form-row",children:(0,a.jsx)(rn.Z,{className:"col-auto",children:(0,a.jsx)(St.Z,{className:"form-inline",controlId:"forwardingFilter",children:(0,a.jsx)(yt.Z,{className:"flex-fill",as:"textarea",placeholder:"forwardingFilter\u3092\u6307\u5b9a",value:t,onChange:e=>{s(Ue(e.target.value))},rows:10,cols:100,disabled:n})})})}):null]})},Ma=()=>{const e=dt((e=>e.frameRate)),t=lt();return(0,a.jsxs)(St.Z,{className:"form-inline",controlId:"frameRate",children:[(0,a.jsx)(Kn,{kind:"frameRate",children:"frameRate:"}),(0,a.jsx)(Ht.Z,{name:"frameRate",value:e,onChange:e=>{g(e.target.value,d.YX)&&t(ke(e.target.value))},children:d.YX.map((e=>(0,a.jsx)("option",{value:e,children:""===e?"\u672a\u6307\u5b9a":e},e)))})]})},Ra=()=>{const e=dt((e=>e.lightAdjustment)),t=dt((e=>e.mediaType)),n=lt(),s="getUserMedia"!==t;return(0,a.jsxs)(St.Z,{className:"form-inline",controlId:"lightAdjustment",children:[(0,a.jsx)(Kn,{kind:"lightAdjustment",children:"lightAdjustment:"}),(0,a.jsx)(Ht.Z,{value:e,onChange:e=>{g(e.target.value,d.Xv)&&n(we(e.target.value))},disabled:s,children:d.Xv.map((e=>(0,a.jsx)("option",{suppressHydrationWarning:!0,value:e,children:""===e||s?"\u672a\u6307\u5b9a":e},e)))})]})},Pa=()=>{const e=dt((e=>e.mediaProcessorsNoiseSuppression)),t=dt((e=>e.mediaType)),n=lt(),s="getUserMedia"!==t;return(0,a.jsx)(St.Z,{className:"form-inline",controlId:"mediaProcessorsNoiseSuppression",children:(0,a.jsx)(ea,{kind:"mediaProcessorsNoiseSuppression",checked:e,onChange:e=>{n(Re(e.target.checked))},disabled:s,children:"mediaProcessorsNoiseSuppression"})})},Za=e=>{const{label:t,disabled:n,onChange:s,mediaType:i}=e;return(0,a.jsx)(Yn.Z,{type:"radio",inline:!0,id:t,label:t,value:t,checked:i===t,onChange:s,disabled:n})},Va=()=>{const[e,t]=(0,s.useState)(!1),n=void 0!==window.CropTarget,i=dt((e=>e.soraContents.connectionStatus)),o=dt((e=>e.soraContents.localMediaStream)),r=dt((e=>e.mediaType)),c=null!==o||y(i),l=lt(),u=e=>{g(e.target.value,d.w_)&&l(Pe(e.target.value))};return(0,s.useEffect)((()=>{t(!0)}),[]),(0,a.jsxs)(St.Z,{className:"form-inline flex-wrap",children:[(0,a.jsx)(Kn,{kind:"mediaType",children:"mediaType:"}),(0,a.jsx)(Za,{label:"getUserMedia",mediaType:r,disabled:c,onChange:u}),(0,a.jsx)(Za,{label:"getDisplayMedia",mediaType:r,disabled:c,onChange:u}),(0,a.jsx)(Za,{label:"fakeMedia",mediaType:r,disabled:c,onChange:u}),e&&(0,a.jsx)(Za,{label:"mediacaptureRegion",mediaType:r,disabled:c||!n,onChange:u})]})},Aa=()=>{const e=dt((e=>e.enabledMetadata)),t=dt((e=>e.metadata)),n=y(dt((e=>e.soraContents.connectionStatus))),s=lt();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(cn.Z,{className:"form-row",children:(0,a.jsx)(rn.Z,{className:"col-auto",children:(0,a.jsx)(St.Z,{className:"form-inline",controlId:"enabledMetadata",children:(0,a.jsx)(ea,{kind:"metadata",checked:e,onChange:e=>{s(he(e.target.checked))},disabled:n,children:"metadata"})})})}),e?(0,a.jsx)(cn.Z,{className:"form-row",children:(0,a.jsx)(rn.Z,{className:"col-auto",children:(0,a.jsx)(St.Z,{className:"form-inline",controlId:"metadata",children:(0,a.jsx)(yt.Z,{className:"flex-fill",as:"textarea",placeholder:"Metadata\u3092\u6307\u5b9a",value:t,onChange:e=>{s(Ze(e.target.value))},rows:10,cols:100,disabled:n})})})}):null]})},Da=()=>{const e=dt((e=>e.micDevice)),t=dt((e=>e.soraContents.sora)),n=dt((e=>e.audio)),s=!(t?t.audio:n),i=lt();return(0,a.jsx)(St.Z,{className:"form-inline",controlId:"micDevice",children:(0,a.jsx)(ea,{kind:"micDevice",checked:e,onChange:e=>{i((e=>async(t,n)=>{const a=n();if(a.soraContents.localMediaStream&&a.soraContents.sora){if(e){const n={aspectRatio:a.aspectRatio,audio:a.audio,audioContentHint:a.audioContentHint,audioInput:a.audioInput,audioTrack:a.audioTrack,autoGainControl:a.autoGainControl,blurRadius:a.blurRadius,cameraDevice:a.cameraDevice,echoCancellation:a.echoCancellation,echoCancellationType:a.echoCancellationType,facingMode:a.facingMode,fakeContents:a.fakeContents,fakeVolume:a.fakeVolume,frameRate:a.frameRate,lightAdjustment:a.lightAdjustment,lightAdjustmentProcessor:a.lightAdjustmentProcessor,mediaProcessorsNoiseSuppression:a.mediaProcessorsNoiseSuppression,mediaType:a.mediaType,micDevice:e,noiseSuppression:a.noiseSuppression,noiseSuppressionProcessor:a.noiseSuppressionProcessor,resizeMode:a.resizeMode,resolution:a.resolution,video:!1,videoContentHint:a.videoContentHint,videoInput:a.videoInput,videoTrack:a.videoTrack,virtualBackgroundProcessor:a.virtualBackgroundProcessor},[s,i]=await T(t,n).catch((e=>{throw t(N.slice.actions.setSoraErrorAlertMessage(e.toString())),e}));0<s.getAudioTracks().length&&(a.soraContents.sora&&a.soraContents.localMediaStream?await a.soraContents.sora.replaceAudioTrack(a.soraContents.localMediaStream,s.getAudioTracks()[0]):a.soraContents.localMediaStream&&(a.soraContents.localMediaStream.getAudioTracks().forEach((e=>{var t;e.enabled=!1,e.stop(),null===(t=a.soraContents.localMediaStream)||void 0===t||t.removeTrack(e)})),a.soraContents.localMediaStream.addTrack(s.getAudioTracks()[0])),t(N.slice.actions.setFakeContentsGainNode(i)))}else a.soraContents.sora&&a.soraContents.localMediaStream?(E(t,a),a.soraContents.sora.stopAudioTrack(a.soraContents.localMediaStream)):a.soraContents.localMediaStream&&E(t,a);t(N.slice.actions.setMicDevice(e))}else t(N.slice.actions.setMicDevice(e))})(e.target.checked))},disabled:s,children:"Enable mic device"})})},Fa=()=>{const e=dt((e=>e.multistream)),t=y(dt((e=>e.soraContents.connectionStatus))),n=lt();return(0,a.jsxs)(St.Z,{className:"form-inline",controlId:"multistream",children:[(0,a.jsx)(Kn,{kind:"multistream",children:"multistream:"}),(0,a.jsx)(Ht.Z,{name:"multistream",value:e,onChange:e=>{g(e.target.value,d.u9)&&n(Ve(e.target.value))},disabled:t,children:d.u9.map((e=>(0,a.jsx)("option",{value:e,children:""===e?"\u672a\u6307\u5b9a":e},e)))})]})},Ea=()=>{const e=dt((e=>e.noiseSuppression)),t=lt();return(0,a.jsxs)(St.Z,{className:"form-inline",controlId:"noiseSuppression",children:[(0,a.jsx)(Kn,{kind:"noiseSuppression",children:"noiseSuppression:"}),(0,a.jsx)(Ht.Z,{name:"noiseSuppression",value:e,onChange:e=>{g(e.target.value,d.ad)&&t(Ae(e.target.value))},children:d.ad.map((e=>(0,a.jsx)("option",{value:e,children:""===e?"\u672a\u6307\u5b9a":e},e)))})]})},Oa=()=>{const e=dt((e=>e.reconnect)),t=y(dt((e=>e.soraContents.connectionStatus))),n=lt();return(0,a.jsx)(cn.Z,{className:"form-row",children:(0,a.jsx)(rn.Z,{className:"col-auto",children:(0,a.jsx)(St.Z,{className:"form-inline",controlId:"reconnect",children:(0,a.jsx)(ea,{kind:"reconnect",checked:e,onChange:e=>{n(Fe(e.target.checked))},disabled:t,children:"reconnect"})})})})},Ba=()=>{const e=lt();return(0,a.jsx)("div",{className:"col-auto mb-1",children:(0,a.jsx)("input",{className:"btn btn-outline-secondary",type:"button",name:"update-devices",defaultValue:"update-devices",onClick:()=>{e(A())}})})},Ha=()=>{const e=lt(),t=dt((e=>e.soraContents.connectionStatus)),n=dt((e=>e.soraContents.sora)),s="recvonly"===dt((e=>e.role))||null!==n||y(t);return(0,a.jsx)("div",{className:"col-auto mb-1",children:(0,a.jsx)("input",{className:"btn btn-outline-secondary",type:"button",name:"media_access",defaultValue:"request media",onClick:()=>{e((async(e,t)=>{const n=t();let a,s;try{[a,s]=await T(e,n).catch((e=>{throw e}))}catch(i){let t;if(i instanceof Error&&(e(N.slice.actions.setLogMessages({title:"REQUEST_MEDIA",description:JSON.stringify(i.message)})),e(N.slice.actions.setAPIErrorAlertMessage("Failed to get user devices. ".concat(i.message)))),n.lightAdjustmentProcessor&&n.lightAdjustmentProcessor.isProcessing()&&(t=n.lightAdjustmentProcessor.getOriginalTrack(),n.lightAdjustmentProcessor.stopProcessing()),n.virtualBackgroundProcessor&&n.virtualBackgroundProcessor.isProcessing()&&(void 0===t&&(t=n.virtualBackgroundProcessor.getOriginalTrack()),n.virtualBackgroundProcessor.stopProcessing()),t?(t.stop(),e(N.slice.actions.setTimelineMessage(P("stop",t)))):a&&a.getVideoTracks().forEach((t=>{t.stop(),e(N.slice.actions.setTimelineMessage(P("stop",t)))})),n.noiseSuppressionProcessor&&n.noiseSuppressionProcessor.isProcessing()){const t=n.noiseSuppressionProcessor.getOriginalTrack();t&&(t.stop(),e(N.slice.actions.setTimelineMessage(P("stop",t)))),n.noiseSuppressionProcessor.stopProcessing()}else a&&a.getAudioTracks().forEach((t=>{t.stop(),e(N.slice.actions.setTimelineMessage(P("stop",t)))}));throw i}s&&e(N.slice.actions.setFakeContentsGainNode(s)),e(N.slice.actions.setLocalMediaStream(a))}))},disabled:s})})},La=()=>{const e=dt((e=>e.resizeMode)),t=lt();return(0,a.jsxs)(St.Z,{className:"form-inline",controlId:"resizeMode",children:[(0,a.jsx)(Kn,{kind:"resizeMode",children:"resizeMode:"}),(0,a.jsx)(Ht.Z,{name:"resizeMode",value:e,onChange:e=>{g(e.target.value,d.L4)&&t(Ee(e.target.value))},children:d.L4.map((e=>(0,a.jsx)("option",{value:e,children:""===e?"\u672a\u6307\u5b9a":e},e)))})]})},Ua=()=>{const e=dt((e=>e.resolution)),t=lt();return(0,a.jsxs)(St.Z,{className:"form-inline",controlId:"resolution",children:[(0,a.jsx)(Kn,{kind:"resolution",children:"resolution:"}),(0,a.jsx)(Ht.Z,{name:"resolution",value:e,onChange:e=>{g(e.target.value,d.Vf)&&t(Be(e.target.value))},children:d.Vf.map((e=>(0,a.jsx)("option",{value:e,children:""===e?"\u672a\u6307\u5b9a":e},e)))})]})},_a=()=>{const e=dt((e=>e.role)),t=dt((e=>e.soraContents.connectionStatus)),n=null!==dt((e=>e.soraContents.localMediaStream))||y(t),s=lt();return(0,a.jsxs)(St.Z,{className:"form-inline",controlId:"role",children:[(0,a.jsx)(Kn,{kind:"role",children:"role:"}),(0,a.jsx)(Ht.Z,{name:"role",value:e,onChange:e=>{g(e.target.value,d.K$)&&s(Oe(e.target.value))},disabled:n,children:d.K$.map((e=>(0,a.jsx)("option",{value:e,children:e},e)))})]})},Ja=()=>{const e=dt((e=>e.enabledSignalingNotifyMetadata)),t=dt((e=>e.signalingNotifyMetadata)),n=y(dt((e=>e.soraContents.connectionStatus))),s=lt();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(cn.Z,{className:"form-row",children:(0,a.jsx)(rn.Z,{className:"col-auto",children:(0,a.jsx)(St.Z,{className:"form-inline",controlId:"enabledSignalingNotifyMetadata",children:(0,a.jsx)(ea,{kind:"signalingNotifyMetadata",checked:e,onChange:e=>{s(pe(e.target.checked))},disabled:n,children:"signalingNotifyMetadata"})})})}),e?(0,a.jsx)(cn.Z,{className:"form-row",children:(0,a.jsx)(rn.Z,{className:"col-auto",children:(0,a.jsx)(St.Z,{className:"form-inline",controlId:"signalingNotifyMetadata",children:(0,a.jsx)(yt.Z,{className:"flex-fill",as:"textarea",placeholder:"signalingNotifyMetadata\u3092\u6307\u5b9a",value:t,onChange:e=>{s(He(e.target.value))},rows:10,cols:100,disabled:n})})})}):null]})},za=()=>{const e=dt((e=>e.enabledSignalingUrlCandidates)),t=dt((e=>e.signalingUrlCandidates)),n=y(dt((e=>e.soraContents.connectionStatus))),s=lt();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(cn.Z,{className:"form-row",xs:"auto",children:(0,a.jsx)(rn.Z,{className:"col-auto",children:(0,a.jsx)(St.Z,{className:"form-inline",controlId:"enabledSignalingUrlCandidates",children:(0,a.jsx)(ea,{kind:"signalingUrlCandidates",checked:e,onChange:e=>{s(ve(e.target.checked))},disabled:n,children:"signalingUrlCandidates"})})})}),e?(0,a.jsx)(cn.Z,{className:"form-row",xs:"auto",children:(0,a.jsx)(rn.Z,{className:"col-auto",children:(0,a.jsx)(St.Z,{className:"form-inline",controlId:"signalingNotifyMetadata",children:(0,a.jsx)(yt.Z,{className:"flex-fill",as:"textarea",placeholder:"signalingUrlCandidates\u3092\u6307\u5b9a",value:t.join("\n"),onChange:e=>{s(Le(e.target.value.split("\n")))},rows:5,cols:100,disabled:n})})})}):null]})},Ga=()=>{const e=dt((e=>e.simulcast)),t=y(dt((e=>e.soraContents.connectionStatus))),n=lt();return(0,a.jsxs)(St.Z,{className:"form-inline",controlId:"simulcast",children:[(0,a.jsx)(Kn,{kind:"simulcast",children:"simulcast:"}),(0,a.jsx)(Ht.Z,{name:"simulcast",value:e,onChange:e=>{g(e.target.value,d.VE)&&n(_e(e.target.value))},disabled:t,children:d.VE.map((e=>(0,a.jsx)("option",{value:e,children:""===e?"\u672a\u6307\u5b9a":e},e)))})]})},Wa=()=>{const e=dt((e=>e.simulcastRid)),t=y(dt((e=>e.soraContents.connectionStatus))),n=lt();return(0,a.jsxs)(St.Z,{className:"form-inline",controlId:"simulcastRid",children:[(0,a.jsx)(Kn,{kind:"simulcastRid",children:"simulcastRid:"}),(0,a.jsx)(Ht.Z,{name:"simulcastRid",value:e,onChange:e=>{g(e.target.value,d.WJ)&&n(Je(e.target.value))},disabled:t,children:d.WJ.map((e=>(0,a.jsx)("option",{value:e,children:""===e?"\u672a\u6307\u5b9a":e},e)))})]})},Ka=()=>{const e=dt((e=>e.spotlightFocusRid)),t=y(dt((e=>e.soraContents.connectionStatus))),n=lt();return(0,a.jsxs)(St.Z,{className:"form-inline",controlId:"spotlightFocusRid",children:[(0,a.jsx)(Kn,{kind:"spotlightFocusRid",children:"spotlightFocusRid:"}),(0,a.jsx)(Ht.Z,{value:e,onChange:e=>{g(e.target.value,d.I7)&&n(Xe(e.target.value))},disabled:t,children:d.I7.map((e=>(0,a.jsx)("option",{value:e,children:""===e?"\u672a\u6307\u5b9a":e},e)))})]})},qa=()=>{const e=dt((e=>e.spotlight)),t=y(dt((e=>e.soraContents.connectionStatus))),n=lt();return(0,a.jsxs)(St.Z,{className:"form-inline",controlId:"spotlight",children:[(0,a.jsx)(Kn,{kind:"spotlight",children:"spotlight:"}),(0,a.jsx)(Ht.Z,{name:"spotlight",value:e,onChange:e=>{g(e.target.value,d.VJ)&&n(qe(e.target.value))},disabled:t,children:d.VJ.map((e=>(0,a.jsx)("option",{value:e,children:""===e?"\u672a\u6307\u5b9a":e},e)))})]})},Xa=()=>{const e=dt((e=>e.spotlightNumber)),t=y(dt((e=>e.soraContents.connectionStatus))),n=lt();return(0,a.jsxs)(St.Z,{className:"form-inline",controlId:"spotlightNumber",children:[(0,a.jsx)(Kn,{kind:"spotlightNumber",children:"spotlightNumber:"}),(0,a.jsx)(Ht.Z,{value:e,onChange:e=>{g(e.target.value,d.Xr)&&n(Qe(e.target.value))},disabled:t,children:d.Xr.map((e=>(0,a.jsx)("option",{value:e,children:""===e?"\u672a\u6307\u5b9a":e},e)))})]})},Qa=()=>{const e=dt((e=>e.spotlightUnfocusRid)),t=y(dt((e=>e.soraContents.connectionStatus))),n=lt();return(0,a.jsxs)(St.Z,{className:"form-inline",controlId:"spotlightUnfocusRid",children:[(0,a.jsx)(Kn,{kind:"spotlightUnfocusRid",children:"spotlightUnfocusRid:"}),(0,a.jsx)(Ht.Z,{value:e,onChange:e=>{g(e.target.value,d.I7)&&n($e(e.target.value))},disabled:t,children:d.I7.map((e=>(0,a.jsx)("option",{value:e,children:""===e?"\u672a\u6307\u5b9a":e},e)))})]})},$a=()=>{const e=dt((e=>e.channelId)),t=dt((e=>e.soraContents.connectionStatus)),n=dt((e=>e.apiUrl)),s=lt();return(0,a.jsx)("div",{className:"col-auto mb-1",children:(0,a.jsx)("input",{className:"btn btn-secondary",type:"button",name:"startRec",defaultValue:"start rec",onClick:async()=>{try{const t=await function(e,t){return pn(e,"20161101","StartRecording",{channel_id:t,expire_time:3600})}(n,e);s(L("POST successed. response: ".concat(JSON.stringify(t))))}catch(t){t instanceof Error&&s(H(t.message))}},disabled:"initializing"===t})})},Ya=()=>{const e=dt((e=>e.channelId)),t=dt((e=>e.soraContents.connectionStatus)),n=dt((e=>e.apiUrl)),s=lt();return(0,a.jsx)("div",{className:"col-auto mb-1",children:(0,a.jsx)("input",{className:"btn btn-secondary",type:"button",name:"stopRec",defaultValue:"stop rec",onClick:async()=>{try{const t=await function(e,t){return pn(e,"20161101","StopRecording",{channel_id:t})}(n,e);s(L("POST successed. response: ".concat(JSON.stringify(t))))}catch(t){t instanceof Error&&s(H(t.message))}},disabled:"initializing"===t})})},es=()=>{const e=lt();return(0,a.jsx)("div",{className:"col-auto mb-1",children:(0,a.jsx)("input",{className:"btn btn-outline-secondary",type:"button",name:"update-mediastream",defaultValue:"update-mediastream",onClick:()=>{e(D())}})})},ts=()=>{const e=dt((e=>e.enabledVideoAV1Params)),t=dt((e=>e.videoAV1Params)),n=y(dt((e=>e.soraContents.connectionStatus))),s=lt();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(cn.Z,{className:"form-row",children:(0,a.jsx)(rn.Z,{className:"col-auto",children:(0,a.jsx)(St.Z,{className:"form-inline",controlId:"enabledVideoAV1Params",children:(0,a.jsx)(ea,{kind:"videoAV1Params",checked:e,onChange:e=>{s(je(e.target.checked))},disabled:n,children:"videoAV1Params"})})})}),e?(0,a.jsx)(cn.Z,{className:"form-row",children:(0,a.jsx)(rn.Z,{className:"col-auto",children:(0,a.jsx)(St.Z,{className:"form-inline",controlId:"videoAV1Params",children:(0,a.jsx)(yt.Z,{className:"flex-fill",as:"textarea",placeholder:"videoAV1Params\u3092\u6307\u5b9a",value:t,onChange:e=>{s(rt(e.target.value))},rows:10,cols:100,disabled:n})})})}):null]})},ns=d.Q5.slice();ns.splice(d.Q5.indexOf("15000")+1,0,"support-message");const as=()=>{const e=dt((e=>e.videoBitRate)),t=y(dt((e=>e.soraContents.connectionStatus))),n=lt();return(0,a.jsxs)(St.Z,{className:"form-inline",controlId:"videoBitRate",children:[(0,a.jsx)(Kn,{kind:"videoBitRate",children:"videoBitRate:"}),(0,a.jsx)(Ht.Z,{name:"videoBitRate",value:e,onChange:e=>{g(e.target.value,d.Q5)&&n(et(e.target.value))},disabled:t,children:ns.map((e=>{let t=e;return""===e?t="\u672a\u6307\u5b9a":"support-message"===e&&(t="\u4ee5\u4e0b\u306f\u30b5\u30dd\u30fc\u30c8\u5916\u3067\u3059"),(0,a.jsx)("option",{value:e,disabled:"support-message"===e,children:t},e)}))})]})},ss=()=>{const e=dt((e=>e.videoCodecType)),t=y(dt((e=>e.soraContents.connectionStatus))),n=lt();return(0,a.jsxs)(St.Z,{className:"form-inline",controlId:"videoCodecType",children:[(0,a.jsx)(Kn,{kind:"videoCodecType",children:"videoCodecType:"}),(0,a.jsx)(Ht.Z,{name:"videoCodecType",value:e,onChange:e=>{g(e.target.value,d.Sh)&&n(tt(e.target.value))},disabled:t,children:d.Sh.map((e=>(0,a.jsx)("option",{value:e,children:""===e?"\u672a\u6307\u5b9a":e},e)))})]})},is=()=>{const e=dt((e=>e.videoContentHint)),t=lt();return(0,a.jsxs)(St.Z,{className:"form-inline",controlId:"videoContentHint",children:[(0,a.jsx)(Kn,{kind:"videoContentHint",children:"videoContentHint:"}),(0,a.jsx)(Ht.Z,{name:"videoContentHint",value:e,onChange:e=>{g(e.target.value,d.QO)&&t(nt(e.target.value))},children:d.QO.map((e=>(0,a.jsx)("option",{value:e,children:""===e?"\u672a\u6307\u5b9a":e},e)))})]})},os=()=>{const e=dt((e=>e.video)),t=y(dt((e=>e.soraContents.connectionStatus))),n=lt();return(0,a.jsx)(St.Z,{className:"form-inline",controlId:"video",children:(0,a.jsx)(ea,{kind:"video",checked:e,onChange:e=>{n(Ye(e.target.checked))},disabled:t,children:"video"})})},rs=()=>{const e=dt((e=>e.enabledVideoH264Params)),t=dt((e=>e.videoH264Params)),n=y(dt((e=>e.soraContents.connectionStatus))),s=lt();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(cn.Z,{className:"form-row",children:(0,a.jsx)(rn.Z,{className:"col-auto",children:(0,a.jsx)(St.Z,{className:"form-inline",controlId:"enabledVideoH264Params",children:(0,a.jsx)(ea,{kind:"videoH264Params",checked:e,onChange:e=>{s(fe(e.target.checked))},disabled:n,children:"videoH264Params"})})})}),e?(0,a.jsx)(cn.Z,{className:"form-row",children:(0,a.jsx)(rn.Z,{className:"col-auto",children:(0,a.jsx)(St.Z,{className:"form-inline",controlId:"videoH264Params",children:(0,a.jsx)(yt.Z,{className:"flex-fill",as:"textarea",placeholder:"videoH264Params\u3092\u6307\u5b9a",value:t,onChange:e=>{s(ot(e.target.value))},rows:10,cols:100,disabled:n})})})}):null]})},cs=()=>{const e=dt((e=>e.videoInput)),t=dt((e=>e.videoInputDevices)),n=lt();return(0,a.jsxs)(St.Z,{className:"form-inline",controlId:"videoInput",children:[(0,a.jsx)(Kn,{kind:"videoInput",children:"videoInput:"}),(0,a.jsxs)(Ht.Z,{name:"videoInput",value:e,onChange:e=>{n(at(e.target.value)),n(D())},disabled:0===t.length,children:[(0,a.jsx)("option",{value:"",children:"\u672a\u6307\u5b9a"}),t.map((e=>(0,a.jsx)("option",{value:e.deviceId,children:e.label},e.deviceId)))]})]})},ls=()=>{const e=dt((e=>e.videoTrack)),t=lt();return(0,a.jsx)(St.Z,{className:"form-inline",controlId:"videoTrack",children:(0,a.jsx)(ea,{kind:"videoTrack",checked:e,onChange:e=>{t(st(e.target.checked))},disabled:!1,children:"Enable video track"})})},ds=()=>{const e=dt((e=>e.enabledVideoVP9Params)),t=dt((e=>e.videoVP9Params)),n=y(dt((e=>e.soraContents.connectionStatus))),s=lt();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(cn.Z,{className:"form-row",children:(0,a.jsx)(rn.Z,{className:"col-auto",children:(0,a.jsx)(St.Z,{className:"form-inline",controlId:"enabledVideoVP9Params",children:(0,a.jsx)(ea,{kind:"videoVP9Params",checked:e,onChange:e=>{s(xe(e.target.checked))},disabled:n,children:"videoVP9Params"})})})}),e?(0,a.jsx)(cn.Z,{className:"form-row",children:(0,a.jsx)(rn.Z,{className:"col-auto",children:(0,a.jsx)(St.Z,{className:"form-inline",controlId:"videoVP9Params",children:(0,a.jsx)(yt.Z,{className:"flex-fill",as:"textarea",placeholder:"videoVP9Params\u3092\u6307\u5b9a",value:t,onChange:e=>{s(it(e.target.value))},rows:10,cols:100,disabled:n})})})}):null]})},us=()=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(cn.Z,{className:"form-row",xs:"auto",children:(0,a.jsx)(rn.Z,{children:(0,a.jsx)(ua,{})})}),(0,a.jsxs)(cn.Z,{className:"form-row",xs:"auto",children:[(0,a.jsx)(rn.Z,{children:(0,a.jsx)(_a,{})}),(0,a.jsx)(rn.Z,{children:(0,a.jsx)(Fa,{})}),(0,a.jsx)(rn.Z,{children:(0,a.jsx)(Ga,{})}),(0,a.jsx)(rn.Z,{children:(0,a.jsx)(qa,{})})]})]}),ms=()=>{const e=dt((e=>e.role)),t=dt((e=>e.multistream)),n=!("recvonly"===e&&("true"===t||""===t));return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(cn.Z,{className:"form-row",xs:"auto",children:[(0,a.jsx)(rn.Z,{children:(0,a.jsx)(ta,{})}),n&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(rn.Z,{children:(0,a.jsx)(Qn,{})}),(0,a.jsx)(rn.Z,{children:(0,a.jsx)(Xn,{})})]})]}),(0,a.jsxs)(cn.Z,{className:"form-row",xs:"auto",children:[(0,a.jsx)(rn.Z,{children:(0,a.jsx)(os,{})}),n&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(rn.Z,{children:(0,a.jsx)(ss,{})}),(0,a.jsx)(rn.Z,{children:(0,a.jsx)(as,{})})]})]})]})},gs=()=>"true"!==dt((e=>e.simulcast))?null:(0,a.jsx)(cn.Z,{className:"form-row",xs:"auto",children:(0,a.jsx)(rn.Z,{children:(0,a.jsx)(Wa,{})})}),hs=()=>"true"!==dt((e=>e.spotlight))?null:(0,a.jsxs)(cn.Z,{className:"form-row",xs:"auto",children:[(0,a.jsx)(rn.Z,{children:(0,a.jsx)(Xa,{})}),(0,a.jsx)(rn.Z,{children:(0,a.jsx)(Ka,{})}),(0,a.jsx)(rn.Z,{children:(0,a.jsx)(Qa,{})})]}),ps=()=>{const[e,t]=(0,s.useState)(!0),n=[dt((e=>e.e2ee)),dt((e=>e.enabledBundleId)),dt((e=>e.enabledClientId)),dt((e=>e.enabledDataChannel)),dt((e=>e.enabledDataChannels)),dt((e=>e.enabledForwardingFilter)),dt((e=>e.enabledMetadata)),dt((e=>e.enabledSignalingNotifyMetadata)),dt((e=>e.enabledSignalingUrlCandidates)),dt((e=>e.reconnect))].some((e=>e)),i=["btn-collapse-options"];e&&i.push("collapsed"),n&&i.push("fw-bold");return(0,a.jsxs)(cn.Z,{className:"form-row",children:[(0,a.jsx)(rn.Z,{children:(0,a.jsx)("a",{href:"#",className:i.join(" "),onClick:n=>{n.preventDefault(),t(!e)},children:"Signaling options"})}),(0,a.jsx)(gt.Z,{in:!e,children:(0,a.jsxs)("div",{children:[(0,a.jsx)(ya,{}),(0,a.jsx)(Oa,{}),(0,a.jsx)(ma,{}),(0,a.jsx)(Aa,{}),(0,a.jsx)(la,{}),(0,a.jsx)(Ja,{}),(0,a.jsx)(za,{}),(0,a.jsx)(Ia,{}),(0,a.jsx)(xa,{}),(0,a.jsx)(va,{})]})})]})},vs=()=>{const[e,t]=(0,s.useState)(!0),n=[""!==dt((e=>e.audioStreamingLanguageCode)),""!==dt((e=>e.audioLyraParamsBitrate)),dt((e=>e.enabledVideoVP9Params)),dt((e=>e.enabledVideoH264Params)),dt((e=>e.enabledVideoAV1Params))].some((e=>e)),i=["btn-collapse-options"];e&&i.push("collapsed"),n&&i.push("fw-bold");return(0,a.jsxs)(cn.Z,{className:"form-row",children:[(0,a.jsx)(rn.Z,{children:(0,a.jsx)("a",{href:"#",className:i.join(" "),onClick:n=>{n.preventDefault(),t(!e)},children:"Advanced signaling options"})}),(0,a.jsx)(gt.Z,{in:!e,children:(0,a.jsxs)("div",{children:[(0,a.jsx)(ia,{}),(0,a.jsx)(cn.Z,{className:"form-row",children:(0,a.jsx)(rn.Z,{className:"col-auto",children:(0,a.jsx)(aa,{})})}),(0,a.jsx)(ds,{}),(0,a.jsx)(rs,{}),(0,a.jsx)(ts,{})]})})]})},xs=()=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(cn.Z,{xs:"auto",className:"form-row",children:(0,a.jsx)(rn.Z,{children:(0,a.jsx)(Va,{})})}),(0,a.jsx)(cn.Z,{xs:"auto",className:"form-row",children:(0,a.jsx)(rn.Z,{children:(0,a.jsx)(Ta,{})})})]}),fs=()=>{const[e,t]=(0,s.useState)(!0),n=[""!==dt((e=>e.audioContentHint)),""!==dt((e=>e.autoGainControl)),""!==dt((e=>e.noiseSuppression)),""!==dt((e=>e.echoCancellation)),""!==dt((e=>e.echoCancellationType)),""!==dt((e=>e.videoContentHint)),""!==dt((e=>e.resolution)),""!==dt((e=>e.frameRate)),""!==dt((e=>e.blurRadius)),""!==dt((e=>e.lightAdjustment)),dt((e=>e.mediaProcessorsNoiseSuppression))].some((e=>e)),i=["btn-collapse-options"];e&&i.push("collapsed"),n&&i.push("fw-bold");return(0,a.jsxs)(cn.Z,{className:"form-row",children:[(0,a.jsx)(rn.Z,{children:(0,a.jsx)("a",{href:"#",className:i.join(" "),onClick:n=>{n.preventDefault(),t(!e)},children:"Media options"})}),(0,a.jsx)(gt.Z,{in:!e,children:(0,a.jsxs)("div",{children:[(0,a.jsxs)(cn.Z,{className:"form-row",children:[(0,a.jsx)(rn.Z,{className:"col-auto",children:(0,a.jsx)($n,{})}),(0,a.jsx)(rn.Z,{className:"col-auto",children:(0,a.jsx)(ra,{})}),(0,a.jsx)(rn.Z,{className:"col-auto",children:(0,a.jsx)(Ea,{})}),(0,a.jsx)(rn.Z,{className:"col-auto",children:(0,a.jsx)(Sa,{})}),(0,a.jsx)(rn.Z,{className:"col-auto",children:(0,a.jsx)(ka,{})}),(0,a.jsx)(rn.Z,{className:"col-auto",children:(0,a.jsx)(Pa,{})})]}),(0,a.jsxs)(cn.Z,{className:"form-row",children:[(0,a.jsx)(rn.Z,{className:"col-auto",children:(0,a.jsx)(is,{})}),(0,a.jsx)(rn.Z,{className:"col-auto",children:(0,a.jsx)(Ua,{})}),(0,a.jsx)(rn.Z,{className:"col-auto",children:(0,a.jsx)(Ma,{})}),(0,a.jsx)(rn.Z,{className:"col-auto",children:(0,a.jsx)(qn,{})}),(0,a.jsx)(rn.Z,{className:"col-auto",children:(0,a.jsx)(La,{})}),(0,a.jsx)(rn.Z,{className:"col-auto",children:(0,a.jsx)(ca,{})}),(0,a.jsx)(rn.Z,{className:"col-auto",children:(0,a.jsx)(Ra,{})}),(0,a.jsx)(rn.Z,{className:"col-auto",children:(0,a.jsx)(Na,{})})]}),(0,a.jsx)(es,{})]})})]})},js=()=>{const e=dt((e=>e.role)),t=dt((e=>e.mediaType));return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(cn.Z,{className:"form-row",xs:"auto",children:"recvonly"!==e&&"getUserMedia"===t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(rn.Z,{children:(0,a.jsx)(na,{})}),(0,a.jsx)(rn.Z,{children:(0,a.jsx)(cs,{})})]}):null}),(0,a.jsxs)(cn.Z,{className:"form-row",xs:"auto",children:[(0,a.jsx)(rn.Z,{children:(0,a.jsx)(sa,{})}),(0,a.jsx)(Ba,{}),"recvonly"!==e?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Ha,{}),(0,a.jsx)(Ca,{})]}):null]})]})},Cs=()=>{const e=dt((e=>e.role));return(0,a.jsxs)(cn.Z,{className:"form-row",xs:"auto",children:[(0,a.jsx)(rn.Z,{children:(0,a.jsx)(ja,{})}),"recvonly"!==e?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(rn.Z,{children:(0,a.jsx)(Da,{})}),(0,a.jsx)(rn.Z,{children:(0,a.jsx)(da,{})}),(0,a.jsx)(rn.Z,{children:(0,a.jsx)(oa,{})}),(0,a.jsx)(rn.Z,{children:(0,a.jsx)(ls,{})})]}):null]})},bs=()=>{const e=dt((e=>e.debug)),t=dt((e=>e.role)),n=dt((e=>e.multistream)),s=!("recvonly"===t&&("true"===n||""===n));return(0,a.jsxs)("div",{className:e?"col-devtools col-6":"col-devtools col-12",children:[(0,a.jsx)(mn,{}),(0,a.jsx)(us,{}),(0,a.jsx)(gs,{}),(0,a.jsx)(hs,{}),(0,a.jsx)("hr",{className:"hr-form"}),(0,a.jsx)(ms,{}),(0,a.jsx)(ps,{}),s&&(0,a.jsx)(vs,{}),(0,a.jsx)("hr",{className:"hr-form"}),"recvonly"!==t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(xs,{}),(0,a.jsx)(fs,{}),(0,a.jsx)("hr",{className:"hr-form"})]}):null,(0,a.jsx)(js,{}),(0,a.jsx)(Cs,{}),(0,a.jsx)("hr",{className:"hr-form"}),(0,a.jsxs)("div",{className:"row",children:[(0,a.jsx)(ga,{}),(0,a.jsx)(fa,{}),(0,a.jsx)($a,{}),(0,a.jsx)(Ya,{})]}),(0,a.jsx)("hr",{className:"hr-form"}),(0,a.jsx)(Dn,{}),"recvonly"===t||"sendrecv"===t?(0,a.jsx)(zn,{}):null]})};var ys=n(7365),Ss=n(7902);const ks=()=>{const e=dt((e=>e.debug)),t=lt(),n=e?"btn btn-footer-debug-mode active":"btn btn-footer-debug-mode";return(0,a.jsx)("div",{children:(0,a.jsx)("button",{className:n,onClick:()=>{t(ae(!e))},children:"debug"})})},Ns=()=>{const e=dt((e=>e.version));return(0,a.jsxs)("footer",{children:[(0,a.jsxs)(Ss.Z,{variant:"dark",bg:"sora",expand:"md",fixed:"bottom",children:[(0,a.jsx)(ys.Z,{className:"me-auto"}),(0,a.jsx)(ys.Z,{children:(0,a.jsxs)(Ss.Z.Collapse,{id:"navbar-collapse",children:[(0,a.jsxs)("a",{href:"https://github.com/shiguredo/sora-devtools",className:"btn btn-outline-light m-1",children:["GitHub: shiguredo/sora-devtools: ",e]}),(0,a.jsxs)("a",{href:"https://github.com/shiguredo/sora-js-sdk",className:"btn btn-outline-light m-1",children:["GitHub: shiguredo/sora-js-sdk: ",c.Z.version()]})]})})]}),(0,a.jsx)(ks,{})]})};var ws=n(8013),Ts=n.n(ws);const Is=()=>(0,a.jsx)(Ts(),{children:(0,a.jsx)("title",{children:"Sora DevTools"})});var Ms=n(317);const Rs=()=>{const e=lt();return(0,a.jsx)("input",{className:"btn btn-light btn-sm ms-1",type:"button",name:"copyUrl",defaultValue:"copy URL",onClick:()=>{e(((e,t)=>{const n=t(),a=!("recvonly"===n.role&&("true"===n.multistream||""===n.multistream)),s={channelId:n.channelId,role:n.role,audio:n.audio,video:n.video,debug:n.debug,mediaType:"getUserMedia"!==n.mediaType?n.mediaType:void 0,audioBitRate:a&&""!==n.audioBitRate?n.audioBitRate:void 0,audioCodecType:a&&""!==n.audioCodecType?n.audioCodecType:void 0,videoBitRate:a&&""!==n.videoBitRate?n.videoBitRate:void 0,videoCodecType:a&&""!==n.videoCodecType?n.videoCodecType:void 0,videoVP9Params:a&&""!==n.videoVP9Params&&n.enabledVideoVP9Params?n.videoVP9Params:void 0,videoH264Params:a&&""!==n.videoH264Params&&n.enabledVideoH264Params?n.videoH264Params:void 0,videoAV1Params:a&&""!==n.videoAV1Params&&n.enabledVideoAV1Params?n.videoAV1Params:void 0,audioContentHint:""!==n.audioContentHint?n.audioContentHint:void 0,autoGainControl:""!==n.autoGainControl?n.autoGainControl:void 0,noiseSuppression:""!==n.noiseSuppression?n.noiseSuppression:void 0,echoCancellation:""!==n.echoCancellation?n.echoCancellation:void 0,echoCancellationType:""!==n.echoCancellationType?n.echoCancellationType:void 0,videoContentHint:""!==n.videoContentHint?n.videoContentHint:void 0,resolution:""!==n.resolution?n.resolution:void 0,facingMode:""!==n.facingMode?n.facingMode:void 0,frameRate:""!==n.frameRate?n.frameRate:void 0,aspectRatio:""!==n.aspectRatio?n.aspectRatio:void 0,resizeMode:""!==n.resizeMode?n.resizeMode:void 0,blurRadius:""!==n.blurRadius?n.blurRadius:void 0,lightAdjustment:""!==n.lightAdjustment?n.lightAdjustment:void 0,multistream:""!==n.multistream?n.multistream:void 0,simulcast:""!==n.simulcast?n.simulcast:void 0,simulcastRid:""!==n.simulcastRid?n.simulcastRid:void 0,spotlight:""!==n.spotlight?n.spotlight:void 0,spotlightNumber:""!==n.spotlightNumber?n.spotlightNumber:void 0,spotlightFocusRid:""!==n.spotlightFocusRid?n.spotlightFocusRid:void 0,spotlightUnfocusRid:""!==n.spotlightUnfocusRid?n.spotlightUnfocusRid:void 0,audioInput:"getUserMedia"===n.mediaType&&""!==n.audioInput?n.audioInput:void 0,audioOutput:""!==n.audioOutput?n.audioOutput:void 0,videoInput:"getUserMedia"===n.mediaType&&""!==n.videoInput?n.videoInput:void 0,displayResolution:""!==n.displayResolution?n.displayResolution:void 0,bundleId:""!==n.bundleId&&n.enabledBundleId?n.bundleId:void 0,clientId:""!==n.clientId&&n.enabledClientId?n.clientId:void 0,metadata:""!==n.metadata&&n.enabledMetadata?n.metadata:void 0,signalingNotifyMetadata:""!==n.signalingNotifyMetadata&&n.enabledSignalingNotifyMetadata?n.signalingNotifyMetadata:void 0,forwardingFilter:""!==n.forwardingFilter&&n.enabledForwardingFilter?n.forwardingFilter:void 0,dataChannelSignaling:""!==n.dataChannelSignaling&&n.enabledDataChannel?n.dataChannelSignaling:void 0,ignoreDisconnectWebSocket:""!==n.ignoreDisconnectWebSocket&&n.enabledDataChannel?n.ignoreDisconnectWebSocket:void 0,dataChannels:""!==n.dataChannels&&n.enabledDataChannels?n.dataChannels:void 0,reconnect:!0===n.reconnect||void 0,e2ee:!0===n.e2ee||void 0,mediaProcessorsNoiseSuppression:!0===n.mediaProcessorsNoiseSuppression||void 0,micDevice:!1!==n.micDevice&&void 0,cameraDevice:!1!==n.cameraDevice&&void 0,audioTrack:!1!==n.audioTrack&&void 0,videoTrack:!1!==n.videoTrack&&void 0,signalingUrlCandidates:0<n.signalingUrlCandidates.length&&n.enabledSignalingUrlCandidates?n.signalingUrlCandidates:void 0,apiUrl:null!==n.apiUrl?n.apiUrl:void 0,fakeVolume:"fakeMedia"===n.mediaType?n.fakeVolume:void 0,mute:!0===n.mute||void 0,audioStreamingLanguageCode:a&&""!==n.audioStreamingLanguageCode&&n.enabledAudioStreamingLanguageCode?n.audioStreamingLanguageCode:void 0,audioLyraParamsBitrate:a&&n.audioLyraParamsBitrate?n.audioLyraParamsBitrate:void 0},i=Object.keys(s).map((e=>{const t=s[e];if(void 0!==t)return"signalingUrlCandidates"===e?"".concat(e,"=").concat(encodeURIComponent(JSON.stringify(t))):"".concat(e,"=").concat(encodeURIComponent(t))})).filter((e=>void 0!==e));m("".concat(location.origin).concat(location.pathname,"?").concat(i.join("&"))),window.history.replaceState(null,"","".concat(location.pathname,"?").concat(i.join("&")))}))}})},Ps=()=>{const e=dt((e=>e.debug)),t=lt(),n=["btn","btn-header-debug-mode","btn-sm","ms-1"];return e&&n.push("active"),(0,a.jsx)("input",{className:n.join(" "),type:"button",name:"debug",defaultValue:"debug",onClick:()=>{t(ae(!e))}})};var Zs=n(4689);const Vs=()=>{const e=(0,s.useRef)(null);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("input",{className:"btn btn-light btn-sm ms-1",type:"button",name:"downloadReport",defaultValue:"Download report",onClick:async()=>{const t=function(){const e=Zs.h.getState(),t={aspectRatio:e.aspectRatio,audio:e.audio,audioBitRate:e.audioBitRate,audioCodecType:e.audioCodecType,audioContentHint:e.audioContentHint,audioInput:e.audioInput,audioInputDevices:e.audioInputDevices,audioOutput:e.audioOutput,audioOutputDevices:e.audioOutputDevices,audioStreamingLanguageCode:e.audioStreamingLanguageCode,audioLyraParamsBitrate:e.audioLyraParamsBitrate,audioTrack:e.audioTrack,autoGainControl:e.autoGainControl,bundleId:e.bundleId,cameraDevice:e.cameraDevice,channelId:e.channelId,clientId:e.clientId,dataChannelSignaling:e.dataChannelSignaling,dataChannels:e.dataChannels,debug:e.debug,displayResolution:e.displayResolution,e2ee:e.e2ee,echoCancellation:e.echoCancellation,echoCancellationType:e.echoCancellationType,enabledAudioStreamingLanguageCode:e.enabledAudioStreamingLanguageCode,enabledBundleId:e.enabledBundleId,enabledClientId:e.enabledClientId,enabledDataChannel:e.enabledDataChannel,enabledDataChannels:e.enabledDataChannels,enabledForwardingFilter:e.enabledForwardingFilter,enabledMetadata:e.enabledMetadata,enabledSignalingNotifyMetadata:e.enabledSignalingNotifyMetadata,enabledSignalingUrlCandidates:e.enabledSignalingUrlCandidates,enabledVideoVP9Params:e.enabledVideoVP9Params,enabledVideoH264Params:e.enabledVideoH264Params,enabledVideoAV1Params:e.enabledVideoAV1Params,facingMode:e.facingMode,fakeVolume:e.fakeVolume,forwardingFilter:e.forwardingFilter,frameRate:e.frameRate,googCpuOveruseDetection:e.googCpuOveruseDetection,ignoreDisconnectWebSocket:e.ignoreDisconnectWebSocket,mediaType:e.mediaType,metadata:e.metadata,micDevice:e.micDevice,multistream:e.multistream,noiseSuppression:e.noiseSuppression,reconnect:e.reconnect,resizeMode:e.resizeMode,resolution:e.resolution,role:e.role,signalingNotifyMetadata:e.signalingNotifyMetadata,signalingUrlCandidates:e.signalingUrlCandidates,simulcast:e.simulcast,simulcastRid:e.simulcastRid,spotlight:e.spotlight,spotlightFocusRid:e.spotlightFocusRid,spotlightNumber:e.spotlightNumber,spotlightUnfocusRid:e.spotlightUnfocusRid,video:e.video,videoBitRate:e.videoBitRate,videoCodecType:e.videoCodecType,videoContentHint:e.videoContentHint,videoInput:e.videoInput,videoInputDevices:e.videoInputDevices,videoTrack:e.videoTrack,videoVP9Params:e.videoVP9Params,videoH264Params:e.videoH264Params,videoAV1Params:e.videoAV1Params};return{userAgent:navigator.userAgent,"sora-devtools":e.version,"sora-js-sdk":c.Z.version(),parameters:t,timeline:e.timelineMessages.map((e=>({timestamp:e.timestamp,message:e}))),notify:e.notifyMessages,stats:e.soraContents.statsReport}}(),n=JSON.stringify(t),a=new Blob([n],{type:"text/plain"});if(window.URL=window.URL||window.webkitURL,e.current){const t=(new Date).toISOString().replaceAll(":","_").replaceAll(".","_");e.current.download="sora-devtools-report-".concat(t,".json"),e.current.href=window.URL.createObjectURL(a),e.current.click()}}}),(0,a.jsx)("a",{ref:e,style:{display:"none"}})]})},As=()=>{const e=dt((e=>e.soraContents.sora));return(0,a.jsx)("header",{children:(0,a.jsx)(Ss.Z,{variant:"dark",bg:"sora",expand:"md",fixed:"top",children:(0,a.jsxs)(Ms.Z,{children:[(0,a.jsx)(Ss.Z.Brand,{href:"/",children:"Sora DevTools"}),(0,a.jsx)(Ss.Z.Toggle,{"aria-controls":"navbar-collapse"}),(0,a.jsxs)(Ss.Z.Collapse,{id:"navbar-collapse",children:[(0,a.jsx)(ys.Z,{className:"me-auto"}),(0,a.jsxs)(ys.Z,{children:[(0,a.jsx)(Ss.Z.Text,{className:"py-0 my-1 mx-1",children:(0,a.jsx)("p",{className:"navbar-signaling-url border rounded",children:e?e.connectedSignalingUrl:"\u672a\u63a5\u7d9a"})}),(0,a.jsx)(Ss.Z.Text,{className:"py-0 my-1 mx-1",children:(0,a.jsx)(Ps,{})}),(0,a.jsx)(Ss.Z.Text,{className:"py-0 my-1 mx-1",children:(0,a.jsx)(Vs,{})}),(0,a.jsx)(Ss.Z.Text,{className:"py-0 my-1 ms-1",children:(0,a.jsx)(Rs,{})})]})]})]})})})};var Ds=n(6871),Fs=n.n(Ds);const Es=()=>{const e=dt((e=>e.mediaType)),t={x:100,y:100},[n,i]=(0,s.useState)(t),[o,r]=(0,s.useState)(0);return(0,s.useEffect)((()=>{const e=()=>{var e;void 0!==window&&r((e=window.innerWidth)<680?e-40:640)};return window.addEventListener("resize",e),e(),()=>{window.removeEventListener("resize",e)}}),[]),"mediacaptureRegion"!==e?null:(0,a.jsx)(Fs(),{position:n,onDrag:(e,t)=>{i({x:t.x,y:t.y})},defaultPosition:t,children:(0,a.jsx)("div",{id:"cropArea",className:"cropArea",style:{width:"".concat(o,"px"),height:"".concat(Math.floor(o/4*3),"px")}})})};var Os=()=>{const e=lt();return(0,s.useEffect)((()=>(e(w()),e(A()),e((async(e,t)=>{const n="https://lyra-wasm.shiguredo.app/2022.2.0/";c.Z.initLyra({wasmPath:n,modelPath:"https://lyra-wasm.shiguredo.app/2022.2.0/"}),"serviceWorker"in navigator&&navigator.serviceWorker.register("./service-worker.js").then((e=>{e.addEventListener("updatefound",(()=>{const t=e.installing;null!==t&&t.addEventListener("statechange",(()=>{"activated"==t.state&&location.reload()}))}))}))})),()=>{e(V())})),[]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Es,{}),(0,a.jsx)(Is,{}),(0,a.jsx)(As,{}),(0,a.jsx)("main",{role:"main",children:(0,a.jsx)("div",{className:"container",children:(0,a.jsxs)("div",{className:"row",children:[(0,a.jsx)(bs,{}),(0,a.jsx)(on,{})]})})}),(0,a.jsx)(Ns,{})]})}}},function(e){e.O(0,[291,530,421,774,888,179],(function(){return t=1206,e(e.s=t);var t}));var t=e.O();_N_E=t}]);